CREATE PROCEDURE SP3S_INSERTSAVED_RECORD_IN_TEMP_TABLE
(
	@cTableName			NVARCHAR(100),
	@cColName			NVARCHAR(100),
	@cTempTableName		NVARCHAR(100),
	@cMEMOID			NVARCHAR(100),
	@cSPID				NVARCHAR(50)
)
AS
BEGIN
--SET NOCOUNT ON  
 DECLARE   @CINSERTSTR NVARCHAR(MAX)  
 DECLARE @CSYSCOLS TABLE ( COLUMN_NAME VARCHAR(50) )  
  
  
 INSERT @CSYSCOLS SELECT NAME FROM SYSCOLUMNS WHERE ID = OBJECT_ID(@CTABLENAME) AND NAME <> 'TS'  
  
 SET @CINSERTSTR = ''  
 UPDATE @CSYSCOLS  
  SET @CINSERTSTR = @CINSERTSTR + ( CASE WHEN @CINSERTSTR <> '' THEN ', ' ELSE '' END ) + [COLUMN_NAME]  
 SET @CINSERTSTR = ' INSERT ' + @cTempTableName +   
     ' ( ' + @CINSERTSTR + ' ) ' +   
     ' SELECT ' +   
     '   ' + @CINSERTSTR +   
     ' FROM ' + @CTABLENAME  +'(NOLOCK) '+
     ' WHERE '+@cColName+' ='''+@cMEMOID+''''
 PRINT @CINSERTSTR  
  
 EXEC SP_EXECUTESQL @CINSERTSTR

 if @cTempTableName='XNR_XNRECONP_UPLOAD'
	update XNR_XNRECONP_UPLOAD set sp_id=@cSPID WHERE recon_id=@cMEMOID
END 