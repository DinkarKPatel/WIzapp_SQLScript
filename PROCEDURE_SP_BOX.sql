CREATE PROCEDURE SP_BOX
  
 @NQUERYID NUMERIC (3,0) ,  
 @CMEMOID VARCHAR(40) = '',  
 @CWHERE  VARCHAR(500) = '',
 @NNAVMODE NUMERIC(1,0) = 0,  
 @CFINYEAR VARCHAR(5)='',
 @CLOCID varchar(4)=''
--WITH ENCRYPTION
AS  
BEGIN  
  --(dinkar) Replace  left(memoid,2) to Location_code 

--DECLARE @CCMD NVARCHAR(4000)  

IF @NQUERYID = 1
	SELECT T1.*,T2.USERNAME,CAST('' AS VARCHAR(50)) AS SP_ID,T2.user_code,CAST('' AS VARCHAR(50)) AS REMARKS
	FROM BOXM T1 (nOlOck)    
	JOIN USERS T2  (nOlOck)  ON '0000000' = T2.USER_CODE    

	--LEFT JOIN AREA AR ON T1.SHIPPING_AREA_CODE=AR.AREA_CODE
 --   LEFT JOIN CITY CT ON CT.CITY_CODE=AR.CITY_CODE
 --   LEFT JOIN STATE ST ON CT.STATE_CODE=ST.STATE_CODE
    --LEFT JOIN ANGM AG ON AG.ANGADIA_CODE=T1.ANGADIA_CODE  
    --LEFT OUTER JOIN LMV01106 LMB ON  T1.BROKER_AC_CODE= LMB.AC_CODE   
	WHERE T1.BOX_ID = @CMEMOID   
ELSe
IF @NQUERYID = 2
	SELECT T1.*,T1.PRODUCT_CODE, SN.ARTICLE_NO,SN.ARTICLE_NAME, CONVERT(NUMERIC, 0) AS SRNO,     
      
 S.PURCHASE_PRICE, '' AS SCHEME_ID, SN.SECTION_NAME, SN.SUB_SECTION_NAME,        
           
 SN.STOCK_NA,    
 T1.QUANTITY AS PREVQTY,SN.MRP AS FIX_MRP, SN.PARA1_NAME,SN.PARA2_NAME,SN.PARA3_NAME,SN.PARA4_NAME,SN.PARA5_NAME,SN.PARA6_NAME     
,SN.WS_PRICE,  
 UOM.UOM_NAME,UOM.UOM_TYPE ,BIN.BIN_NAME,
 SN.ARTICLE_ALIAS, CAST('' AS VARCHAR(50)) AS SP_ID   ,
  T1.PRODUCT_CODE AS ORG_PRODUCT_CODE, 
 CAST(CASE WHEN CHARINDEX('@',T1.PRODUCT_CODE)=0 THEN '' ELSE 
(SUBSTRING(T1.PRODUCT_CODE,CHARINDEX('@',T1.PRODUCT_CODE)+1,15)) END  AS VARCHAR(100)) AS BATCH_LOT_NO,
   S.barcode_coding_scheme AS CODING_SCHEME  
   ,ISNULL(SN.ATTR1_KEY_NAME,'') as ATTR1_KEY_NAME   ,ISNULL(SN.ATTR2_KEY_NAME,'')  as ATTR2_KEY_NAME
  ,ISNULL(SN.ATTR3_KEY_NAME,'') as ATTR3_KEY_NAME  ,ISNULL(SN.ATTR4_KEY_NAME,'') as ATTR4_KEY_NAME
  ,ISNULL(SN.ATTR5_KEY_NAME,'') as ATTR5_KEY_NAME,ISNULL(SN.ATTR6_KEY_NAME,'') as ATTR6_KEY_NAME
  ,ISNULL(SN.ATTR7_KEY_NAME,'')  ATTR7_KEY_NAME ,ISNULL(SN.ATTR8_KEY_NAME,'')  ATTR8_KEY_NAME
  ,ISNULL(SN.ATTR9_KEY_NAME,'')  ATTR9_KEY_NAME ,ISNULL(SN.ATTR10_KEY_NAME,'') ATTR10_KEY_NAME
  ,ISNULL(SN.ATTR11_KEY_NAME,'') ATTR11_KEY_NAME,ISNULL(SN.ATTR12_KEY_NAME,'') ATTR12_KEY_NAME
  ,ISNULL(SN.ATTR13_KEY_NAME,'') ATTR13_KEY_NAME ,ISNULL(SN.ATTR14_KEY_NAME,'') ATTR14_KEY_NAME
  ,ISNULL(SN.ATTR15_KEY_NAME,'') ATTR15_KEY_NAME     
  ,ISNULL(SN.ATTR16_KEY_NAME,'') ATTR16_KEY_NAME,ISNULL(SN.ATTR17_KEY_NAME,'') ATTR17_KEY_NAME
  ,ISNULL(SN.ATTR18_KEY_NAME,'') ATTR18_KEY_NAME,ISNULL(SN.ATTR19_KEY_NAME,'') ATTR19_KEY_NAME
  ,ISNULL(SN.ATTR20_KEY_NAME,'')  ATTR20_KEY_NAME  ,ISNULL(SN.ATTR21_KEY_NAME,'') ATTR21_KEY_NAME
  ,ISNULL(SN.ATTR22_KEY_NAME,'') as ATTR22_KEY_NAME,ISNULL(SN.ATTR23_KEY_NAME,'') as ATTR23_KEY_NAME
  ,ISNULL(SN.ATTR24_KEY_NAME,'') ATTR24_KEY_NAME,ISNULL(SN.ATTR25_KEY_NAME,'')  ATTR25_KEY_NAME     
 FROM BOXD T1 (nolock)   
 --LEFT OUTER JOIN PMT01106 P (nolock) ON T1.PRODUCT_CODE = P.PRODUCT_CODE AND P.DEPT_ID=T1.DEPT_ID  AND P.BIN_ID=T1.BIN_ID
 --LEFT OUTER JOIN BUYER_ORDER_MST MST (nolock) ON MST.ORDER_ID=T1.ORDER_ID         
 JOIN sku S (nolock) ON S.PRODUCT_CODE = T1.PRODUCT_CODE         
 JOIN ARTICLE B (nolock) ON S.ARTICLE_CODE = B.ARTICLE_CODE          
 --JOIN SECTIOND SD (nolock) ON B.SUB_SECTION_CODE = SD.SUB_SECTION_CODE        
 --JOIN SECTIONM SM (nolock) ON SD.SECTION_CODE = SM.SECTION_CODE        
 ----JOIN FORM J (nolock) ON T1.ITEM_FORM_ID= J.FORM_ID     
 --JOIN PARA1 P1 (nolock) ON P1.PARA1_CODE=S.PARA1_CODE      
 --JOIN PARA2 P2 (nolock) ON P2.PARA2_CODE=S.PARA2_CODE      
 --JOIN PARA3 P3 (nolock) ON P3.PARA3_CODE=S.PARA3_CODE      
 --JOIN PARA4 P4 (nolock) ON P4.PARA4_CODE=S.PARA4_CODE      
 --JOIN PARA5 P5 (nolock) ON P5.PARA5_CODE=S.PARA5_CODE      
 --JOIN PARA6 P6 (nolock) ON P6.PARA6_CODE=S.PARA6_CODE  
 JOIN UOM (nolock)  ON UOM.UOM_CODE=B.UOM_CODE  
 JOIN BIN (nolock)  ON BIN.BIN_ID=ISNULL(NULL,'000')  
 --LEFT OUTER  JOIN EMPLOYEE EMP (nolock) ON T1.EMP_CODE= EMP.EMP_CODE        
 --LEFT OUTER JOIN EMPLOYEE EMP1 (nolock) ON T1.EMP_CODE1= EMP1.EMP_CODE        
 --LEFT OUTER JOIN EMPLOYEE EMP2 (nolock) ON T1.EMP_CODE2= EMP2.EMP_CODE     
 LEFT JOIN SKU_NAMES SN (NOLOCK) ON SN.product_Code=T1.product_Code
 WHERE T1.BOX_ID = @CMEMOID   --ORDER BY SRNO  
--ELSe
--IF @NQUERYID = 4
--	EXECUTE SP_BOX_4 
--	@CMEMOID=@CMEMOID,  
--	@CWHERE=@CWHERE,
--	@NNAVMODE=@NNAVMODE,  
--	@CFINYEAR=@CFINYEAR,
--	@CLOCID=@CLOCID	
--ELSe
--IF @NQUERYID = 5
--	EXECUTE SP_BOX_5 
--	@CMEMOID=@CMEMOID,  
--	@CWHERE=@CWHERE,
--	@NNAVMODE=@NNAVMODE,  
--	@CFINYEAR=@CFINYEAR,
--	@CLOCID=@CLOCID	
--else
--IF @NQUERYID = 7
--	EXECUTE SP_BOX_7 
--	@CMEMOID=@CMEMOID,  
--	@CWHERE=@CWHERE,
--	@NNAVMODE=@NNAVMODE,  
--	@CFINYEAR=@CFINYEAR,
--	@CLOCID=@CLOCID	
--else
--	exec  SP_WSLPACKSLIP_rest  
--	@NQUERYID=@NQUERYID ,  
--	@CMEMOID=@CMEMOID,  
--	@CWHERE=@CWHERE,
--	@NNAVMODE=@NNAVMODE,  
--	@CFINYEAR=@CFINYEAR,
--	@CLOCID=@CLOCID	
LAST:  

END