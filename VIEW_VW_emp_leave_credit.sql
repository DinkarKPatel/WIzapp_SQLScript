CREATE VIEW VW_EMP_LEAVE_CREDIT
--WITH ENCRYPTION
AS  
SELECT 
A.MEMO_NO AS MST_MEMO_NO,
A.MEMO_DT AS MST_XN_DT,
A.REMARKS AS MST_REMARKS,
A.MONTH AS MST_MONTH,
A.YEAR AS MST_YEAR,
B.REF_ID AS MST_EMP_ID,
B.EMP_FNAME + ' ' + B.EMP_LNAME AS MST_EMP_NAME,
F.DEPT_ID AS MST_LOCATION_ID,
F.DEPT_ALIAS AS MST_LOCATION_ALIAS,
F.DEPT_NAME AS MST_LOCATION_NAME,
C.DEPARTMENT_NAME AS MST_DEPARTMENT,
D.DESIG_NAME AS MST_DESIGNATION,
A.SL AS CAL_SHORT_LEAVE, 
A.HL AS CAL_HALF_LEAVE,
A.FL AS CAL_FULL_LEAVE,
E.LEAVE_NAME AS MST_LEAVE_NAME,
CASE WHEN A.LEAVE_MODE = 1 THEN 'CREDIT' WHEN A.LEAVE_MODE = 2 THEN 'DEBIT' END AS MST_LEAVE_MODE,
CASE WHEN A.ADJ_METHOD = 1 THEN 'SALARY CALCULATION' WHEN A.LEAVE_MODE = 2 THEN 'LEAVES' END AS MST_ADJESTMENT
FROM EMP_LEAVE_CREDIT A
JOIN EMP_MST B (NOLOCK) ON A.EMP_ID = B.EMP_ID
JOIN EMP_DEPARTMENT C (NOLOCK) ON B.DEPARTMENT_ID = C.DEPARTMENT_ID
JOIN EMP_DESIG D (NOLOCK) ON B.DESIG_ID = D.DESIG_ID
JOIN EMP_LEAVE_MASTER E (NOLOCK) ON A.LEAVE_CODE = E.LEAVE_CODE
JOIN LOCATION F (NOLOCK) ON B.DEPT_ID = F.DEPT_ID
