CREATE PROCEDURE SPACT_VCHENTRY_QUERY
(
	@cQuery				VARCHAR(100),
	@DoNotShowAlias		BIT=1,
	@cWhere				VARCHAR(100)=''
)
AS
BEGIN
DECLARE @CHEADCODE VARCHAR(4000),@CHEADCODE1 VARCHAR(4000),@CHEADCODE2 VARCHAR(4000),@CHEADCODE3 VARCHAR(4000)  ,@CHEADCODE4 VARCHAR(4000)  
IF @cQuery='TCOSTCENTER'
BEGIN
	SELECT TOP 100 A.COST_CENTER_CODE COST_CENTER_CODE, COST_CENTER_NAME ,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(COST_CENTER_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_NAME, 
	COST_CENTER_NAME AS REPL_AC_NAME ,COST_CENTER_REMARKS,'' AS AC_CODE,'Cost Center Ledger' as LedgerType
	FROM COST_CENTER_MST A (NOLOCK)
	WHERE  COST_CENTER_NAME<>'' AND 
	--AC_NAME LIKE @cWhere OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(COST_CENTER_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	UNION ALL
	SELECT TOP 100 A.AC_CODE as COST_CENTER_CODE,AC_NAME AS COST_CENTER_NAME,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_NAME, 
	AC_NAME AS REPL_AC_NAME ,'' AS COST_CENTER_REMARKS,A.AC_CODE,'Ledger' as LedgerType
	FROM LM01106 A (NOLOCK)
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON A.AC_CODE= B.AC_CODE
	WHERE ISNULL(INACTIVE,0)=0 AND AC_NAME<>'' AND 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	ORDER BY 2
END
ELSE IF @cQuery='TACCOUNTS'
BEGIN
	SELECT TOP 100 A.AC_CODE,AC_NAME,BILL_BY_BILL,HEAD_CODE,ISNULL(CREDIT_DAYS,0) AS CR_DAYS, 
	ISNULL(DISCOUNT_PERCENTAGE,0) AS DISCOUNT_PERCENTAGE,PRINT_NAME,TDS_CODE,PAN_NO, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	AC_NAME AS REPL_AC_NAME ,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LM01106 A (NOLOCK)
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON A.AC_CODE= B.AC_CODE
	WHERE ISNULL(INACTIVE,0)=0 AND AC_NAME<>'' AND 
	--AC_NAME LIKE @cWhere OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	UNION ALL
	SELECT TOP 500 A.AC_CODE,ALIAS AS [AC_NAME],BILL_BY_BILL,HEAD_CODE,ISNULL(CREDIT_DAYS,0) AS CR_DAYS, 
	ISNULL(DISCOUNT_PERCENTAGE,0) AS DISCOUNT_PERCENTAGE,PRINT_NAME,TDS_CODE,PAN_NO, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	AC_NAME AS REPL_AC_NAME ,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LM01106 A (NOLOCK)
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON A.AC_CODE= B.AC_CODE
	WHERE ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>'' AND 0=@DoNotShowAlias AND  
	--ALIAS LIKE @cWhere	OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME
END
ELSE IF @cQuery='TACCOUNTS_CONTRA'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000014') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('0000000007') 
	SET @CHEADCODE3=DBO.FN_ACT_TRAVTREE('0000000031') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B  (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0 ) AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE3)>0 AND ISNULL(INACTIVE,0)=0 
	AND REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	UNION ALL
	SELECT  TOP 100 A.AC_CODE,ALIAS AS [AC_NAME],BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME ,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0 ) AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE3)>0 AND ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>''  
	  AND 0=@DoNotShowAlias AND  REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME
END
ELSE IF @cQuery='TACCOUNTS_JOURNAL'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000014') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('1111117') 
	SET @CHEADCODE3=DBO.FN_ACT_TRAVTREE('11111131') 
	SELECT @CHEADCODE4=DBO.FN_ACT_TRAVTREE('0000000014') 
	FROM config WHERE CONFIG_OPTION='ACT_INCLUDE_CASH_IN_HAND_IN_JOURNAL' AND VALUE='1'
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LM01106  A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE ((NOT (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0)) 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE3)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE4)>0) AND ISNULL(INACTIVE,0)=0 AND ISNULL(AC_NAME,'')<>''
	 AND REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere 
	UNION ALL
	SELECT  TOP 100 A.AC_CODE,ALIAS AS [AC_NAME],BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME ,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE ((NOT (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0)) 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE3)>0
	OR CHARINDEX( HEAD_CODE, @CHEADCODE4)>0) AND ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>''  AND ISNULL(AC_NAME,'')<>'' 
	 AND 0=@DoNotShowAlias AND  REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME


END
ELSE IF @cQuery='TACCOUNTS_DUTY_N_TAX'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000019') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0  AND ISNULL(INACTIVE,0)=0 
	 AND REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	UNION ALL
	SELECT  TOP 100 A.AC_CODE,ALIAS AS [AC_NAME],BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME ,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0) 
	AND ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>''  
	 AND 0=@DoNotShowAlias AND  REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME
END
ELSE IF @cQuery='SUNDRYCREDITORS'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000021') 
	SELECT  TOP 100 AC_CODE, AC_NAME,BILL_BY_BILL,ADDRESS0,ADDRESS1,ADDRESS2,AREA_NAME,CITY,
	PINCODE, STATE ,PHONES_O,PHONES_R,PHONES_FAX,CST_NO,TIN_NO ,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LMV01106 (NOLOCK) 
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ISNULL(ALLOW_CREDITOR_DEBTOR,0) =1 
	 AND AC_NAME LIKE @cWhere
	ORDER BY AC_NAME
END
ELSE IF @cQuery='SUNDRYDEBTORS'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000018') 
	SELECT  TOP 100 AC_CODE, AC_NAME,BILL_BY_BILL,ADDRESS0,ADDRESS1,ADDRESS2,AREA_NAME,CITY,
	PINCODE, STATE ,PHONES_O,PHONES_R,PHONES_FAX,CST_NO,TIN_NO,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LMV01106 (NOLOCK) 
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ISNULL(ALLOW_CREDITOR_DEBTOR,0) =1 
	 AND AC_NAME LIKE @cWhere
	ORDER BY AC_NAME
END

ELSE IF @cQuery='TACCOUNTS_BANKS'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000007') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('0000000031') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106  A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0  
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 )  AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE2)>0 
	AND ISNULL(INACTIVE,0)=0   AND REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	UNION ALL
	SELECT  TOP 100 A.AC_CODE,ALIAS AS [AC_NAME],BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME ,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106  A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B  (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0) AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE2)>0  
	AND ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>'' 
	 AND 0=@DoNotShowAlias AND  REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere 
	ORDER BY AC_NAME
END
ELSE IF @cQuery='TACCOUNTS_MATCHING'
BEGIN
	SELECT ac_code,sum(balance) as balance 
	INTO #all_loc_ledger_balance 
	from loc_ledger_balance a (NOLOCK)
	WHERE ac_code =@cWhere
	GROUP BY ac_code

	SELECT TOP 100 A.AC_CODE,AC_NAME,BILL_BY_BILL,HEAD_CODE,ISNULL(CREDIT_DAYS,0) AS CR_DAYS, 
	ISNULL(DISCOUNT_PERCENTAGE,0) AS DISCOUNT_PERCENTAGE,PRINT_NAME,TDS_CODE,PAN_NO, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	AC_NAME AS REPL_AC_NAME ,isnull(hold_for_payment,0) AS hold_for_payment,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	,ISNULL(B.fc_code,'0000000') AS PARTY_FC_CODE,ISNULL(fc.fc_name,'INR') AS PARTY_FC_NAME,ISNULL(fc.fc_rate,1) AS PARTY_FC_RATE
	,CAST ((CASE WHEN ISNULL(B.fc_code,'0000000') ='0000000' THEN 0 ELSE 1 END) AS BIT) AS FC
	FROM LM01106 A (NOLOCK)
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON A.AC_CODE= B.AC_CODE
	LEFT OUTER JOIN fc (NOLOCK) ON fc.fc_code=B.fc_code
	Left outer join  #all_loc_ledger_balance all_bal (nolock) on a.ac_code= all_bal.ac_code
	WHERE ISNULL(INACTIVE,0)=0 AND (A.AC_CODE = @cWhere OR A.AC_NAME = @cWhere)
	
END
ELSE IF @cQuery='TACCOUNTS_CONTRA_MATCHING'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000014') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('0000000007') 
	SET @CHEADCODE3=DBO.FN_ACT_TRAVTREE('0000000031') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B  (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0 ) AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE3)>0 AND ISNULL(INACTIVE,0)=0 
	AND (AC_NAME = @cWhere OR A.AC_CODE = @cWhere)
END
ELSE IF @cQuery='TACCOUNTS_JOURNAL_MATCHING'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000014') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('1111117') 
	SET @CHEADCODE3=DBO.FN_ACT_TRAVTREE('11111131') 
	SELECT @CHEADCODE4=DBO.FN_ACT_TRAVTREE('0000000014') 
	FROM config WHERE CONFIG_OPTION='ACT_INCLUDE_CASH_IN_HAND_IN_JOURNAL' AND VALUE='1'
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LM01106  A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE ((NOT (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE2)>0)) 
	OR CHARINDEX( HEAD_CODE, @CHEADCODE3)>0  
	OR CHARINDEX( HEAD_CODE, @CHEADCODE4)>0) AND ISNULL(INACTIVE,0)=0 
	    AND (AC_NAME = @cWhere OR A.AC_CODE = @cWhere) AND A.AC_NAME<>''
END
ELSE IF @cQuery='TACCOUNTS_DUTY_N_TAX_MATCHING'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000019') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106   A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0  AND ISNULL(INACTIVE,0)=0 
	   AND (AC_NAME = @cWhere OR A.AC_CODE = @cWhere)
END
ELSE IF @cQuery='SUNDRYCREDITORS_MATCHING'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000021') 
	SELECT  TOP 100 AC_CODE, AC_NAME,BILL_BY_BILL,ADDRESS0,ADDRESS1,ADDRESS2,AREA_NAME,CITY,
	PINCODE, STATE ,PHONES_O,PHONES_R,PHONES_FAX,CST_NO,TIN_NO ,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LMV01106 (NOLOCK) 
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ISNULL(ALLOW_CREDITOR_DEBTOR,0) =1 
	   AND (AC_NAME = @cWhere OR AC_CODE = @cWhere)
END
ELSE IF @cQuery='SUNDRYDEBTORS_MATCHING'
BEGIN
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000018') 
	SELECT  TOP 100 AC_CODE, AC_NAME,BILL_BY_BILL,ADDRESS0,ADDRESS1,ADDRESS2,AREA_NAME,CITY,
	PINCODE, STATE ,PHONES_O,PHONES_R,PHONES_FAX,CST_NO,TIN_NO,ISNULL(sor_party,0) AS SOR_PARTY
	FROM LMV01106 (NOLOCK) 
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ISNULL(ALLOW_CREDITOR_DEBTOR,0) =1 
	AND (AC_NAME = @cWhere OR AC_CODE = @cWhere)
END

ELSE IF @cQuery='TACCOUNTS_BANKS_MATCHING'
BEGIN
	
	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000013') 
	SET @CHEADCODE1=DBO.FN_ACT_TRAVTREE('0000000007') 
	SET @CHEADCODE2=DBO.FN_ACT_TRAVTREE('0000000031') 
	SELECT  TOP 100 A.AC_CODE, AC_NAME,BILL_BY_BILL,HEAD_CODE, 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	,ISNULL(B.ON_HOLD,0) AS ON_HOLD,ISNULL(sor_party,0) AS SOR_PARTY
	 FROM LM01106  A (NOLOCK) 
	LEFT OUTER JOIN LMP01106 B (NOLOCK) ON  A.AC_CODE= B.AC_CODE
	WHERE (CHARINDEX(HEAD_CODE,@CHEADCODE)>0  
	OR CHARINDEX( HEAD_CODE, @CHEADCODE1)>0 )  AND NOT CHARINDEX( HEAD_CODE, @CHEADCODE2)>0 
	AND ISNULL(INACTIVE,0)=0   AND (AC_NAME = @cWhere OR A.AC_CODE = @cWhere)
	
END
ELSE IF @cQuery='TLEDGERADDRESS'
BEGIN

SELECT A.AC_NAME, B.HEAD_NAME, A.ADDRESS0, A.ADDRESS1, A.ADDRESS2, A.AREA_NAME, A.CITY, A.STATE, 
A.PINCODE, A.AC_GST_NO,LM_REMARKS,ISNULL(LM.LM_BROKER_AC_NAME,'') AS BROKER_AC_NAME
,A.CREDIT_DAYS,A.TRADE_DISCOUNT_PERCENTAGE,A.DISCOUNT_PERCENTAGE,ISNULL(sor_party,0) AS SOR_PARTY
FROM LMV01106 A (NOLOCK) 
JOIN HD01106 B (NOLOCK) ON A.HEAD_CODE=B.HEAD_CODE 
LEFT OUTER JOIN 
( 
	SELECT AC_CODE AS LM_BROKER_AC_CODE, AC_NAME AS LM_BROKER_AC_NAME FROM LM01106  (NOLOCK) 
)LM ON LM.LM_BROKER_AC_CODE=A.BROKER_AC_CODE 
WHERE A.AC_CODE=@cWhere
END
ELSE IF @cQuery='THEADS'
BEGIN
	SELECT TOP 100 HEAD_CODE AC_CODE,HEAD_NAME AC_NAME,HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME,1 source_mode
	FROM HD01106 (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND HEAD_NAME<>'' AND 
	--AC_NAME LIKE @cWhere OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	UNION ALL
	SELECT TOP 100 HEAD_CODE AS AC_CODE,ALIAS AS [AC_NAME],HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME ,1 source_mode
	FROM HD01106 A (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>'' AND 0=@DoNotShowAlias AND  
	--ALIAS LIKE @cWhere	OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	UNION ALL 
	SELECT DISTINCT TOP 100 b.BROKER_AC_CODE AS AC_CODE,a.ac_name  AS AC_NAME,A.HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	a.ac_name AS REPL_AC_NAME,2 source_mode 
	from LM_BROKER_DETAILS b(NOLOCK) 
	JOIN lm01106 a(NOLOCK) ON b.BROKER_AC_CODE=a.AC_CODE 
	WHERE a.AC_CODE<>'0000000000'
	AND ISNULL(INACTIVE,0)=0 AND   
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere

	UNION ALL 
	SELECT DISTINCT TOP 100 b.MAJOR_AC_CODE AS AC_CODE,a.ac_name  AS AC_NAME,A.HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	a.ac_name AS REPL_AC_NAME,3 source_mode 
	from LM01106 b(NOLOCK) 
	JOIN lm01106 a(NOLOCK) ON b.major_ac_code=a.AC_CODE 
	WHERE a.AC_CODE NOT IN('','0000000000') AND b.major_ac_code<>b.AC_CODE
	AND ISNULL(A.INACTIVE,0)=0 AND   
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	
	ORDER BY AC_NAME


END
ELSE IF @cQuery='THEADS_TRIAL'
BEGIN
	SELECT TOP 100 HEAD_CODE AC_CODE,HEAD_NAME AC_NAME,HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME 
	FROM HD01106 (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND HEAD_NAME<>'' AND 
	--AC_NAME LIKE @cWhere OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	UNION ALL
	SELECT TOP 100 HEAD_CODE AS AC_CODE,ALIAS AS [AC_NAME],HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME 
	FROM HD01106 A (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>'' AND 0=@DoNotShowAlias AND  
	--ALIAS LIKE @cWhere	OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME
END
ELSE IF @cQuery='THEADS_MULTI_LEDGER'
BEGIN
	SELECT HEAD_CODE AC_CODE,HEAD_NAME AC_NAME,HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME ,CAST(4 AS INT) AS [MODE],CAST(0 AS BIT) AS [CHK]
	FROM HD01106 (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND HEAD_NAME<>'' AND 
	--AC_NAME LIKE @cWhere OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(HEAD_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE    @cWhere
	UNION ALL
	SELECT HEAD_CODE AS AC_CODE,ALIAS AS [AC_NAME],HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	HEAD_NAME AS REPL_AC_NAME ,CAST(4 AS INT) AS [MODE],CAST(0 AS BIT) AS [CHK]
	FROM HD01106 A (NOLOCK)
	WHERE ISNULL(INACTIVE,0)=0 AND ISNULL(ALIAS,'')<>'' AND 0=@DoNotShowAlias AND  
	--ALIAS LIKE @cWhere	OR 
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALIAS,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	UNION ALL 
	SELECT DISTINCT b.BROKER_AC_CODE AS AC_CODE,a.ac_name  AS AC_NAME,A.HEAD_CODE,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  AS PARSE_AC_NAME, 
	a.ac_name AS REPL_AC_NAME ,CAST(0 AS INT) AS [MODE],CAST(0 AS BIT) AS [CHK]
	from LM_BROKER_DETAILS b(NOLOCK) 
	JOIN lm01106 a(NOLOCK) ON b.BROKER_AC_CODE=a.AC_CODE 
	WHERE a.AC_CODE<>'0000000000'
	AND ISNULL(INACTIVE,0)=0 AND   
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(a.AC_NAME,'&',''),'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','') LIKE @cWhere
	ORDER BY AC_NAME
END

END