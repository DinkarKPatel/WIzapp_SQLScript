CREATE VIEW VW_WSLBUYERORDER_QBF

AS 
SELECT A.ORDER_NO AS MST_ORDER_NO,
A.ORDER_ID,
A.ORDER_DT AS MST_ORDER_DT,
A.AC_CODE AS MST_AC_CODE,
A.TOTAL_AMOUNT AS MST_TOTAL_AMOUNT,
A.REMARKS AS MST_REMARKS,
A.SUBTOTAL AS MST_SUBTOTAL,
A.MEMO_TYPE AS MST_MEMO_TYPE,
A.ROUND_OFF AS MST_ROUND_OFF,
A.DISCOUNT_PERCENTAGE AS MST_DISCOUNT_PERCENTAGE,
A.DISCOUNT_AMOUNT AS MST_DISCOUNT_AMOUNT,
A.OTHER_CHARGES AS MST_OTHER_CHARGES,
A.REF_NO AS MST_REF_NO,
A.TRAIL_DT AS MST_TRAIL_DT,
A.PAYMENT_DETAILS AS MST_PAYMENT_DETAILS,
A.SHIPPING_ADDRESS AS MST_SHIPPING_ADDRESS,
A.ORDER_ID AS MST_ORDER_ID,
A.DELIVERY_DT AS MST_DELIVERY_DT,
A.ROUND_OFF AS ROUND_OFF,
A.CHECKED_BY AS MST_CHECKED_BY,
A.FIN_YEAR AS MST_FIN_YEAR,
A.MANUAL_DISCOUNT AS MST_MANUAL_DISCOUNT,
B.AC_NAME AS MST_AC_NAME,
D.USERNAME AS MST_EDT_USERNAME,
E.USERNAME AS MST_USERNAME, 
ART.ARTICLE_NO,P1.PARA1_NAME,P2.PARA2_NAME,P3.PARA3_NAME,
P4.PARA4_NAME,P5.PARA5_NAME,P6.PARA6_NAME,
ART.MRP,(DET.QUANTITY * DET.WS_PRICE) AS AMOUNT,
(ISNULL(P7.EMP_FNAME,'') +' '+ ISNULL(P7.EMP_LNAME,'')) AS MST_EMP_NAME,
ART.ARTICLE_NAME,
ART.ALIAS AS ARTICLE_ALIAS,
DET.QUANTITY,
DET.WS_PRICE,
DET.GROSS_WSP,
DET.DISCOUNT_PERCENTAGE,
DET.DISCOUNT_AMOUNT,
DET.REMARKS,
DET.RFNET,
DET.MANUAL_DISCOUNT,
DET.PRODUCT_CODE,
U.UOM_NAME,
DET.GROSS_QUANTITY,A.location_Code
FROM BUYER_ORDER_MST A
JOIN LMV01106 B (NOLOCK)  ON A.AC_CODE = B.AC_CODE       
JOIN USERS D  (NOLOCK)  ON A.USER_CODE = D.USER_CODE       
JOIN USERS E (NOLOCK)  ON A.EDT_USER_CODE = E.USER_CODE       
JOIN LOCATION C (NOLOCK)  ON A.DEPT_ID = C.DEPT_ID         
JOIN BUYER_ORDER_DET DET (NOLOCK) ON DET.ORDER_ID=A.ORDER_ID
JOIN ARTICLE ART(NOLOCK)  ON DET.ARTICLE_CODE = ART.ARTICLE_CODE      
JOIN PARA1 P1 (NOLOCK)  ON DET.PARA1_CODE = P1.PARA1_CODE      
JOIN PARA2 P2 (NOLOCK)  ON DET.PARA2_CODE = P2.PARA2_CODE       
JOIN PARA3 P3(NOLOCK)  ON ART.PARA3_CODE = P3.PARA3_CODE       
JOIN PARA4 P4 (NOLOCK)  ON ART.PARA4_CODE = P4.PARA4_CODE       
JOIN PARA5 P5 (NOLOCK)  ON ART.PARA5_CODE = P5.PARA5_CODE       
JOIN PARA6 P6 (NOLOCK) ON ART.PARA6_CODE = P6.PARA6_CODE   
JOIN UOM U (NOLOCK) ON U.UOM_CODE = ART.UOM_CODE 
LEFT OUTER JOIN EMP_MST P7 (NOLOCK) ON  P7.EMP_ID = A.EMP_CODE
