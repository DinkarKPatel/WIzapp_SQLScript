UPDATE T1 SET T1.SOURCE_MEMO_NO=T2.SOURCE_MEMO_NO
FROM XNRECONMEMO T1
JOIN XNRECONM B ON B.recon_id=T1.recon_id
JOIN 
(
	SELECT 'PUR' AS XN_TYPE, MRR_ID AS XN_ID,BILL_NO AS SOURCE_MEMO_NO FROM  PIM01106 (NOLOCK) 
	UNION ALL
	SELECT 'PRT' AS XN_TYPE, RM_ID AS XN_ID,'' AS SOURCE_MEMO_NO FROM  RMM01106 (NOLOCK) 
	UNION ALL
	SELECT 'WSI' AS XN_TYPE, INV_ID AS XN_ID,'' AS SOURCE_MEMO_NO FROM  INM01106 (NOLOCK) 
	UNION ALL
	SELECT 'WSR' AS XN_TYPE, CN_ID AS XN_ID,(CASE WHEN MODE=2 THEN RIGHT(RM_ID,10) ELSE CN_NO END) AS SOURCE_MEMO_NO FROM  CNM01106 (NOLOCK) 
	UNION ALL
	SELECT 'DCO' AS XN_TYPE, MEMO_ID AS XN_ID,MEMO_NO AS SOURCE_MEMO_NO FROM  FLOOR_ST_MST (NOLOCK) 

)T2 ON T2.XN_ID = T1.XN_ID AND B.xn_type=T2.XN_TYPE
WHERE  T1.SOURCE_MEMO_NO<>T2.SOURCE_MEMO_NO