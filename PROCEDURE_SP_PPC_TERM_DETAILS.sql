CREATE PROCEDURE DBO.SP_PPC_TERM_DETAILS
(
 @QUERYTYPE INT
,@MEMO_ID VARCHAR(22)=''
)
AS
 BEGIN
  --DECLARE LOCAL VARIABLE
  DECLARE @ERRMSG VARCHAR(MAX)
  SET @ERRMSG=''
  IF ISNULL(@QUERYTYPE,0)= 0 
     BEGIN
      SET @ERRMSG='QUERYTYPE IS NOT NULL';
      GOTO PROC_END;
     END
  IF @QUERYTYPE= 1
     BEGIN
       SELECT MEMO_ID,TERM_NAME 
       FROM DBO.PPC_TERM_CONDITION_MST WITH(NOLOCK)
       WHERE CANCELLED=0 AND XN_TYPE='PO'
     END
  IF @QUERYTYPE= 2
     BEGIN
       IF ISNULL(@MEMO_ID,'')= ''
          BEGIN
           SET @ERRMSG='QUERYTYPE IS NOT NULL';
           GOTO PROC_END;
          END
       SELECT D.MEMO_ID,D.REMARKS
       FROM DBO.PPC_TERM_CONDITION_MST M WITH(NOLOCK)
       JOIN DBO.PPC_TERM_CONDITION_DET D WITH(NOLOCK)
        ON M.MEMO_ID=D.MEMO_ID
       WHERE M.CANCELLED=0 AND M.MEMO_ID=@MEMO_ID
     END
    IF @QUERYTYPE= 3
      BEGIN
       SELECT P.TERMS_MEMO_ID AS [MEMO_ID],T.REMARKS FROM DBO.PPC_PO_TERMS T WITH(NOLOCK) 
       JOIN PPC_POM01106 P ON P.PO_ID = T.PO_ID
       WHERE T.PO_ID = @MEMO_ID
      END 
  PROC_END:
  IF ISNULL(@ERRMSG,'') <>''
	  BEGIN
	    SELECT @ERRMSG AS [ERRMSG];
	  END
 END
