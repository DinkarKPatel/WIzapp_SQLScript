CREATE FUNCTION FN_GETBILLHOLDEMPCODE
(
	@CHOLDID VARCHAR(40)
)
RETURNS VARCHAR(7)
--WITH ENCRYPTION
AS
BEGIN
	DECLARE @CEMPCODE VARCHAR(7)
	
	SELECT TOP 1 @CEMPCODE = (CASE WHEN EMP_CODE<>'0000000' THEN EMP_CODE WHEN EMP_CODE1<>'0000000'
	THEN EMP_CODE1 ELSE EMP_CODE2 END)	 FROM CMD_HOLD
	WHERE HOLD_ID = @CHOLDID AND (EMP_CODE <> '0000000' OR EMP_CODE1 <> '0000000' OR EMP_CODE2 <> '0000000')
	

	RETURN ISNULL(@CEMPCODE, '0000000')
END
