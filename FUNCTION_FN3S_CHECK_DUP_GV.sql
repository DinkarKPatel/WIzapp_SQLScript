CREATE FUNCTION DBO.FN3S_CHECK_DUP_GV
(
	 @CROWID VARCHAR(40)
	,@CGVSRNO VARCHAR(50)
	,@CGVSCRATCHNO VARCHAR(50)
)
RETURNS BIT
AS
BEGIN
	DECLARE @BDUPEXISTS BIT
	SET @BDUPEXISTS=0

	IF EXISTS(SELECT TOP 1 'U' FROM GV_GEN_DET A (NOLOCK) JOIN GV_GEN_MST B (NOLOCK) ON A.MEMO_ID=B.MEMO_ID
			  WHERE (GV_SRNO=@CGVSRNO OR (GV_SCRATCH_NO=@CGVSCRATCHNO AND @CGVSCRATCHNO<>''))
			  AND ROW_ID<>@CROWID AND B.CANCELLED=0)
		SET @BDUPEXISTS=1

	RETURN @BDUPEXISTS
END


