CREATE PROC [DBO].[SPPR_CREATEONLINEPARA3] 
(@PARA3_NAME VARCHAR(300))  
AS  
BEGIN  
  DECLARE @CNEW_PARA3_CODE VARCHAR(10)  
   
  IF EXISTS(SELECT [PARA3_NAME] FROM [PARA3] WHERE [PARA3_NAME] = @PARA3_NAME)  
  BEGIN  
   SELECT @CNEW_PARA3_CODE =  PARA3_CODE FROM [PARA3] WHERE [PARA3_NAME] = @PARA3_NAME  
   SELECT @CNEW_PARA3_CODE AS PARA3_CODE  
  END  
  ELSE  
  BEGIN  
   EXEC DBO.GETNEXTKEY 'PARA3', 'PARA3_CODE', 7, '00', 1, '', 2, @CNEW_PARA3_CODE OUTPUT   
     
   INSERT PARA3 (PARA3_CODE, PARA3_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS, LAST_MODIFIED_ON)  
   VALUES (@CNEW_PARA3_CODE, @PARA3_NAME, GETDATE(), '', 0, '', GETDATE())  
     
   SELECT @CNEW_PARA3_CODE AS PARA3_CODE  
  END  
END
