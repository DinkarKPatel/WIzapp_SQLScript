CREATE VIEW VW_FINISH_GOODS_QBF 

AS 
SELECT  
T1.MEMO_NO AS MST_MEMO_NO
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MST_MEMO_DATE 
,ISNULL(T6.MEMO_NO,'') AS MST_WORK_ORDER_MEMO_NO
,T3.DEPARTMENT_NAME AS MST_DEPARTMENT_NAME
,T1.REMARKS AS MST_REMARKS 
,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED
,T2.USERNAME AS USER_NAME 
,(CASE WHEN T6.MEMO_DT <> '' THEN CONVERT(CHAR(10),ISNULL(T6.MEMO_DT,''),105) ELSE ''  END) AS WORK_ORDER_DATE
,ISNULL(T6.REF_NO,'') AS WORK_ORDER_REFNO
,ART.ARTICLE_NO,ART.ARTICLE_NAME,ART.ARTICLE_CODE,ART.ARTICLE_DESC
,U.UOM_NAME 
,DET.QUANTITY
,DET.MRP
,DET.PURCHASE_PRICE
,DET.WS_PRICE
,PARA1.PARA1_NAME ,PARA2.PARA2_NAME
, T1.MEMO_NO,T1.COMPANY_CODE
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MEMO_DT
,T1.MEMO_ID,T1.DEPARTMENT_ID
,SEC.SECTION_NAME,SSEC.SUB_SECTION_NAME
FROM PRD_FINISH_MST T1 
JOIN PRD_FINISH_DET DET ON DET.MEMO_ID = T1.MEMO_ID
JOIN ARTICLE ART ON DET.ARTICLE_CODE = ART.ARTICLE_CODE 
JOIN UOM U ON ART.UOM_CODE = U.UOM_CODE 
JOIN PARA1 ON PARA1.PARA1_CODE = DET.PARA1_CODE
JOIN PARA2 ON PARA2.PARA2_CODE = DET.PARA2_CODE
JOIN SECTIOND SSEC ON SSEC.SUB_SECTION_CODE = ART.SUB_SECTION_CODE 
JOIN SECTIONM SEC ON SEC.SECTION_CODE  = SSEC.SECTION_CODE  
JOIN USERS T2 ON T1.USER_CODE = T2.USER_CODE
JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID = T1.DEPARTMENT_ID
JOIN PRD_WO_MST T6 ON T1.REF_PRD_WORKORDER_MEMOID= T6.MEMO_ID
