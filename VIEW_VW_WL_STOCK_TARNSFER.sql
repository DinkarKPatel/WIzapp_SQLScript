CREATE VIEW VW_WL_STOCK_TARNSFER

AS    
SELECT       
   M.MEMO_NO   ,CONVERT(VARCHAR,M.MEMO_DT   ,105) AS TRANSFER_DT ,M.MEMO_ID,M.CANCELLED       
   ,WOM.MEMO_NO AS [WORK_ORDER_NO],WOM.REF_NO  
   ,D.ROW_ID
   ,ARTCOM.ARTICLE_NO AS COMPONENT,COMP1.PARA1_NAME AS COM_PARA1_NAME,COMP2.PARA2_NAME AS COM_PARA2_NAME 
   ,SKU.ARTICLE_CODE AS ARTICLE_CODE , A2.ARTICLE_NAME,A2.ARTICLE_NO,P1.PARA1_NAME AS COLOR ,P2.PARA2_NAME AS SIZE  
  ,M.SOURCE_DEPARTMENT_ID        
  ,M.TARGET_DEPARTMENT_ID      
  ,TDEP.COMPANY_CODE       
  ,D.QUANTITY        
  ,D.PRODUCT_UID    
  ,SDEP.DEPARTMENT_NAME AS SOURCE_DEPARTMENT_NAME        
  ,TDEP.DEPARTMENT_NAME AS TARGET_DEPARTMENT_NAME      
  ,ISNULL(SKU.PURCHASE_PRICE,0) AS PURCHASE_PRICE,ISNULL(SKU.MRP,0) AS MRP,    
  ISNULL(SKU.TAX_AMOUNT,0) AS TAX_AMOUNT,ISNULL(SKU.FORM_ID,'0000000') AS FORM_ID    
  ,P1.PARA1_NAME,P2.PARA2_NAME,FRM.FORM_NAME,UOM.UOM_NAME    
FROM PRD_STK_TRANSFER_DET D    
JOIN PRD_STK_TRANSFER_MST  M ON D.MEMO_ID=M.MEMO_ID  
JOIN PRD_WO_MST WOM ON D.REF_WO_ID=WOM.MEMO_ID  
JOIN PRD_SKU S ON D.PRODUCT_UID = S.PRODUCT_UID       
JOIN ARTICLE A1 ON S.ARTICLE_CODE=A1.ARTICLE_CODE  
JOIN PRD_DEPARTMENT_MST SDEP ON M.SOURCE_DEPARTMENT_ID  = SDEP.DEPARTMENT_ID      
JOIN PRD_DEPARTMENT_MST TDEP ON M.TARGET_DEPARTMENT_ID  = TDEP.DEPARTMENT_ID      
JOIN PRD_SKU SKU ON SKU.PRODUCT_UID=D.PRODUCT_UID  
JOIN ARTICLE A2 ON SKU.ARTICLE_CODE=A2.ARTICLE_CODE    
JOIN PARA1 P1 ON P1.PARA1_CODE=SKU.PARA1_CODE    
JOIN PARA2 P2 ON P2.PARA2_CODE=SKU.PARA2_CODE  
JOIN FORM FRM ON FRM.FORM_ID=SKU.FORM_ID    
JOIN UOM ON UOM.UOM_CODE=A2.UOM_CODE 
LEFT OUTER JOIN PARA1 COMP1 ON COMP1.PARA1_CODE = D.COM_PARA1_CODE         
LEFT OUTER JOIN PARA2 COMP2 ON COMP2.PARA2_CODE = D.COM_PARA2_CODE    
LEFT OUTER JOIN ARTICLE ARTCOM  ON ARTCOM.ARTICLE_CODE = D.COMPONENT_CODE
