

IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='DELETE_DUPLICATE_SLSBCPARAART_ENTRIES' AND VALUE=1)
BEGIN
	PRINT 'DELETE DUPLICATE ENTRIES FROM SLSBC/PARA/ART ENTRIES'

	DELETE A FROM SCHEME_SETUP_SLSART A JOIN SCHEME_SETUP_DET C ON A.SCHEME_SETUP_DET_ROW_ID=C.ROW_ID
	WHERE A.ROW_ID<>(SELECT TOP 1 ROW_ID FROM SCHEME_SETUP_SLSART B WHERE B.SCHEME_SETUP_DET_ROW_ID=A.SCHEME_SETUP_DET_ROW_ID
	AND B.ARTICLE_CODE=A.ARTICLE_CODE)

	DELETE A FROM SCHEME_SETUP_SLSBC A JOIN SCHEME_SETUP_DET C ON A.SCHEME_SETUP_DET_ROW_ID=C.ROW_ID
	WHERE A.ROW_ID<>(SELECT TOP 1 ROW_ID FROM SCHEME_SETUP_SLSBC B WHERE B.SCHEME_SETUP_DET_ROW_ID=A.SCHEME_SETUP_DET_ROW_ID
	AND B.PRODUCT_CODE=A.PRODUCT_CODE)

	DELETE A FROM SCHEME_SETUP_SLSPARA A JOIN SCHEME_SETUP_DET C ON A.SCHEME_SETUP_DET_ROW_ID=C.ROW_ID
	WHERE A.ROW_ID<>(SELECT TOP 1 ROW_ID FROM SCHEME_SETUP_SLSPARA B WHERE B.SCHEME_SETUP_DET_ROW_ID=A.SCHEME_SETUP_DET_ROW_ID
	AND B.PARA3_CODE=A.PARA3_CODE)
	
	IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='DELETE_DUPLICATE_SLSBCPARAART_ENTRIES')
		INSERT CONFIG (CONFIG_OPTION,VALUE,ROW_ID,LAST_UPDATE)
			   VALUES ('DELETE_DUPLICATE_SLSBCPARAART_ENTRIES',1,'',GETDATE())	
	ELSE
		UPDATE CONFIG SET VALUE='1' WHERE CONFIG_OPTION='DELETE_DUPLICATE_SLSBCPARAART_ENTRIES'
	
END		
