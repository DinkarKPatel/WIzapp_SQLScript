create PROCEDURE SP_MERGE_MIRROR_MSTDATA
(
	@CXNTYPE VARCHAR(10),
	@NMODE INT
)
--WITH ENCRYPTION
AS
BEGIN
	IF EXISTS (SELECT TOP 1 TABLENAME FROM MIRRORXNSINFO (NOLOCK) WHERE (ISNULL(INSERTSTR,'')='' OR ISNULL(UPDATESTR,'')='')
				 AND tablename<>'year_wise_cbsstk_depcn_mst')	
	BEGIN
		SELECT @CXNTYPE AS MEMO_ID,'INSERT STRING NOT DEFINED' AS ERRMSG
		RETURN
	END
	
    DECLARE @DTSQL NVARCHAR(MAX)
	IF @CXNTYPE='MSTUSR'
		EXEC SP_MERGE_MIRROR_MSTUSR @NMODE
	ELSE
	IF @CXNTYPE='MSTEOSS'
		EXEC SP_MERGE_MIRROR_MSTEOSS_NEW @NMODE
	ELSE
	IF @CXNTYPE='MSTLST'
		EXEC SP_MERGE_MIRROR_LOCSST @NMODE
	ELSE
	IF @CXNTYPE='MSTWPAY'
		EXEC SP_MERGE_MIRROR_MSTWPAY @NMODE	
	ELSE
	IF @CXNTYPE='MSTCUSATTR'
		EXEC SP_MERGE_MIRROR_MSTCUSATTR @NMODE	
	ELSE
	  BEGIN
	     SET @DTSQL='EXEC SP_MERGE_MIRROR_'+@CXNTYPE+' '+CAST(@NMODE AS VARCHAR(10))+''  
			PRINT @DTSQL
			EXEC SP_EXECUTESQL @DTSQL
	  END		
END
