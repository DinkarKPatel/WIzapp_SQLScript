CREATE VIEW VW_LEAVEAPPLICATION 
--WITH ENCRYPTION
AS        
 SELECT DISTINCT          
  B.APPLICATION_NO AS 'MST_MEMO_NO',          
  B.APPLICATION_DT AS 'MST_XN_DT',       
  C.REF_ID   AS 'MST_EMPLOYEE_ID',                      
  C.EMP_FNAME + ' ' + C.EMP_LNAME AS 'MST_EMPLOYEE_NAME',             
  A.NO_OF_LEAVES  AS 'CAL_TOTAL_LEAVES',              
  B.NO_OF_LEAVES  AS 'CAL_APPLIED_LEAVES',      
  B.LEAVES_APPROVED AS 'CAL_APPROVED_LEAVES',           
  A.LEAVE_NAME  AS 'MST_LEAVE_NAME',          
  B.LEAVE_DR_CR  AS 'MST_DB_CR',          
  CONVERT(VARCHAR(10),B.DATE_FROM,105)  AS 'MST_DATE_FROM',          
  CONVERT(VARCHAR(10),B.DATE_TO,105)   AS 'MST_DATE_TO',          
  B.REMARKS   AS 'MST_REMARKS',          
  B.LEAVE_REMARKS AS 'MST_LEAVE_REMARKS',  
  C.ADDRESS1   AS 'MST_ADDRESS1',          
  C.ADDRESS2   AS 'MST_ADDRESS2',          
  D.AREA_NAME  AS 'MST_AREA_NAME',          
  D.CITY    AS 'MST_CITY',          
  D.STATE   AS 'MST_STATE',          
  C.EMAIL1   AS 'MST_EMAIL1',          
  C.EMAIL2   AS 'MST_EMAIL2',          
  C.MOBILE1   AS 'MST_MOBILE_NO',          
  C.PHONES_H   AS 'MST_PHONE_H',        
  C.PAN_NO   AS 'PAN_NO',          
  C.ID_PROOF_DOC_NO AS 'MST_ID_PROOF_DOCK_NO',          
  E.DESIG_NAME  AS 'MST_DESIGNATION',          
  F.DEPARTMENT_NAME AS 'MST_DEPARTMENT',        
  CASE         
  WHEN B.APPROVED=0 THEN 'UNTOUCHED'         
  WHEN B.APPROVED=1 THEN 'APPROVED'         
  ELSE 'UNAPPROVED'         
  END    AS 'MST_LEAVE_STATUS',          
  CASE         
  WHEN C.ID_PROOF_DOC_TYPE=0 THEN 'DRIVING LICENSE'         
  WHEN C.ID_PROOF_DOC_TYPE=1 THEN 'PASSPORT'          
  WHEN C.ID_PROOF_DOC_TYPE=2 THEN 'VOTER ID CARD'         
  ELSE 'OTHERS'         
  END    AS 'MST_ID_PROOF_DOCK_TYPE'          
 FROM EMP_LEAVE_MASTER A         
 JOIN EMP_LEAVE_DETAILS B (NOLOCK) ON A.LEAVE_CODE=B.LEAVE_CODE           
 JOIN EMP_MST C    (NOLOCK) ON B.EMP_ID=C.EMP_ID         
 JOIN AREA_VIEW D   (NOLOCK) ON C.AREA_CODE=D.AREA_CODE          
 JOIN EMP_DESIG E   (NOLOCK) ON C.DESIG_ID=E.DESIG_ID         
 JOIN EMP_DEPARTMENT F  (NOLOCK) ON C.DEPARTMENT_ID=F.DEPARTMENT_ID
