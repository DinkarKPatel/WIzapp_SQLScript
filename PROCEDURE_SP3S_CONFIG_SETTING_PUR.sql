CREATE PROCEDURE SP3S_CONFIG_SETTING_PUR
AS
BEGIN

	;WITH ALL_PARAM
	AS
	(
		SELECT CAST(1 AS INT) AS ROW_ID,'LEDGER' AS MASTER_NAME, 'DO_NOT_CREATE_AC_MASTERS_IN_FILE_IMPORT' config_option 
		UNION
		SELECT CAST(2 AS INT) AS ROW_ID,'SECTION' AS MASTER_NAME, 'DO_NOT_CREATE_SECTION_MASTERS_IN_FILE_IMPORT' config_option
		UNION
		SELECT CAST(3 AS INT) AS ROW_ID,'SUB SECTION' AS MASTER_NAME, 'DO_NOT_CREATE_SUB_SECTION_MASTERS_IN_FILE_IMPORT' config_option
		UNION
		SELECT CAST(4 AS INT) AS ROW_ID,'ARTICLE' AS MASTER_NAME, 'DO_NOT_CREATE_ARTICLE_MASTERS_IN_FILE_IMPORT' config_option
		UNION
		SELECT CAST(5 AS INT) AS ROW_ID,'UOM' AS MASTER_NAME, 'DO_NOT_CREATE_UOM_MASTERS_IN_FILE_IMPORT' config_option
		UNION
		SELECT CAST(6 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA1_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA1_CAPTION'
		UNION
		SELECT CAST(7 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA2_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA2_CAPTION'
		UNION
		SELECT CAST(8 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA3_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA3_CAPTION'
		UNION
		SELECT CAST(9 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA4_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA4_CAPTION'
		UNION
		SELECT CAST(10 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA5_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA5_CAPTION'
		UNION
		SELECT CAST(11 AS INT) AS ROW_ID,VALUE AS MASTER_NAME, 'DO_NOT_CREATE_PARA6_MASTERS_IN_FILE_IMPORT' config_option FROM CONFIG WHERE CONFIG_OPTION='PARA6_CAPTION'
		UNION
		SELECT CAST(11+CAST(REPLACE(REPLACE(table_name,'ATTR',''),'_MST','') AS INT) AS INT) AS ROW_ID,table_caption AS MASTER_NAME, 'DO_NOT_CREATE_'+UPPER(LTRIM(RTRIM(table_name)))+'_MASTERS_IN_FILE_IMPORT' config_option 
		FROM CONFIG_ATTR WHERE ISNULL(table_caption,'')<>''
	)
	SELECT a.*,CAST(ISNULL(b.value,0) AS BIT) AS [VALUE] 
	FROM ALL_PARAM a
	LEFT OUTER JOIN CONFIG b ON B.config_option=a.config_option
END