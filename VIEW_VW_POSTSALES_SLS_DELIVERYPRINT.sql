create VIEW  VW_POSTSALES_SLS_DELIVERYPRINT   

AS  
SELECT C.PRODUCT_CODE AS SLS_PRODUCT_CODE,  
 G.CM_ID,A.MEMO_NO,A.MEMO_DT,G.CM_NO,G.CM_DT, A.CANCELLED,A.CUSTOMER_CODE,A.DELIVERED_TO,B.*,  
 (CAST(1 AS NUMERIC(10,2))) AS sls_qty,  
 ART.ARTICLE_CODE, ART.ARTICLE_NO, ART.ARTICLE_NAME, P1.PARA1_CODE,    
 PARA1_NAME, P2.PARA2_CODE,PARA2_NAME,P3.PARA3_CODE,PARA3_NAME,UOM_NAME,       
 CODING_SCHEME,CONVERT(NUMERIC(10,2),0) AS QUANTITY_IN_STOCK,SKU.PURCHASE_PRICE,  
 SKU.MRP,SKU.WS_PRICE, C.MRP AS CMD_MRP,  SM.SECTION_NAME, SD.SUB_SECTION_NAME,    
 P4.PARA4_CODE,P5.PARA5_CODE,P6.PARA6_CODE,    
 PARA4_NAME,PARA5_NAME,PARA6_NAME,E.UOM_CODE,ISNULL(E.UOM_TYPE,0) AS [UOM_TYPE],    
 ART.DT_CREATED AS [ART_DT_CREATED],P3.DT_CREATED AS [PARA3_DT_CREATED],SKU.DT_CREATED AS [SKU_DT_CREATED],    
 ART.STOCK_NA,cast('' as varchar(100)) as JOB_NAME,M.REMARKS AS HBD_REMARKS  
 ,ART.DT_CREATED   
 ,H.CUSTOMER_FNAME  AS CUSTOMER_NAME  
 ,H.ADDRESS9  AS CUSTOMER_ADDRESS 
 ,EMP.EMP_NAME,EMP1.EMP_NAME AS [EMP_NAME2],EMP2.EMP_NAME AS [EMP_NAME3] ,h.CUST_BAL ,
  SL.DEPT_ID AS SOURCE_LOCATION_ID ,
  sl.dept_name as SOURCE_LOCATION_NAME ,
  sl.address1 SOURCE_LOCATION_ADDRESS1,sl.address1 SOURCE_LOCATION_ADDRESS2,SL.REGISTERED_ADD SOURCE_LOCATION_REGISTERED_ADDRESS ,
  SL.TIN_NO SOURCE_LOCATION_TIN,SL.loc_gst_no SOURCE_LOCATION_GST_NO,LEFT(SL.loc_gst_no,2) SOURCE_LOCATION_STATE_CODE, 
  SLA.AREA_NAME SOURCE_LOCATION_AREA,SLC.CITY SOURCE_LOCATION_CITY ,
  SLS.GST_STATE_NAME SOURCE_LOCATION_STATE_NAME,SLR.region_name SOURCE_LOCATION_COUNTRY_NAME, 
  SL.PHONE SOURCE_LOCATION_PHONE,SL.CONTACT_NO SOURCE_LOCATION_CONTACT_NO,SL.DEPT_PRINT_NAME LOCATION_PRINT_NAME  ,
   sla.pincode SOURCE_LOCATION_PIN 
 FROM SLS_DELIVERY_MST A (NOLOCK)   
 JOIN SLS_DELIVERY_DET B (NOLOCK) ON A.MEMO_ID = B.MEMO_ID   
 JOIN LOCATION SL (NOLOCK) ON SL.DEPT_ID =A.location_code/*left(a.memo_id,2)*//*Rohit 04-11-2024*/
 left JOIN AREA SLA (NOLOCK) ON SL.AREA_CODE=SLA.AREA_CODE                  
 left JOIN CITY SLC (NOLOCK) ON SLA.CITY_CODE=SLC.CITY_CODE                  
 left JOIN GST_STATE_MST SLS (NOLOCK) ON SLS.GST_STATE_CODE=SL.GST_STATE_CODE
 left JOIN STATE SLST (nolock) on SL.gst_state_code =SLST.state_code
 left JOIN REGIONM SLR (NOLOCK) ON SLST.region_code=SLR.region_code  
 JOIN HOLD_BACK_DELIVER_DET M (NOLOCK) ON B.REF_HBD_ROW_ID = M.ROW_ID   
 JOIN HOLD_BACK_DELIVER_MST N (NOLOCK) ON M.MEMO_ID = N.MEMO_ID
 --LEFT OUTER JOIN POST_SALES_JOBWORK_ISSUE_DET P (NOLOCK) ON P.REF_HBD_ROW_ID = M.ROW_ID 
 --LEFT OUTER  JOIN POST_SALES_JOBWORK_ISSUE_MST ISSMST (NOLOCK) ON ISSMST.ISSUE_ID=P.ISSUE_ID 
 --LEFT OUTER JOIN POST_SALES_JOBWORK_RECEIPT_DET Q (NOLOCK) ON P.ROW_ID = Q.REF_ROW_ID  
 --LEFT OUTER  JOIN POST_SALES_JOBWORK_RECEIPT_MST RMST ON RMST.RECEIPT_ID=Q.RECEIPT_ID
 LEFT JOIN CMD01106 C (NOLOCK) ON C.ROW_ID = M.REF_CMD_ROW_ID   
 LEFT JOIN CMM01106 G (NOLOCK) ON C.CM_ID = G.CM_ID   
 JOIN SKU (NOLOCK) ON SKU.PRODUCT_CODE= ISNULL(C.PRODUCT_CODE  ,M.PRODUCT_CODE)
 JOIN ARTICLE ART (NOLOCK) ON SKU.ARTICLE_CODE = ART.ARTICLE_CODE      
 JOIN SECTIOND SD (NOLOCK) ON ART.SUB_SECTION_CODE = SD.SUB_SECTION_CODE    
 JOIN SECTIONM SM (NOLOCK) ON SD.SECTION_CODE = SM.SECTION_CODE    
 JOIN PARA1 P1 (NOLOCK) ON SKU.PARA1_CODE = P1.PARA1_CODE      
 JOIN PARA2 P2 (NOLOCK) ON SKU.PARA2_CODE = P2.PARA2_CODE      
 JOIN PARA3 P3 (NOLOCK)ON SKU.PARA3_CODE = P3.PARA3_CODE      
 JOIN PARA4 P4 (NOLOCK)ON SKU.PARA4_CODE = P4.PARA4_CODE      
 JOIN PARA5 P5 (NOLOCK)ON SKU.PARA5_CODE = P5.PARA5_CODE      
 JOIN PARA6 P6 (NOLOCK)ON SKU.PARA6_CODE = P6.PARA6_CODE      
 JOIN UOM E (NOLOCK)ON ART.UOM_CODE = E.UOM_CODE   
 --JOIN JOBS F (NOLOCK) ON F.JOB_CODE = ISNULL(P.JOB_CODE ,M.JOB_CODE)
 LEFT OUTER JOIN CUSTDYM H ON N.CUSTOMER_CODE = H.CUSTOMER_CODE 
 JOIN EMPLOYEE EMP(NOLOCK) ON EMP.EMP_CODE=C.EMP_CODE
JOIN EMPLOYEE EMP1(NOLOCK) ON EMP1.EMP_CODE=C.EMP_CODE1
JOIN EMPLOYEE EMP2(NOLOCK) ON EMP2.EMP_CODE=C.EMP_CODE2
