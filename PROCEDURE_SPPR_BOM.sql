CREATE PROCEDURE SPPR_BOM   
(    
 @CARTICLE_CODE VARCHAR(10)    
)    
AS    
BEGIN           
                
 SELECT CAST(0 AS BIT) AS CHK, @CARTICLE_CODE AS ARTICLE_CODE,--@CARTICLE_CODE    
 A.ARTICLE_CODE AS BOM_ARTICLE_CODE,    
 AVG_QTY=CAST(0 AS NUMERIC(10,4)),    
 ROW_ID=CAST('LATER'+CAST(NEWID () AS VARCHAR(40)) AS VARCHAR(40)),    
 LAST_UPDATE=GETDATE(),    
 COMPANY_CODE=COM.COMPANY_CODE,    
 RATE=CAST(0 AS NUMERIC(10,2)),    
 BOM_PARA1_CODE=CAST('0000000' AS VARCHAR(100)),    
 USES=CAST('' AS VARCHAR(10)),    
 BOM_PARA2_CODE=CAST('0000000' AS VARCHAR(100)),    
 ADD_AVG_QTY=CAST(0 AS NUMERIC(10,4)),    
 0 AS TOTALCOST,         
 A.ARTICLE_NO AS BOM_ARTICLE_NO,         
 A.ARTICLE_NAME AS BOM_ARTICLE_NAME,         
 E.UOM_NAME AS BOM_UOM_NAME, E.UOM_TYPE,    
 0 AS QUANTITY_IN_STOCK,    
 B.SUB_SECTION_NAME,C.SECTION_NAME,    
 CAST('' AS VARCHAR(100)) AS BOM_PARA1_NAME,    
 CAST('' AS VARCHAR(100)) AS BOM_PARA2_NAME     
 FROM ARTICLE A    
 JOIN SECTIOND B ON A.SUB_SECTION_CODE=B.SUB_SECTION_CODE    
 JOIN SECTIONM C ON B.SECTION_CODE=C.SECTION_CODE    
 JOIN COMPANY COM ON COM.COMPANY_CODE='01'    
 JOIN UOM E ON A.UOM_CODE = E.UOM_CODE     
 LEFT OUTER JOIN ART_BOM BOM ON BOM.BOM_ARTICLE_CODE=A.ARTICLE_CODE AND BOM.ARTICLE_CODE=@CARTICLE_CODE    
 WHERE A.ARTICLE_TYPE=2 AND A.INACTIVE=0  AND BOM.BOM_ARTICLE_CODE IS NULL    
    
    
END
