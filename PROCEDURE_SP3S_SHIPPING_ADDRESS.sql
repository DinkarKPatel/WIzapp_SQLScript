CREATE PROCEDURE SP3S_SHIPPING_ADDRESS
	@cAcCode	VARCHAR(40) = ''
AS
BEGIN
	SELECT A.ADDRESS0 
	,A.ADDRESS1
	,A.ADDRESS2 	 
		  ,B1.pincode
		  ,B1.AREA_NAME
		  ,B1.AREA_CODE
		  ,C.CITY --AS CITY_NAME
		  ,D.STATE --AS STATE_NAME
		  ,C.CITY+','+D.STATE+','+B1.pincode AS LOCATION
		  ,A.ADDRESS0+','+A.ADDRESS1+','+A.ADDRESS2 AS [ADDRESS]	
		  ,ISNULL(A.ADDRESS0 ,'')+CHAR(13)+ISNULL(A.ADDRESS1,'')+CHAR(13)+ISNULL(A.ADDRESS2,'')+
		  ISNULL(B1.AREA_NAME,'')+' '+ISNULL(C.CITY,'')+' '+ISNULL(D.STATE ,'')+' ' +ISNULL(B1.pincode ,'') AS [ADDRESS99]
		  ,CONVERT(VARCHAR(40),NEWID()) AS ROW_ID
	FROM LM01106 B	(NOLOCK)
	LEFT JOIN LMP01106 A (NOLOCK) ON A.AC_CODE=B.AC_CODE
	LEFT JOIN AREA B1 ON B1.AREA_CODE=A.AREA_CODE
	LEFT JOIN CITY C ON B1.CITY_CODE=C.CITY_CODE
	LEFT JOIN STATE D ON C.STATE_CODE=D.STATE_CODE
	WHERE A.AC_CODE=@cAcCode
END