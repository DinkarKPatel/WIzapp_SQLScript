CREATE PROCEDURE SP3S_GET_TILL_RECIPIENT
--WITH ENCRYPTION
AS
BEGIN
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

	SELECT A.REC_ID,A.REC_FNAME+' '+A.REC_LNAME AS REC_NAME,(CASE WHEN C.DEPT_ID IS NULL THEN 0 ELSE 1 END) AS CHK
		  ,B.DEPT_ID,B.DEPT_NAME,C.TMPLT_TYPE,D.TMPLT_NAME
	FROM TILL_SMS_REC A
	CROSS JOIN LOCATION B 
	LEFT JOIN TILL_SMS_REC_LOC C ON C.DEPT_ID=B.DEPT_ID AND A.REC_ID=C.REC_ID
	LEFT JOIN TILL_SMS_TMPLT D ON C.TMPLT_TYPE=D.TMPLT_TYPE
	WHERE A.INACTIVE=0 AND B.INACTIVE=0 AND ISNULL(B.TILL_ENABLED,0)=1
	ORDER BY A.REC_ID
END
--END OF PROCEDURE - SP3S_GET_TILL_RECIPIENT
