CREATE VIEW VW_OP_MATERIAL_CON_PRINT

AS
SELECT T1.*, T2.USERNAME,ISNULL(T6.MEMO_ID,'') AS WORK_ORDER_MEMO_ID,
ISNULL(T6.MEMO_NO,'') AS WORK_ORDER_MEMO_NO,
ISNULL(T6.REF_NO,'') AS WORK_REFNO,ISNULL(JOB.JOB_NAME,'') AS JOB_NAME,
(CASE WHEN T6.MEMO_DT <> '' THEN CONVERT(CHAR(10),ISNULL(T6.MEMO_DT,''),105) ELSE ''  END) AS WORKORDERDT,
ART.ARTICLE_NO AS ARTICLE_NO_MST
,C.UOM_NAME,
D.QUANTITY,D.ROW_ID AS CON_DET_ROW_ID,
B.ARTICLE_NO AS ARTICLE_NO_DET,B.ARTICLE_NAME,PARA1.PARA1_NAME,PARA2.PARA2_NAME
,RWM_DET.MEMO_ID AS RWM_MEMO_ID
,RWM_DET.QUANTITY AS RWM_QUANTITY
,RWM_DET.AVG_QTY AS RWM_AVG_QTY
,RWM_DET.ROW_ID AS RWM_ROW_ID
,ART_RWM_DET.ARTICLE_NAME AS RWM_ARTICLE_NAME
,ART_RWM_DET.ARTICLE_NO AS RWM_ARTICLE_NO
,ART_RWM_DET.ARTICLE_DESC AS RWM_ARTICLE_DESC
,UOM_RWM_DET.UOM_NAME AS RWM_UOM_NAME
,P1_RWM_DET.PARA1_NAME AS RWM_PARA1_NAME
,P2_RWM_DET.PARA2_NAME AS RWM_PARA2_NAME
,QI_DET.XN_MEMO_ID,QI_DET.XN_TYPE,QI_DET.INS_TYPE_CODE,QI_DET.INS_PARA_CODE
,QI_DET.OK,QI_DET.NOTOK,QI_DET.OKWITHVARIATION,QI_DET.REMARKS AS QI_DET_REMARKS,QI_DET.ROW_ID 
,QIT.QI_TYPE_NAME ,QIP.QIPARA_NAME 
FROM PRD_OP_MATERIAL_CON_MST T1 
JOIN PRD_OP_MATERIAL_CON_DET D ON T1.MEMO_ID = D.MEMO_ID 
JOIN ARTICLE B ON D.ARTICLE_CODE  = B.ARTICLE_CODE 
JOIN UOM C ON B.UOM_CODE = C.UOM_CODE  
JOIN PARA1 ON PARA1.PARA1_CODE = D.PARA1_CODE
JOIN PARA2 ON PARA2.PARA2_CODE = D.PARA2_CODE
JOIN USERS T2 ON T1.USER_CODE = T2.USER_CODE 
JOIN ARTICLE ART ON T1.REF_COMPONENT_ARTICLE_CODE = ART.ARTICLE_CODE
JOIN PRD_OP_MATERIAL_CON_RWM_DET RWM_DET ON RWM_DET.MEMO_ID = T1.MEMO_ID 
JOIN ARTICLE ART_RWM_DET ON RWM_DET.ARTICLE_CODE = ART_RWM_DET.ARTICLE_CODE 
JOIN UOM UOM_RWM_DET ON ART_RWM_DET.UOM_CODE = UOM_RWM_DET.UOM_CODE 
JOIN PARA1 P1_RWM_DET ON P1_RWM_DET.PARA1_CODE = RWM_DET.PARA1_CODE
JOIN PARA2 P2_RWM_DET ON P2_RWM_DET.PARA2_CODE = RWM_DET.PARA2_CODE
LEFT OUTER JOIN PRD_WO_MST T6 ON T1.REF_PRD_WORKORDER_MEMOID= T6.MEMO_ID
LEFT OUTER JOIN JOBS JOB ON T1.JOB_CODE = JOB.JOB_CODE 
LEFT OUTER JOIN INSPECTION_XN_DET QI_DET ON QI_DET.XN_MEMO_ID = T1.MEMO_ID 
LEFT OUTER JOIN QUALITY_INS_TYPES QIT ON QI_DET.INS_TYPE_CODE = QIT.QI_TYPE_CODE 
LEFT OUTER JOIN QUALITY_INSPECTION_PARA QIP ON QI_DET.INS_PARA_CODE =QIP.QIPARA_CODE
