CREATE PROC SP3S_RAWMATERIALSHEET    
(      
 @NQUERYID  NUMERIC(3,0)       
       
)
--WITH ENCRYPTION      
AS            
BEGIN
           
IF @NQUERYID=1            
GOTO LBL1   
ELSE IF @NQUERYID=2
GOTO LBL2 
	       
  
LBL1:  
     
	SELECT A.MEMO_ID,A.MEMO_NO,CONVERT(VARCHAR,A.MEMO_DT,105) AS MEMO_DT
	FROM PRD_WO_MST A
	LEFT OUTER JOIN
	(
	SELECT B.REF_WO_ID  FROM PRD_STK_TRANSFER_MST A
	JOIN PRD_STK_TRANSFER_DET B ON A.MEMO_ID =B.MEMO_ID 
	WHERE A.CANCELLED =0
	GROUP BY B.REF_WO_ID
	) TRF ON TRF.REF_WO_ID =A.MEMO_ID 
	WHERE A.CANCELLED=0 AND TRF.REF_WO_ID IS NULL
	
   GOTO LAST 
   
   LBL2:  
   
   SELECT ARTICLE_CODE,ARTICLE_NO,ARTICLE_NAME  FROM ARTICLE WHERE ARTICLE_TYPE= 1 AND ARTICLE_NO <> ''
               
   
 LAST:              
END
