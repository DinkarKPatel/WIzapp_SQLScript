--CMM01106 (wrong xn type pod change in po 15032023)
DELETE XN_AUDIT_TRIAL_MST WHERE XN_TYPE IN('PUR','WSL','SLS','PRT','BO','VCH','POD','PO')
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='CM_DT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','CM_DT','','UPDATE','BILL DATE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='CUSTOMER_CODE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','CUSTOMER_CODE','','UPDATE','CUSTOMER CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','DISCOUNT_PERCENTAGE','','UPDATE','BILL DISCOUNT %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='DISCOUNT_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','DISCOUNT_AMOUNT','','UPDATE','BILL DISCOUNT AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='ATD_CHARGES')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','ATD_CHARGES','','UPDATE','OTHER CHARGES'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='CANCELLED')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','CANCELLED','','UPDATE','CANCELLED'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='NET_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','NET_AMOUNT','','UPDATE','BILL VALUE'   
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='REF_NO') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','REF_NO','VARCHAR','UPDATE','REF NUMBER'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMM01106' AND FIELD_NAME='REMARKS') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMM01106','','REMARKS','VARCHAR','UPDATE','REMARKS'    
--CMD01106
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND TRIG='DELETE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','','','DELETE',''
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='PRODUCT_CODE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','PRODUCT_CODE','','UPDATE','PRODUCT CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='MRP')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','MRP','','UPDATE','MRP'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','DISCOUNT_PERCENTAGE','','UPDATE','ITEM DISCOUNT %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='DISCOUNT_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','DISCOUNT_AMOUNT','','UPDATE','ITEM DISCOUNT AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='HSN_CODE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','HSN_CODE','','UPDATE','HSN CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='IGST_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','IGST_AMOUNT','','UPDATE','IGST AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='SGST_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','SGST_AMOUNT','','UPDATE','SGST AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='CMD01106' AND FIELD_NAME='CGST_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'SLS','CMD01106','','CGST_AMOUNT','','UPDATE','CGST AMT'
--PIM01106
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='AC_CODE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','AC_CODE','','UPDATE','ACCOUNT CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='BILL_NO')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','BILL_NO','','UPDATE','BILL NUMBER'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','DISCOUNT_PERCENTAGE','','UPDATE','DISCOUNT %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='DISCOUNT_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','DISCOUNT_AMOUNT','','UPDATE','DISCOUNT AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='FREIGHT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','FREIGHT','','UPDATE','FREIGHT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='OTHER_CHARGES')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','OTHER_CHARGES','','UPDATE','OTHER CHARGES'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='CANCELLED')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','CANCELLED','','UPDATE','CANCELLED'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='TERMS')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','TERMS','','UPDATE','TERMS'   
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='TOTAL_AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','TOTAL_AMOUNT','','UPDATE','TOTAL AMOUNT'      
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PIM01106' AND FIELD_NAME='BILL_LEVEL_TAX_METHOD')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PIM01106','','BILL_LEVEL_TAX_METHOD','','UPDATE','BILL LEVEL TAX METHOD'      
  
--PID01106
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='PRODUCT_CODE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','PRODUCT_CODE','','UPDATE','PRODUCT CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='QUANTITY')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','QUANTITY','','UPDATE','QTY'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='GROSS_PURCHASE_PRICE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','GROSS_PURCHASE_PRICE','','UPDATE','GROSS PP'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='MRP')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','MRP','','UPDATE','MRP'
--
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='WD_PERCENTAGE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','WD_PERCENTAGE','','UPDATE','WD %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='WSP_PERCENTAGE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','WSP_PERCENTAGE','','UPDATE','WSP %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND FIELD_NAME='WHOLESALE_PRICE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','WHOLESALE_PRICE','','UPDATE','WHOLESALE PRICE'
--   
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PUR' AND TABLE_NAME='PID01106' AND TRIG='DELETE')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PUR','PID01106','','','','DELETE',''
--RMM01106
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='AC_CODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','AC_CODE','','UPDATE','SUPPLIER'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','DISCOUNT_PERCENTAGE','','UPDATE','DISC %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='DISCOUNT_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','DISCOUNT_AMOUNT','','UPDATE','DISC AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='OTHER_CHARGES') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','OTHER_CHARGES','','UPDATE','OTHER CHARGES'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='FREIGHT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','FREIGHT','','UPDATE','FREIGHT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='TOTAL_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','TOTAL_AMOUNT','','UPDATE','TOTAL AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='CANCELLED') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','CANCELLED','','UPDATE','CANCELLED'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='OH_TAX_METHOD') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','OH_TAX_METHOD','','UPDATE','OTHER CHARGE TAX METHOD'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='TAXFORM_STORAGE_MODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','TAXFORM_STORAGE_MODE','','UPDATE','TAX CALCULATION METHOD'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMM01106' AND FIELD_NAME='TAX_PICKING_MODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMM01106','','TAX_PICKING_MODE','','UPDATE',''
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='PRODUCT_CODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','PRODUCT_CODE','','UPDATE','BARCODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='QUANTITY') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','QUANTITY','','UPDATE','QTY'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','DISCOUNT_PERCENTAGE','','UPDATE','ITEM DISC %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='DISCOUNT_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','DISCOUNT_AMOUNT','','UPDATE','ITEM DISC AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='ITEM_TAX_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','ITEM_TAX_PERCENTAGE','','UPDATE','ITEM TAX %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='ITEM_TAX_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','ITEM_TAX_AMOUNT','','UPDATE','ITEM TAX AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='DN_DISCOUNT_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','DN_DISCOUNT_AMOUNT','','UPDATE','DN DISC AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='DN_DISCOUNT_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','DN_DISCOUNT_PERCENTAGE','','UPDATE','DN DISC %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='BILL_LEVEL_TAX_METHOD') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','BILL_LEVEL_TAX_METHOD','','UPDATE','BILL LEVEL TAX METHOD'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='GROSS_PURCHASE_PRICE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','GROSS_PURCHASE_PRICE','','UPDATE','GROSS PP'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='PRT' AND TABLE_NAME='RMD01106' AND FIELD_NAME='') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'PRT','RMD01106','','','','DELETE',''
--WSL
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='AC_CODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','AC_CODE','','UPDATE','AC CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','DISCOUNT_PERCENTAGE','','UPDATE','DISC %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='DISCOUNT_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','DISCOUNT_AMOUNT','','UPDATE','DISC AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='FREIGHT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','FREIGHT','','UPDATE','FREIGHT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='TERMS_CODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','TERMS_CODE','','UPDATE','TERMS CODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='OTHER_CHARGES') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','OTHER_CHARGES','','UPDATE','OTHER CHARGES'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='NET_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','NET_AMOUNT','','UPDATE','NET AMOUNT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='CANCELLED') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','CANCELLED','','UPDATE','CANCELLED'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='BILL_LEVEL_TAX_METHOD') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','BILL_LEVEL_TAX_METHOD','','UPDATE','BILL LEVEL TAX METHOD'   
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='OCTROI_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','OCTROI_AMOUNT','','UPDATE','OCTROI AMT'   
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='INM01106' AND FIELD_NAME='INSURANCE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','INM01106','','INSURANCE','','UPDATE','INSURANCE AMT'   
--
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='PRODUCT_CODE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','PRODUCT_CODE','','UPDATE','BARCODE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='DISCOUNT_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL)SELECT 'WSL','IND01106','','DISCOUNT_PERCENTAGE','','UPDATE','ITEM DISC %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='DISCOUNT_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','DISCOUNT_AMOUNT','','UPDATE','ITEM DISC AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='ITEM_TAX_PERCENTAGE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','ITEM_TAX_PERCENTAGE','','UPDATE','ITEM TAX %'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='ITEM_TAX_AMOUNT') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','ITEM_TAX_AMOUNT','','UPDATE','ITEM TAX AMT'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='RATE') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','RATE','','UPDATE','RATE'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='QUANTITY') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','QUANTITY','','UPDATE','QTY'
IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='WSL' AND TABLE_NAME='IND01106' AND FIELD_NAME='') 
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL) SELECT 'WSL','IND01106','','','','DELETE',''


UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='NET_AMOUNT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='AC_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='INM01106' AND FIELD_NAME LIKE 'DISC%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='OTHER_CHARGES'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='OCTROI_AMOUNT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='INSURANCE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='FREIGHT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='TERMS_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='CANCELLED'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=7 WHERE TABLE_NAME='INM01106' AND FIELD_NAME='BILL_LEVEL_TAX_METHOD'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='IND01106' AND FIELD_NAME='PRODUCT_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='IND01106' AND FIELD_NAME='RATE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='IND01106' AND FIELD_NAME='QUANTITY'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='IND01106' AND FIELD_NAME LIKE 'DISC%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='IND01106' AND FIELD_NAME LIKE 'ITEM_TAX%'

UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='TOTAL_AMOUNT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='BILL_NO'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='AC_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME LIKE 'DISC%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='FREIGHT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='OTHER_CHARGES'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=7 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME LIKE 'TERMS%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=8 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='CANCELLED'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=9 WHERE TABLE_NAME='PIM01106' AND FIELD_NAME='BILL_LEVEL_TAX_METHOD'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='PRODUCT_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='QUANTITY'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='GROSS_PURCHASE_PRICE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='MRP'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='WD_PERCENTAGE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='WSP_PERCENTAGE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=7 WHERE TABLE_NAME='PID01106' AND FIELD_NAME='WHOLESALE_PRICE'


UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='TOTAL_AMOUNT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='AC_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME LIKE 'DISCOUNT%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='OTHER_CHARGES'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='FREIGHT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='CANCELLED'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=7 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='OH_TAX_METHOD'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=8 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='TAXFORM_STORAGE_MODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=9 WHERE TABLE_NAME='RMM01106' AND FIELD_NAME='TAX_PICKING_MODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME='PRODUCT_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME='QUANTITY'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME='GROSS_PURCHASE_PRICE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME LIKE 'DN_DISC%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME LIKE 'ITEM_TAX%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME LIKE 'DISCOUNT%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='RMD01106' AND FIELD_NAME LIKE 'BILL_LEVEL_TAX_METHOD'

UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='NET_AMOUNT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='CM_DT'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='CUSTOMER_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME LIKE 'DISCOUNT%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='ATD_CHARGES'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=6 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='CANCELLED'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=7 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='REF_NO'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=8 WHERE TABLE_NAME='CMM01106' AND FIELD_NAME='REMARKS'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=1 WHERE TABLE_NAME='CMD01106' AND FIELD_NAME='PRODUCT_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=2 WHERE TABLE_NAME='CMD01106' AND FIELD_NAME='HSN_CODE'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=3 WHERE TABLE_NAME='CMD01106' AND FIELD_NAME='MRP'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=4 WHERE TABLE_NAME='CMD01106' AND FIELD_NAME LIKE 'DISCOUNT%'
UPDATE XN_AUDIT_TRIAL_MST SET ORDER_ID=5 WHERE TABLE_NAME='CMD01106' AND FIELD_NAME LIKE '%GST_AM%'

UPDATE XN_AUDIT_TRIAL_MST SET TRIG=UPPER(TRIG)

UPDATE X SET X.DATA_TYPE=C.DATA_TYPE
FROM XN_AUDIT_TRIAL_MST X 
JOIN INFORMATION_SCHEMA.COLUMNS C ON C.TABLE_NAME=X.TABLE_NAME AND C.COLUMN_NAME=X.FIELD_NAME
WHERE TRIG='UPDATE'


IF OBJECT_ID('TEMPDB..#PKEY','U') IS NOT NULL
   DROP TABLE #PKEY
SELECT DISTINCT X.TABLE_NAME,COL.COLUMN_NAME,COL.ORDINAL_POSITION
INTO #PKEY
FROM XN_AUDIT_TRIAL_MST X (ROWLOCK) 
JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK
JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE COL ON PK.TABLE_NAME=COL.TABLE_NAME AND PK.CONSTRAINT_NAME=COL.CONSTRAINT_NAME AND PK.CONSTRAINT_TYPE='PRIMARY KEY'
ON X.TABLE_NAME=PK.TABLE_NAME

DECLARE @TAB VARCHAR(100),@KEY VARCHAR(1000)
IF CURSOR_STATUS('GLOBAL','PKEY') IN (0,1)
   BEGIN
     CLOSE PKEY
	 DEALLOCATE PKEY
   END
DECLARE PKEY CURSOR FOR SELECT DISTINCT TABLE_NAME FROM #PKEY
OPEN PKEY
FETCH NEXT FROM PKEY INTO @TAB
WHILE @@FETCH_STATUS=0
  BEGIN
    SET @KEY='' 
    SELECT @KEY=COALESCE('',@KEY)+COLUMN_NAME+'+' FROM #PKEY WHERE TABLE_NAME=@TAB ORDER BY ORDINAL_POSITION
    UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS=UPPER(@KEY) WHERE TABLE_NAME=@TAB
    FETCH NEXT FROM PKEY INTO @TAB
  END
CLOSE PKEY
DEALLOCATE PKEY


IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='CMM01106' AND XN_TYPE='SLS' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='CM_ID+' WHERE TABLE_NAME='CMM01106' AND XN_TYPE='SLS' AND TRIG='UPDATE'
IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='CMD01106' AND XN_TYPE='SLS' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='CM_ID+PRODUCT_CODE+' WHERE TABLE_NAME='CMD01106' AND XN_TYPE='SLS' AND TRIG='UPDATE'

   
IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='PIM01106' AND XN_TYPE='PUR' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='MRR_ID+' WHERE TABLE_NAME='PIM01106' AND XN_TYPE='PUR' AND TRIG='UPDATE'
IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='PID01106' AND XN_TYPE='PUR' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='MRR_ID+PRODUCT_CODE+' WHERE TABLE_NAME='PID01106' AND XN_TYPE='PUR' AND TRIG='UPDATE'


IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='RMM01106' AND XN_TYPE='PRT' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='RM_ID+' WHERE TABLE_NAME='RMM01106' AND XN_TYPE='PRT' AND TRIG='UPDATE'
IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='RMD01106' AND XN_TYPE='PRT' AND KEY_FIELDS IN ('','ROW_ID+') AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='RM_ID+PRODUCT_CODE+' WHERE TABLE_NAME='RMD01106' AND XN_TYPE='PRT' AND TRIG='UPDATE'


IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='INM01106' AND XN_TYPE='WSL' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='INV_ID+' WHERE TABLE_NAME='INM01106' AND XN_TYPE='WSL' AND TRIG='UPDATE'
IF EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME='IND01106' AND XN_TYPE='WSL' AND KEY_FIELDS='' AND TRIG='UPDATE')
   UPDATE XN_AUDIT_TRIAL_MST SET KEY_FIELDS='INV_ID+PRODUCT_CODE+' WHERE TABLE_NAME='IND01106' AND XN_TYPE='WSL' AND TRIG='UPDATE'



IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='PAYMODE_XN_DET' AND FIELD_NAME='PAYMODE_NAME')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL,ORDER_ID) SELECT 'SLS','PAYMODE_XN_DET','MEMO_ID+PAYMODE_NAME+','PAYMODE_NAME','','UPDATE','PAYMODE_NAME',1

IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='SLS' AND TABLE_NAME='PAYMODE_XN_DET' AND FIELD_NAME='AMOUNT')
   INSERT INTO XN_AUDIT_TRIAL_MST (XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME,DATA_TYPE,TRIG,FRIENDLY_COL,ORDER_ID) SELECT 'SLS','PAYMODE_XN_DET','MEMO_ID+PAYMODE_NAME+','AMOUNT','','UPDATE','AMOUNT',2




IF NOT EXISTS(SELECT * FROM XN_AUDIT_TRIAL_MST WHERE XN_TYPE='VCH')
   BEGIN
	  INSERT XN_AUDIT_TRIAL_MST(XN_TYPE,TABLE_NAME,KEY_FIELDS,FIELD_NAME  ,DATA_TYPE ,TRIG    ,FRIENDLY_COL,ORDER_ID)
	  SELECT 'VCH'  ,'VM01106' ,'VM_ID+'  ,'VOUCHER_DT','DATETIME','UPDATE','VOUCHER DATE',1
	  UNION
	  SELECT 'VCH'  ,'VM01106' ,'VM_ID+'  ,'VOUCHER_CODE','CHAR','UPDATE','VOUCHER TYPE',2
	  UNION
	  SELECT 'VCH'  ,'VM01106' ,'VM_ID+'  ,'BILL_TYPE'   ,'CHAR','UPDATE','BILL TYPE',3
	  UNION
	  SELECT 'VCH'  ,'VM01106' ,'VM_ID+'  ,'CANCELLED','BIT','UPDATE','CANCELLED',4
	  UNION
	  SELECT 'VCH'  ,'VD01106' ,'VM_ID+'  ,'AC_CODE'   ,'CHAR','UPDATE','LEDGER',1
	  UNION
	  SELECT 'VCH'  ,'VD01106' ,'VM_ID+'  ,'X_TYPE'   ,'CHAR','UPDATE','X_TYPE',2
	  UNION
	  SELECT 'VCH'  ,'VD01106' ,'VM_ID+'  ,'DEBIT_AMOUNT'   ,'NUMERIC','UPDATE','DEBIT AMOUNT',3
	  UNION
	  SELECT 'VCH'  ,'VD01106' ,'VM_ID+'  ,'CREDIT_AMOUNT'   ,'NUMERIC','UPDATE','CREDIT AMOUNT',4
	  UNION
	  SELECT 'VCH'  ,'VD01106' ,'VM_ID+'  ,'VD_ID'   ,'CHAR','UPDATE','VD_ID',5
   END


INSERT XN_AUDIT_TRIAL_MST (XN_TYPE, TABLE_NAME, KEY_FIELDS, FIELD_NAME, DATA_TYPE, TRIG, FRIENDLY_COL, ORDER_ID )  
SELECT 'PO'XN_TYPE, C.TABLE_NAME, 'PO_ID+'KEY_FIELDS, UPPER(C.COLUMN_NAME)FIELD_NAME, C.DATA_TYPE, 'UPDATE'TRIG, UPPER(C.COLUMN_NAME) FRIENDLY_COL, 1 ORDER_ID 
FROM INFORMATION_SCHEMA.COLUMNS C
LEFT JOIN XN_AUDIT_TRIAL_MST X ON C.TABLE_NAME=X.TABLE_NAME AND C.COLUMN_NAME=X.FIELD_NAME
WHERE C.TABLE_NAME='POM01106'
AND C.COLUMN_NAME IN ('AC_CODE','CANCELLED','cr_discount_percentage','DELIVERY_DT','delivery_mode','discount_amount','discount_percentage','donot_send_to_store','freight','other_charges','po_dt','PUR_CAL_METHOD','Terms','total_amount','TOTAL_QUANTITY','xn_item_type')
AND X.FIELD_NAME IS NULL
ORDER BY 4


INSERT XN_AUDIT_TRIAL_MST	( XN_TYPE, TABLE_NAME, KEY_FIELDS, FIELD_NAME, DATA_TYPE, TRIG, FRIENDLY_COL, ORDER_ID )  
SELECT 'PO'XN_TYPE, C.TABLE_NAME, 'PO_ID+PRODUCT_CODE+'KEY_FIELDS, UPPER(C.COLUMN_NAME)FIELD_NAME, C.DATA_TYPE, 'UPDATE'TRIG, UPPER(C.COLUMN_NAME) FRIENDLY_COL, 1 ORDER_ID 
FROM INFORMATION_SCHEMA.COLUMNS C
LEFT JOIN XN_AUDIT_TRIAL_MST X ON C.TABLE_NAME=X.TABLE_NAME AND C.COLUMN_NAME=X.FIELD_NAME
WHERE C.TABLE_NAME='POD01106'
AND C.COLUMN_NAME IN ('amount','article_code','discount_amount','discount_percentage','gross_purchase_price','gst_percentage','invoice_quantity','mp_percentage','mrp','para1_code','para2_code','para3_code','para4_code','para5_code','para6_code','product_code','purchase_price','quantity','WD_PERCENTAGE','wholesale_price','wsp_percentage')
AND X.FIELD_NAME IS NULL
ORDER BY 4


INSERT XN_AUDIT_TRIAL_MST (XN_TYPE, TABLE_NAME, KEY_FIELDS, FIELD_NAME, DATA_TYPE, TRIG, FRIENDLY_COL, ORDER_ID )  
SELECT 'BO'XN_TYPE, C.TABLE_NAME, 'ORDER_ID+'KEY_FIELDS, UPPER(C.COLUMN_NAME)FIELD_NAME, C.DATA_TYPE, 'UPDATE'TRIG, UPPER(C.COLUMN_NAME) FRIENDLY_COL, 1 ORDER_ID 
FROM INFORMATION_SCHEMA.COLUMNS C
LEFT JOIN XN_AUDIT_TRIAL_MST X ON C.TABLE_NAME=X.TABLE_NAME AND C.COLUMN_NAME=X.FIELD_NAME
WHERE C.TABLE_NAME='BUYER_ORDER_MST'
AND C.COLUMN_NAME IN ('ac_code','Angadia_code','BROKER_AC_CODE','CANCELLED','converted_by_user_code','customer_code','DELIVERY_DT','DEPT_ID','discount_amount','discount_percentage','inv_mode','memo_type','MODE','order_dt','ORDER_STATUS','ORDER_TIME','order_type','other_charges','pay_type','Ref_no','total_amount')
AND X.FIELD_NAME IS NULL
ORDER BY 4

INSERT XN_AUDIT_TRIAL_MST (XN_TYPE, TABLE_NAME, KEY_FIELDS, FIELD_NAME, DATA_TYPE, TRIG, FRIENDLY_COL, ORDER_ID )  
SELECT 'BO'XN_TYPE, C.TABLE_NAME, 'ORDER_ID+PRODUCT_CODE+'KEY_FIELDS, UPPER(C.COLUMN_NAME)FIELD_NAME, C.DATA_TYPE, 'UPDATE'TRIG, UPPER(C.COLUMN_NAME) FRIENDLY_COL, 1 ORDER_ID 
FROM INFORMATION_SCHEMA.COLUMNS C
LEFT JOIN XN_AUDIT_TRIAL_MST X ON C.TABLE_NAME=X.TABLE_NAME AND C.COLUMN_NAME=X.FIELD_NAME
WHERE C.TABLE_NAME='BUYER_ORDER_DET'
AND C.COLUMN_NAME IN ('article_code','discount_amount','discount_percentage','gross_wsp','GST_PERCENTAGE','HSN_CODE','para1_code','para2_code','para3_code','product_code','quantity','ws_price')
AND X.FIELD_NAME IS NULL
ORDER BY 4



IF NOT EXISTS (SELECT TOP 1 'U' FROM XN_AUDIT_TRIAL_MST WHERE TABLE_NAME ='CMD01106' AND FIELD_NAME ='QUANTITY')
BEGIN

 INSERT XN_AUDIT_TRIAL_MST	( DATA_TYPE, FIELD_NAME, FRIENDLY_COL, KEY_FIELDS, ORDER_ID, TABLE_NAME, TRIG, XN_TYPE ) 
 SELECT 	'NUMERIC' DATA_TYPE,'QUANTITY' FIELD_NAME,'QUANTITY' FRIENDLY_COL,'CM_ID+PRODUCT_CODE+' KEY_FIELDS,6 ORDER_ID,'CMD01106' TABLE_NAME,
 'UPDATE' TRIG,'SLS' XN_TYPE

END


