 --- Do not overwrite in May2022 release
DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),OLD_COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('SLS','LEFT(SKU.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SKU.PRODUCT_CODE)-1,-1),LEN(SKU.PRODUCT_CODE )))',
                                  'LEFT(SKU.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SKU.PRODUCT_CODE)-1,-1),LEN(SKU.PRODUCT_CODE )))', 'PRODUCT_CODE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','ARTICLE.ARTICLE_NAME','ARTICLE.ARTICLE_NAME','ARTICLE_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','ARTICLE.ALIAS','ARTICLE.ALIAS','ARTICLE_ALIAS',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','UOM.UOM_NAME','UOM.UOM_NAME','UOM_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SUB_SECTION_NAME','SUB_SECTION_NAME','SUB_SECTION_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SECTION_NAME','SECTION_NAME','SECTION_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.XN_VALUE_WITHOUT_GST','CMD01106.old_XN_VALUE_WITHOUT_GST','TAXABLE_VALUE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.IGST_AMOUNT','CMD01106.old_IGST_AMOUNT','IGST_AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.CGST_AMOUNT','CMD01106.old_CGST_AMOUNT','CGST_AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.SGST_AMOUNT','CMD01106.old_SGST_AMOUNT','SGST_AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.XN_VALUE_WITH_GST','CMD01106.old_XN_VALUE_WITH_GST','TOTAL_VALUE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.QUANTITY*CMD01106.MRP','CMD01106.QUANTITY*CMD01106.OLD_MRP','AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CAST(ROUND((ISNULL(CMD01106.CMM_DISCOUNT_AMOUNT,0)+ISNULL(CMD01106.DISCOUNT_AMOUNT,0))/(CMD01106.MRP*CMD01106.QUANTITY)*100,2) AS NUMERIC(10,2))',
                                  'CAST(ROUND((ISNULL(CMD01106.old_CMM_DISCOUNT_AMOUNT,0)+ISNULL(CMD01106.old_DISCOUNT_AMOUNT,0))/(CMD01106.old_MRP*CMD01106.QUANTITY)*100,2) AS NUMERIC(10,2))', 'LESS_DISCOUNT',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.CMM_DISCOUNT_AMOUNT','CMD01106.old_CMM_DISCOUNT_AMOUNT','CMM_DISCOUNT_AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.manual_discount_percentage','CMD01106.manual_discount_percentage','manual_discount_percentage',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.manual_discount_amount','CMD01106.manual_discount_amount','manual_discount_amount',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.CMD_REMARKS','CMD01106.CMD_REMARKS','CMD_REMARKS',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.card_discount_amount','CMD01106.card_discount_amount','card_discount_amount',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.card_discount_percentage','CMD01106.card_discount_percentage','card_discount_percentage',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1''  AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then CMD01106.FIX_MRP ELSE CMD01106.MRP END ',
                                  'CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1''  AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then CMD01106.FIX_MRP ELSE CMD01106.old_MRP END ', 'RATE',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1'' AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then CMD01106.FIX_MRP ELSE CMD01106.MRP END ',
                                  'CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1'' AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then CMD01106.FIX_MRP ELSE CMD01106.old_MRP END ','MRP',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1'' AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then ((ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)-ISNULL(CMD01106.net,0))*100/(ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)ELSE CMD01106.DISCOUNT_PERCENTAGE END ',
                                  'CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1'' AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then ((ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)-ISNULL(CMD01106.old_net,0))*100/(ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)ELSE CMD01106.old_DISCOUNT_PERCENTAGE END ','ITEM_DISCOUNT_PERCENTAGE',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1''  AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then ((ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)-ISNULL(CMD01106.net,0))ELSE CMD01106.DISCOUNT_AMOUNT END ',
                                  'CASE WHEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''APPLY_FIX_MRP_EOSS_AND_BILLPRINT'' ),'''')=''1''  AND ISNULL(FIX_MRP_APPLICABLE,0)=1 AND ISNULL(CMD01106.FIX_MRP,0)<>0 then ((ISNULL(CMD01106.FIX_MRP,0)*CMD01106.QUANTITY)-ISNULL(CMD01106.old_net,0))ELSE CMD01106.old_DISCOUNT_AMOUNT END ',   'ITEM_DISCOUNT_AMOUNT',0,'Retail_Sale','SLS_DETAILS')


INSERT INTO @dtLocal VALUES('SLS','RPSDET.NET','RPSDET.NET','RPS_NET',0,'Retail_Sale','RPS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.HSN_CODE','CMD01106.HSN_CODE','HSN_CODE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','LTRIM(RTRIM(ISNULL(CMD01106.REF_SLS_MEMO_NO,'''')))+'' / ''+CONVERT(VARCHAR,ISNULL(CMD01106.REF_SLS_MEMO_DT,''1900-01-01''),105)',
                                  'LTRIM(RTRIM(ISNULL(CMD01106.REF_SLS_MEMO_NO,'''')))+'' / ''+CONVERT(VARCHAR,ISNULL(CMD01106.REF_SLS_MEMO_DT,''1900-01-01''),105)', 'REF_NO',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.item_desc','CMD01106.item_desc','item_desc',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.SR_NO','CMD01106.SR_NO','SR_NO',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.FIX_MRP','CMD01106.FIX_MRP','FIX_MRP',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR1_KEY_NAME','SKU_NAMES.ATTR1_KEY_NAME','ATTRIBUTE1_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR2_KEY_NAME','SKU_NAMES.ATTR2_KEY_NAME','ATTRIBUTE2_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR3_KEY_NAME','SKU_NAMES.ATTR3_KEY_NAME','ATTRIBUTE3_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR4_KEY_NAME','SKU_NAMES.ATTR4_KEY_NAME','ATTRIBUTE4_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR5_KEY_NAME','SKU_NAMES.ATTR5_KEY_NAME','ATTRIBUTE5_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR6_KEY_NAME','SKU_NAMES.ATTR6_KEY_NAME','ATTRIBUTE6_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR7_KEY_NAME','SKU_NAMES.ATTR7_KEY_NAME','ATTRIBUTE7_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR8_KEY_NAME','SKU_NAMES.ATTR8_KEY_NAME','ATTRIBUTE8_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR9_KEY_NAME','SKU_NAMES.ATTR9_KEY_NAME','ATTRIBUTE9_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR10_KEY_NAME','SKU_NAMES.ATTR10_KEY_NAME','ATTRIBUTE10_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR11_KEY_NAME','SKU_NAMES.ATTR11_KEY_NAME','ATTRIBUTE11_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR12_KEY_NAME','SKU_NAMES.ATTR12_KEY_NAME','ATTRIBUTE12_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR13_KEY_NAME','SKU_NAMES.ATTR13_KEY_NAME','ATTRIBUTE13_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR14_KEY_NAME','SKU_NAMES.ATTR14_KEY_NAME','ATTRIBUTE14_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR15_KEY_NAME','SKU_NAMES.ATTR15_KEY_NAME','ATTRIBUTE15_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR16_KEY_NAME','SKU_NAMES.ATTR16_KEY_NAME','ATTRIBUTE16_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR17_KEY_NAME','SKU_NAMES.ATTR17_KEY_NAME','ATTRIBUTE17_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR18_KEY_NAME','SKU_NAMES.ATTR18_KEY_NAME','ATTRIBUTE18_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR19_KEY_NAME','SKU_NAMES.ATTR19_KEY_NAME','ATTRIBUTE19_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR20_KEY_NAME','SKU_NAMES.ATTR20_KEY_NAME','ATTRIBUTE20_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR21_KEY_NAME','SKU_NAMES.ATTR21_KEY_NAME','ATTRIBUTE21_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR22_KEY_NAME','SKU_NAMES.ATTR22_KEY_NAME','ATTRIBUTE22_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR23_KEY_NAME','SKU_NAMES.ATTR23_KEY_NAME','ATTRIBUTE23_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR24_KEY_NAME','SKU_NAMES.ATTR24_KEY_NAME','ATTRIBUTE24_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.ATTR25_KEY_NAME','SKU_NAMES.ATTR25_KEY_NAME','ATTRIBUTE25_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.SN_ARTICLE_PACK_SIZE','SKU_NAMES.SN_ARTICLE_PACK_SIZE','SN_ARTICLE_PACK_SIZE',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.gst_percentage','CMD01106.old_gst_percentage','GST_PERCENTAGE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.QUANTITY','CMD01106.QUANTITY','QUANTITY',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMD01106.pcs_quantity','CMD01106.pcs_quantity','pcs_quantity',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.mtr_quantity','CMD01106.mtr_quantity','mtr_quantity',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.BOX_PRODUCT_CODE','CMD01106.BOX_PRODUCT_CODE','BOX_PRODUCT_CODE',0,'Retail_Sale','SLS_DETAILS')


INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.barcode_img_id','SKU_NAMES.barcode_img_id','IMG_id',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.para2_order','SKU_NAMES.para2_order','PARA2_ORDER',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA1_NAME','SKU_NAMES.PARA1_NAME','PARA1_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA2_NAME','SKU_NAMES.PARA2_NAME','PARA2_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA3_NAME','SKU_NAMES.PARA3_NAME','PARA3_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA4_NAME','SKU_NAMES.PARA4_NAME','PARA4_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA5_NAME','SKU_NAMES.PARA5_NAME','PARA5_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','SKU_NAMES.PARA6_NAME','SKU_NAMES.PARA6_NAME','PARA6_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','ARTICLE.ARTICLE_NO','ARTICLE.ARTICLE_NO','ARTICLE_NO',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE.EMP_NAME','EMPLOYEE.EMP_NAME','SALEPERSON1',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE.EMP_ALIAS','EMPLOYEE.EMP_ALIAS','SALEPERSON1_ALIAS',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE1.EMP_NAME','EMPLOYEE1.EMP_NAME','SALEPERSON2',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE1.EMP_ALIAS','EMPLOYEE1.EMP_ALIAS','SALEPERSON2_ALIAS',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE2.EMP_NAME','EMPLOYEE2.EMP_NAME','SALEPERSON3',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','EMPLOYEE2.EMP_ALIAS','EMPLOYEE2.EMP_ALIAS','SALEPERSON3_ALIAS',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMM.REF_NO','CMM.REF_NO','CMM_REF_NO',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.CASH_TENDERED','CMM.CASH_TENDERED','CASH_TENDERED',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','ISNULL(CMM.PAYBACK,0)','ISNULL(CMM.PAYBACK,0)','PAYBACK',0,'Retail_Sale','SLS_MST')

INSERT INTO @dtLocal VALUES('SLS','CMM.CANCELLED','CMM.CANCELLED','CANCELLED',0,'Retail_Sale','SLS_MST')

INSERT INTO @DTLOCAL VALUES('SLS','CASE WHEN  isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and ((ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')))
                                               or ( isnull(cmm.DELIVERY_MODE,0)=1 and  abs(CMM.NET_AMOUNT)>=isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)  and isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)>0 and isnull(cmm.AUTO_EWAYBILL_NO,'''')='''' ) ) THEN ''*****''+RIGHT(CMM.CM_NO,5)
ELSE CASE WHEN  LEFT(RTRIM(LTRIM(CMM.CM_NO)),1)=''0'' AND ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')  ) 
THEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END  ' +'+CMM.CM_NO  END',

                                 'CASE WHEN  isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and (( ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')))
                                              or ( isnull(cmm.DELIVERY_MODE,0)=1 and  abs(CMM.NET_AMOUNT)>=isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)  and isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)>0 and isnull(cmm.AUTO_EWAYBILL_NO,'''')='''' )) THEN ''*****''+RIGHT(CMM.CM_NO,5)
ELSE CASE WHEN  LEFT(RTRIM(LTRIM(CMM.CM_NO)),1)=''0'' AND ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')  ) 
THEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END  ' +'+CMM.CM_NO  END',
'CM_NO',0,'RETAIL_SALE','SLS_MST')

INSERT INTO @dtLocal VALUES('SLS',' CASE WHEN isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and ((ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')))
                                              or ( isnull(cmm.DELIVERY_MODE,0)=1 and abs(CMM.NET_AMOUNT)>=isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)  and isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)>0 and isnull(cmm.AUTO_EWAYBILL_NO,'''')='''' ))  THEN '''' else CMM.CM_DT end ',
                                  ' CASE WHEN isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and (( ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')))
                                              or ( isnull(cmm.DELIVERY_MODE,0)=1 and  abs(CMM.NET_AMOUNT)>=isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)  and isnull((CASE WHEN SLS.gst_state_code=cmm.party_state_code THEN sls.EWAY_BILL_AMOUNT_LOCAL ELSE sls.EWAY_BILL_AMOUNT_INTERSTATE END),0)>0 and isnull(cmm.AUTO_EWAYBILL_NO,'''')='''' ))   THEN '''' else CMM.CM_DT end ', 
                                    'CM_DT',0,'Retail_Sale','SLS_MST')
                                  
INSERT INTO @dtLocal VALUES('SLS','CMM.CM_Time','CMM.CM_Time','CM_TIME',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','USERS.USERNAME','USERS.USERNAME','USERNAME',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','RPSDET.QUANTITY','RPSDET.QUANTITY','RPS_QTY',0,'Retail_Sale','RPS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','RPSMST.CM_NO','RPSMST.CM_NO','RPS_MEMO_NO',0,'Retail_Sale','RPS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','DTM.DT_NAME','DTM.DT_NAME','Discount_Type',0,'Retail_Sale','SLS_MST')


INSERT INTO @dtLocal VALUES('SLS','CMM.SUPPLY_TYPE_CODE','CMM.SUPPLY_TYPE_CODE','SUPPLY_TYPE_CODE',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.COPIES_PTD','CMM.COPIES_PTD','COPIES_PTD',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.Computer_Name','CMM.Computer_Name','Computer_Name',0,'Retail_Sale','SLS_MST')

INSERT INTO @dtLocal VALUES('SLS','CMM.AUTO_EWAYBILL_NO','CMM.AUTO_EWAYBILL_NO','AUTO_EWAYBILL_NO',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.AUTO_EWAYBILL_DT','CMM.AUTO_EWAYBILL_DT','AUTO_EWAYBILL_DT',0,'Retail_Sale','SLS_MST')


INSERT INTO @dtLocal VALUES('SLS','CMM.ROUND_OFF','CMM.ROUND_OFF','ROUND_OFF',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.REMARKS','CMM.REMARKS','BILL_LEVEL_REMARKS',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.ATD_Charges','CMM.ATD_Charges','OTHER_CHARGES',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','  CASE 
                    WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''') ) THEN ''SAMPLE INVOICE''
                    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''N'' THEN ''CREDIT NOTE'' 
                    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''E'' THEN ''ESTIMATE''  
					WHEN  SUBSTRING(CMM.CM_NO,5,1) =''R'' THEN ''CASH REFUND'' 
				    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''F'' THEN ''CREDIT REFUND'' 
             ELSE CASE ISNULL(SL.REGISTERED_GST,0) WHEN 1 THEN (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=1) 
			                                      WHEN 0 THEN (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=2) 
			      ELSE (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=0) END          
        END ',
	  '  CASE 
                    WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(CONS.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' AND ISNULL(CMM.Party_gst_no,'''')<>'''' AND ISNULL(CMM.Party_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CMM.EINV_IRN_NO,'''')='''' AND  CMM.CM_DT>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''') ) THEN ''SAMPLE INVOICE''
                    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''N'' THEN ''CREDIT NOTE'' 
                    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''E'' THEN ''ESTIMATE''  
					WHEN  SUBSTRING(CMM.CM_NO,5,1) =''R'' THEN ''CASH REFUND'' 
				    WHEN  SUBSTRING(CMM.CM_NO,5,1) =''F'' THEN ''CREDIT REFUND'' 
             ELSE CASE ISNULL(SL.REGISTERED_GST,0) WHEN 1 THEN (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=1) 
			                                      WHEN 0 THEN (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=2) 
			      ELSE (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''sls'' AND [MODE]=0) END          
        END ',
		'INVOICE_TYPE',0,'Retail_Sale','SLS_MST')

INSERT INTO @dtLocal VALUES('SLS','ISNULL(CMM.other_charges_gst_percentage,0)','ISNULL(CMM.other_charges_gst_percentage,0)','OTHER_CHARGES_GST_PERCENTAGE',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.other_charges_hsn_code','CMM.other_charges_hsn_code','OTHER_CHARGES_HSN_CODE',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','ISNULL(CMM.other_charges_igst_amount,0)','ISNULL(CMM.other_charges_igst_amount,0)','OTHER_CHARGES_IGST_AMOUNT',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','ISNULL(CMM.other_charges_cgst_amount,0)','ISNULL(CMM.other_charges_cgst_amount,0)','OTHER_CHARGES_CGST_AMOUNT',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','ISNULL(CMM.other_charges_sgst_amount,0)','ISNULL(CMM.other_charges_sgst_amount,0)','OTHER_CHARGES_SGST_AMOUNT',0,'Retail_Sale','SLS_MST')  
INSERT INTO @dtLocal VALUES('SLS','CMM.NET_AMOUNT','CMM.old_NET_AMOUNT','NET_AMOUNT',0,'Retail_Sale','SLS_MST')  
INSERT INTO @dtLocal VALUES('SLS','CMM.DISCOUNT_PERCENTAGE','CMM.old_DISCOUNT_PERCENTAGE','BILL_DISCOUNT_PERCENTAGE',0,'Retail_Sale','SLS_MST') 
INSERT INTO @dtLocal VALUES('SLS','CMM.DISCOUNT_AMOUNT','CMM.old_DISCOUNT_AMOUNT','BILL_DISCOUNT_AMOUNT',0,'Retail_Sale','SLS_MST') 

INSERT INTO @dtLocal VALUES('SLS','SL.DEPT_ID','SL.DEPT_ID','SOURCE_LOCATION__ID',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.DEPT_NAME','SL.DEPT_NAME','SOURCE_LOCATION_NAME',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.address1','SL.address1','SOURCE_LOCATION_ADDRESS1',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.address2','SL.address2','SOURCE_LOCATION_ADDRESS2',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.REGISTERED_ADD','SL.REGISTERED_ADD','SOURCE_LOCATION_REGISTERED_ADDRESS',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.TIN_NO','SL.TIN_NO','SOURCE_LOCATION_TIN',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.loc_gst_no','SL.loc_gst_no','SOURCE_LOCATION_GST_NO',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','ISNULL(LEFT(SL.loc_gst_no,2),'''')','ISNULL(LEFT(SL.loc_gst_no,2),'''')','SOURCE_LOCATION_STATE_CODE',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SLA.AREA_NAME','SLA.AREA_NAME','SOURCE_LOCATION_AREA',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SLA.PINCODE','SLA.PINCODE','SOURCE_LOCATION_PIN',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SLC.CITY','SLC.CITY','SOURCE_LOCATION_CITY',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SLS.GST_STATE_NAME','SLS.GST_STATE_NAME','SOURCE_LOCATION_STATE_NAME',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SLR.region_name','SLR.region_name','SOURCE_LOCATION_COUNTRY_NAME',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.PHONE','SL.PHONE','SOURCE_LOCATION_PHONE',0,'Retail_Sale','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('SLS','SL.CONTACT_NO','SL.CONTACT_NO','SOURCE_LOCATION_CONTACT_NO',0,'Retail_Sale','SOURCE_LOCATION')

INSERT INTO @dtLocal VALUES('SLS','CMP.COMPANY_NAME','CMP.COMPANY_NAME','COMPANY_NAME',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.ADDRESS1','CMP.ADDRESS1','COMPANY_ADDRESS1',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.ADDRESS2','CMP.ADDRESS2','COMPANY_ADDRESS2',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.CITY','CMP.CITY','COMPANY_CITY',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.[STATE]','CMP.[STATE]','COMPANY_STATE',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.COUNTRY','CMP.COUNTRY','COMPANY_COUNTRY',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.GST_NO','CMP.GST_NO','COMPANY_GST_NO',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.CIN','CMP.CIN','COMPANY_CIN',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.PAN_NO','CMP.PAN_NO','COMPANY_PAN_NO',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.PIN','CMP.PIN','COMPANY_PIN',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.EMAIL_ID','CMP.EMAIL_ID','COMPANY_EMAIL_ID',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','CMP.WEB_ADDRESS','CMP.WEB_ADDRESS','COMPANY_WEBSITE',0,'Retail_Sale','COMPANY')
INSERT INTO @dtLocal VALUES('SLS','IMG.PROD_IMAGE','IMG.PROD_IMAGE','PROD_IMAGE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','com.PRINT_GATE_PASS','com.PRINT_GATE_PASS','PRINT_GATE_PASS',1,'Retail_Sale','SLS_DETAILS')


--FOR TAX INVOICE BEFORE GST
INSERT INTO @dtLocal VALUES('SLS','CMD01106.TAX_PERCENTAGE','CMD01106.TAX_PERCENTAGE','VAT_PERCENTAGE',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.tax_amount','CMD01106.tax_amount','VAT_AMOUNT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.NET','CMD01106.old_NET','NET',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMM.TOTAL_GST_CESS_AMOUNT','CMM.TOTAL_GST_CESS_AMOUNT','TOTAL_GST_CESS_AMOUNT',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.GST_Cess_AMount','CMD01106.GST_Cess_AMount','GST_Cess_AMount',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CMD01106.GST_Cess_Percentage','CMD01106.GST_Cess_Percentage','GST_Cess_Percentage',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','BIN.BIN_ID','BIN.BIN_ID','BIN_ID',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','BIN.BIN_NAME','BIN.BIN_NAME','BIN_NAME',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','CMM.ACH_NO','CMM.ACH_NO','ACH_NO',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.ACH_DT','CMM.ACH_DT','ACH_DT',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.IRN_QR_CODE','CMM.IRN_QR_CODE','IRN_QR_CODE',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.EINV_IRN_NO','CMM.EINV_IRN_NO','EINV_IRN_NO',0,'Retail_Sale','SLS_MST')
INSERT INTO @dtLocal VALUES('SLS','CMM.PARTY_STATE_CODE','CMM.PARTY_STATE_CODE','PARTY_STATE_CODE',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUSTST.GST_STATE_NAME','CUSTST.GST_STATE_NAME','PARTY_STATE_NAME',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.CUSTOMER_Title','CUST.CUSTOMER_Title','PARTY_TITLE',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.CUSTOMER_FNAME','CUST.CUSTOMER_FNAME','PARTY_FNAME',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.CUSTOMER_LNAME','CUST.CUSTOMER_LNAME','PARTY_LNAME',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.ADDRESS0','CUST.ADDRESS0','PARTY_ADDRESS',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.ADDRESS1','CUST.ADDRESS1','PARTY_ADDRESS1',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.ADDRESS2','CUST.ADDRESS2','PARTY_ADDRESS2',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.ADDRESS9','CUST.ADDRESS9','PARTY_ADDRESS9',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.CUST_BAL','CUST.CUST_BAL','CUST_BAL',0,'Retail_Sale','CUSTOMER')

INSERT INTO @dtLocal VALUES('SLS','CUST.USER_CUSTOMER_CODE','CUST.USER_CUSTOMER_CODE','USER_CUSTOMER_CODE',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.CARD_NO','CUST.CARD_NO','CARD_NO',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.DT_CARD_EXPIRY','CUST.DT_CARD_EXPIRY','DT_CARD_EXPIRY',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUSTAR.pincode','CUSTAR.pincode','Party_PinCode',0,'Retail_Sale','CUSTOMER')

INSERT INTO @dtLocal VALUES('SLS','CMM.Party_gst_no','CMM.Party_gst_no','PARTY_GST_NO',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.MOBILE','CUST.MOBILE','MOBILE',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUST.EMAIL','CUST.EMAIL','PARTY_EMAIL',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','CUSTCT.CITY','CUSTCT.CITY','PARTY_CITY',0,'Retail_Sale','CUSTOMER')
INSERT INTO @dtLocal VALUES('SLS','isnull(CMM.OTHER_CHARGES_TAXABLE_VALUE,0)','isnull(CMM.OTHER_CHARGES_TAXABLE_VALUE,0)','OTHER_CHARGES_TAXABLE_VALUE',0,'Retail_Sale','SLS_MST')
INSERT INTO @DTLOCAL VALUES('SLS','SL.DEPT_PRINT_NAME','SL.DEPT_PRINT_NAME','LOCATION_PRINT_NAME',0,'Retail_Sale','SOURCE_LOCATION')


INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_1','GST_TNC.TNC_1','TNC_1',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_2','GST_TNC.TNC_2','TNC_2',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_3','GST_TNC.TNC_3','TNC_3',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_4','GST_TNC.TNC_4','TNC_4',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_5','GST_TNC.TNC_5','TNC_5',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_6','GST_TNC.TNC_6','TNC_6',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_7','GST_TNC.TNC_7','TNC_7',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','GST_TNC.TNC_8','GST_TNC.TNC_8','TNC_8',0,'Retail_Sale','SLS_DETAILS')

INSERT INTO @dtLocal VALUES('SLS','isnull(hlds.Hold_Status,0)','isnull(hlds.Hold_Status,0)','Hold_Status',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','hlds.JOB_NAME','hlds.JOB_NAME','JOB_NAME',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','hlds.DELIVERY_DT','hlds.DELIVERY_DT','DELIVERY_DT',0,'Retail_Sale','SLS_DETAILS')
INSERT INTO @dtLocal VALUES('SLS','CONS.CONSUMABLE_BARCODE','CONS.CONSUMABLE_BARCODE','CONSUMABLE_BARCODE',0,'Retail_Sale','SLS_DETAILS')



UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1


update  a set OLD_COLUMN_NAME =b.OLD_COLUMN_NAME 
FROM DYNAMIC_PRINT_COLS a
JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME 
WHERE a.MODULE_NAME= 'Retail_Sale' and isnull(a.OLD_COLUMN_NAME,'') <>b.OLD_COLUMN_NAME 


DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'Retail_Sale'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,OLD_COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.OLD_COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='SLS'
WHERE b.COLUMN_NAME IS NULL  

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='SLS'
)

DELETE  FROM CTE WHERE SR>1



