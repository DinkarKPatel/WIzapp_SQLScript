CREATE VIEW VW_WL_ANGMLIST  

AS       
SELECT  A.ANGADIA_CODE AS MEMO_ID,
A.ANGADIA_NAME AS TRANSPORTER_NAME, 
A.ANGADIA_ALIAS AS TRANSPORTER_ALIAS, 
A.ANGADIA_HEAD AS TRANSPORTER_HEAD,   
A.ANGADIA_ADD1+' '+A.ANGADIA_ADD2 AS ADDRESS, 
B.AREA_NAME AS AREA, 
B.PINCODE AS PIN, 
C.CITY,       
D.STATE, E.REGION_NAME, 
A.ANGADIA_PHONE AS TRANSPORTER_PHONE,      
 (CASE WHEN A.INACTIVE=0 THEN 'NO' ELSE 'YES' END) AS INACTIVE 
FROM ANGM A       
JOIN AREA B ON A.AREA_CODE = B.AREA_CODE       
JOIN CITY C ON B.CITY_CODE = C.CITY_CODE       
JOIN STATE D ON C.STATE_CODE = D.STATE_CODE      
JOIN REGIONM E ON D.REGION_CODE = E.REGION_CODE
