DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('WPS','wpm.PS_ID','PS_ID',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.PS_NO','PS_NO',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.PS_DT','PS_DT',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.ps_created_time','ps_created_time',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SUBTOTAL','SUBTOTAL',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.REMARKS','REMARKS',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.CANCELLED','CANCELLED',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.CHECKED_BY','CHECKED_BY',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.WAY_BILL','WAY_BILL',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.PS_NO','PS_NO',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.PAY_TYPE','PAY_TYPE',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.party_dept_id','party_dept_id',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')

INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_ADDRESS','SHIPPING_ADDRESS',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SUBTOTAL','SUBTOTAL',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','''''','Size_Cross_Type',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')


INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_ADDRESS3','SHIPPING_ADDRESS3',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_AREA_NAME','SHIPPING_AREA_NAME',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_PIN','SHIPPING_PIN',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_CITY_NAME','SHIPPING_CITY_NAME',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_STATE_NAME','SHIPPING_STATE_NAME',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')
INSERT INTO @dtLocal VALUES('WPS','wpm.SHIPPING_STATE_NAME','SHIPPING_STATE_NAME',0,'WSL_PACKSLIP','PACKSLIP_MASTERS')           
      
INSERT INTO @dtLocal VALUES('WPS','LEFT(WPS_DET.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',WPS_DET.PRODUCT_CODE)-1,-1),LEN(WPS_DET.PRODUCT_CODE )))','PRODUCT_CODE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.QUANTITY','QUANTITY',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.RATE','RATE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','RIGHT(WPS_DET.ORDER_ID,10)','ORDER_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','cast(WPS_DET.QUANTITY * WPS_DET.RATE as numeric(10,2))','AMOUNT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.MRP','MRP',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','ISNULL(WPS_DET.BOX_NO,0)','BOX_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.MRP','MRP',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.BOX_DT','BOX_DT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.SRNO','SRNO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')

INSERT INTO @dtLocal VALUES('WPS','WPS_DET.GST_PERCENTAGE','GST_PERCENTAGE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.XN_VALUE_WITHOUT_GST','XN_VALUE_WITHOUT_GST',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.XN_VALUE_WITH_GST','XN_VALUE_WITH_GST',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.IGST_AMOUNT','IGST_AMOUNT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.CGST_AMOUNT','CGST_AMOUNT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.SGST_AMOUNT','SGST_AMOUNT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.REMARKS','ITEM_REMARKS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','WPS_DET.HSN_CODE','HSN_CODE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')


INSERT INTO @dtLocal VALUES('WPS','XNBOX.GROSSWEIGHT','GROSSWEIGHT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')


INSERT INTO @dtLocal VALUES('WPS','LMV.AC_NAME','AC_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','LMV.ALIAS','ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','LMV.AC_NAME','AC_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','LMV.AC_NAME','AC_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','LMV.CLOSING_BALANCE','CLOSING_BALANCE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')
INSERT INTO @dtLocal VALUES('WPS','LMV.CLOSING_BALANCE_CR_DR','CLOSING_BALANCE_CR_DR',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')       
INSERT INTO @dtLocal VALUES('WPS','LMV.PRINT_NAME','PRINT_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')  		 

INSERT INTO @dtLocal VALUES('WPS','LMV.ADDRESS0','ADDRESS0',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.ADDRESS1','ADDRESS1',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.ADDRESS2','ADDRESS2',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.AREA_NAME','AREA_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.CITY','CITY',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.STATE','STATE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.CST_NO','CST_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.SST_NO','SST_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.TIN_NO','TIN_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.PHONES_R','PHONES_R',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.PHONES_O','PHONES_O',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.PHONES_FAX','PHONES_FAX',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.MOBILE','MOBILE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.E_MAIL','E_MAIL',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.AC_GST_NO','AC_GST_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.PINCODE','PINCODE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','EMPLOYEE.EMP_NAME','EMP_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','EMPLOYEE.EMP_ALIAS','EMP_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','EMPLOYEE.EMP_HEAD','EMP_HEAD',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 	  
INSERT INTO @dtLocal VALUES('WPS','LMV.ac_gst_state_code','ac_gst_state_code',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.registered_gst_dealer','registered_gst_dealer',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.pan_no','PARTY_PAN_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LMV.party_erp_code','party_erp_code',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 



INSERT INTO @dtLocal VALUES('WPS','SN.ARTICLE_NO','ARTICLE_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.ARTICLE_NAME','ARTICLE_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.SUB_SECTION_NAME','SUB_SECTION_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.SECTION_NAME','SECTION_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','SN.article_alias','article_alias',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.sub_Section_alias','sub_Section_alias',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.section_alias','section_alias',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','SN.PARA1_NAME','PARA1_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA2_NAME','PARA2_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA3_NAME','PARA3_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA4_NAME','PARA4_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA5_NAME','PARA5_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA6_NAME','PARA6_NAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.WS_price','WS_price',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA2_SET','PARA2_SET',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA2_ORDER','PARA2_ORDER',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 


INSERT INTO @dtLocal VALUES('WPS','SN.PARA1_ALIAS','PARA1_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')  
INSERT INTO @dtLocal VALUES('WPS','SN.PARA3_ALIAS','PARA3_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA4_ALIAS','PARA4_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA5_ALIAS','PARA5_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.PARA6_ALIAS','PARA6_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SN.SN_ARTICLE_PACK_SIZE','SN_ARTICLE_PACK_SIZE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','SKU.Purchase_price','Purchase_price',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','com.COMPANY_CODE','COMPANY_CODE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.ADDRESS1','COMP_ADDRESS1',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.ADDRESS2','COMP_ADDRESS2',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.CITY','COMP_CITY',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.STATE','COMP_STATE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','com.EMAIL_ID','COMP_EMAILID',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.CONTACT_NAME','COMP_CONTACTNAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.COMPANY_NAME','COMP_COMPANYNAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.PHONES_FAX','COMP_PHONES_FAX',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.LOGO_PATH','COMP_LOGOPATH',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.WEB_ADDRESS','COMP_WEBADDRESS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.CIN','COMP_CIN',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.SST_NO','COMP_SSTNO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.SST_DT','COMP_SSTDT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.PRINT_ADDRESS','COMP_PRINTADDRESS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.GST_NO','COMP_GST_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','com.pin','COMP_pin',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','LOC.Dept_Print_Name ','LOC_Print_name',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.LOC_GST_NO','COMP_LOC_GSTNO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.PAN_NO','LOC_PAN_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.STATE','LOC_STATE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.phone','LOC_phone',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.DEPT_ALIAS','LOC_ALIAS',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.ADDRESS1','LOC_ADDRESS1',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.ADDRESS2','LOC_ADDRESS2',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.CITY','LOC_CITY',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.TAN_NO','LOC_TAN_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.CST_DT','LOC_CST_DT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','LOC.PINCODE','LOC_PINCODE',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 


INSERT INTO @dtLocal VALUES('WPS','z.TOTAL_BOX','TOTAL_BOX',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','x.BUYER_ORDER_NO','BUYER_ORDER_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','x.BUYER_ORDER_DT','BUYER_ORDER_DT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','x.BUYER_ORDER_REF_NO','BUYER_ORDER_REF_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','x.JOB_CARD_NO','JOB_CARD_NO',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','x.JOB_CARD_DT','JOB_CARD_DT',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 

INSERT INTO @dtLocal VALUES('WPS','u1.USERNAME','USERNAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','U2.USERNAME','EDT_USERNAME',0,'WSL_PACKSLIP','PACKSLIP_DETAILS') 
INSERT INTO @dtLocal VALUES('WPS','SizeQtyString','SizeQtyString',0,'WSL_PACKSLIP','PACKSLIP_DETAILS')         
 

UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1

DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME AND A.DISPLAY_COLUMN_NAME =B.DISPLAY_COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'WSL_PACKSLIP'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='WPS'
WHERE b.COLUMN_NAME IS NULL

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='WPS'
)

DELETE  FROM CTE WHERE SR>1



