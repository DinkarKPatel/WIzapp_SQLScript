CREATE VIEW VW_WL_PARCEL_QBF  

AS     

SELECT T1.PARCEL_MEMO_NO AS MST_PARCEL_MEMO_NO,T1.PARCEL_MEMO_ID, 
T1.PARCEL_MEMO_DT AS MST_PARCEL_MEMO_DT,
T1.RECEIPT_DT AS MST_RECEIPT_DT,
T2.AC_CODE,T1.CANCELLED,T1.ANG_TYPE,T1.DEPT_ID,
T1.TOTAL_AMOUNT,T1.COMPANY_CODE,T1.LAST_UPDATE,T1.FIN_YEAR,
T1.EDT_USER_CODE,T1.USER_CODE,T1.PAY_TYPE,T1.CASH_RECEIPT_NO,T1.ANGADIA_CODE,
T1.BILTY_NO,T1.XN_TYPE,T1.MODE,T1.GATE_ENTRY_NO,T1.HANDLED_BY,
T1.REMARKS AS MST_REMARKS,
T1.ANG_TYPE AS MST_ANG_TYPE,
T1.TOTAL_AMOUNT AS MST_TOTAL_AMOUNT,
T1.PARCEL_MEMO_ID AS MST_PARCEL_MEMO_ID,
T1.PAY_TYPE AS MST_PAY_TYPE,
T1.CASH_RECEIPT_NO AS MST_CASH_RECEIPT_NO,
T1.BILTY_NO  AS MST_BILTY_NO,
T2.ROW_ID,T2.UOM_CODE,T2.AMOUNT,T2.BOX_NO,
T2.QUANTITY,T2.REMARKS,T2.QTY,
t2.party_inv_no as BILL_CHALLAN_NO,
T2.GOODS_DESC,
T3.AC_NAME AS MST_AC_NAME ,
AN.ANGADIA_NAME AS MST_ANGADIA_NAME,
U.USERNAME,
M.UOM_NAME,'' as REF_MEMO_NO,
t2.REF_MEMO_ID,
0 as TOTAL_BOXES
,T1.LOCATION_CODE
FROM PARCEL_MST T1    
JOIN PARCEL_DET T2 ON T1.PARCEL_MEMO_ID = T2.PARCEL_MEMO_ID  
LEFT OUTER JOIN LMV01106 T3 ON T3.AC_CODE = T2.AC_CODE    
JOIN ANGM AN ON AN.ANGADIA_CODE=T1.ANGADIA_CODE
JOIN USERS U ON U.USER_CODE=T1.USER_CODE
JOIN UOM M  ON M.UOM_CODE=T2.UOM_CODE
