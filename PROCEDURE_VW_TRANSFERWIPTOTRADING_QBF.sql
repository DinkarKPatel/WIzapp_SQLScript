create PROCEDURE VW_TRANSFERWIPTOTRADING_QBF
AS
BEGIN
    
    SELECT B.PRODUCT_CODE, B.MRP AS  FIX_MRP,SKU.MRP, B.PURCHASE_PRICE, SKU.WS_PRICE AS WS_PRICE,
      ((SKU.PURCHASE_PRICE+ ISNULL(SKU_OH.TAX_AMOUNT,0)+ ISNULL(SKU_OH.OTHER_CHARGES,0) +   
      ISNULL(SKU_OH.ROUND_OFF,0) +  ISNULL(SKU_OH.FREIGHT,0))-  ISNULL(SKU_OH.DISCOUNT_AMOUNT,0)+ ISNULL(SKU_OH.EXCISE_DUTY_AMOUNT,0)) AS LANDED_COST,   
       0 AS WHOLESALE_PRICE, C.ARTICLE_NO, C.ARTICLE_NAME, SKU.BARCODE_CODING_SCHEME AS CODING_SCHEME,  
      C.DISCON, SM.SECTION_NAME, SD.SUB_SECTION_NAME, P1.PARA1_CODE, P1.PARA1_NAME,  
      P2.PARA2_CODE, P2.PARA2_NAME, P3.PARA3_CODE, P3.PARA3_NAME,   
      P4.PARA4_CODE, P4.PARA4_NAME,  P5.PARA5_CODE, P5.PARA5_NAME,  
      P6.PARA6_CODE, P6.PARA6_NAME,  C.ARTICLE_DESC,LM.AC_NAME, ''  AS INV_NO,    
      CONVERT(VARCHAR,SKU.INV_DT,101) AS INV_DT, SKU.INV_NO AS CHALLAN_NO, LM.ALIAS, P3.INACTIVE AS PARA3_INACTIVE,     
      (RTRIM(LTRIM(STR(MONTH(SKU.INV_DT)))) + '/' + RTRIM(LTRIM(LM.ALIAS)) + '/'+   
       RTRIM(LTRIM(STR(YEAR(SKU.INV_DT))))+ '9/' + RTRIM(LTRIM(SKU.INV_NO)) + '/'+  
       RTRIM(LTRIM(STR(DAY(SKU.INV_DT))))) AS INV_DETAILS,        
      CONVERT(NUMERIC(10,0),SKU.MRP) AS WMRP,SKU.MRP,B.QTY AS QTY,'' AS RECEIPT_DT,  
      '' AS VANDOR_BILL_DT,U.UOM_NAME,SKU.AC_CODE,SKU.PRODUCT_NAME,  
      DBO.FN_GETENCRYPTVAL(B.PURCHASE_PRICE) AS PUR_PRICE_ENCRYPT,
      DBO.FN_GETENCRYPTVAL(SKU.MRP) AS MRP_ENCRYPT,
      0 AS SRNO ,0 AS USER_SRNO,
      DBO.FN_GETENCRYPTVAL((SKU.PURCHASE_PRICE+ ISNULL(SKU_OH.TAX_AMOUNT,0)+ ISNULL(SKU_OH.OTHER_CHARGES,0) +   
      ISNULL(SKU_OH.ROUND_OFF,0) +  ISNULL(SKU_OH.FREIGHT,0))-  ISNULL(SKU_OH.DISCOUNT_AMOUNT,0)+ ISNULL(SKU_OH.EXCISE_DUTY_AMOUNT,0)) AS LANDED_COST_ENCRYPT,  
      CUST.USER_CUSTOMER_CODE, CUST.CUSTOMER_TITLE,CUST.CUSTOMER_FNAME,CUST.CUSTOMER_LNAME,CUST.MOBILE
      ,AT1.ATTR1_KEY_NAME,AT2.ATTR2_KEY_NAME,AT3.ATTR3_KEY_NAME,AT4.ATTR4_KEY_NAME,AT5.ATTR5_KEY_NAME,AT6.ATTR6_KEY_NAME,
		AT7.ATTR7_KEY_NAME,AT8.ATTR8_KEY_NAME,AT9.ATTR9_KEY_NAME,AT10.ATTR10_KEY_NAME,AT11.ATTR11_KEY_NAME,AT12.ATTR12_KEY_NAME,
		AT13.ATTR13_KEY_NAME,AT14.ATTR14_KEY_NAME,AT15.ATTR15_KEY_NAME,AT16.ATTR16_KEY_NAME,AT17.ATTR17_KEY_NAME,AT18.ATTR18_KEY_NAME,
		AT19.ATTR19_KEY_NAME,AT20.ATTR20_KEY_NAME,AT21.ATTR21_KEY_NAME,AT22.ATTR22_KEY_NAME,AT23.ATTR23_KEY_NAME,AT24.ATTR24_KEY_NAME,
		AT25.ATTR25_KEY_NAME 
		 
       ,WO.REF_NO AS BUYER_ORDER_REF_NO, P4.ALIAS AS P4_ALIAS,SKU.ER_FLAG,SKU.INV_DT AS INV_DT1
      ,ROUND(B.MRP+(B.MRP*11.2/100),-1) AS SUVIDHAMRP,
      '' AS OEM_ID,'' AS OEM_NAME,'' AS OEM_ADD1,'' AS OEM_ADD2,'' AS OEM_ADD3,'' AS OEM_PHONE,
      '' AS OEM_EMAIL,'' AS OEM_WEB,
      LMP.ADDRESS0,
      LMP.ADDRESS1,SKU.VENDOR_EAN_NO,SKU.ONLINE_PRODUCT_CODE
      FROM PRD_TRANSFER_MAIN_MST A (NOLOCK)    
      JOIN PRD_TRANSFER_MAIN_DET B (NOLOCK) ON A.MEMO_ID=B.MEMO_ID  
      JOIN ARTICLE C (NOLOCK) ON B.ARTICLE_CODE=C.ARTICLE_CODE    
     LEFT OUTER JOIN ARTICLE_FIX_ATTR ATTR  (NOLOCK) ON c.ARTICLE_CODE = ATTR.ARTICLE_CODE 
LEFT OUTER JOIN ATTR1_MST AT1 (NOLOCK) ON AT1.ATTR1_KEY_CODE=ATTR.ATTR1_KEY_CODE
LEFT OUTER JOIN ATTR2_MST AT2 (NOLOCK) ON AT2.ATTR2_KEY_CODE=ATTR.ATTR2_KEY_CODE
LEFT OUTER JOIN ATTR3_MST AT3 (NOLOCK) ON AT3.ATTR3_KEY_CODE=ATTR.ATTR3_KEY_CODE
LEFT OUTER JOIN ATTR4_MST AT4 (NOLOCK) ON AT4.ATTR4_KEY_CODE=ATTR.ATTR4_KEY_CODE
LEFT OUTER JOIN ATTR5_MST AT5 (NOLOCK) ON AT5.ATTR5_KEY_CODE=ATTR.ATTR5_KEY_CODE
LEFT OUTER JOIN ATTR6_MST AT6 (NOLOCK) ON AT6.ATTR6_KEY_CODE=ATTR.ATTR6_KEY_CODE
LEFT OUTER JOIN ATTR7_MST AT7 (NOLOCK) ON AT7.ATTR7_KEY_CODE=ATTR.ATTR7_KEY_CODE
LEFT OUTER JOIN ATTR8_MST AT8 (NOLOCK) ON AT8.ATTR8_KEY_CODE=ATTR.ATTR8_KEY_CODE
LEFT OUTER JOIN ATTR9_MST AT9 (NOLOCK) ON AT9.ATTR9_KEY_CODE=ATTR.ATTR9_KEY_CODE
LEFT OUTER JOIN ATTR10_MST AT10 (NOLOCK) ON AT10.ATTR10_KEY_CODE=ATTR.ATTR10_KEY_CODE
LEFT OUTER JOIN ATTR11_MST AT11 (NOLOCK) ON AT11.ATTR11_KEY_CODE=ATTR.ATTR11_KEY_CODE
LEFT OUTER JOIN ATTR12_MST AT12 (NOLOCK) ON AT12.ATTR12_KEY_CODE=ATTR.ATTR12_KEY_CODE
LEFT OUTER JOIN ATTR13_MST AT13 (NOLOCK) ON AT13.ATTR13_KEY_CODE=ATTR.ATTR13_KEY_CODE
LEFT OUTER JOIN ATTR14_MST AT14 (NOLOCK) ON AT14.ATTR14_KEY_CODE=ATTR.ATTR14_KEY_CODE
LEFT OUTER JOIN ATTR15_MST AT15 (NOLOCK) ON AT15.ATTR15_KEY_CODE=ATTR.ATTR15_KEY_CODE
LEFT OUTER JOIN ATTR16_MST AT16 (NOLOCK) ON AT16.ATTR16_KEY_CODE=ATTR.ATTR16_KEY_CODE
LEFT OUTER JOIN ATTR17_MST AT17 (NOLOCK) ON AT17.ATTR17_KEY_CODE=ATTR.ATTR17_KEY_CODE
LEFT OUTER JOIN ATTR18_MST AT18 (NOLOCK) ON AT18.ATTR18_KEY_CODE=ATTR.ATTR18_KEY_CODE
LEFT OUTER JOIN ATTR19_MST AT19 (NOLOCK) ON AT19.ATTR19_KEY_CODE=ATTR.ATTR19_KEY_CODE
LEFT OUTER JOIN ATTR20_MST AT20 (NOLOCK) ON AT20.ATTR20_KEY_CODE=ATTR.ATTR20_KEY_CODE
LEFT OUTER JOIN ATTR21_MST AT21 (NOLOCK) ON AT21.ATTR21_KEY_CODE=ATTR.ATTR21_KEY_CODE
LEFT OUTER JOIN ATTR22_MST AT22 (NOLOCK) ON AT22.ATTR22_KEY_CODE=ATTR.ATTR22_KEY_CODE
LEFT OUTER JOIN ATTR23_MST AT23 (NOLOCK) ON AT23.ATTR23_KEY_CODE=ATTR.ATTR23_KEY_CODE
LEFT OUTER JOIN ATTR24_MST AT24 (NOLOCK) ON AT24.ATTR24_KEY_CODE=ATTR.ATTR24_KEY_CODE
LEFT OUTER JOIN ATTR25_MST AT25(NOLOCK) ON AT25.ATTR25_KEY_CODE=ATTR.ATTR25_KEY_CODE  
      JOIN SKU (NOLOCK) ON SKU.PRODUCT_CODE=B.PRODUCT_CODE  
      JOIN PARA1 P1 (NOLOCK) ON B.PARA1_CODE= P1.PARA1_CODE    
      JOIN PARA2 P2 (NOLOCK) ON B.PARA2_CODE= P2.PARA2_CODE    
      JOIN PARA3 P3 (NOLOCK) ON B.PARA3_CODE= P3.PARA3_CODE    
      JOIN PARA4 P4 (NOLOCK) ON B.PARA4_CODE= P4.PARA4_CODE    
      JOIN PARA5 P5 (NOLOCK) ON B.PARA5_CODE= P5.PARA5_CODE    
      JOIN PARA6 P6 (NOLOCK) ON B.PARA6_CODE= P6.PARA6_CODE    
      JOIN SECTIOND SD (NOLOCK) ON C.SUB_SECTION_CODE = SD.SUB_SECTION_CODE    
      JOIN SECTIONM SM (NOLOCK) ON SD.SECTION_CODE= SM.SECTION_CODE    
      LEFT OUTER  JOIN LM01106 LM (NOLOCK) ON SKU.AC_CODE=LM.AC_CODE 
      LEFT OUTER JOIN LMP01106 LMP (NOLOCK) ON LM.AC_CODE=LMP.AC_CODE 
      JOIN UOM U (NOLOCK) ON U.UOM_CODE=C.UOM_CODE    
      LEFT OUTER JOIN  SKU_BO (NOLOCK) ON B.PRODUCT_CODE= SKU_BO.PRODUCT_CODE  
      LEFT OUTER JOIN WSL_ORDER_MST WO (NOLOCK)  ON SKU_BO.ORDER_ID= WO.ORDER_ID  
      LEFT OUTER JOIN custdym CUST (NOLOCK) ON WO.CUSTOMER_CODE= CUST.CUSTOMER_CODE  
      LEFT OUTER JOIN SKU_OH  (NOLOCK) ON SKU_OH.PRODUCT_CODE=SKU.PRODUCT_CODE 
      LEFT OUTER JOIN UOM AR_U (NOLOCK) ON AR_U.UOM_CODE=C.UOM_CODE 

END
