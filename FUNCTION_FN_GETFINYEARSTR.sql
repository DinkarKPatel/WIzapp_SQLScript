CREATE FUNCTION FN_GETFINYEARSTR
(
	@DDATE DATETIME
)
RETURNS VARCHAR(20)
--WITH ENCRYPTION
AS
BEGIN
	DECLARE @NYEAR INT,
			@NMONTH INT,
			@NFROMYEAR INT,
			@NTOYEAR INT
			
	SELECT @NYEAR = YEAR(@DDATE), @NMONTH = MONTH(@DDATE)

	IF @NMONTH <= 3
		SET @NFROMYEAR = @NYEAR - 1
	ELSE 
		SET @NFROMYEAR = @NYEAR

	SET @NTOYEAR = @NFROMYEAR + 1

	RETURN CONVERT(VARCHAR, @NFROMYEAR) + '-' + CONVERT(VARCHAR, @NTOYEAR)
END
