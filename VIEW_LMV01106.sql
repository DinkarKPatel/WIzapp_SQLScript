CREATE VIEW LMV01106
--WITH ENCRYPTION
AS 
SELECT LM.AC_CODE, lm.AC_NAME, lm.ALIAS, lm.HEAD_CODE,
	lm.CLOSING_BALANCE, lm.CLOSING_BALANCE_CR_DR, lm.PRINT_LEDGER, LM.LAST_UPDATE, LM.INACTIVE,
	ISNULL(PRINT_NAME,LM.AC_NAME) AS PRINT_NAME , ADDRESS0, ADDRESS1, ADDRESS2, 
	LMP.AREA_CODE, AREA.AREA_NAME, AREA.PINCODE, AREA.CITY_CODE, CITY.CITY, STATE.STATE_CODE, STATE.STATE,
	CST_NO, CST_DT, SST_NO, SST_DT, TIN_NO, TIN_DT, PHONES_R, PHONES_O, PHONES_FAX, LMP.MOBILE, 
	E_MAIL, TAX_CODE, CREDIT_DAYS, DISCOUNT_PERCENTAGE, BILL_BY_BILL, ON_HOLD, 
	THROUGH_BROKER, BROKER_AC_CODE, BROKER_COMM_PERCENT, CREDIT_LIMIT, 
	ALLOW_CREDITOR_DEBTOR, DPWEF_DT, LMP.CST_PERCENTAGE, LMP.PAN_NO, LMP.FORM_ID,
	CUSTOMER_CODE,  GLN_NO, LMP.MP_PERCENTAGE, ISNULL(LMP.MRP_CALC_MODE,1) AS MRP_CALC_MODE,
	LM.TDS_CODE,LMP.COMPANY_CODE,LMP.INV_RATE_TYPE,LMP.OUTSTATION_PARTY,LMP.SALES_AC_CODE,
	LM.USER_CODE,LM.EDT_USER_CODE,U.USERNAME,EU.USERNAME AS EDT_USERNAME,LMP.DEFAULT_RATE_TYPE,
	REGIONM.REGION_CODE,REGIONM.REGION_NAME ,LM.ALIAS_TO_BE_SUFFIXED ,
	ISNULL(LMP.PUR_CAL_METHOD,1) AS PUR_CAL_METHOD , ISNULL(LMP.wsl_rate_calc_method,1) as wsl_rate_calc_method,
	ISNULL(LMP.RESTRICT_PUR_ENTRY,0)  AS RESTRICT_PUR_ENTRY,ISNULL(LMP.WP_PERCENTAGE,0) AS WP_PERCENTAGE,
	ISNULL(LMP.EOSS_DISCOUNT_SHARE,0) AS [EOSS_DISCOUNT_SHARE],
	ISNULL(LMP.EOSS_DISCOUNT_PER,0) AS [EOSS_DISCOUNT_PER],
	ISNULL(LMP.purchase_against_terms,0) AS [purchase_against_terms],
	ISNULL(LMP.shipping_address,0) AS [shipping_address],
	ISNULL(LMP.shipping_address2,0) AS [shipping_address2],
	ISNULL(LMP.shipping_address3,0) AS [shipping_address3],
	ISNULL(lmp.custom_rate_type,0) as custom_rate_type,
	ISNULL(lmp.DO_NOT_ALLOW_DIRECT_PUR,0) as DO_NOT_ALLOW_DIRECT_PUR,
	ISNULL(lmp.Enable_Email,0) AS Enable_Email,	ISNULL(lmp.WhatsApp_no,'') AS WhatsApp_no,
	ISNULL(lmp.Ac_gst_no,'') AS Ac_gst_no,isnull(THRU_RTGS,0) AS THRU_RTGS,
	isnull(lmp.PARTY_ERP_CODE,'') AS party_erp_code,
	isnull(lmp.ANGADIA_CODE,'0000000') AS ANGADIA_CODE,
	isnull(lmp.hold_for_payment,0) AS hold_for_payment,
	isnull(ANGM.Angadia_name,'') AS Angadia_name,
	LM.SHARE_WITH_WH , 
	LM.SHARE_WITH_COMPANY_OWNED_POS,
	LM.SHARE_WITH_FRANCHISE_CONSIGNEE, 
	LM.SHARE_WITH_FRANCHISE_OUTRIGHT ,ISNULl(LMP.registered_gst_dealer,0) AS registered_gst_dealer,
	isnull(LMP.ac_gst_state_code,'') As ac_gst_state_code,
	isnull(lm.hsn_code,'') as hsn_code,isnull(PARTY_RATE_MEMO_ID,'') as PARTY_RATE_MEMO_ID,
	ISNULL(prm.PARTY_RATE_DESCRIPTION,'') as PARTY_RATE_DESCRIPTION,
	isnull(COUNTRY.COUNTRY_CODE,'0000000') as COUNTRY_CODE,
	isnull(COUNTRY.COUNTRY_NAME,'INDIA') as COUNTRY_NAME
	--14 Mar 2018
	,ISNULL(LMP.PARTY_RATE_SUPP,'')AS PARTY_RATE_SUPP	
	--27 Mar 2018
	,ISNULL(prm_supp.PARTY_RATE_DESCRIPTION,'')AS PARTY_RATE_SUPP_DESCRIPTION
	, lm.lm_REMARKS,ISNULL(lm.sor_party,0) as sor_party
	,ISNULL(lmp.order_allocation_priority,0) as order_allocation_priority
	,isnull(lm.major_ac_code,'0000000000') as major_ac_code
	,isnull(lm_major.ac_name,'') as major_ac_name,LMP.AR_ID,AR.AR_NAME,LMP.CONTACT_PERSON_NAME
	,ISNULL(export_gst_mode,0) AS export_gst_mode ,ISNULL(export_gst_percentage,0) AS export_gst_percentage
	,ISNULL(trade_discount_percentage,0) AS trade_discount_percentage
	,ISNULL(ROUND_OFF_GST_AMT,0) AS ROUND_OFF_GST_AMT, ISNULL(export_gst_percentage_Applicable,0) AS export_gst_percentage_Applicable
	,ISNULL(lmp.rcm_applicable,0) as rcm_applicable,ISNULL(LMP.ALLOW_ALLOCATION_WIP_STK,0) AS ALLOW_ALLOCATION_WIP_STK
	,ISNULL(lmp.e_mail_cc,'') AS e_mail_cc,ISNULL(lm_broker.ac_name,'') AS BROKER_AC_NAME
	,ISNULL(cd_calc_based_on,1) AS cd_calc_based_on,LMP.fc_code ,F.fc_name,ISNULL(LM.GSTR3B,0) AS GSTR3B
	,ISNULL(mp_calc_based_on,1) AS mp_calc_based_on,LMP.PT_ID,ISNULL(PT_NAME,'') AS PT_NAME, 
	ISNULL(LMP_MSME,0) AS LMP_MSME,ISNULL(LMP_MSME_NO,'') AS LMP_MSME_NO,ISNULL(LMP_MSME_ACITIVITY,'') AS LMP_MSME_ACITIVITY,
ISNULL(LMP_MSME_NIC,'') AS LMP_MSME_NIC,ISNULL(LMP_MSME_AGREEMENT,0) AS LMP_MSME_AGREEMENT,ISNULL(LMP_MSME_TYPE,0) AS LMP_MSME_TYPE,
ISNULL(LMP.DoNotDebitGoodsTCS,0) AS DoNotDebitGoodsTCS,
ISNULL(LMP.freightPaidBy,1) as freightPaidBy
FROM LM01106 AS LM 
LEFT OUTER JOIN LMP01106 AS LMP ON ( LM.AC_CODE = LMP.AC_CODE )
LEFT OUTER JOIN AREA ON ( LMP.AREA_CODE = AREA.AREA_CODE )
LEFT OUTER JOIN CITY ON ( AREA.CITY_CODE = CITY.CITY_CODE )
LEFT OUTER JOIN STATE ON ( CITY.STATE_CODE = STATE.STATE_CODE )
LEFT OUTER JOIN USERS U ON U.USER_CODE=LM.USER_CODE
LEFT OUTER JOIN USERS EU ON EU.USER_CODE=LM.EDT_USER_CODE
LEFT OUTER JOIN REGIONM  ON STATE.REGION_CODE = REGIONM.REGION_CODE  
LEFT OUTER JOIN COUNTRY  ON COUNTRY.COUNTRY_CODE = REGIONM.COUNTRY_CODE  
LEFT OUTER JOIN ANGM  ON LMP.ANGADIA_CODE = ANGM.ANGADIA_CODE
LEFT OUTER JOIN party_rate_mst prm(nolock) on prm.MEMO_ID=lmp.PARTY_RATE_MEMO_ID
--27 Mar 2018
LEFT OUTER JOIN party_rate_mst prm_supp(nolock) on prm_supp.MEMO_ID=lmp.PARTY_RATE_SUPP
LEFT OUTER JOIN lm01106 lm_major (NOLOCK) ON lm_major.ac_code=lm.major_ac_code
LEFT OUTER JOIN lm01106 lm_Broker (NOLOCK) ON lm_Broker.ac_code=lmp.BROKER_AC_CODE
LEFT OUTER JOIN AUTO_REMINDER_MST AR ON LMP.AR_ID= AR.AR_ID
LEFT OUTER JOIN FC F ON LMP.FC_CODE = F.FC_CODE
LEFT OUTER JOIN PTFILES_TEMPLATES PT ON LMP.PT_ID= PT.PT_ID 


