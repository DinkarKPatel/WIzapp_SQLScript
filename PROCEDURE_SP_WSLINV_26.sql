CREATE PROCEDURE SP_WSLINV_26 --(LocId 3 digit change by Sanjay:04-11-2024)
 @CMEMOID VARCHAR(40) = '',  
 @CWHERE1 VARCHAR(500) = '',  
 @NNAVMODE NUMERIC(1,0) = 0,  
 @CWHERE2 NVARCHAR(MAX)='',  
 @DMEMODT DATETIME='',  
 @CLOCID  VARCHAR(4)=''  
----WITH ENCRYPTION  
AS  
BEGIN   

	SELECT a.PRODUCT_CODE,a.BIN_ID,b.location_Code AS DEPT_ID,A.MRP,CAST('' AS VARCHAR(50)) AS BIN_NAME,SUM(ISNULL(C.QUANTITY_IN_STOCK,0)+a.invoice_quantity) AS QUANTITY_IN_STOCK
	FROM IND01106 a (NOLOCK)
	JOIN INM01106 b (NOLOCK) ON b.INV_ID=a.INV_ID
	LEFT OUTER JOIN PMT01106 C (NOLOCK )  ON C.product_code=a.PRODUCT_CODE AND b.location_Code=a.DEPT_ID AND a.BIN_ID=c.BIN_ID
	WHERE a.INV_ID=@CMEMOID
	GROUP BY a.PRODUCT_CODE,a.BIN_ID,A.MRP,b.location_Code
END