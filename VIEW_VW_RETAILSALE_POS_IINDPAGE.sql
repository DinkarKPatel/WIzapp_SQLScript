CREATE VIEW VW_RETAILSALE_POS_IINDPAGE

AS
SELECT A.FIN_YEAR,CM_NO,CM_DT,SUBTOTAL,A.DISCOUNT_PERCENTAGE,DISCOUNT_AMOUNT,NET_AMOUNT,CANCELLED,A.REMARKS,
CM_ID AS MEMO_ID,ROUND_OFF,MEMO_TYPE,A.AC_CODE,B.CUSTOMER_CODE,
  B.CUSTOMER_FNAME+' '+B.CUSTOMER_LNAME AS CUSTOMER_NAME,  C.USERNAME, '' AS ADDRESS,    
  ISNULL(ST.STATE,'') AS [STATE],ISNULL(AR.AREA_NAME,'') AS  AREA,    
    ISNULL(CI.CITY,'') AS CITY,ISNULL(AR.PINCODE,'') AS PINCODE,    
    ISNULL(D.USERNAME,'') AS [EDT_USERNAME]  ,B.MOBILE,
    CONVERT(VARCHAR(10),(CASE WHEN D1.MEMO_ID IS NULL THEN 'NO' ELSE 'YES' END)) AS [DOCUMENT_ATTACHED]
  FROM CMM01106 A  (NOLOCK)    
  JOIN CUSTDYM B  (NOLOCK) ON B.CUSTOMER_CODE=A.CUSTOMER_CODE     
  JOIN LM01106 B1  (NOLOCK) ON B1.AC_CODE=A.AC_CODE   
  JOIN DTM  (NOLOCK) ON DTM.DT_CODE=A.DT_CODE  
  LEFT OUTER JOIN AREA AR  (NOLOCK) ON AR.AREA_CODE=B.AREA_CODE    
  LEFT OUTER JOIN CITY CI  (NOLOCK) ON CI.CITY_CODE=AR.CITY_CODE    
  LEFT OUTER JOIN STATE ST  (NOLOCK) ON ST.STATE_CODE=CI.STATE_CODE    
  --LEFT OUTER JOIN CMR01106 CMR  (NOLOCK) ON CMR.CM_ID=A.CM_ID      
  JOIN USERS C  (NOLOCK) ON C.USER_CODE=A.USER_CODE    
  LEFT OUTER JOIN USERS D  (NOLOCK) ON D.USER_CODE=A.EDT_USER_CODE     
 LEFT OUTER JOIN IMAGE_XN_DET D1  (NOLOCK) ON D1.MEMO_ID=A.CM_ID AND D1.XN_TYPE='SLS'
