CREATE PROCEDURE SPPPC_SIZEGROUP_PARA2
 (
   @CSIZEGRUP_CODE VARCHAR(10)='',
   @NMODE INT=0,
   @CARTICLE_CODE VARCHAR(10)=''
 )
 AS
 BEGIN
 IF @NMODE=0
  BEGIN
 SELECT A.SIZEGROUP_CODE,
 ISNULL(B.PARA2_CODE,'0000000') AS PARA2_CODE,
 C.PARA2_NAME,
 C.PARA2_ORDER  
 ,CAST(0 AS NUMERIC(10,2)) AS PURCHASE_PRICE
 ,CAST(0 AS NUMERIC(10,2)) AS MRP
 ,CAST(0 AS NUMERIC(10,2)) AS WS_PRICE
 ,ROW_ID=CAST(NEWID() AS VARCHAR(40))
 FROM PPC_SIZEGROUP A
 LEFT JOIN PPC_SIZEGROUP_PARA2 B ON A.SIZEGROUP_CODE=B.SIZEGROUP_CODE
 JOIN PARA2 C ON C.PARA2_CODE=ISNULL(B.PARA2_CODE,'0000000')
 WHERE A.SIZEGROUP_CODE=@CSIZEGRUP_CODE
 GROUP BY B.SR_NO,A.SIZEGROUP_CODE,B.PARA2_CODE,C.PARA2_NAME ,C.PARA2_ORDER
 ORDER BY  B.SR_NO
 END
 ELSE
 BEGIN
 
 SELECT A.SIZEGROUP_CODE,A.PARA2_CODE,C.PARA2_NAME ,C.PARA2_ORDER
 , PURCHASE_PRICE
 ,MRP
 ,WS_PRICE
 ,CAST(A.ROW_ID  AS VARCHAR(40)) AS ROW_ID
 FROM PPC_ART_DET_SIZEGROUP A
 JOIN PPC_SIZEGROUP B ON A.SIZEGROUP_CODE=B.SIZEGROUP_CODE
 JOIN PARA2 C ON C.PARA2_CODE =A.PARA2_CODE
 LEFT JOIN PPC_SIZEGROUP_PARA2 SP ON SP.SIZEGROUP_CODE=B.SIZEGROUP_CODE AND SP.PARA2_CODE=C.PARA2_CODE
 WHERE A.ARTICLE_CODE=@CARTICLE_CODE
 AND A.SIZEGROUP_CODE=@CSIZEGRUP_CODE
 ORDER BY ISNULL(SP.SR_NO,C.PARA2_ORDER)
 
 END
 
END
