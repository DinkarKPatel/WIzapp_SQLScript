UPDATE A SET BILL_DT =RECEIPT_DT  FROM PIM01106 A (NOLOCK) WHERE ISNULL(BILL_DT,'') =''
IF EXISTS (SELECT TOP 1 'U' FROM INFORMATION_SCHEMA .COLUMNS WHERE TABLE_NAME ='PID01106' AND COLUMN_NAME ='GRN_QTY')
BEGIN
     UPDATE B SET GRN_QTY =quantity  FROM PIM01106 A (NOLOCK)
     JOIN pid01106 B (NOLOCK) ON A.mrr_id =B.mrr_id 
     WHERE A.CANCELLED =0 AND A.pim_mode =6 AND ISNULL(B.GRN_QTY,0)=0

END

IF EXISTS (SELECT TOP 1 'U' FROM INFORMATION_SCHEMA .COLUMNS WHERE TABLE_NAME ='HSN_DET' AND COLUMN_NAME ='GST_CAL_BASIS')
BEGIN
    
    
    UPDATE A SET GST_CAL_BASIS =B.GST_CAL_BASIS 
    FROM HSN_DET A
    JOIN HSN_MST B ON A.HSN_CODE =B.HSN_CODE 
    WHERE A.GST_CAL_BASIS IS NULL
    
END

IF EXISTS (SELECT TOP 1 'U' FROM INFORMATION_SCHEMA .COLUMNS WHERE TABLE_NAME ='BUYER_ORDER_MST' AND COLUMN_NAME ='TOTAL_PICK_LIST_QTY')
BEGIN
    
    
   UPDATE A  SET TOTAL_PICK_LIST_QTY=ISNULL(B.PICK_LIST_QTY,0)
   FROM BUYER_ORDER_MST A (NOLOCK)
   JOIN
   (
    SELECT A.ORDER_ID ,SUM(B.QUANTITY) AS PICK_LIST_QTY 
    FROM FLOOR_ST_MST A
    JOIN FLOOR_ST_DET B ON A.MEMO_ID =B.MEMO_ID 
    WHERE A.CANCELLED =0
    AND ISNULL(A.ORDER_ID ,'')<>''
    GROUP BY A.ORDER_ID
    ) B ON A.order_id =B.ORDER_ID 
    WHERE ISNULL(A.TOTAL_PICK_LIST_QTY,0)=0
    
END	


IF EXISTS (SELECT TOP 1'U' FROM INFORMATION_SCHEMA .COLUMNS WHERE TABLE_NAME ='BOM_ISSUE_DET' AND COLUMN_NAME ='STOCK_QTY')
BEGIN
   UPDATE BOM_ISSUE_DET SET STOCK_QTY=QUANTITY WHERE STOCK_QTY IS NULL
END
	
