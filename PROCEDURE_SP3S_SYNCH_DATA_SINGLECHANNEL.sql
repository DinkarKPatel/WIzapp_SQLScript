create PROCEDURE SP3S_SYNCH_DATA_SINGLECHANNEL
@CXNTYPE VARCHAR(20),
@nSpId VARCHAR(50)
AS
BEGIN


	

	DECLARE @nInvmode NUMERIC(1,0),@CCURLOCID VARCHAR(5),@CHOLOCID VARCHAR(5),@CERRMSG VARCHAR(MAX),@cMergeStr VARCHAR(20)

	SET @cMergeStr=@CXNTYPE+'merge'
	EXEC SP_CHKXNSAVELOG @cMergeStr,'0.2',0,@nSpId,'',1

	SELECT TOP 1 @CCURLOCID=VALUE FROM CONFIG (NOLOCK) WHERE CONFIG_OPTION='LOCATION_ID'	
	SELECT TOP 1 @CHOLOCID=VALUE FROM CONFIG (NOLOCK) WHERE CONFIG_OPTION='HO_LOCATION_ID'	
	
	EXEC SP_CHKXNSAVELOG @cMergeStr,'0.5',0,@nSpId,'',1
	DECLARE @tOutput TABLE (errmsg varchar(max),missing_memo_id VARCHAR(50))

	IF EXISTS (SELECT TOP 1 memo_id FROM tblMissingMemos (NOLOCK) WHERE sp_id=@nSpId)
		DELETE FROM tblMissingMemos WITH (ROWLOCK) WHERE sp_id=@nSpid
	
	---- ONLY CUSTOMER DATA IS ALLOWED TO BE MERGED AT LOCATION
	IF @CCURLOCID<>@CHOLOCID 
	BEGIN
		SET @CERRMSG='TRANSACTION MERGING CAN ONLY BE DONE AT HEAD OFFICE....'
		GOTO EXIT_PROC
	END 
	
	EXEC SP_CHKXNSAVELOG @cMergeStr,'0.8',0,@nSpId,'',1
	EXEC SP3S_VALIDATE_MERGING_CHECKSUM
	@cSpId=@nSpId,
	@cErrormsg=@CERRMSG OUTPUT 			
	
	IF ISNULL(@cErrmsg,'')<>''
		GOTO EXIT_PROC
			
	PRINT 'END OF SP3S_CHECK_PARENTDATA'
	 
	EXEC SP_CHKXNSAVELOG @cMergeStr,'1',0,@nSpId,'',1
		
	IF @CXNTYPE='PUR'
	BEGIN
		SELECT TOP 1 @nInvmode=inv_mode FROM PUR_pim01106_UPLOAD (NOLOCK) WHERE sp_id=@nSpId

		IF @nInvmode=2
			EXEC SP3S_SYNCH_UPLOADDATA_GRPPUR_OPT
			@nSpId=@nSPId, 
			@CERRMSG=@CERRMSG OUTPUT 		
		ELSE
			EXEC SP3S_SYNCH_UPLOADDATA_PUR_OPT
			@nSpId=@nSPId, 
			@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE
	IF @CXNTYPE='SLS'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_SLSNEW_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE
	IF @CXNTYPE='PO'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PO_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='WSL'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_WSL_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='IRR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_IRR_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='PRT'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PRT_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='WSR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_WSR_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='wps'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_WPS_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='rps'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_RPS_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='arc'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_arc_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END	
	ELSE
	IF @CXNTYPE='stkcnt'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_stkcnt_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='SNC'
	BEGIN
		EXEC SP3s_SYNCH_UPLOADDATA_SNC_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='TLF'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_TLF_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='grnps'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_GRNPS_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='SLRRECON'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_SLRRECON_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='SCF'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_SCF_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='APP'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_APP_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='APR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_APR_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='SHF'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_SHF_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='XNSLM'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_XNSLM_OPT
		@CspId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='XNSDTM'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_XNSDTM_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='TEX'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_TEX_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='BKT'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_BKT_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PTC'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PTC_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PTCAPP'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PTC_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='WSLORD'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_WSLORD_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='SCHNEW'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_SCHNEW_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
    ELSE
	IF @CXNTYPE='WBO'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_WBO_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='DNPS'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_DNPS_OPT
		@NSPID=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='BCO'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_BCO_OPT
		@NSPID=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='JWI'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_JWI_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='JWR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_JWR_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='ATD'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_ATD_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PSHBD'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PSHBD_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PSJWI'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PSJWI_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PSJWR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PSJWR_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PSDLV'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PSDLV_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='CNC'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_CNC_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='DEND'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_DEND_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='STREC'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_STREC_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PCI'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PCI_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PCO'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PCO_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='DSM'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_DSM_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PRCL'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PRCL_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='CUS'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_CUS_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='PFI'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_PFI_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='BIN_MST'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_BIN_MST_OPT
		@cSPId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='GVXFR'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_GVXFR_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='POADJ'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_POADJ_OPT
		@CSPID=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END
	ELSE
	IF @CXNTYPE='XNRECON'
	BEGIN
		EXEC SP3S_SYNCH_UPLOADDATA_XNRECON_OPT
		@nSpId=@nSPId, 
		@CERRMSG=@CERRMSG OUTPUT
	END

EXIT_PROC:
	IF NOT EXISTS (SELECT TOP 1 SP_ID  FROM tblmissingMemos (NOLOCK) WHERE sp_id=@nSpId )
		select @CERRMSG as errmsg,'' AS MISSING_MEMO_ID
	ELSE	
		SELECT 'Missing Series' as errmsg,memo_id as missing_cm_id from tblmissingmemos (NOLOCK) WHERE sp_id=@nSpId 
	
END
----- 'END OF CREATING PROCEDURE SP3S_SYNCH_DATA_SINGLECHANNEL'
