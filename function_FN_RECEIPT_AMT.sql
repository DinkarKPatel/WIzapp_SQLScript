CREATE FUNCTION FN_RECEIPT_AMT  
(  
  @CSHIFT_ID VARCHAR(100)  
)  
RETURNS  NUMERIC(18,2)  
BEGIN  
 
 DECLARE @CRECEIPT NUMERIC(18,2) ,@CRECEIPT1 NUMERIC(18,2) ,@CRECEIPT2 NUMERIC(18,2) ,@CRECEIPT3 NUMERIC(18,2)  
--CASH RECEIVED THRU ADVANCES/OS RECEIPTS  
 SELECT @CRECEIPT1=ISNULL(SUM(B.AMOUNT) ,0)  
 FROM ARC01106 A  
 JOIN PAYMODE_XN_DET B ON A.ADV_REC_ID=B.MEMO_ID AND B.XN_TYPE='ARC'  
 WHERE  A.ARC_TYPE=1 AND B.PAYMODE_CODE='0000000'  
 AND A.CANCELLED=0 AND A.SHIFT_ID =@CSHIFT_ID  
   
--NET CASH RECEIVED AGAINST SALES     
   
 SELECT @CRECEIPT2=SUM(B.AMOUNT)   
 FROM CMM01106 A  
 JOIN PAYMODE_XN_DET B ON A.CM_ID=B.MEMO_ID AND B.XN_TYPE='SLS'  
 WHERE  B.PAYMODE_CODE='0000000'  
 AND A.CANCELLED=0 AND A.SHIFT_ID =@CSHIFT_ID  
  
--CASH ISSUED AGAINST PAYMENTS  
 SELECT @CRECEIPT3=ISNULL(SUM(B.AMOUNT) ,0)  
 FROM ARC01106 A  
 JOIN PAYMODE_XN_DET B ON A.ADV_REC_ID=B.MEMO_ID AND B.XN_TYPE='ARC'  
 WHERE  A.ARC_TYPE=2 AND B.PAYMODE_CODE='0000000' AND A.SHIFT_ID =@CSHIFT_ID  
 AND A.CANCELLED=0  
 
 set @CRECEIPT=isnull(@CRECEIPT1,0)+isnull(@CRECEIPT2,0)-isnull(@CRECEIPT3,0)
   
 RETURN @CRECEIPT  
 END 
