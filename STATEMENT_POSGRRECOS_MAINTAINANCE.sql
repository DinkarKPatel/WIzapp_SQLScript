TRUNCATE TABLE POSGRRECOS

	 INSERT POSGRRecos	( cm_id, CMDRowId, GRQuantity, lastupdate, ProductCode, RecoQty )  
	 SELECT 	  E.CM_ID,E.ROW_ID CMDROWID,abs(E.QUANTITY) GRQUANTITY,GETDATE() LASTUPDATE,E.PRODUCT_CODE PRODUCTCODE,0 RECOQTY 
	 FROM  CMD01106 E (NOLOCK) 
	 JOIN CMM01106 C (NOLOCK) ON C.CM_ID=E.CM_ID  
	 JOIN LOCATION D (NOLOCK) ON D.DEPT_ID=C.location_code/*LEFT(C.CM_NO,2)  *//*Rohit 01-11-2024*/
	 WHERE ISNULL(D.SLR_RECON_REQD,0)=1 AND C.CANCELLED = 0  AND C.CM_DT>=ISNULL(D.SLR_RECON_CUTOFF_DATE,'')   
	 AND C.CANCELLED=0  and e.QUANTITY <0
 
	 ;WITH SLR_RECO AS
	 (
	 SELECT A.CMD_ROW_ID ,SUM(ABS(A.QUANTITY)) AS QUANTITY
	 FROM SLR_RECON_DET A (NOLOCK)
	 JOIN SLR_RECON_MST B (NOLOCK) ON A.MEMO_ID =B.MEMO_ID 
	 WHERE B.CANCELLED =0
	 GROUP BY A.CMD_ROW_ID
	 )
	 Update a set RecoQty =b.QUANTITY 
	 from POSGRRecos A (nolock)
	 join SLR_RECO b (nolock) on a.CMDRowId =b.cmd_row_id 
