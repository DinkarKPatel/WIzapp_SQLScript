CREATE VIEW VW_WL_PRD_WSLINV  

AS   
SELECT 
T1.INV_NO AS MST_INV_NO,T1.MEMO_PREFIX AS MST_MEMO_PREFIX,
T1.INV_ID,    T1.INV_DT AS MST_XN_DT,  T1.REF_WO_ID,  T1.INV_NO AS MST_MEMO_NO,    T1.SUBTOTAL AS MST_SUBTOTAL,    
T1.DISCOUNT_PERCENTAGE AS MST_DISCOUNT_PERCENTAGE ,    T1.DISCOUNT_AMOUNT AS MST_DISCOUNT_AMOUNT ,    
T1.FREIGHT AS MST_FREIGHT ,    T1.OTHER_CHARGES AS MST_OTHER_CHARGES ,    T1.NET_AMOUNT AS MST_NET_AMOUNT ,    
T1.ROUND_OFF AS MST_ROUNDOFF,    T1.REMARKS AS MST_REMARKS ,    T1.GRLR_DATE AS MST_GRLR_DATE ,    
T1.BANDALS AS MST_BANDALS ,    T1.THROUGH AS MST_THROUGH ,    T1.INSURANCE AS MST_INSURANCE ,    
T2.ITEM_TAX_PERCENTAGE AS MST_TAX_PERCENTAGE ,    T2.ITEM_TAX_AMOUNT AS MST_TAX_AMOUNT ,    
T1.OCTROI_PERCENTAGE AS MST_OCTROI_PERCENTAGE,    T1.OCTROI_AMOUNT AS MST_OCTROI_AMOUNT,    
T1.PARTY_DA_NO AS MST_PARTY_DA_NO ,    T1.PARTY_PO_NO AS MST_PARTY_PO_NO ,    
T1.MANUAL_INV_NO AS MST_MANUAL_INV_NO, T2.PRODUCT_UID AS MST_PRODUCT_CODE,    T2.QUANTITY AS CAL_QUANTITY,    
T2.RATE AS CAL_RATE,    T2.DISCOUNT_PERCENTAGE AS CAL_DISCOUNT_PERCENTAGE,    T2.DISCOUNT_AMOUNT AS CAL_DISCOUNT_AMOUNT,    
(T2.QUANTITY*T2.RATE)-T2.DISCOUNT_AMOUNT AS CAL_AMOUNT,    
T1.EXCISE_ACCESSIBLE_PERCENTAGE,T1.EXCISE_ACCESSIBLE_AMOUNT,
T1.EXCISE_DUTY_PERCENTAGE,T1.EXCISE_DUTY_AMOUNT,    T1.EXCISE_EDU_CESS_PERCENTAGE,T1.EXCISE_EDU_CESS_AMOUNT,
T1.EXCISE_HEDU_CESS_PERCENTAGE,T1.EXCISE_HEDU_CESS_AMOUNT,    T1.DEPT_ID,T1.EXCISE_INVOICE
,T1.AC_CODE    ,T1.INV_NO    ,T1.INV_DT    ,T1.PACKING     ,T1.CHECKED_BY    ,T1.SENT_BY    
,T1.COMPANY_CODE    ,T1.FORM_ID    ,T1.USER_CODE    ,T1.LAST_UPDATE    ,T1.GRLR_NO    ,T1.GRLR_DATE    
,T1.FIN_YEAR    ,T1.BANDALS    ,T1.THROUGH    ,T1.FORM_NO    ,T1.SENT_TO_HO    ,T1.UPLOADED_TO_ACTIVSTREAM    
,T1.BROKER_AC_CODE    ,T1.BROKER_COMM_PERCENTAGE    ,T1.BROKER_COMM_AMOUNT    ,T1.ROUTE_FORM1    
,T1.ROUTE_FORM2    ,T1.CASH_CREDIT    ,T1.INSURANCE    ,T1.EMP_CODE    ,T1.DT_CODE    ,T1.POSTEDINAC    
,T1.EDT_USER_CODE    ,T1.INV_TIME    ,T1.SMS_SENT    ,T2.ITEM_TAX_PERCENTAGE AS TAX_PERCENTAGE    
,T2.ITEM_TAX_AMOUNT  AS TAX_AMOUNT  ,T2.ITEM_TAX_PERCENTAGE   ,T2.ITEM_TAX_AMOUNT    ,T1.INV_MODE    
,T1.EXPORTED    ,T1.PARTY_DEPT_ID    ,T1.APPROVED    ,T2.PRODUCT_UID,T2.QUANTITY    ,T2.RATE    ,T2.ROW_ID    
,T2.PRINT_LABEL    ,T2.RFNET    ,T2.RFNET_WOTAX    ,T2.NET_RATE    ,T2.MRP    
,    T2.QUANTITY*T6.MRP AS CAL_AMOUNT_MRP
 ,AT1.attr1_key_name,AT2.attr2_key_name,AT3.attr3_key_name,AT4.attr4_key_name,AT5.attr5_key_name,AT6.attr6_key_name,
   AT7.attr7_key_name,AT8.attr8_key_name,AT9.attr9_key_name,AT10.attr10_key_name,AT11.attr11_key_name,AT12.attr12_key_name,
   AT13.attr13_key_name,AT14.attr14_key_name,AT15.attr15_key_name,AT16.attr16_key_name,AT17.attr17_key_name,AT18.attr18_key_name,
   AT19.attr19_key_name,AT20.attr20_key_name,AT21.attr21_key_name,AT22.attr22_key_name,AT23.attr23_key_name,AT24.attr24_key_name,
	AT25.attr25_key_name 
  
,T3.AC_NAME AS MST_AC_NAME,    T3.ADDRESS0,T3.ADDRESS1,T3.ADDRESS2,T3.AREA_NAME,T3.PINCODE,    
T3.CITY,T3.STATE,T3.CST_NO,T3.CST_DT,T3.SST_NO,T3.SST_DT,T3.TIN_NO,T3.TIN_DT,    
T3.PHONES_R,T3.PHONES_O,T3.PHONES_FAX,T3.MOBILE,T3.E_MAIL,TAX_CODE  
,T4.FORM_NAME AS MST_FORM_NAME,    T5.EMP_NAME AS MST_EMP_NAME ,  T6.MRP AS CAL_MRP
,    (CASE WHEN T1.CANCELLED = 1 THEN 'CANCELLED' ELSE '' END) AS MST_CANCELLED
,SECTION_NAME,SUB_SECTION_NAME,ARTICLE_NO,ARTICLE_DESC,ARTICLE_NAME,    
PARA1_NAME,PARA2_NAME,PARA3_NAME,PARA4_NAME,PARA5_NAME,PARA6_NAME,    
P2.PARA2_ORDER
,UOM.UOM_NAME,UOM.UOM_TYPE
,    T3.AC_NAME    ,T3.ALIAS    ,T3.HEAD_CODE    ,T3.CLOSING_BALANCE    ,T3.CLOSING_BALANCE_CR_DR    ,T3.PRINT_LEDGER    ,T3.PRINT_NAME    
,T3.AREA_CODE    ,T3.CITY_CODE    ,T3.STATE_CODE    ,T3.CREDIT_DAYS    ,T3.BILL_BY_BILL    ,T3.ON_HOLD    
,T3.THROUGH_BROKER    ,T3.BROKER_COMM_PERCENT    ,T3.CREDIT_LIMIT    ,T3.ALLOW_CREDITOR_DEBTOR    
,T3.DPWEF_DT    ,T3.CST_PERCENTAGE    ,T3.PAN_NO    ,T3.GLN_NO    ,T3.MP_PERCENTAGE    ,T3.MRP_CALC_MODE    
,T3.TDS_CODE    ,T3.INV_RATE_TYPE    ,T3.OUTSTATION_PARTY    ,T3.SALES_AC_CODE    ,T3.USERNAME    ,T3.EDT_USERNAME 
 ,T4.FORM_NAME    ,T4.PURCHASE_AC_CODE    ,T4.SALE_AC_CODE    ,T4.TAX_AC_CODE    
,T4.POST_TAX_SEPARATELY    ,T4.PUR_RETURN_AC_CODE    ,T4.SALE_RETURN_AC_CODE    ,T4.PHYSICAL_FORM    
,T4.SERIES    ,T4.EXCISE_EDU_CESS_AC_CODE    ,T4.EXCISE_HEDU_CESS_AC_CODE    ,T4.EXCISE_DUTY_AC_CODE    
,T5.EMP_NAME    ,T5.EMP_ALIAS    ,T5.EMP_HEAD,T6.PRODUCT_CODE   
 ,T6.PARA1_CODE    ,T6.PARA2_CODE    ,T6.PURCHASE_PRICE    
,T6.PARA3_CODE    ,T6.RECEIPT_DT    ,T6.PARA4_CODE    ,T6.PARA5_CODE    ,T6.PARA6_CODE    ,T6.DT_CREATED    
,T6.WS_PRICE    ,T6.CHALLAN_NO  
      ,T7.CODING_SCHEME    ,T7.UOM_CODE    ,T7.PARA1_SET    ,T7.PARA2_SET    
,T7.INACTIVE    ,T7.SKU_CODE    ,T7.SUB_SECTION_CODE    ,T7.DISCON    ,T7.WHOLESALE_PRICE    ,T7.WSP_PERCENTAGE    
,T7.MIN_PRICE    ,T7.STOCK_NA    ,T7.ARTICLE_TYPE    ,T7.CREATED_ON    ,T7.ARTICLE_GROUP_CODE    ,T7.GENERATE_BARCODES_WITHARTICLE_PREFIX    
,T7.ARTICLE_GEN_MODE    ,T7.ARTICLE_PRD_MODE    ,T7.ARTICLE_SET_CODE    ,T7.OH_PERCENTAGE    ,T7.OH_AMOUNT    
,T8.SECTION_CODE    ,T8.MFG_CATEGORY    

,USERS.MAJOR_USER_CODE    ,USERS.USER_ALIAS    ,USERS.DISCOUNT_PERCENTAGE_LEVEL    
,USERS.VIEW_DATA_AFTER_DFM    ,USERS.EMAIL   
 ,LCT.DEPT_NAME    ,LCT.MAJOR_DEPT_ID    ,LCT.LOC_TYPE  
,LCT.DATE_OF_OPENING    ,LCT.REPORT_BLOCKED    ,LCT.ACCOUNTS_POSTING_DEPT_ID    ,LCT.CONTROL_AC_CODE    
,LCT.UPD_PURINFO    ,LCT.SSPL_REG_KEY    ,LCT.WIZCOM_ENABLED    ,LCT.EXCISABLE    ,LCT.FR_TYPE    
,LCT.PRIMARY_EMAIL_PORT    ,LCT.PRIMARY_EMAIL    ,LCT.PRIMARY_EMAIL_SMTP    ,LCT.PRIMARY_EMAIL_PWD    ,LCT.PRIMARY_EMAIL_SSL    
,LCT.SSPL_GRP_CODE    ,LCT.PUR_LOC    ,LCT.ADDRESS1 AS LOCATION_ADDRESS1    ,LCT.ADDRESS2 AS LOCATION_ADDRESS2    
,LCT.DEPT_AC_CODE    ,LCT.LST_NO    ,LCT.LST_DT    ,LCT.DEPT_ALIAS    ,LCT.PHONE    


,LA.AREA_NAME AS LOCATION_AREA    
,LC.CITY AS LOCATION_CITY    ,LS.STATE_CODE AS LOCATION_STATE    ,LRG.REGION_NAME AS LOCATION_REGION 
,COM.COMPANY_NAME,COM.ADDRESS9   
FROM PRD_INM01106 T1    
JOIN PRD_IND01106 T2 ON T1.INV_ID = T2.INV_ID    
JOIN LMV01106 T3 ON T3.AC_CODE = T1.AC_CODE    
JOIN FORM   T4 ON T4.FORM_ID = T2.ITEM_FORM_ID     
LEFT OUTER JOIN EMPLOYEE T5 ON T5.EMP_CODE = T1.EMP_CODE    
JOIN PRD_SKU T6 ON T6.PRODUCT_UID= T2.PRODUCT_UID
JOIN ARTICLE T7 ON T7.ARTICLE_CODE=T6.ARTICLE_CODE    
JOIN SECTIOND T8 ON T8.SUB_SECTION_CODE=T7.SUB_SECTION_CODE    
JOIN SECTIONM T9 ON T9.SECTION_CODE=T8.SECTION_CODE    
JOIN PARA1 P1 ON P1.PARA1_CODE=T6.PARA1_CODE    
JOIN PARA2 P2 ON P2.PARA2_CODE=T6.PARA2_CODE    
JOIN PARA3 P3 ON P3.PARA3_CODE=T6.PARA3_CODE    
JOIN PARA4 P4 ON P4.PARA4_CODE=T6.PARA4_CODE    
JOIN PARA5 P5 ON P5.PARA5_CODE=T6.PARA5_CODE    
JOIN PARA6 P6 ON P6.PARA6_CODE=T6.PARA6_CODE    
JOIN UOM ON UOM.UOM_CODE = T7.UOM_CODE    
LEFT OUTER JOIN article_fix_attr ATTR  (NOLOCK) ON T6.article_code = ATTR.ARTICLE_CODE 
LEFT OUTER JOIN attr1_mst at1 (NOLOCK) ON at1.attr1_key_code=ATTR.attr1_key_code
LEFT OUTER JOIN attr2_mst at2 (NOLOCK) ON at2.attr2_key_code=ATTR.attr2_key_code
LEFT OUTER JOIN attr3_mst at3 (NOLOCK) ON at3.attr3_key_code=ATTR.attr3_key_code
LEFT OUTER JOIN attr4_mst at4 (NOLOCK) ON at4.attr4_key_code=ATTR.attr4_key_code
LEFT OUTER JOIN attr5_mst at5 (NOLOCK) ON at5.attr5_key_code=ATTR.attr5_key_code
LEFT OUTER JOIN attr6_mst at6 (NOLOCK) ON at6.attr6_key_code=ATTR.attr6_key_code
LEFT OUTER JOIN attr7_mst at7 (NOLOCK) ON at7.attr7_key_code=ATTR.attr7_key_code
LEFT OUTER JOIN attr8_mst at8 (NOLOCK) ON at8.attr8_key_code=ATTR.attr8_key_code
LEFT OUTER JOIN attr9_mst at9 (NOLOCK) ON at9.attr9_key_code=ATTR.attr9_key_code
LEFT OUTER JOIN attr10_mst at10 (NOLOCK) ON at10.attr10_key_code=ATTR.attr10_key_code
LEFT OUTER JOIN attr11_mst at11 (NOLOCK) ON at11.attr11_key_code=ATTR.attr11_key_code
LEFT OUTER JOIN attr12_mst at12 (NOLOCK) ON at12.attr12_key_code=ATTR.attr12_key_code
LEFT OUTER JOIN attr13_mst at13 (NOLOCK) ON at13.attr13_key_code=ATTR.attr13_key_code
LEFT OUTER JOIN attr14_mst at14 (NOLOCK) ON at14.attr14_key_code=ATTR.attr14_key_code
LEFT OUTER JOIN attr15_mst at15 (NOLOCK) ON at15.attr15_key_code=ATTR.attr15_key_code
LEFT OUTER JOIN attr16_mst at16 (NOLOCK) ON at16.attr16_key_code=ATTR.attr16_key_code
LEFT OUTER JOIN attr17_mst at17 (NOLOCK) ON at17.attr17_key_code=ATTR.attr17_key_code
LEFT OUTER JOIN attr18_mst at18 (NOLOCK) ON at18.attr18_key_code=ATTR.attr18_key_code
LEFT OUTER JOIN attr19_mst at19 (NOLOCK) ON at19.attr19_key_code=ATTR.attr19_key_code
LEFT OUTER JOIN attr20_mst at20 (NOLOCK) ON at20.attr20_key_code=ATTR.attr20_key_code
LEFT OUTER JOIN attr21_mst at21 (NOLOCK) ON at21.attr21_key_code=ATTR.attr21_key_code
LEFT OUTER JOIN attr22_mst at22 (NOLOCK) ON at22.attr22_key_code=ATTR.attr22_key_code
LEFT OUTER JOIN attr23_mst at23 (NOLOCK) ON at23.attr23_key_code=ATTR.attr23_key_code
LEFT OUTER JOIN attr24_mst at24 (NOLOCK) ON at24.attr24_key_code=ATTR.attr24_key_code
LEFT OUTER JOIN attr25_mst at25(NOLOCK) ON at25.attr25_key_code=ATTR.attr25_key_code
JOIN USERS ON T1.USER_CODE=USERS.USER_CODE    
JOIN LOCATION LCT ON T1.DEPT_ID=LCT.DEPT_ID    
JOIN AREA LA ON LCT.AREA_CODE=LA.AREA_CODE    
JOIN CITY LC ON LA.CITY_CODE=LC.CITY_CODE    
JOIN STATE LS ON LC.STATE_CODE=LS.STATE_CODE    
JOIN REGIONM LRG ON LS.REGION_CODE=LRG.REGION_CODE
JOIN COMPANY COM (NOLOCK) ON COM.COMPANY_CODE='01'
