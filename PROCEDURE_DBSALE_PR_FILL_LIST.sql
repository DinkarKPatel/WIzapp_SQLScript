CREATE PROCEDURE DBSALE_PR_FILL_LIST (  
 @nMode    TINYINT)  
AS  
BEGIN  
 --DECLARE LOCAL VARIABLE  
 DECLARE @CCMD NVARCHAR(MAX), @Errmsg NVARCHAR(MAX)  
   
 SET @Errmsg = ''    
BEGIN TRY    
BEGIN TRANSACTION    
  
 --FILL LOCATION ID  
 IF @nMode  = 0  
 BEGIN  
  SELECT DEPT_ID, UPPER(DEPT_ID) AS DEPT_ID FROM LOCATION WITH(NOLOCK) WHERE ISNULL(INACTIVE,0) = 0  
 END  
   
 --FILL LOCATION  
 IF @nMode  = 1  
 BEGIN  
  SELECT DEPT_ID, UPPER(DEPT_NAME + ' ('+ DEPT_ID + ')') AS DEPT_NAME FROM LOCATION WITH(NOLOCK) WHERE ISNULL(INACTIVE,0) = 0  
 END  
  
 --FILL CITY  
 IF @nMode  = 2  
 BEGIN  
  SELECT CITY_CODE, UPPER(CITY) AS CITY FROM CITY WITH(NOLOCK) WHERE ISNULL(INACTIVE,0) = 0  
 END  
   
 --FILL STATE  
 IF @nMode  = 3  
 BEGIN  
  SELECT STATE_CODE, UPPER([STATE]) AS [STATE] FROM [STATE] WITH(NOLOCK) WHERE ISNULL(INACTIVE,0) = 0  
 END  
END TRY    
BEGIN CATCH    
 SET @Errmsg = 'ERROR IN PROCEDURE DBSALE_PR_FILL_LIST ERROR MESSAGE || '+ ERROR_MESSAGE();  
END CATCH    
  
PROC_END:  
 IF ISNULL(@Errmsg,'') = ''  
  COMMIT;  
 ELSE  
  ROLLBACK;  
  
 SELECT ISNULL(@Errmsg,'') AS [Errmsg]  
END  