IF NOT EXISTS(SELECT TOP 1 'U' FROM CONFIG WHERE CONFIG_OPTION ='KEYS_PRT_UPDATE_LASTKEYVAL' AND VALUE =1)
BEGIN
   
     UPDATE  KEYS_PRT SET PREFIX=PREFIX +'-' WHERE RIGHT(PREFIX,1)<>'-'
     
 UPDATE A SET
 LASTKEYVAL=  CAST(
 CASE WHEN LEN(REPLACE(LASTKEYVAL,PREFIX,''))<=6 THEN
  PREFIX+ISNULL(CAST(REPLICATE ('0',6-LEN(REPLACE(LASTKEYVAL,PREFIX,''))) AS VARCHAR(100)),'')
       +REPLACE(LASTKEYVAL,PREFIX,'')   
       ELSE
     PREFIX+CAST(RIGHT(LASTKEYVAL,6) AS VARCHAR(100)) END AS VARCHAR(100))
 FROM KEYS_PRT  A 
 
  INSERT CONFIG	( CONFIG_OPTION, VALUE, ROW_ID, LAST_UPDATE,  REMARKS )  
  SELECT 	  CONFIG_OPTION='KEYS_PRT_UPDATE_LASTKEYVAL', VALUE=1, ROW_ID=NEWID(),
   LAST_UPDATE=GETDATE (),  REMARKS =''
  
END
