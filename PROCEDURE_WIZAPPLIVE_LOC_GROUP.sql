CREATE PROCEDURE WIZAPPLIVE_LOC_GROUP
(
@CLOC_ID VARCHAR(5)/*Rohit 06-11-2024*/
)
AS
BEGIN
            
             DECLARE @CCMD NVARCHAR(MAX)
             
           SET @CCMD ='SELECT L.DEPT_ID,'''+ @CLOC_ID+''' AS MAJOR_DEPT_ID,L.DEPT_NAME,A.AREA_NAME,C.CITY,S.STATE ,(L.ADDRESS1 +'' ''+ L.ADDRESS2 ) AS ADDRESS,
                        NEWID() AS ROW_ID,
                        (CASE WHEN W.DEPT_ID=L.DEPT_ID THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT) END) AS CHK 
						FROM LOCATION L JOIN AREA A ON A.AREA_CODE=L.AREA_CODE
						JOIN CITY C ON C.CITY_CODE=A.CITY_CODE
						JOIN STATE S ON S.STATE_CODE=C.STATE_CODE
						LEFT JOIN WIZAPPLIVELOC_GROUP W ON W.DEPT_ID=L.DEPT_ID AND W.MAJOR_DEPT_ID='''+ @CLOC_ID +'''
			    		WHERE L.INACTIVE=0 AND L.DEPT_ID <> '''' AND L.DEPT_ID=L.MAJOR_DEPT_ID'  
			PRINT @CCMD
			EXEC SP_EXECUTESQL @CCMD		
    
END

--******************** END OF PROCEDURE WIZAPPLIVE_LOC_GROUP****************
