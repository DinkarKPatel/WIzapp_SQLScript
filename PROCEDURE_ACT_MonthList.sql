CREATE PROCEDURE ACT_MONTHLIST 
(	
		@DFROMDT DATETIME, 
		@DTODT DATETIME
)
--WITH ENCRYPTION
AS
BEGIN
	-- GETTING NAMES OF ALL MONTHS IN A FIN-YEAR
	DECLARE @MONTHC TABLE ( MONTH_NAME VARCHAR(20), YEAR_NO BIGINT, MONTH_NO INT, FROM_DT DATETIME, TO_DT DATETIME )
	DECLARE	@DTEMPDATE DATETIME

	SET @DTEMPDATE = @DFROMDT

	WHILE @DTEMPDATE <= @DTODT
	BEGIN
		INSERT @MONTHC 
		SELECT	DATENAME(MM, @DTEMPDATE ) AS MONTH_NAME, 
				DATEPART(YYYY, @DTEMPDATE) AS YEAR_NO, 
				DATEPART(MM, @DTEMPDATE) AS MONTH_NO,
				@DTEMPDATE AS FROM_DT,
				DATEADD( DD, -1, DATEADD( MM, 1, @DTEMPDATE)) AS TO_DT

		SET @DTEMPDATE = DATEADD( MM, 1, @DTEMPDATE) 
	END

	SELECT * FROM @MONTHC
END
