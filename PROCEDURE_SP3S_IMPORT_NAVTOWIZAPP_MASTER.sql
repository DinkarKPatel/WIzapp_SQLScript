create PROCEDURE SP3S_IMPORT_NAVTOWIZAPP_MASTER
(
 @CXNTYPE VARCHAR(10)='',
 @SP_ID INT
)
AS
BEGIN



     DECLARE @CTEMP_TABLENAME VARCHAR(50),@CHSNTABLENAME VARCHAR(50),@CCMD nvarchar(max)
    
	IF @CXNTYPE='LOC'
	BEGIN
	    
		  SET @CTEMP_TABLENAME='TMP_LOC_UPLOAD_MST_'+RTRIM(LTRIM(STR(@SP_ID)))
		  EXEC SP3S_IMPORT_LOCATION @SP_ID

	END
	ELSE IF @CXNTYPE='HSN'
	BEGIN

	     SET @CTEMP_TABLENAME='TMP_HSN_UPLOAD_MST_'+RTRIM(LTRIM(STR(@SP_ID)))
		 set @CHSNTABLENAME='TMP_HSN_MST_'+RTRIM(LTRIM(STR(@SP_ID)))


		 
		SET @CCMD=N'SELECT HSN_CODE AS  M_HSN_CODE,TAX_PERCENTAGE AS D_TAX_PERCENTAGE,RATE_CUTOFF AS D_RATE_CUTOFF,RATE_CUTOFF_TAX_PERCENTAGE AS D_RATE_CUTOFF_TAX_PERCENTAGE,DEPT_ID AS D_DEPT_ID,GST_CAL_BASIS AS M_GST_CAL_BASIS,
		 HSN_TYPE AS M_HSN_TYPE,TAXABLE_ITEM AS M_TAXABLE_ITEM,GST_VARIATION AS M_GST_VARIATION,DESCRIPTIONS AS M_DESCRIPTIONS
		 into '+@CHSNTABLENAME+'
		 FROM '+@CTEMP_TABLENAME+'  '
		 print @CCMD
		 exec sp_executesql @CCMD
 

		 EXEC SP3S_IMPORT_HSN_DATA @CHSNTABLENAME,'2017-07-01'

		SET @CCMD = N'IF OBJECT_ID('''+@CTEMP_TABLENAME+''',''U'') IS NOT NULL
						 DROP TABLE '+@CTEMP_TABLENAME
		PRINT @CCMD
		EXEC SP_EXECUTESQL @CCMD
	   
   
		SET @CCMD = N'IF OBJECT_ID('''+@CHSNTABLENAME+''',''U'') IS NOT NULL
						 DROP TABLE '+@CHSNTABLENAME
		PRINT @CCMD
		EXEC SP_EXECUTESQL @CCMD
	   
	END



	END_PROC:
END

