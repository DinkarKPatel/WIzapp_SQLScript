CREATE PROCEDURE SP_SEND_MIRROR_TLF_DATA_NEW --(LocId 3 digit change only increased the parameter width by Sanjay:01-11-2024)
	 @CUPLOADEDXNID VARCHAR(50)
	,@CCURLOCID VARCHAR(4)	
	,@BACKNOWLEDGE BIT=0 
	,@CERRMSG VARCHAR(1000) OUTPUT
--WITH ENCRYPTION	
AS
/*
	SP_SEND_MIRROR_TLF_DATA_NEW : THIS PROCEDURE WILL SEND WHOLESALE DATA FROM LOCATION TO HO.
*/
BEGIN
	DECLARE @CMEMOID VARCHAR(50),@CSTEP VARCHAR(5)
BEGIN TRY 	
	SET @CSTEP=0
	
	SET @CMEMOID = @CUPLOADEDXNID
	---- IF NO MEMO FOUND , JUST END THE PROCESS
	IF ISNULL(@CMEMOID,'')=''
	GOTO END_PROC

	IF NOT EXISTS (SELECT TOP 1 * FROM TILL_LIFTS WHERE memo_id=@CMEMOID)
	BEGIN
		SET @CERRMSG='INVALID MEMO ID :'+@CMEMOID
		GOTO END_PROC
	END

LBLTABLEINFO:
	SET @CSTEP=50
	---- POPULATE LIST OF TABLES 

	IF @BACKNOWLEDGE=1
		GOTO END_PROC
		
	SET @CSTEP=55
	SELECT DISTINCT 'TLF_TILL_LIFTS_MIRROR' AS target_tablename,A.*,@CMEMOID as XN_ID FROM TILL_LIFTS A (NOLOCK) WHERE A.memo_id=@CMEMOID
	

	
END TRY
BEGIN CATCH
	SET @CERRMSG='P: SP_SEND_MIRROR_TLF_DATA_NEW, STEP:'+@CSTEP+', MESSAGE:'+ERROR_MESSAGE()
	GOTO END_PROC
END CATCH 		

END_PROC:

END
---END OF PROCEDURE - SP_SEND_MIRROR_TLF_DATA_NEW
