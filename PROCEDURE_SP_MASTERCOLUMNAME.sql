CREATE PROC SP_MASTERCOLUMNAME
AS
BEGIN
SELECT 'SECTION_NAME' AS COLUMN_NAME, 'SECTION NAME'AS DISPLAYNAME,'SECTIONM' AS TABLENAME ,'SECTION_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'SUB_SECTION_NAME' AS COLUMN_NAME, 'SUB SECTION NAME'AS DISPLAYNAME,'SECTIOND' AS TABLENAME ,'SUB_SECTION_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'ARTICLE_NAME' AS COLUMN_NAME, 'ARTICLE NAME'AS DISPLAYNAME ,'ARTICLE' AS TABLENAME,'ARTICLE_CODE' AS PRIMARY_COL
UNION ALL
--SELECT 'ATTRM-'+ATTRIBUTE_NAME AS COLUMN_NAME ,'ATTRM-'+ATTRIBUTE_NAME  AS DISPLAYNAME ,'ATTRM' AS TABLENAME,'ATTRIBUTE_CODE' AS PRIMARY_COL
--FROM ATTRM  WHERE ATTRIBUTE_NAME<>''
SELECT 'ATTRM-'+TABLE_CAPTION AS COLUMN_NAME ,'ATTRM-'+TABLE_CAPTION  AS DISPLAYNAME ,UPPER(TABLE_NAME) AS TABLENAME,UPPER(REPLACE (COLUMN_NAME,'NAME','CODE')) AS PRIMARY_COL
FROM CONFIG_ATTR  WHERE TABLE_CAPTION<>''
UNION ALL
SELECT 'PREFIX_NAME' AS COLUMN_NAME, 'PREFIX NAME'AS DISPLAYNAME,'PREFIX' AS TABLENAME ,'PREFIX_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'ARTICLE_NO' AS COLUMN_NAME, 'ARTICLE NO'AS DISPLAYNAME,'ARTICLE' AS TABLENAME ,'ARTICLE_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'ONLINE_PRODUCT_CODE' AS COLUMN_NAME, 'ONLINE PRODUCT'AS DISPLAYNAME,'SKU' AS TABLENAME,'PRODUCT_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'AC_NAME' AS COLUMN_NAME, 'LEDGER NAME'AS DISPLAYNAME , 'LM01106' AS TABLENAME ,'AC_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'USER_CUSTOMER_CODE' AS COLUMN_NAME, 'CUSTOMER ID'AS DISPLAYNAME , 'CUSTDYM' AS TABLENAME ,'CUSTOMER_CODE' AS PRIMARY_COL
UNION ALL
SELECT 'HSN_CODE' AS COLUMN_NAME, 'HSN CODE'AS DISPLAYNAME , 'HSN_MST' AS TABLENAME ,'HSN_CODE' AS PRIMARY_COL
UNION ALL
 SELECT (CASE WHEN CONFIG_OPTION='PARA1_caption' THEN 'PARA1_NAME' 
              WHEN CONFIG_OPTION='PARA2_caption' THEN 'PARA2_NAME' 
              WHEN CONFIG_OPTION='PARA3_caption' THEN 'PARA3_NAME' 
              WHEN CONFIG_OPTION='PARA4_caption' THEN 'PARA4_NAME'
              WHEN CONFIG_OPTION='PARA5_caption' THEN 'PARA5_NAME'
              WHEN CONFIG_OPTION='PARA6_caption' THEN 'PARA6_NAME'
              END)AS COLUMN_NAME,
              VALUE AS DISPLAYNAME ,
             (CASE WHEN CONFIG_OPTION='PARA1_caption' THEN 'PARA1' 
              WHEN CONFIG_OPTION='PARA2_caption' THEN 'PARA2' 
              WHEN CONFIG_OPTION='PARA3_caption' THEN 'PARA3' 
              WHEN CONFIG_OPTION='PARA4_caption' THEN 'PARA4'
              WHEN CONFIG_OPTION='PARA5_caption' THEN 'PARA5'
              WHEN CONFIG_OPTION='PARA6_caption' THEN 'PARA6'
              END)AS TABLENAME,
               (CASE WHEN CONFIG_OPTION='PARA1_caption' THEN 'PARA1_CODE' 
              WHEN CONFIG_OPTION='PARA2_caption' THEN 'PARA2_CODE' 
              WHEN CONFIG_OPTION='PARA3_caption' THEN 'PARA3_CODE' 
              WHEN CONFIG_OPTION='PARA4_caption' THEN 'PARA4_CODE'
              WHEN CONFIG_OPTION='PARA5_caption' THEN 'PARA5_CODE'
              WHEN CONFIG_OPTION='PARA6_caption' THEN 'PARA6_CODE'
              END)AS PRIMARY_COL
 FROM CONFIG 
 WHERE CONFIG_OPTION IN('PARA1_caption','PARA2_caption','PARA3_caption','PARA4_caption','PARA5_caption','PARA6_caption')
END
--END PROCEDURES  SP_MASTERCOLUMNAME
