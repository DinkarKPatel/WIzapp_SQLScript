CREATE FUNCTION FN_GST_ACCOUNTS_CONFIG (@XN_TYPE VARCHAR(40))
RETURNS @TBLACCOUNTS_CONFIG TABLE (XN_TYPE VARCHAR(20),GST_PERCENTAGE NUMERIC(10,2),[CGST_TAX_AC_CODE] VARCHAR(10),[IGST_TAX_AC_CODE] VARCHAR(10),[IGST_XN_AC_CODE] VARCHAR(10),[LOCAL_GST_XN_AC_CODE] VARCHAR(10),[SGST_TAX_AC_CODE] VARCHAR(10))
BEGIN
	
	INSERT INTO @TBLACCOUNTS_CONFIG(XN_TYPE,GST_PERCENTAGE,[CGST_TAX_AC_CODE],[IGST_TAX_AC_CODE],[IGST_XN_AC_CODE],[LOCAL_GST_XN_AC_CODE],[SGST_TAX_AC_CODE])
	SELECT *
	FROM 
	(
	SELECT XN_TYPE, GST_PERCENTAGE ,COLUMNNAME,VALUE
	FROM GST_ACCOUNTS_CONFIG_DET_2
	WHERE XN_TYPE=@XN_TYPE
	GROUP BY XN_TYPE,GST_PERCENTAGE,COLUMNNAME,VALUE
	) A
	PIVOT (MAX(VALUE) FOR COLUMNNAME IN ([CGST_TAX_AC_CODE],[IGST_TAX_AC_CODE],[IGST_XN_AC_CODE],[LOCAL_GST_XN_AC_CODE],[SGST_TAX_AC_CODE])) AS PTABLE

RETURN
END
