CREATE PROCEDURE SP_SEND_MIRROR_STKCNT_DATA_NEW --(LocId 3 digit change only increased the parameter width by Sanjay:01-11-2024)
(	
	 @CREQXNID VARCHAR(50)
    ,@CCURLOCID VARCHAR(4)
	,@BACKNOWLEDGE BIT=0
	,@CERRMSG VARCHAR(1000) OUTPUT
)	
--WITH ENCRYPTION
AS 
/*
	SP_SEND_MIRROR_ARC_DATA_208_05_02_14 : THIS PROCEDURE WILL SEND APPROVAL RETURN DATA FROM LOCATION TO HO.
*/
BEGIN
	DECLARE @CMEMOID VARCHAR(50),
	@BRECFOUND BIT,@CSTEP VARCHAR(5),@CFILTERCONDITION VARCHAR(MAX),@CCUTOFFDATE VARCHAR(20)
	,@CKEYFIELD VARCHAR(100),@BPENDINGMSTFOUND BIT
BEGIN TRY 	
	---- CALL ACKNOWLEDGEMENT OF MEMO SUCCESSFUL MERGING AT MIRRORING SERVER
	
	SET @CSTEP=10
	SET @CMEMOID=@CREQXNID
	
	
LBLTABLEINFO:			
	---- POPULATE LIST OF TABLES 
/*ARC01106,LM01106,LMP01106,HD01106,CUSTDYM,AREA,CITY,STATE,EMPLOYEE,PAYMODE_XN_DET,PAYMODE_MST,PAYMODE_GRP_MST*/
	
	
	IF @BACKNOWLEDGE=1
		GOTO END_PROC
		
	SET @CSTEP=50
	---- SEND THE ARC MEMO MASTER TABLE
	SELECT DISTINCT 'stkcnt_MANUAL_STOCK_COUNT_XN_mst_upload' AS TARGET_TABLENAME,*,@CMEMOID AS XN_ID 
	FROM MANUAL_STOCK_COUNT_XN_mst (NOLOCK) WHERE memo_id=@CMEMOID
	
	SET @CSTEP=55
	---- SEND THE WSL_ORDER_ADV_RECEIPT RELATED TO ARC TABLE  -
	SELECT DISTINCT 'stkcnt_MANUAL_STOCK_COUNT_XN_det_upload' AS TARGET_TABLENAME,* FROM MANUAL_STOCK_COUNT_XN_det (NOLOCK)
	WHERE MEMO_ID=@CMEMOID
	
END TRY
BEGIN CATCH
	SET @CERRMSG='P: SP_SEND_MIRROR_STKCNT_DATA_NEW, STEP:'+@CSTEP+', MESSAGE:'+ERROR_MESSAGE()
	GOTO END_PROC
END CATCH 		

END_PROC:

END
---END OF PROCEDURE - SP_SEND_MIRROR_STKCNT_DATA_NEW