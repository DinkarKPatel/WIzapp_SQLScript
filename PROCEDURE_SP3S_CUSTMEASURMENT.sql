CREATE PROC SP3S_CUSTMEASURMENT    
(      
 @NQUERYID  NUMERIC(3,0)  ,
 @CWHERE VARCHAR(100)    
       
)
      
AS            
BEGIN
           
IF @NQUERYID=1            
GOTO LBL1   
ELSE IF @NQUERYID=2
GOTO LBL2 
ELSE IF @NQUERYID=3
GOTO LBL3 
	       
  
LBL1:  
     
     
    SELECT A.*,ARTICLE_NO,ARTICLE_NAME,
	C.M_NAME
	FROM CUST_MEASURMENT_DET A (NOLOCK)
	JOIN MEASUREMENT_MST C (NOLOCK) ON A.M_CODE= C.M_CODE
	JOIN ARTICLE D (NOLOCK) ON A.ARTICLE_CODE= D.ARTICLE_CODE	
	WHERE A.CUSTOMER_CODE= @CWHERE ORDER BY ARTICLE_NO,C.ORDER_NO
       
		
   GOTO LAST 
         
   
   LBL2:  
   
	
	SELECT DISTINCT A.ARTICLE_CODE,ARTICLE_NO,ARTICLE_NAME
	FROM ARTICLE_MEASUREMENTS A (NOLOCK)
	JOIN ARTICLE D  (NOLOCK) ON A.ARTICLE_CODE= D.ARTICLE_CODE
	WHERE D.INACTIVE=0	
	
	GOTO LAST 
	
	LBL3:  
   	
    SELECT DISTINCT A.ARTICLE_CODE,C.M_NAME ,C.M_CODE,C.ORDER_NO
	FROM ARTICLE_MEASUREMENTS A (NOLOCK)
	JOIN MEASUREMENT_MST C (NOLOCK) ON A.M_CODE= C.M_CODE	
	WHERE C.INACTIVE =0 AND A.ARTICLE_CODE= @CWHERE 
	ORDER BY C.ORDER_NO
	
	GOTO LAST 
               
   
 LAST:              
END
