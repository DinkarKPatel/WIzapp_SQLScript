CREATE PROCEDURE SPPPC_TERM_CONDITION
(
 @NQUERYID INT=0,
 @CXN_TYPE VARCHAR(100)='',
 @CMEMO_ID VARCHAR(100)='',
 @CJOB_CODE VARCHAR(10)=''
)
AS
BEGIN
    
   IF @NQUERYID=1
      GOTO LBLXNTYPE
   ELSE IF @NQUERYID=2
      GOTO LBLMST
   ELSE IF @NQUERYID=3
      GOTO LBLDET
   ELSE IF @NQUERYID=4
      GOTO LBLJOBS
   ELSE
   GOTO END_PROC
   
   LBLXNTYPE:
       
       SELECT 'PO' AS XN_TYPE
       UNION 
       SELECT 'JWI' AS XN_TYPE
   
   GOTO END_PROC
   
   LBLMST:
      
      SELECT A.MEMO_ID,A.MEMO_NO,A.MEMO_DT,A.LAST_UPDATE,
      A.XN_TYPE, A.JOB_CODE,JOBS.JOB_NAME,A.TERM_NAME
      ,CASE WHEN ISNULL(A.CANCELLED,0)  = 0 THEN 0 ELSE 1 END AS [CANCELLED]--ADD BY JAI RAM KUMAR
      FROM PPC_TERM_CONDITION_MST A
      LEFT JOIN JOBS ON JOBS.JOB_CODE=A.JOB_CODE
      WHERE (@CMEMO_ID='' OR A.MEMO_ID=@CMEMO_ID)
      AND (@CJOB_CODE='' OR A.JOB_CODE=@CJOB_CODE)
      AND (@CXN_TYPE='' OR A.XN_TYPE=@CXN_TYPE)
   
   GOTO END_PROC
   
   LBLDET:
   
   SELECT A.MEMO_ID,A.ROW_ID,A.REMARKS
   FROM PPC_TERM_CONDITION_DET A
   WHERE (@CMEMO_ID='' OR A.MEMO_ID=@CMEMO_ID)
   
   GOTO END_PROC
   
   
   LBLJOBS:
      
      
      SELECT JOB_CODE,JOB_NAME
      FROM JOBS
      WHERE JOB_CODE<>'0000000'
      ORDER BY JOB_NAME
   
   GOTO END_PROC
   
   
   END_PROC:

END
