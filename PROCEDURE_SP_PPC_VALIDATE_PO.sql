CREATE PROCEDURE SP_PPC_VALIDATE_PO 
(
  @CPO_ID VARCHAR(100)
)
AS
BEGIN 
    
    DECLARE @CERRORMSG VARCHAR(1000)
    SET @CERRORMSG=''
	IF OBJECT_ID ('TEMPDB..#TMPPO','U') IS NOT NULL
			DROP TABLE #TMPPO
					 
		SELECT DISTINCT A.PO_ID  
			INTO #TMPPO
		FROM PPC_POD01106 A JOIN PPC_POM01106 B ON A.PO_ID=B.PO_ID
		JOIN PPC_PID01106 C ON A.ROW_ID =C.PO_ROW_ID 
		JOIN PPC_PIM01106 D ON C.MRR_ID=D.MRR_ID
		WHERE D.CANCELLED =0 AND B.PO_ID=@CPO_ID

		IF EXISTS (SELECT TOP 1 'U' FROM #TMPPO)
		BEGIN
			SET @CERRORMSG='PURCHASE HAS BEEN GENERATED........CANNOT EDIT'
			GOTO END_PROC
		END
	
	
	END_PROC:	 
	SELECT @CERRORMSG AS ERRMSG	


END
