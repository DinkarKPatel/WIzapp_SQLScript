CREATE VIEW VW_STK_RECEIVE_LIST 

AS 
SELECT DISTINCT T1.MEMO_NO 
,T1.MEMO_DT AS MEMO_DATE 
,ISNULL(T6.MEMO_NO,'') AS WORK_ORDER_MEMO_NO
,(CASE WHEN T6.MEMO_DT <> '' THEN CONVERT(CHAR(10),ISNULL(T6.MEMO_DT,''),105) ELSE ''  END) AS WORK_ORDER_DATE
,ISNULL(T6.REF_NO,'') AS WORK_ORDER_REFNO ,ART.ARTICLE_NO AS SET_NO,ART.ARTICLE_NAME AS SET_NAME
,T3.DEPARTMENT_NAME AS SOURCE_DEPARTMENT_NAME
,T33.DEPARTMENT_NAME AS TARGET_DEPARTMENT_NAME
,CASE WHEN T1.CANCELLED = 0 THEN '' ELSE 'CANCELLED' END AS CANCELLED
,T1.TARGET_DEPARTMENT_ID,T1.MEMO_ID,T1.FIN_YEAR
FROM PRD_STK_RECEIVE_MST T1
JOIN PRD_STK_RECEIVE_DET DET ON T1.MEMO_ID=DET.MEMO_ID
JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID = T1.SOURCE_DEPARTMENT_ID
JOIN PRD_DEPARTMENT_MST T33 ON T33.DEPARTMENT_ID = T1.TARGET_DEPARTMENT_ID
JOIN PRD_WO_MST T6 ON T6.MEMO_ID=DET.REF_WO_ID
JOIN ARTICLE ART ON ART.ARTICLE_CODE=T6.ARTICLE_SET_CODE
