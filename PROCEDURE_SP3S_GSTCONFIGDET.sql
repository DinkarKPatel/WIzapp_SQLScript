CREATE PROCEDURE SP3S_GSTCONFIGDET
(
	@CXNTYPE		VARCHAR(10)
)
AS
BEGIN
	SELECT DISTINCT H.TAX_PERCENTAGE AS GST_PERCENTAGE,MST.XN_TYPE,
	ISNULL(MST.IGST_XN_AC_CODE,'0000000000') AS IGST_XN_AC_CODE,
	ISNULL(MST.IGST_TAX_AC_CODE,'0000000000') AS IGST_TAX_AC_CODE,
	ISNULL(MST.LOCAL_GST_XN_AC_CODE,'0000000000') AS LOCAL_GST_XN_AC_CODE,
	ISNULL(MST.CGST_TAX_AC_CODE,'0000000000') AS CGST_TAX_AC_CODE,
	ISNULL(MST.SGST_TAX_AC_CODE,'0000000000') AS SGST_TAX_AC_CODE ,
	A.AC_NAME AS IGSTACNAME,B.AC_NAME AS IGSTTAXACNAME,C.AC_NAME AS LOCAL_GST_XN_AC_NAME,
	D.AC_NAME AS CGSTTAXACNAME,F.AC_NAME AS SGSTTAXACNAME
	FROM HSN_DET H
    JOIN GST_POSTING_CONFIG MST ON H.TAX_PERCENTAGE=MST.GST_PERCENTAGE 
	LEFT OUTER JOIN LM01106 A ON A.AC_CODE=MST.IGST_XN_AC_CODE
	LEFT OUTER JOIN LM01106 B ON B.AC_CODE=MST.IGST_TAX_AC_CODE
	LEFT OUTER JOIN LM01106 C ON C.AC_CODE=MST.LOCAL_GST_XN_AC_CODE
	LEFT OUTER JOIN LM01106 D ON D.AC_CODE=MST.CGST_TAX_AC_CODE
	LEFT OUTER JOIN  LM01106 F ON F.AC_CODE=MST.SGST_TAX_AC_CODE 
	WHERE MST.XN_TYPE =@CXNTYPE 
	UNION 
	SELECT DISTINCT H.RATE_CUTOFF_TAX_PERCENTAGE AS GST_PERCENTAGE,MST.XN_TYPE,
	ISNULL(MST.IGST_XN_AC_CODE,'0000000000') AS IGST_XN_AC_CODE,
	ISNULL(MST.IGST_TAX_AC_CODE,'0000000000') AS IGST_TAX_AC_CODE,
	ISNULL(MST.LOCAL_GST_XN_AC_CODE,'0000000000') AS LOCAL_GST_XN_AC_CODE,
	ISNULL(MST.CGST_TAX_AC_CODE,'0000000000') AS CGST_TAX_AC_CODE,
	ISNULL(MST.SGST_TAX_AC_CODE,'0000000000') AS SGST_TAX_AC_CODE ,
	A.AC_NAME AS IGSTACNAME,B.AC_NAME AS IGSTTAXACNAME,C.AC_NAME AS LOCAL_GST_XN_AC_NAME,D.AC_NAME AS CGSTTAXACNAME,
	F.AC_NAME AS SGSTTAXACNAME 
	FROM HSN_DET H 
	JOIN GST_POSTING_CONFIG MST ON H.RATE_CUTOFF_TAX_PERCENTAGE=MST.GST_PERCENTAGE 
	LEFT OUTER JOIN LM01106 A ON A.AC_CODE=MST.IGST_XN_AC_CODE 
	LEFT OUTER JOIN LM01106 B ON B.AC_CODE=MST.IGST_TAX_AC_CODE 
	LEFT OUTER JOIN LM01106 C ON C.AC_CODE=MST.LOCAL_GST_XN_AC_CODE 
	LEFT OUTER JOIN LM01106 D ON D.AC_CODE=MST.CGST_TAX_AC_CODE 
	LEFT OUTER JOIN  LM01106 F ON F.AC_CODE=MST.SGST_TAX_AC_CODE 
	WHERE MST.XN_TYPE=@CXNTYPE
	UNION 
	SELECT DISTINCT H.TAX_PERCENTAGE AS GST_PERCENTAGE,@CXNTYPE XN_TYPE,
	ISNULL(MST.IGST_XN_AC_CODE,'0000000000') AS IGST_XN_AC_CODE,
	ISNULL(MST.IGST_TAX_AC_CODE,'0000000000') AS IGST_TAX_AC_CODE,
	ISNULL(MST.LOCAL_GST_XN_AC_CODE,'0000000000') AS LOCAL_GST_XN_AC_CODE,
	ISNULL(MST.CGST_TAX_AC_CODE,'0000000000') AS CGST_TAX_AC_CODE,
	ISNULL(MST.SGST_TAX_AC_CODE,'0000000000') AS SGST_TAX_AC_CODE ,
	'' AS IGSTACNAME,'' AS IGSTTAXACNAME,'' AS LOCAL_GST_XN_AC_NAME,
	'' AS CGSTTAXACNAME,'' AS SGSTTAXACNAME  
	FROM HSN_DET H 
	LEFT OUTER JOIN GST_POSTING_CONFIG MST  ON H.TAX_PERCENTAGE=MST.GST_PERCENTAGE  AND MST.XN_TYPE=@CXNTYPE 
	WHERE MST.GST_PERCENTAGE IS NULL 
	UNION 
	SELECT DISTINCT H.RATE_CUTOFF_TAX_PERCENTAGE AS GST_PERCENTAGE,@CXNTYPE XN_TYPE,ISNULL(MST.IGST_XN_AC_CODE,'0000000000') AS IGST_XN_AC_CODE,
	ISNULL(MST.IGST_TAX_AC_CODE,'0000000000') AS IGST_TAX_AC_CODE,ISNULL(MST.LOCAL_GST_XN_AC_CODE,'0000000000') AS LOCAL_GST_XN_AC_CODE,
	ISNULL(MST.CGST_TAX_AC_CODE,'0000000000') AS CGST_TAX_AC_CODE,
	ISNULL(MST.SGST_TAX_AC_CODE,'0000000000') AS SGST_TAX_AC_CODE , 
	'' AS IGSTACNAME,'' AS IGSTTAXACNAME,'' AS LOCAL_GST_XN_AC_NAME,'' AS CGSTTAXACNAME,'' AS SGSTTAXACNAME  
	FROM HSN_DET H 
	LEFT OUTER JOIN GST_POSTING_CONFIG MST  ON H.RATE_CUTOFF_TAX_PERCENTAGE=MST.GST_PERCENTAGE  AND MST.XN_TYPE=@CXNTYPE 
	WHERE MST.GST_PERCENTAGE IS NULL
END
