CREATE PROCEDURE SPSIS_SYNCH_DATA_SINGLECHANNEL
@CXNTYPE VARCHAR(20),
@CDEPTID VARCHAR(5)/*Rohit 01-11-2024*/,
@nSpId VARCHAR(50),
@CSISDEPTID VARCHAR(5)/*Rohit 01-11-2024*/
AS
BEGIN


	
	DECLARE @nInvmode NUMERIC(1,0),@CCURLOCID VARCHAR(5),@CHOLOCID VARCHAR(5),@CERRMSG VARCHAR(MAX)

	SELECT TOP 1 @CCURLOCID=VALUE FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID'	
	SELECT TOP 1 @CHOLOCID=VALUE FROM CONFIG WHERE CONFIG_OPTION='HO_LOCATION_ID'	
	
	DECLARE @tOutput TABLE (errmsg varchar(max),missing_memo_id VARCHAR(50))

	IF EXISTS (SELECT TOP 1 memo_id FROM tblMissingMemos (NOLOCK) WHERE sp_id=@nSpId)
		DELETE FROM tblMissingMemos WITH (ROWLOCK) WHERE sp_id=@nSpid
	
	---- ONLY CUSTOMER DATA IS ALLOWED TO BE MERGED AT LOCATION
	IF @CCURLOCID<>@CHOLOCID 
	BEGIN
		SET @CERRMSG='TRANSACTION MERGING CAN ONLY BE DONE AT HEAD OFFICE....'
		GOTO EXIT_PROC
	END 
	
	
	PRINT 'END OF SP3S_CHECK_PARENTDATA'
	   		
	

	IF @CXNTYPE='PUR'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_PUR_OPT
		@nSpId=@nSPId, 
		@CDEPTID=@CDEPTID,
		@CSISDEPTID=@CSISDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	else IF @CXNTYPE='SLS'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_SLSNEW_OPT
		@nSpId=@nSPId, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='wsl'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_WSL_OPT
		@nSpId=@nSPId, 
		@CDEPTID=@CDEPTID,
		@CSISDEPTID=@CSISDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='prt'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_PRT_OPT
		@nSpId=@nSPId, 
		@CDEPTID=@CDEPTID,
		@CSISDEPTID=@CSISDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='WSR'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_WSR_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CSISDEPTID=@CSISDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='APP'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_APP_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='APR'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_APR_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='WPS'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_WPS_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='RPS'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_RPS_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='DNPS'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_DNPS_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='JWI'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_JWI_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='JWR'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_JWR_OPT
		@NSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='CNC'
	BEGIN
		EXEC SPSIS_SYNCH_UPLOADDATA_CNC_OPT
		@CSPID=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
	ELSE IF @CXNTYPE='CLS'
	BEGIN
		EXEC SPsis_SYNCH_UPLOADDATA_cls_OPT
		@nSpId=@NSPID, 
		@CDEPTID=@CDEPTID,
		@CERRMSG=@CERRMSG OUTPUT 				
	END	
EXIT_PROC:
	    
		DELETE A FROM SIS_SKUNAMES_UPLOAD A WITH (NOLOCK) WHERE SP_ID=@NSPID
		select @CERRMSG as errmsg,'' AS MISSING_MEMO_ID
	
END
----- 'END OF CREATING PROCEDURE SPSIS_SYNCH_DATA_SINGLECHANNEL'
