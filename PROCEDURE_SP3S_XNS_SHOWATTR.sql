create PROCEDURE SP3S_XNS_SHOWATTR(@nMode int=1,@cFilter VARCHAR(MAX))  
AS  
BEGIN  
SET NOCOUNT ON  
DECLARE @SQL VARCHAR(MAX),@ERR VARCHAR(100)=''  
IF @cFilter='' SET @ERR='NO '+CASE @nMode WHEN 1 THEN 'Barcode' WHEN 2 THEN 'Article' WHEN 3 THEN 'Style' END+' is passed'  
IF @ERR<>'' GOTO EXT_PROC  
SET @cFilter=''''+REPLACE(@cFilter,',',''',''')+''''  

SET @SQL=';with cte as( SELECT distinct '+CASE @nMode WHEN 1 THEN 'a.PRODUCT_CODE' WHEN 2 THEN 'F.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' as col_name
 ,F.ATTR1_KEY_NAME,F.ATTR2_KEY_NAME,F.ATTR3_KEY_NAME,F.ATTR4_KEY_NAME
       ,F.ATTR5_KEY_NAME,F.ATTR6_KEY_NAME,F.ATTR7_KEY_NAME,F.ATTR8_KEY_NAME,F.ATTR9_KEY_NAME
	,F.ATTR10_KEY_NAME,F.ATTR11_KEY_NAME,F.ATTR12_KEY_NAME,F.ATTR13_KEY_NAME,F.ATTR14_KEY_NAME
	,F.ATTR15_KEY_NAME,F.ATTR16_KEY_NAME,F.ATTR17_KEY_NAME,F.ATTR18_KEY_NAME,F.ATTR19_KEY_NAME
	,F.ATTR20_KEY_NAME,F.ATTR21_KEY_NAME,F.ATTR22_KEY_NAME,F.ATTR23_KEY_NAME,F.ATTR24_KEY_NAME,F.ATTR25_KEY_NAME FROM SKU A (NOLOCK) JOIN ART_NAMES F (NOLOCK) ON F.ARTICLE_CODE= A.ARTICLE_CODE      
 JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= A.PARA3_CODE ' +CHAR(13)+ 'WHERE '+CASE @nMode WHEN 1 THEN 'a.PRODUCT_CODE' WHEN 2 THEN 'F.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')'   +') SELECT col_name  AS '+CASE @nMode WHEN 1 THEN 'Product_code' WHEN 2 THEN 'ARTICLE_NO' WHEN 3 THEN 'STYLE_NAME' END+',
 b.table_caption as ATTRIBUTE_NAME,KEY_NAME from cte 
 Unpivot(KEY_NAME For ATTRIBUTE_NAME IN (ATTR1_KEY_NAME,ATTR2_KEY_NAME,ATTR3_KEY_NAME,ATTR4_KEY_NAME
       ,ATTR5_KEY_NAME,ATTR6_KEY_NAME,ATTR7_KEY_NAME,ATTR8_KEY_NAME,ATTR9_KEY_NAME
	,ATTR10_KEY_NAME,ATTR11_KEY_NAME,ATTR12_KEY_NAME,ATTR13_KEY_NAME,ATTR14_KEY_NAME
	,ATTR15_KEY_NAME,ATTR16_KEY_NAME,ATTR17_KEY_NAME,ATTR18_KEY_NAME,ATTR19_KEY_NAME
	,ATTR20_KEY_NAME,ATTR21_KEY_NAME,ATTR22_KEY_NAME,ATTR23_KEY_NAME,ATTR24_KEY_NAME,ATTR25_KEY_NAME)) AS H	join config_attr b on h.ATTRIBUTE_NAME=b.column_name	where b.table_caption<>'''' '

	print @SQL
	exec ( @SQL)


/*

IF OBJECT_ID('tempdb..##SHOW_ATTR') IS NOT NULL DROP TABLE ##SHOW_ATTR  
CREATE TABLE ##SHOW_ATTR(FILTER_ON VARCHAR(1000),ATTRIBUTE_NAME VARCHAR(1000),KEY_NAME VARCHAR(1000))  
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'F.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.ATTRIBUTE_NAME, D.KEY_NAME    
FROM ART_ATTR A (NOLOCK)       
JOIN ATTRM C (NOLOCK) ON A.ATTRIBUTE_CODE = C.ATTRIBUTE_CODE        
JOIN ATTR_KEY D (NOLOCK) ON A.KEY_CODE = D.KEY_CODE    
JOIN SKU E (NOLOCK) ON A.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN ARTICLE F (NOLOCK) ON F.ARTICLE_CODE= E.ARTICLE_CODE      
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= F.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'F.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')'  
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL)  
  
IF @@ROWCOUNT>0 GOTO EXT_PROC  
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR1_KEY_NAME[KEY_NAME]  
FROM ARTICLE_FIX_ATTR AF (NOLOCK)   
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN ATTR1_MST A (NOLOCK) ON A.ATTR1_KEY_CODE=AF.ATTR1_KEY_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR1_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')'  

PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR2_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR2_MST A (NOLOCK) ON A.ATTR2_KEY_CODE=AF.ATTR2_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR2_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR3_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR3_MST A (NOLOCK) ON A.ATTR3_KEY_CODE=AF.ATTR3_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR3_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  

'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR4_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR4_MST A (NOLOCK) ON A.ATTR4_KEY_CODE=AF.ATTR4_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR4_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  


'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR5_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR5_MST A (NOLOCK) ON A.ATTR5_KEY_CODE=AF.ATTR5_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR5_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  


'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR6_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR6_MST A (NOLOCK) ON A.ATTR6_KEY_CODE=AF.ATTR6_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR6_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  


'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR7_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR7_MST A (NOLOCK) ON A.ATTR7_KEY_CODE=AF.ATTR7_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR7_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR8_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR8_MST A (NOLOCK) ON A.ATTR8_KEY_CODE=AF.ATTR8_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR8_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR9_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR9_MST A (NOLOCK) ON A.ATTR9_KEY_CODE=AF.ATTR9_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR9_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE  
WHERE ART.ARTICLE_NO IN ('+@cFilter+')  '

PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR10_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR10_MST A (NOLOCK) ON A.ATTR10_KEY_CODE=AF.ATTR10_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR10_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR11_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR11_MST A (NOLOCK) ON A.ATTR11_KEY_CODE=AF.ATTR11_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR11_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR12_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR12_MST A (NOLOCK) ON A.ATTR12_KEY_CODE=AF.ATTR12_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR12_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR13_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR13_MST A (NOLOCK) ON A.ATTR13_KEY_CODE=AF.ATTR13_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR13_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR14_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR14_MST A (NOLOCK) ON A.ATTR14_KEY_CODE=AF.ATTR14_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR14_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  

'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR15_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR15_MST A (NOLOCK) ON A.ATTR15_KEY_CODE=AF.ATTR15_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR15_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR16_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR16_MST A (NOLOCK) ON A.ATTR16_KEY_CODE=AF.ATTR16_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR16_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR17_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR17_MST A (NOLOCK) ON A.ATTR17_KEY_CODE=AF.ATTR17_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR17_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  

'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR18_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR18_MST A (NOLOCK) ON A.ATTR18_KEY_CODE=AF.ATTR18_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR18_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR19_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR19_MST A (NOLOCK) ON A.ATTR19_KEY_CODE=AF.ATTR19_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR19_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR20_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR20_MST A (NOLOCK) ON A.ATTR20_KEY_CODE=AF.ATTR20_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR20_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR21_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR21_MST A (NOLOCK) ON A.ATTR21_KEY_CODE=AF.ATTR21_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR21_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
 '
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL)  
  
 

SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR22_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR22_MST A (NOLOCK) ON A.ATTR22_KEY_CODE=AF.ATTR22_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR22_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  

'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR23_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR23_MST A (NOLOCK) ON A.ATTR23_KEY_CODE=AF.ATTR23_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR23_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL) 

  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR24_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR24_MST A (NOLOCK) ON A.ATTR24_KEY_CODE=AF.ATTR24_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR24_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')  
'
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL)
  
SET @SQL='SELECT '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+',C.TABLE_CAPTION ATTRIBUTE_NAME,A.ATTR25_KEY_NAME  
FROM ARTICLE_FIX_ATTR AF (NOLOCK) JOIN ATTR25_MST A (NOLOCK) ON A.ATTR25_KEY_CODE=AF.ATTR25_KEY_CODE  
JOIN ARTICLE ART (NOLOCK) ON ART.ARTICLE_CODE=AF.ARTICLE_CODE  
JOIN CONFIG_ATTR C (NOLOCK) ON C.COLUMN_NAME=''ATTR25_KEY_NAME''  
JOIN SKU E (NOLOCK) ON ART.ARTICLE_CODE= E.ARTICLE_CODE  
JOIN PARA3 G (NOLOCK) ON G.PARA3_CODE= ART.PARA3_CODE'  
+CHAR(13)+' WHERE '+CASE @nMode WHEN 1 THEN 'E.PRODUCT_CODE' WHEN 2 THEN 'ART.ARTICLE_NO' WHEN 3 THEN 'G.PARA3_NAME' END+' IN ('+@cFilter+')'  
PRINT @SQL  
INSERT INTO ##SHOW_ATTR(FILTER_ON,ATTRIBUTE_NAME,KEY_NAME)  
EXEC(@SQL)  
  
  */
EXT_PROC:  
--SET @SQL='SELECT DISTINCT FILTER_ON AS '+CASE @nMode WHEN 1 THEN 'PRODUCT_CODE' WHEN 2 THEN 'ARTICLE_NO' WHEN 3 THEN 'STYLE_NAME' END+',ATTRIBUTE_NAME,KEY_NAME FROM ##SHOW_ATTR WHERE ISNULL(ATTRIBUTE_NAME,'''')<>'''';'  
--IF @ERR='' EXEC(@SQL) 

SELECT @ERR ERRMSG  
SET NOCOUNT OFF  
END  