
/*
CREATED BY: JAI RAM KUMAR
CREATED DATE: 13-JAN-2017 

EXEC USP_PURCHASE_NAVIGATE 'P00111700000P000000220'
*/
CREATE PROCEDURE DBO.USP_PURCHASE_NAVIGATE
(@MEMO_ID VARCHAR(100))
----WITH ENCRYPTION
AS
 BEGIN
  
  --DECLARE LOCAL VARIABLE
  DECLARE @ERROR_MSG VARCHAR(MAX)
  SET @ERROR_MSG=''
  
  IF ISNULL(@MEMO_ID,'') =''
    BEGIN
      SET @ERROR_MSG='ERROR || PLEASE ENTER MEMO ID';
      GOTO PROC_END;
    END
   --SELECT DATA FROM MILK_PURCHASE_MST TABLE
	SELECT M.AC_CODE,LV.AC_NAME AS [SUPPLIER_NAME]
	 ,ISNULL(ADDRESS0,'')+' '+ ISNULL(ADDRESS1,'')+' '+ ISNULL(ADDRESS2,'') AS [ADDRESS]
	 ,M.MEMO_ID,M.MEMO_NO,M.MEMO_DT,M.FIN_YEAR
	 ,M.BILL_NO,M.BILL_DT,M.CANCELED,M.TOTAL_AMOUNT,M.LAST_UPDATE  
	FROM DBO.MILK_PURCHASE_MST M WITH(NOLOCK)
	 JOIN DBO.LMV01106 LV WITH(NOLOCK) ON M.AC_CODE=LV.AC_CODE
   WHERE M.MEMO_ID=@MEMO_ID
   --SELECT DATE FROM MILK_PURCHASE_DET TABLE
   SELECT D.MEMO_ID,D.MILK_QTY,D.FSN_QTY,D.FSN_PERCENTAGE,D.FSN_RATE
         ,D.FSN_AMOUNT,D.FAT_QTY,D.FAT_PERCENTAGE,D.FAT_RATE,D.FAT_AMOUNT ,ISNULL(D.CLR_PERCENTAGE,0) AS CLR_PERCENTAGE
   FROM DBO.MILK_PURCHASE_DET D WITH(NOLOCK)
   WHERE D.MEMO_ID=@MEMO_ID
   
   PROC_END:
   IF ISNULL(@MEMO_ID,'')=''
      BEGIN
        SELECT @ERROR_MSG AS [ERROR_MSG]
        SET @ERROR_MSG=''
      END
      
 END
 

