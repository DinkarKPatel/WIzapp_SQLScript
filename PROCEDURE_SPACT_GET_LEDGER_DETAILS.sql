CREATE PROCEDURE SPACT_GET_LEDGER_DETAILS
(
	@cAC_CODE VARCHAR(20)='',
	@dFromDt	DATETIME='',  
	@dToDt		DATETIME=''
)
AS
BEGIN
	IF EXISTS(select name from sys.tables  WHERE name='LEDGER_DETAILS' AND datediff(d,create_date,getdate())>0) OR OBJECT_ID('LEDGER_DETAILS','U') IS NULL
	BEGIN
		IF OBJECT_ID('LEDGER_DETAILS','U') IS NOT NULL
			DROP TABLE LEDGER_DETAILS
		SELECT *,CAST('' AS VARCHAR(50)) AS OPENING,CAST('' AS VARCHAR(50)) AS TOTAL_DEBIT
		,CAST('' AS VARCHAR(50)) AS TOTAL_CREDIT,CAST('' AS VARCHAR(50)) AS CLOSING
		,@dFromDt AS FROM_DATE,@dToDt AS TO_DATE
		INTO LEDGER_DETAILS
		FROM LMV01106
		WHERE 1=2
	END
	--DECLARE @dFromDt	DATETIME='',  	@dToDt		DATETIME=''
	SELECT *,CAST('' AS VARCHAR(50)) AS OPENING,CAST('' AS VARCHAR(50)) AS TOTAL_DEBIT
	,CAST('' AS VARCHAR(50)) AS TOTAL_CREDIT,CAST('' AS VARCHAR(50)) AS CLOSING
	,@dFromDt AS FROM_DATE,@dToDt AS TO_DATE
	--INTO LEDGER_DETAILS
	FROM LMV01106
	WHERE ac_code=@cAC_CODE OR ISNULL(@cAC_CODE ,'')=''


END
