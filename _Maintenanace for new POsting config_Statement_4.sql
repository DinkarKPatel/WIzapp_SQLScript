

IF NOT EXISTS (SELECT TOP 1 PAYMODE_CODE FROM GST_ACCOUNTS_CONFIG_DET_PAYMODES)
BEGIN
	IF OBJECT_ID('TEMPDB..#TMPGACDP','U') IS NOT NULL
		DROP TABLE #TMPGACDP
	
	
	SELECT DISTINCT CONVERT(VARCHAR(40),'') AS ROW_ID,LEFT(COLUMNNAME,7) AS PAYMODE_CODE, COLUMNNAME, COLUMNDESC,
	ISNULL(VALUE,'0000000000') AS VALUE
	INTO #TMPGACDP FROM GST_ACCOUNTS_CONFIG_DET_1 WHERE XN_TYPE='SLS' AND
	(COLUMNDESC  IN ('A/C','BANK A/C','COMMISSION A/C')
	OR COLUMNNAME IN ('CASH_AC_CODE','CUSTOMER_CONTROL_AC_CODE_SALE','CUSTOMER_CONTROL_AC_CODE_CN','WIZCLIP_GVS_AC_CODE'))
	
	
	UPDATE #TMPGACDP SET ROW_ID=NEWID(),COLUMNNAME=REPLACE(COLUMNNAME,'DOC_PAYMODE_CODE','DOC')
	UPDATE #TMPGACDP SET COLUMNNAME=REPLACE(COLUMNNAME,'BANK_AC_CODE','DOC')
	UPDATE #TMPGACDP SET COLUMNNAME=REPLACE(COLUMNNAME,'COMMISSION_AC_CODE','COMM')
	UPDATE #TMPGACDP SET PAYMODE_CODE='' WHERE  COLUMNNAME IN ('CASH_AC_CODE','CUSTOMER_CONTROL_AC_CODE_SALE','CUSTOMER_CONTROL_AC_CODE_CN','WIZCLIP_GVS_AC_CODE')
	
	DELETE A FROM #TMPGACDP A WHERE A.ROW_ID<>(SELECT TOP 1 ROW_ID FROM #TMPGACDP B WHERE B.COLUMNNAME=A.COLUMNNAME)
	
	INSERT GST_ACCOUNTS_CONFIG_DET_PAYMODES	(PAYMODE_CODE,COLUMNNAME,COLUMNDESC,VALUE) 
	SELECT PAYMODE_CODE, COLUMNNAME, COLUMNDESC, VALUE FROM #TMPGACDP 
END
