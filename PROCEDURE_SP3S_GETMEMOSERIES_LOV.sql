CREATE PROCEDURE SP3S_GETMEMOSERIES_LOV
@CXNTYPE		VARCHAR(20),
@CLOCID			VARCHAR(5)='',
@nXN_ITEM_TYPE	NUMERIC(5)=1
AS
BEGIN
	DECLARE @CCURLOCID VARCHAR(5)
	
	
	IF ISNULL(@CLOCID,'')=''
		SELECT TOP 1 @CCURLOCID = [VALUE] FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID'
	ELSE
		SELECT @CCURLOCID=@CLOCID
	
	if @nXN_ITEM_TYPE=0
     set @nXN_ITEM_TYPE=1
	

	IF EXISTS (SELECT TOP 1 PREFIX FROM SERIES_SETUP_MANUAL_DET A (NOLOCK) 
		JOIN SERIES_SETUP_MST B (NOLOCK) ON A.MEMO_ID=B.MEMO_ID
		WHERE XN_TYPE=@CXNTYPE AND DEPT_ID=@CCURLOCID AND (ISNULL(B.XN_ITEM_TYPE,0)=0 OR ISNULL(B.XN_ITEM_TYPE,0)=ISNULL(@nXN_ITEM_TYPE,0))
		AND A.INACTIVE=0 AND SERIES_SETUP_MODE=1)
		SELECT PREFIX AS MEMO_PREFIX 
		FROM SERIES_SETUP_MANUAL_DET A (NOLOCK) 
		JOIN SERIES_SETUP_MST B (NOLOCK) ON A.MEMO_ID=B.MEMO_ID
		WHERE XN_TYPE=@CXNTYPE AND DEPT_ID=@CCURLOCID AND (ISNULL(@nXN_ITEM_TYPE,0)=0 OR ISNULL(B.XN_ITEM_TYPE,0)=ISNULL(@nXN_ITEM_TYPE,0))
		AND A.INACTIVE=0--Ticket 04-0475 dated 04 Apr 2019
	ELSE
		SELECT PREFIX AS MEMO_PREFIX FROM SERIES_SETUP_MANUAL_DET(NOLOCK) WHERE 1=2
		
END