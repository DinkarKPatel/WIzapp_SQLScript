IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='UDPATE_MIRRORLOG_CUS_DATA' AND VALUE='1')
BEGIN
	DECLARE @CHOID CHAR(2),@CLOCID CHAR(2)
	
	SELECT @CHOID=VALUE FROM CONFIG WHERE  CONFIG_OPTION = 'HO_LOCATION_ID'
	SELECT @CLOCID=VALUE FROM CONFIG WHERE CONFIG_OPTION = 'LOCATION_ID'
	IF @CHOID <> @CLOCID
	BEGIN
		INSERT INTO MIRRORLOG (XN_TYPE,XN_ID,LAST_UPDATE)
		SELECT DISTINCT 'CUS' AS XN_TYPE,A.CUSTOMER_CODE AS XN_ID,MAX(A.LAST_UPDATE) AS  LAST_UPDATE FROM CMM01106 A 
		LEFT OUTER JOIN MIRRORLOG B  ON A.CUSTOMER_CODE = B.XN_ID
		WHERE CUSTOMER_CODE <> '000000000000' AND B.XN_ID IS NULL
		GROUP BY A.CUSTOMER_CODE
		
    END
	IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='UDPATE_MIRRORLOG_CUS_DATA')
       INSERT CONFIG (CONFIG_OPTION,VALUE,ROW_ID,LAST_UPDATE)
	   VALUES ('UDPATE_MIRRORLOG_CUS_DATA','1','',GETDATE())	
	ELSE	
		UPDATE CONFIG SET VALUE='1' WHERE CONFIG_OPTION='UDPATE_MIRRORLOG_CUS_DATA'	
		
END
