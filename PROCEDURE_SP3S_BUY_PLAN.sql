CREATE PROCEDURE SP3S_BUY_PLAN  
(  
	@NQUERYID INT   , 
	@CWHERE VARCHAR(100)
)  
AS   
BEGIN  
	IF @NQUERYID=1  
	BEGIN  
		SELECT A.MEMO_NO,C.SEASON_NAME,B.EXPIRY_DT, G.SECTION_NAME,B.BUDGET_PLAN_NAME,BUDGET_AMOUNT,CAST(ISNULL(F.BUY_PLAN_AMOUNT,0) AS NUMERIC(10,2)) AS BUY_PLAN_AMOUNT,  
		CAST((BUDGET_AMOUNT - ISNULL(F.BUY_PLAN_AMOUNT,0)) AS NUMERIC(10,2)) AS PENDING_AMOUNT   
		FROM BUDGET_PLAN_DET	A  
		JOIN BUDGET_PLAN_MST	B	ON A.MEMO_NO=B.MEMO_NO  
		JOIN SECTIONM			G	ON G.SECTION_CODE=A.SECTION_CODE 
		JOIN SEASON_MST C ON B.SEASON_ID=C.SEASON_ID
		LEFT OUTER JOIN  
		(  
			SELECT  A1.BUDGET_PLAN_MEMO_NO AS MEMO_NO, D.SECTION_NAME, D.SECTION_CODE,SUM(QUANTITY*A.PURCHASE_PRICE) AS BUY_PLAN_AMOUNT 
			FROM BUY_PLAN_DET A   
			JOIN BUY_PLAN_MST A1   ON A1.MEMO_NO=A.MEMO_NO
			JOIN ARTICLE B ON B.ARTICLE_CODE=A.ARTICLE_CODE  
			JOIN SECTIOND C ON C.SUB_SECTION_CODE=B.SUB_SECTION_CODE  
			JOIN SECTIONM D ON D.SECTION_CODE=C.SECTION_CODE
			WHERE A1.CANCELLED=0  
			GROUP BY A1.BUDGET_PLAN_MEMO_NO ,D.SECTION_CODE,D.SECTION_NAME  
		)F ON F.SECTION_CODE=A.SECTION_CODE   AND B.MEMO_NO=F.MEMO_NO
		WHERE B.CANCELLED=0 AND B.APPROVEDLEVELNO=99 --AND A.BUDGET_AMOUNT > ISNULL(F.BUY_PLAN_AMOUNT  ,0)
	END   
	ELSE IF @NQUERYID=2  
	BEGIN  
		SELECT A.MEMO_NO,B.BUDGET_PLAN_NAME,H.SEASON_NAME ,B.EXPIRY_DT
		FROM BUDGET_PLAN_DET	A  
		JOIN BUDGET_PLAN_MST	B	ON A.MEMO_NO=B.MEMO_NO  
		JOIN SECTIONM			G	ON G.SECTION_CODE=A.SECTION_CODE 
		JOIN SEASON_MST			H	ON H.SEASON_ID=B.SEASON_ID
		LEFT OUTER JOIN  
		(  
			SELECT  A1.BUDGET_PLAN_MEMO_NO AS MEMO_NO,D.SECTION_NAME, D.SECTION_CODE,SUM(QUANTITY*A.PURCHASE_PRICE) AS BUY_PLAN_AMOUNT 
			FROM BUY_PLAN_DET A 
			JOIN BUY_PLAN_MST A1   ON A1.MEMO_NO=A.MEMO_NO  
			JOIN ARTICLE B ON B.ARTICLE_CODE=A.ARTICLE_CODE  
			JOIN SECTIOND C ON C.SUB_SECTION_CODE=B.SUB_SECTION_CODE  
			JOIN SECTIONM D ON D.SECTION_CODE=C.SECTION_CODE  
			WHERE A1.CANCELLED=0
			GROUP BY A1.BUDGET_PLAN_MEMO_NO,D.SECTION_CODE,D.SECTION_NAME  
		)F ON F.SECTION_CODE=A.SECTION_CODE AND F.MEMO_NO=B.MEMO_NO   
		WHERE B.CANCELLED=0 AND B.APPROVEDLEVELNO=99 AND A.BUDGET_AMOUNT > ISNULL(F.BUY_PLAN_AMOUNT,0)
		GROUP BY A.MEMO_NO,B.BUDGET_PLAN_NAME ,H.SEASON_NAME  ,B.EXPIRY_DT
	END    
	ELSE  IF @NQUERYID=3
	BEGIN  
		SELECT A.*,B.*,C.SEASON_NAME,'' AS SP_ID 
		FROM BUY_PLAN_MST A 
		JOIN BUDGET_PLAN_MST B ON B.MEMO_NO=A.BUDGET_PLAN_MEMO_NO
		JOIN SEASON_MST C ON B.SEASON_ID=C.SEASON_ID
		WHERE A.MEMO_NO=@CWHERE
	END   
	ELSE  IF @NQUERYID=4 
	BEGIN  
		SELECT T.*,K.SECTION_NAME, J.SUB_SECTION_NAME, C.PARA1_NAME,        
		D.PARA2_NAME,E.PARA3_NAME,F.PARA4_NAME,G.PARA5_NAME,H.PARA6_NAME,
		B.ARTICLE_NO,B.ARTICLE_NAME,CONVERT(NUMERIC(14,2),T.QUANTITY*T.PURCHASE_PRICE) AS AMOUNT, '' AS SP_ID
		 ,AT1.attr1_key_name,AT2.attr2_key_name,AT3.attr3_key_name,AT4.attr4_key_name,AT5.attr5_key_name,AT6.attr6_key_name,
   AT7.attr7_key_name,AT8.attr8_key_name,AT9.attr9_key_name,AT10.attr10_key_name,AT11.attr11_key_name,AT12.attr12_key_name,
   AT13.attr13_key_name,AT14.attr14_key_name,AT15.attr15_key_name,AT16.attr16_key_name,AT17.attr17_key_name,AT18.attr18_key_name,
   AT19.attr19_key_name,AT20.attr20_key_name,AT21.attr21_key_name,AT22.attr22_key_name,AT23.attr23_key_name,AT24.attr24_key_name,
	AT25.attr25_key_name 

		FROM BUY_PLAN_DET T
		JOIN ARTICLE B (NOLOCK) ON T.ARTICLE_CODE = B.ARTICLE_CODE         
		JOIN PARA1 C (NOLOCK) ON T.PARA1_CODE = C.PARA1_CODE        
		JOIN PARA2 D (NOLOCK) ON T.PARA2_CODE = D.PARA2_CODE        
		JOIN PARA3 E (NOLOCK) ON T.PARA3_CODE = E.PARA3_CODE        
		JOIN PARA4 F (NOLOCK) ON T.PARA4_CODE = F.PARA4_CODE        
		JOIN PARA5 G (NOLOCK) ON T.PARA5_CODE = G.PARA5_CODE        
		JOIN PARA6 H (NOLOCK) ON T.PARA6_CODE = H.PARA6_CODE        
		JOIN UOM I (NOLOCK) ON B.UOM_CODE = I.UOM_CODE        
		JOIN SECTIOND J (NOLOCK) ON B.SUB_SECTION_CODE = J.SUB_SECTION_CODE        
		JOIN SECTIONM K (NOLOCK) ON J.SECTION_CODE = K.SECTION_CODE 
		LEFT OUTER JOIN article_fix_attr ATTR  (NOLOCK) ON T.article_code = ATTR.ARTICLE_CODE 
		LEFT OUTER JOIN attr1_mst at1 (NOLOCK) ON at1.attr1_key_code=ATTR.attr1_key_code
		LEFT OUTER JOIN attr2_mst at2 (NOLOCK) ON at2.attr2_key_code=ATTR.attr2_key_code
		LEFT OUTER JOIN attr3_mst at3 (NOLOCK) ON at3.attr3_key_code=ATTR.attr3_key_code
		LEFT OUTER JOIN attr4_mst at4 (NOLOCK) ON at4.attr4_key_code=ATTR.attr4_key_code
		LEFT OUTER JOIN attr5_mst at5 (NOLOCK) ON at5.attr5_key_code=ATTR.attr5_key_code
		LEFT OUTER JOIN attr6_mst at6 (NOLOCK) ON at6.attr6_key_code=ATTR.attr6_key_code
		LEFT OUTER JOIN attr7_mst at7 (NOLOCK) ON at7.attr7_key_code=ATTR.attr7_key_code
		LEFT OUTER JOIN attr8_mst at8 (NOLOCK) ON at8.attr8_key_code=ATTR.attr8_key_code
		LEFT OUTER JOIN attr9_mst at9 (NOLOCK) ON at9.attr9_key_code=ATTR.attr9_key_code
		LEFT OUTER JOIN attr10_mst at10 (NOLOCK) ON at10.attr10_key_code=ATTR.attr10_key_code
		LEFT OUTER JOIN attr11_mst at11 (NOLOCK) ON at11.attr11_key_code=ATTR.attr11_key_code
		LEFT OUTER JOIN attr12_mst at12 (NOLOCK) ON at12.attr12_key_code=ATTR.attr12_key_code
		LEFT OUTER JOIN attr13_mst at13 (NOLOCK) ON at13.attr13_key_code=ATTR.attr13_key_code
		LEFT OUTER JOIN attr14_mst at14 (NOLOCK) ON at14.attr14_key_code=ATTR.attr14_key_code
		LEFT OUTER JOIN attr15_mst at15 (NOLOCK) ON at15.attr15_key_code=ATTR.attr15_key_code
		LEFT OUTER JOIN attr16_mst at16 (NOLOCK) ON at16.attr16_key_code=ATTR.attr16_key_code
		LEFT OUTER JOIN attr17_mst at17 (NOLOCK) ON at17.attr17_key_code=ATTR.attr17_key_code
		LEFT OUTER JOIN attr18_mst at18 (NOLOCK) ON at18.attr18_key_code=ATTR.attr18_key_code
		LEFT OUTER JOIN attr19_mst at19 (NOLOCK) ON at19.attr19_key_code=ATTR.attr19_key_code
		LEFT OUTER JOIN attr20_mst at20 (NOLOCK) ON at20.attr20_key_code=ATTR.attr20_key_code
		LEFT OUTER JOIN attr21_mst at21 (NOLOCK) ON at21.attr21_key_code=ATTR.attr21_key_code
		LEFT OUTER JOIN attr22_mst at22 (NOLOCK) ON at22.attr22_key_code=ATTR.attr22_key_code
		LEFT OUTER JOIN attr23_mst at23 (NOLOCK) ON at23.attr23_key_code=ATTR.attr23_key_code
		LEFT OUTER JOIN attr24_mst at24 (NOLOCK) ON at24.attr24_key_code=ATTR.attr24_key_code
		LEFT OUTER JOIN attr25_mst at25(NOLOCK) ON at25.attr25_key_code=ATTR.attr25_key_code
		WHERE MEMO_NO=@CWHERE
	END 
	ELSE  IF @NQUERYID=5
	BEGIN  
		SELECT B.ARTICLE_NO,B.ARTICLE_NAME,B.ARTICLE_CODE,K.SECTION_NAME,J.SUB_SECTION_NAME
		FROM ARTICLE B 
		JOIN SECTIOND			J (NOLOCK) ON B.SUB_SECTION_CODE = J.SUB_SECTION_CODE        
		JOIN SECTIONM			K (NOLOCK) ON J.SECTION_CODE = K.SECTION_CODE 
		JOIN BUDGET_PLAN_DET	L (NOLOCK) ON L.SECTION_CODE=K.SECTION_CODE
		WHERE L.MEMO_NO=@CWHERE
		GROUP BY B.ARTICLE_NO,B.ARTICLE_NAME,B.ARTICLE_CODE,K.SECTION_NAME,J.SUB_SECTION_NAME
		ORDER BY B.ARTICLE_NO,B.ARTICLE_NAME,B.ARTICLE_CODE,K.SECTION_NAME,J.SUB_SECTION_NAME
	END      
	ELSE  IF @NQUERYID=6
	BEGIN  
		SELECT PARA1_CODE,'---ALL---' AS PARA1_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA1  
		WHERE PARA1_CODE='0000000'
		UNION ALL
		SELECT PARA1_CODE,PARA1_NAME,ROW_NUMBER() OVER (ORDER BY PARA1_NAME) AS SRNO
		FROM PARA1  
		WHERE PARA1_NAME<>'' AND PARA1_CODE<>'0000000' 
		AND PARA1_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END     
    ELSE  IF @NQUERYID=7
	BEGIN
		SELECT PARA2_CODE,'---ALL---' AS PARA2_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA2 
		WHERE PARA2_CODE='0000000'
		UNION ALL
		SELECT PARA2_CODE,PARA2_NAME,ROW_NUMBER() OVER (ORDER BY PARA2_NAME) AS SRNO
		FROM PARA2  
		WHERE PARA2_NAME<>'' AND PARA2_CODE<>'0000000' 
		AND PARA2_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END
	ELSE  IF @NQUERYID=8
	BEGIN  
		SELECT PARA3_CODE,'---ALL---' AS PARA3_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA3  
		WHERE PARA3_CODE='0000000'
		UNION ALL
		SELECT PARA3_CODE,PARA3_NAME,ROW_NUMBER() OVER (ORDER BY PARA3_NAME) AS SRNO
		FROM PARA3  
		WHERE PARA3_NAME<>'' AND PARA3_CODE<>'0000000' 
		AND PARA3_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END 
	ELSE  IF @NQUERYID=9
	BEGIN  
		SELECT PARA4_CODE,'---ALL---' AS PARA4_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA4  
		WHERE PARA4_CODE='0000000'
		UNION ALL
		SELECT PARA4_CODE,PARA4_NAME,ROW_NUMBER() OVER (ORDER BY PARA4_NAME) AS SRNO
		FROM PARA4  
		WHERE PARA4_NAME<>'' AND PARA4_CODE<>'0000000' 
		AND PARA4_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END 
	ELSE  IF @NQUERYID=10
	BEGIN  
	
		SELECT PARA5_CODE,'---ALL---' AS PARA5_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA5  
		WHERE PARA5_CODE='0000000'
		UNION ALL
		SELECT PARA5_CODE,PARA5_NAME,ROW_NUMBER() OVER (ORDER BY PARA5_NAME) AS SRNO
		FROM PARA5  
		WHERE PARA5_NAME<>'' AND PARA5_CODE<>'0000000' 
		AND PARA5_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END 
	ELSE  IF @NQUERYID=11
	BEGIN
		SELECT PARA6_CODE,'---ALL---' AS PARA6_NAME,CAST(0 AS INT) AS SRNO
		FROM PARA6  
		WHERE PARA6_CODE='0000000'
		UNION ALL
		SELECT PARA6_CODE,PARA6_NAME,ROW_NUMBER() OVER (ORDER BY PARA6_NAME) AS SRNO
		FROM PARA6 
		WHERE PARA6_NAME<>'' AND PARA6_CODE<>'0000000' 
		AND PARA6_NAME LIKE @CWHERE--+'%'
		ORDER BY 3
	END
	ELSE  IF @NQUERYID=12
	BEGIN
		SELECT A.ARTICLE_CODE, A.ARTICLE_DESC, A.ARTICLE_NAME, A.ARTICLE_NO, 
		A.CODING_SCHEME,A.PURCHASE_PRICE, A.MRP, A.WHOLESALE_PRICE AS WS_PRICE,   
		A.PARA1_SET, A.PARA2_SET, B.UOM_CODE,B.UOM_NAME, B.UOM_TYPE,A.ALIAS AS ARTICLE_ALIAS,
		J.SUB_SECTION_CODE,J.SUB_SECTION_NAME,K.SECTION_CODE,K.SECTION_NAME
		 ,AT1.attr1_key_name,AT2.attr2_key_name,AT3.attr3_key_name,AT4.attr4_key_name,AT5.attr5_key_name,AT6.attr6_key_name,
   AT7.attr7_key_name,AT8.attr8_key_name,AT9.attr9_key_name,AT10.attr10_key_name,AT11.attr11_key_name,AT12.attr12_key_name,
   AT13.attr13_key_name,AT14.attr14_key_name,AT15.attr15_key_name,AT16.attr16_key_name,AT17.attr17_key_name,AT18.attr18_key_name,
   AT19.attr19_key_name,AT20.attr20_key_name,AT21.attr21_key_name,AT22.attr22_key_name,AT23.attr23_key_name,AT24.attr24_key_name,
	AT25.attr25_key_name 

		,'0000000' AS PARA1_CODE,'---ALL---' AS PARA1_NAME
		,'0000000' AS PARA2_CODE,'---ALL---' AS PARA2_NAME
		,'0000000' AS PARA3_CODE,'---ALL---' AS PARA3_NAME
		,'0000000' AS PARA4_CODE,'---ALL---' AS PARA4_NAME
		,'0000000' AS PARA5_CODE,'---ALL---' AS PARA5_NAME
		,'0000000' AS PARA6_CODE,'---ALL---' AS PARA6_NAME
		FROM ARTICLE A (NOLOCK)     
		JOIN UOM B (NOLOCK)  ON A.UOM_CODE = B.UOM_CODE  
		JOIN SECTIOND			J (NOLOCK) ON A.SUB_SECTION_CODE = J.SUB_SECTION_CODE        
		JOIN SECTIONM			K (NOLOCK) ON J.SECTION_CODE = K.SECTION_CODE 
		LEFT OUTER JOIN article_fix_attr ATTR  (NOLOCK) ON a.article_code = ATTR.ARTICLE_CODE 
		LEFT OUTER JOIN attr1_mst at1 (NOLOCK) ON at1.attr1_key_code=ATTR.attr1_key_code
		LEFT OUTER JOIN attr2_mst at2 (NOLOCK) ON at2.attr2_key_code=ATTR.attr2_key_code
		LEFT OUTER JOIN attr3_mst at3 (NOLOCK) ON at3.attr3_key_code=ATTR.attr3_key_code
		LEFT OUTER JOIN attr4_mst at4 (NOLOCK) ON at4.attr4_key_code=ATTR.attr4_key_code
		LEFT OUTER JOIN attr5_mst at5 (NOLOCK) ON at5.attr5_key_code=ATTR.attr5_key_code
		LEFT OUTER JOIN attr6_mst at6 (NOLOCK) ON at6.attr6_key_code=ATTR.attr6_key_code
		LEFT OUTER JOIN attr7_mst at7 (NOLOCK) ON at7.attr7_key_code=ATTR.attr7_key_code
		LEFT OUTER JOIN attr8_mst at8 (NOLOCK) ON at8.attr8_key_code=ATTR.attr8_key_code
		LEFT OUTER JOIN attr9_mst at9 (NOLOCK) ON at9.attr9_key_code=ATTR.attr9_key_code
		LEFT OUTER JOIN attr10_mst at10 (NOLOCK) ON at10.attr10_key_code=ATTR.attr10_key_code
		LEFT OUTER JOIN attr11_mst at11 (NOLOCK) ON at11.attr11_key_code=ATTR.attr11_key_code
		LEFT OUTER JOIN attr12_mst at12 (NOLOCK) ON at12.attr12_key_code=ATTR.attr12_key_code
		LEFT OUTER JOIN attr13_mst at13 (NOLOCK) ON at13.attr13_key_code=ATTR.attr13_key_code
		LEFT OUTER JOIN attr14_mst at14 (NOLOCK) ON at14.attr14_key_code=ATTR.attr14_key_code
		LEFT OUTER JOIN attr15_mst at15 (NOLOCK) ON at15.attr15_key_code=ATTR.attr15_key_code
		LEFT OUTER JOIN attr16_mst at16 (NOLOCK) ON at16.attr16_key_code=ATTR.attr16_key_code
		LEFT OUTER JOIN attr17_mst at17 (NOLOCK) ON at17.attr17_key_code=ATTR.attr17_key_code
		LEFT OUTER JOIN attr18_mst at18 (NOLOCK) ON at18.attr18_key_code=ATTR.attr18_key_code
		LEFT OUTER JOIN attr19_mst at19 (NOLOCK) ON at19.attr19_key_code=ATTR.attr19_key_code
		LEFT OUTER JOIN attr20_mst at20 (NOLOCK) ON at20.attr20_key_code=ATTR.attr20_key_code
		LEFT OUTER JOIN attr21_mst at21 (NOLOCK) ON at21.attr21_key_code=ATTR.attr21_key_code
		LEFT OUTER JOIN attr22_mst at22 (NOLOCK) ON at22.attr22_key_code=ATTR.attr22_key_code
		LEFT OUTER JOIN attr23_mst at23 (NOLOCK) ON at23.attr23_key_code=ATTR.attr23_key_code
		LEFT OUTER JOIN attr24_mst at24 (NOLOCK) ON at24.attr24_key_code=ATTR.attr24_key_code
		LEFT OUTER JOIN attr25_mst at25(NOLOCK) ON at25.attr25_key_code=ATTR.attr25_key_code
		WHERE A.ARTICLE_TYPE =1 AND ARTICLE_PRD_MODE <> 3 
		AND  A.INACTIVE =0 AND  A.ARTICLE_CODE = @CWHERE
	
	END	
	ELSE  IF @NQUERYID=13
	BEGIN
		SELECT TOP 10 COLUMN_NAME FROM config_attr
		WHERE table_caption<>''
	END

	ELSE  IF @NQUERYID=14
	BEGIN
		SELECT T.MEMO_NO,M.MEMO_DT,M.BUY_PLAN_NAME,BPM.BUDGET_PLAN_NAME,BPM.EXPIRY_DT,S.SEASON_NAME
		,B.ARTICLE_NO,B.ARTICLE_NAME
		,T.QUANTITY,T.PURCHASE_PRICE,T.MRP,CONVERT(NUMERIC(14,2),T.QUANTITY*T.PURCHASE_PRICE) AS AMOUNT, '' AS SP_ID
		,K.SECTION_NAME,J.SUB_SECTION_NAME
		,C.PARA1_NAME,D.PARA2_NAME,E.PARA3_NAME,F.PARA4_NAME,G.PARA5_NAME,H.PARA6_NAME,T.ROW_ID AS BUY_PLAN_ROW_ID
		 ,AT1.attr1_key_name,AT2.attr2_key_name,AT3.attr3_key_name,AT4.attr4_key_name,AT5.attr5_key_name,AT6.attr6_key_name,
   AT7.attr7_key_name,AT8.attr8_key_name,AT9.attr9_key_name,AT10.attr10_key_name,AT11.attr11_key_name,AT12.attr12_key_name,
   AT13.attr13_key_name,AT14.attr14_key_name,AT15.attr15_key_name,AT16.attr16_key_name,AT17.attr17_key_name,AT18.attr18_key_name,
   AT19.attr19_key_name,AT20.attr20_key_name,AT21.attr21_key_name,AT22.attr22_key_name,AT23.attr23_key_name,AT24.attr24_key_name,
	AT25.attr25_key_name 

		
		FROM BUY_PLAN_MST M (NOLOCK)
		JOIN BUY_PLAN_DET T (NOLOCK) ON M.MEMO_NO=T.MEMO_NO
		JOIN BUDGET_PLAN_MST BPM (NOLOCK) ON BPM.MEMO_NO=M.BUDGET_PLAN_MEMO_NO
		JOIN SEASON_MST S (NOLOCK) ON BPM.SEASON_ID=S.SEASON_ID
		JOIN ARTICLE B (NOLOCK) ON T.ARTICLE_CODE = B.ARTICLE_CODE         
		JOIN PARA1 C (NOLOCK) ON T.PARA1_CODE = C.PARA1_CODE        
		JOIN PARA2 D (NOLOCK) ON T.PARA2_CODE = D.PARA2_CODE        
		JOIN PARA3 E (NOLOCK) ON T.PARA3_CODE = E.PARA3_CODE        
		JOIN PARA4 F (NOLOCK) ON T.PARA4_CODE = F.PARA4_CODE        
		JOIN PARA5 G (NOLOCK) ON T.PARA5_CODE = G.PARA5_CODE        
		JOIN PARA6 H (NOLOCK) ON T.PARA6_CODE = H.PARA6_CODE        
		JOIN UOM I (NOLOCK) ON B.UOM_CODE = I.UOM_CODE        
		JOIN SECTIOND J (NOLOCK) ON B.SUB_SECTION_CODE = J.SUB_SECTION_CODE        
		JOIN SECTIONM K (NOLOCK) ON J.SECTION_CODE = K.SECTION_CODE 
		LEFT OUTER JOIN article_fix_attr ATTR  (NOLOCK) ON t.article_code = ATTR.ARTICLE_CODE 
		LEFT OUTER JOIN attr1_mst at1 (NOLOCK) ON at1.attr1_key_code=ATTR.attr1_key_code
		LEFT OUTER JOIN attr2_mst at2 (NOLOCK) ON at2.attr2_key_code=ATTR.attr2_key_code
		LEFT OUTER JOIN attr3_mst at3 (NOLOCK) ON at3.attr3_key_code=ATTR.attr3_key_code
		LEFT OUTER JOIN attr4_mst at4 (NOLOCK) ON at4.attr4_key_code=ATTR.attr4_key_code
		LEFT OUTER JOIN attr5_mst at5 (NOLOCK) ON at5.attr5_key_code=ATTR.attr5_key_code
		LEFT OUTER JOIN attr6_mst at6 (NOLOCK) ON at6.attr6_key_code=ATTR.attr6_key_code
		LEFT OUTER JOIN attr7_mst at7 (NOLOCK) ON at7.attr7_key_code=ATTR.attr7_key_code
		LEFT OUTER JOIN attr8_mst at8 (NOLOCK) ON at8.attr8_key_code=ATTR.attr8_key_code
		LEFT OUTER JOIN attr9_mst at9 (NOLOCK) ON at9.attr9_key_code=ATTR.attr9_key_code
		LEFT OUTER JOIN attr10_mst at10 (NOLOCK) ON at10.attr10_key_code=ATTR.attr10_key_code
		LEFT OUTER JOIN attr11_mst at11 (NOLOCK) ON at11.attr11_key_code=ATTR.attr11_key_code
		LEFT OUTER JOIN attr12_mst at12 (NOLOCK) ON at12.attr12_key_code=ATTR.attr12_key_code
		LEFT OUTER JOIN attr13_mst at13 (NOLOCK) ON at13.attr13_key_code=ATTR.attr13_key_code
		LEFT OUTER JOIN attr14_mst at14 (NOLOCK) ON at14.attr14_key_code=ATTR.attr14_key_code
		LEFT OUTER JOIN attr15_mst at15 (NOLOCK) ON at15.attr15_key_code=ATTR.attr15_key_code
		LEFT OUTER JOIN attr16_mst at16 (NOLOCK) ON at16.attr16_key_code=ATTR.attr16_key_code
		LEFT OUTER JOIN attr17_mst at17 (NOLOCK) ON at17.attr17_key_code=ATTR.attr17_key_code
		LEFT OUTER JOIN attr18_mst at18 (NOLOCK) ON at18.attr18_key_code=ATTR.attr18_key_code
		LEFT OUTER JOIN attr19_mst at19 (NOLOCK) ON at19.attr19_key_code=ATTR.attr19_key_code
		LEFT OUTER JOIN attr20_mst at20 (NOLOCK) ON at20.attr20_key_code=ATTR.attr20_key_code
		LEFT OUTER JOIN attr21_mst at21 (NOLOCK) ON at21.attr21_key_code=ATTR.attr21_key_code
		LEFT OUTER JOIN attr22_mst at22 (NOLOCK) ON at22.attr22_key_code=ATTR.attr22_key_code
		LEFT OUTER JOIN attr23_mst at23 (NOLOCK) ON at23.attr23_key_code=ATTR.attr23_key_code
		LEFT OUTER JOIN attr24_mst at24 (NOLOCK) ON at24.attr24_key_code=ATTR.attr24_key_code
		LEFT OUTER JOIN attr25_mst at25(NOLOCK) ON at25.attr25_key_code=ATTR.attr25_key_code
		WHERE M.MEMO_NO=@CWHERE	
	END
	ELSE  IF @NQUERYID=15
	BEGIN
		SELECT BUDGET_PLAN_NAME AS BUDGET_PLAN_CODE,BUDGET_PLAN_NAME FROM BUDGET_PLAN_MST
		UNION 
		SELECT '' AS BUDGET_PLAN_CODE,'----ALL----' AS BUDGET_PLAN_NAME 
		ORDER BY BUDGET_PLAN_CODE
	END
	ELSE  IF @NQUERYID=16
	BEGIN
		SELECT BUY_PLAN_NAME AS BUY_PLAN_CODE,BUY_PLAN_NAME FROM BUY_PLAN_MST
		UNION 
		SELECT '' AS BUY_PLAN_CODE,'----ALL----' AS BUY_PLAN_NAME 
		ORDER BY BUY_PLAN_CODE
	END
	ELSE  IF @NQUERYID=17
	BEGIN
		SELECT SEASON_NAME AS SEASON_CODE,SEASON_NAME FROM SEASON_MST
		UNION 
		SELECT '' AS SEASON_CODE,'----ALL----' AS SEASON_NAME 
		ORDER BY SEASON_CODE
	END
	   
END
