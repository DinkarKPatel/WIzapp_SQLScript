CREATE VIEW VW_ITEMRATEREVISION_QBF

AS 
	SELECT  A.IRM_MEMO_NO,
	 A.IRM_MEMO_NO AS MST_IRM_MEMO_NO,
	A.IRM_MEMO_DT AS MST_IRM_MEMO_DT,
	A.REMARKS AS MST_REMARKS,
	A.TYPE,
	A.USER_CODE,
	A.DEPT_ID,
	A.COMPANY_CODE,
	A.RATE_TYPE,
	A.IRM_MEMO_ID, 
	A.IRM_MEMO_ID AS MST_IRM_MEMO_ID,
	A.FIN_YEAR AS MST_FIN_YEAR,
	A.MEMO_TIME MST_MEMO_TIME,
	A.REVISION_TYPE,
	A.INC_TYPE,
	B.NEW_MRP,B.NEW_WSP,B.OLD_WSP,B.OLD_MRP,
	A.BARCODE_PREFIX AS MST_BARCODE_PREFIX,B.PRODUCT_CODE,
	ARTICLE.ARTICLE_NO ,ARTICLE.ARTICLE_NAME,PARA1.PARA1_NAME,PARA2.PARA2_NAME,  
	PARA3.PARA3_NAME,PARA4.PARA4_NAME,PARA5.PARA5_NAME,PARA6.PARA6_NAME,UOM.UOM_NAME,  
	OA.ARTICLE_NO AS OLD_ARTICLE_NO,OP1.PARA1_NAME AS OLD_PARA1_NAME ,  
	OP2.PARA2_NAME AS OLD_PARA2_NAME ,OP3.PARA3_NAME AS OLD_PARA3_NAME ,  
	OP4.PARA4_NAME AS OLD_PARA4_NAME,OP5.PARA5_NAME AS OLD_PARA5_NAME,  
	OP6.PARA6_NAME AS OLD_PARA6_NAME,SECTIOND.SUB_SECTION_NAME ,SECTIONM.SECTION_NAME,  
	SECTIOND.SUB_SECTION_CODE ,SECTIONM.SECTION_CODE,ARTICLE.CODING_SCHEME,'' AS AC_NAME,  
	ARTICLE.PURCHASE_PRICE,SKU.FIX_MRP,SKU.PRODUCT_NAME ,  
	ARTICLE.DT_CREATED AS [ART_DT_CREATED],PARA3.DT_CREATED AS [PARA3_DT_CREATED],  
	SKU.DT_CREATED AS [SKU_DT_CREATED] ,   
B.QUANTITY ,
 B.NEW_PRODUCT_CODE,A.location_Code
	FROM IRM01106 A (NOLOCK)     
	JOIN IRD01106 B ON A.IRM_MEMO_ID= B.IRM_MEMO_ID   
	JOIN SKU ON B.PRODUCT_CODE = SKU.PRODUCT_CODE   
	JOIN ARTICLE  (NOLOCK) ON SKU.ARTICLE_CODE= ARTICLE.ARTICLE_CODE  
	JOIN SECTIOND  (NOLOCK) ON ARTICLE.SUB_SECTION_CODE= SECTIOND.SUB_SECTION_CODE     
	JOIN SECTIONM  (NOLOCK) ON SECTIOND.SECTION_CODE= SECTIONM.SECTION_CODE     
	JOIN PARA1  (NOLOCK) ON B.PARA1_CODE= PARA1.PARA1_CODE     
	JOIN PARA2  (NOLOCK) ON B.PARA2_CODE= PARA2.PARA2_CODE   
	JOIN PARA3  (NOLOCK) ON B.PARA3_CODE= PARA3.PARA3_CODE     
	JOIN PARA4  (NOLOCK) ON B.PARA4_CODE= PARA4.PARA4_CODE   
	JOIN PARA5  (NOLOCK) ON B.PARA5_CODE= PARA5.PARA5_CODE     
	JOIN PARA6  (NOLOCK) ON B.PARA6_CODE= PARA6.PARA6_CODE   
	JOIN UOM  (NOLOCK) ON ARTICLE.UOM_CODE= UOM.UOM_CODE   

	JOIN ARTICLE OA (NOLOCK) ON B.OLD_ARTICLE_CODE= OA.ARTICLE_CODE     
	JOIN SECTIOND OS (NOLOCK) ON OA.SUB_SECTION_CODE= OS .SUB_SECTION_CODE     
	JOIN SECTIONM OSM (NOLOCK) ON OS.SECTION_CODE= OSM.SECTION_CODE     
	JOIN PARA1 OP1 (NOLOCK) ON B.OLD_PARA1_CODE= OP1.PARA1_CODE  
	JOIN PARA2 OP2 (NOLOCK) ON B.OLD_PARA2_CODE= OP2.PARA2_CODE   
	JOIN PARA3 OP3 (NOLOCK) ON B.OLD_PARA3_CODE= OP3.PARA3_CODE    
	JOIN PARA4 OP4 (NOLOCK) ON B.OLD_PARA4_CODE= OP4.PARA4_CODE   
	JOIN PARA5 OP5 (NOLOCK) ON B.OLD_PARA5_CODE= OP5.PARA5_CODE  
	JOIN PARA6 OP6 (NOLOCK) ON B.OLD_PARA6_CODE= OP6.PARA6_CODE
