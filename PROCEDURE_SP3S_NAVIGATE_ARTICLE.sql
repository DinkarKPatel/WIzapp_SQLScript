CREATE PROCEDURE SP3S_NAVIGATE_ARTICLE
(
	@NNAVMODE NUMERIC(1)/*@NNAVMODE : 
						  VALUES    : 1 - GET THE TOP(FIRST RECORD) ARTICLE_CODE
									  2 - GET THE PREVIOUS ARTICLE_CODE
									  3 - GET THE NEXT ARTICLE_CODE
									  4 - GET THE BOTTOM(LAST RECORD) ARTICLE_CODE
									  */
   ,@CARTICLE_NO VARCHAR(300)=''
   ,@CARTICLE_CODE VARCHAR(10)='' 	
)
--WITH ENCRYPTION 
AS
BEGIN
	DECLARE @CERRMSG VARCHAR(500),@NPREID VARCHAR(300),@NRETID VARCHAR(300)
	IF ISNULL(@CARTICLE_CODE,'')<>''
	BEGIN
	    SELECT TOP 1 @NRETID=ARTICLE_NO FROM ARTICLE WHERE ARTICLE_CODE=@CARTICLE_CODE
	    GOTO END_PROC
	END
	IF @NNAVMODE=1 --GET THE FIRST ARTICLE_NO
	BEGIN
		SELECT @NRETID=MIN(ARTICLE_NO) FROM ARTICLE(NOLOCK)WHERE  ARTICLE_NO<>''
		GOTO END_PROC
	END
	ELSE IF @NNAVMODE=2 --GET THE PREVIOUS ARTICLE_NO FROM THE PASSED ARTICLE_NO
	BEGIN
		SELECT @NRETID=MAX(ARTICLE_NO) FROM ARTICLE(NOLOCK) WHERE ARTICLE_NO<@CARTICLE_NO AND ARTICLE_NO<>''
		IF ISNULL(@NRETID,'')=''
			SET @NRETID=@CARTICLE_NO
		GOTO END_PROC
	END
	ELSE IF @NNAVMODE=3 --GET THE NEXT ARTICLE_NO FROM THE PASSED ARTICLE_NO
	BEGIN
		SELECT @NRETID=MIN(ARTICLE_NO) FROM ARTICLE(NOLOCK)WHERE ARTICLE_NO>@CARTICLE_NO AND ARTICLE_NO<>''
		
		IF ISNULL(@NRETID,'')=''
			SET @NRETID=@CARTICLE_NO
		GOTO END_PROC
	END
	ELSE IF @NNAVMODE=4 --GET THE LAST PRODUCT_CODE
	BEGIN
		SELECT @NRETID=MAX(ARTICLE_NO) FROM ARTICLE(NOLOCK) WHERE  ARTICLE_NO<>''		
		GOTO END_PROC
	END

END_PROC:
	SELECT TOP 1 ARTICLE_NO,ARTICLE_CODE   FROM ARTICLE(NOLOCK) WHERE ARTICLE_NO=@NRETID AND ARTICLE_NO<>''
END
--END OF PROCEDURE - SP3S_NAVIGATE_ARTICLE
