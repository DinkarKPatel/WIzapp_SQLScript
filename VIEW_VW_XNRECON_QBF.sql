CREATE VIEW VW_XNRECON_QBF

AS
SELECT M.RECON_ID,M.RECON_NO,M.RECON_ID AS MST_RECON_ID,M.RECON_NO AS MST_RECON_NO,M.RECON_DT AS MST_RECON_DT,
M.RECONCILED AS MST_RECONCILED,M.XN_TYPE AS MST_XN_TYPE,M.FIN_YEAR AS MST_FIN_YEAR, 
T1.RECON_ID AS SUB_RECON_ID,T1.PRODUCT_CODE AS SUB_PRODUCT_CODE,T1.QUANTITY AS SUB_QUANTITY,
T4.ARTICLE_NAME AS SUB_ARTICLE_NAME,T4.ARTICLE_NO AS SUB_ARTICLE_NO,C.PARA1_NAME AS SUB_PARA1_NAME,
D.PARA2_NAME AS SUB_PARA2_NAME,F.PARA3_NAME AS SUB_PARA3_NAME,G.PARA4_NAME AS SUB_PARA4_NAME,
H.PARA5_NAME AS SUB_PARA5_NAME,I.PARA6_NAME AS SUB_PARA6_NAME,SM.SECTION_NAME AS SUB_SECTION_NAME,
SD.SUB_SECTION_NAME AS SUB_SUB_SECTION_NAME,T2.UOM_NAME AS SUB_UOM_NAME,
(CASE WHEN M.XN_TYPE= 'PUR' THEN PIM01106.BILL_NO ELSE T9.XN_ID END) AS SOURCE_MEMO_NO,M.location_code
FROM XNRECONM M 
JOIN XNRECONP T1 ON M.RECON_ID = T1.RECON_ID
JOIN XNRECONMEMO T9 ON M.RECON_ID= T9.RECON_ID
JOIN SKU A ON A.PRODUCT_CODE = T1.PRODUCT_CODE
JOIN ARTICLE T4 ON A.ARTICLE_CODE = T4.ARTICLE_CODE
JOIN SECTIOND SD ON T4.SUB_SECTION_CODE = SD.SUB_SECTION_CODE
JOIN SECTIONM SM ON SD.SECTION_CODE = SM.SECTION_CODE
JOIN PARA1 C ON A.PARA1_CODE = C.PARA1_CODE  
JOIN PARA2 D ON A.PARA2_CODE = D.PARA2_CODE  
JOIN PARA3 F ON A.PARA3_CODE = F.PARA3_CODE  
JOIN PARA4 G ON A.PARA4_CODE = G.PARA4_CODE  
JOIN PARA5 H ON A.PARA5_CODE = H.PARA5_CODE  
JOIN PARA6 I ON A.PARA6_CODE = I.PARA6_CODE  
JOIN UOM T2 ON T2.UOM_CODE = T4.UOM_CODE 
LEFT OUTER JOIN PIM01106 ON T9.XN_ID = PIM01106.MRR_ID
