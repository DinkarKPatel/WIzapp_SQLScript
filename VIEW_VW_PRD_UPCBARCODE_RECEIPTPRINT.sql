CREATE VIEW   VW_PRD_UPCBARCODE_RECEIPTPRINT
AS

  SELECT SD.SUB_SECTION_NAME ,
         AGLM.ALIAS AS AGENCY_ALIAS,
         WO.MEMO_NO AS WO_NO,
         WO.MEMO_DT AS WO_DT,
         ISNULL(BM1.ORDER_NO ,BM2.ORDER_NO) AS ORDER_NO,
         ISNULL(BM1.ORDER_DT ,BM2.ORDER_DT) AS ORDER_DT,
         ISNULL(BM1LM.AC_NAME ,BM2LM .AC_NAME) AS PARTY_NAME,
         AR.ARTICLE_NO,P1.PARA1_NAME ,
         B.MEMO_NO AS RECEIVE_NO,B.MEMO_DT AS RECEIVE_DT,
         AGENCY_CHALLAN_NO ,AGENCY_CHALLAN_DT ,
         AGENCY_BILL_NO ,AGENCY_BILL_DT ,
         A.PRODUCT_CODE ,
         B.REMARKS,
         A.MEMO_ID
        
  FROM PRD_AGENCY_MATERIAL_RECEIPT_UPC A
  JOIN PRD_AGENCY_MATERIAL_RECEIPT_MST B ON A.MEMO_ID =B.MEMO_ID
  JOIN PRD_UPCPMT PMT ON PMT.PRODUCT_CODE =A.PRODUCT_CODE  
  JOIN PRD_WO_MST WO ON PMT.WO_ID =WO.MEMO_ID 
  JOIN (SELECT * FROM PRD_WO_ORDERS ) BO ON BO.MEMO_ID =WO.MEMO_ID 
  LEFT JOIN BUYER_ORDER_MST BM1 ON BM1.ORDER_ID =PMT.ORDER_ID 
  LEFT JOIN BUYER_ORDER_MST BM2 ON BM2.ORDER_ID =BO.ORDER_ID 
  LEFT JOIN LM01106 BM1LM ON BM1LM .AC_CODE =BM1.AC_CODE 
  LEFT JOIN LM01106 BM2LM ON BM2LM .AC_CODE =BM2.AC_CODE 
  JOIN ARTICLE (NOLOCK) AR ON WO.ARTICLE_SET_CODE=AR.ARTICLE_CODE    
  JOIN SECTIOND SD ON SD.SUB_SECTION_CODE=AR.SUB_SECTION_CODE    
  JOIN PARA1 P1 ON P1.PARA1_CODE=PMT.PARA1_CODE    
  JOIN PRD_AGENCY_MST AG ON AG.AGENCY_CODE =B.AGENCY_CODE 
  JOIN LM01106 AGLM ON AGLM.AC_CODE =AG.AC_CODE
