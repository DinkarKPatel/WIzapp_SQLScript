CREATE VIEW VW_WPS_DET  

AS    
  SELECT T1.*,ROW_NUMBER() OVER (ORDER BY T1.TS) AS S_NO,    
 B.ARTICLE_NO, B.ARTICLE_NAME,P1.PARA1_NAME,      
 P2.PARA2_NAME, P3.PARA3_NAME,
 B.INACTIVE, ISNULL(P.QUANTITY_IN_STOCK,0) AS QUANTITY_IN_STOCK,      
 S.PURCHASE_PRICE,  '' AS SCHEME_ID, SM.SECTION_NAME, SD.SUB_SECTION_NAME,      
 P4.PARA4_NAME,P5.PARA5_NAME,P6.PARA6_NAME,   
   
 B.DT_CREATED AS [ART_DT_CREATED],S.DT_CREATED AS [SKU_DT_CREATED],      
 B.STOCK_NA,  
 T1.QUANTITY AS PREVQTY,S.FIX_MRP,S.PRODUCT_NAME,J.FORM_NAME    
 -------  
 ,B.UOM_CODE,CONVERT(NUMERIC(14,2),ISNULL(T1.QUANTITY,0)*ISNULL(T1.RATE,0)) AS AMOUNT  
 --------    
 FROM WPS_DET T1 
 LEFT OUTER JOIN PMT01106 P ON T1.PRODUCT_CODE = P.PRODUCT_CODE AND P.DEPT_ID=T1.DEPT_ID      
 JOIN SKU S ON S.PRODUCT_CODE = T1.PRODUCT_CODE       
 JOIN ARTICLE B ON S.ARTICLE_CODE = B.ARTICLE_CODE        
 JOIN SECTIOND SD ON B.SUB_SECTION_CODE = SD.SUB_SECTION_CODE      
 JOIN SECTIONM SM ON SD.SECTION_CODE = SM.SECTION_CODE      
 JOIN FORM J ON T1.ITEM_FORM_ID= J.FORM_ID     
 JOIN PARA1 P1 ON P1.PARA1_CODE=S.PARA1_CODE  
JOIN PARA2 P2 ON P2.PARA2_CODE=S.PARA2_CODE  
JOIN PARA3 P3 ON P3.PARA3_CODE=S.PARA3_CODE  
JOIN PARA4 P4 ON P4.PARA4_CODE=S.PARA4_CODE  
JOIN PARA5 P5 ON P5.PARA5_CODE=S.PARA5_CODE  
JOIN PARA6 P6 ON P6.PARA6_CODE=S.PARA6_CODE
