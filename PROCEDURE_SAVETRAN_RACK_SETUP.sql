create PROCEDURE SAVETRAN_RACK_SETUP(@nSPID int)
AS
BEGIN

BEGIN TRAN
DELETE FROM loc_delivery_racks
BEGIN TRY
	INSERT INTO loc_delivery_racks(DEPT_ID,rack_no)
	SELECT DEPT_ID,Rack_no
	FROM RACKSETUP_IMPORT_UPLOAD WHERE SP_ID=@nSPID

END TRY
BEGIN CATCH
	
END CATCH
IF @@ERROR=0
BEGIN
	COMMIT TRAN
	SELECT '' ERRMSG
END
ELSE
BEGIN
	ROLLBACK
	SELECT ERROR_MESSAGE()ERRMSG   
END

DELETE RACKSETUP_IMPORT_UPLOAD WHERE SP_ID=@nSPID  
END