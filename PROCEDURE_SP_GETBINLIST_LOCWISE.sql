CREATE  PROCEDURE SP_GETBINLIST_LOCWISE
@cLoc varchar(5)='',  
@CWHERE VARCHAR(MAX)=''
  
--WITH ENCRYPTION  
AS  
BEGIN  
 
  SELECT A.DEPT_ID,A.DEPT_ID+'-'+DEPT_NAME AS DEPT_NAME,  
    ISNULL(B1.BIN_ID,'000') AS [BIN_ID],  ISNULL(B2.BIN_NAME,'DEFAULT BIN') AS [BIN_NAME]
  FROM LOC_VIEW A (NOLOCK)  
  LEFT OUTER JOIN BIN_LOC B1 (NOLOCK) ON B1.DEPT_ID=A.DEPT_ID  
  LEFT OUTER JOIN BIN B2 (NOLOCK) ON B2.BIN_ID=B1.BIN_ID   
  WHERE A.DEPT_ID =  @cLoc  
  AND A.INACTIVE=0 AND A.DEPT_ID=A.MAJOR_DEPT_ID   
  AND (@CWHERE='' OR (ISNULL(B2.BIN_NAME,'') LIKE @CWHERE OR ISNULL(B2.BIN_ALIAS,'') LIKE @CWHERE))  
 
END