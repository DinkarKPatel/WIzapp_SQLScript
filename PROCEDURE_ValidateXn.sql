CREATE PROCEDURE VALIDATEXN
		@CXNTYPE VARCHAR(10),
		@CXNID VARCHAR(40),
		@NUPDATEMODE INT=1,
		@CUSERCODE CHAR(7)='0000000',
		@BCALLEDFORPRINT BIT=0, 		 
		@CCMD VARCHAR(1000) OUTPUT,
		@CDEPT_ID VARCHAR(5)=''
		--*** PARAMETERS :
		--*** @CXNTYPE - TRANSACTION TYPE (MODULE SPECIFIC)
		--*** @CXNID - TRANSACTION ID ( MEMO ID OF MASTER TABLE )
--WITH ENCRYPTION
AS
BEGIN
	SET @CCMD = ''
 
	EXEC VALIDATE_XN_DATA_FREEZE  @CXNTYPE,@CUSERCODE,@CXNID ,'',@CCMD OUTPUT
    IF ISNULL(@CCMD,'')<>''
		GOTO END_PROC
		
 	--*** STARTING VALIDATION OF SALES
	IF @CXNTYPE IN ('SLS')		-- SALE
	BEGIN
		DECLARE @BGSTBILL BIT,@CGSTCUTOFFDATE VARCHAR(20),@DGSTDATE DATETIME,@DCMDT DATETIME
		SET @BGSTBILL=0
		SELECT @CGSTCUTOFFDATE=VALUE FROM CONFIG WHERE CONFIG_OPTION ='GST_CUT_OFF_DATE'
		
		SELECT @DCMDT=CM_DT FROM CMM01106 WHERE CM_ID=@CXNID
	    
		IF ISNULL(@CGSTCUTOFFDATE,'')<>''
		BEGIN
			SELECT @DGSTDATE=CAST(@CGSTCUTOFFDATE AS DATETIME)
		    
			IF @DCMDT>=@DGSTDATE
				SET @BGSTBILL=1
		END
			
		EXEC VALIDATEXN_SLS_AFTERSAVE @NUPDATEMODE,'',0,@CXNID,@BGSTBILL,@CCMD OUTPUT,@BCALLEDFORPRINT 		
		RETURN	
	END		--		END OF SALE
	
	ELSE
	IF @CXNTYPE IN ('PUR')		-- PURCHASE INVOICE
	BEGIN
		EXEC VALIDATEXN_PUR @CXNID,@NUPDATEMODE,@BCALLEDFORPRINT, @CCMD OUTPUT,@CDEPT_ID
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('PRT')		-- PURCHASE RETURN
	BEGIN
		EXEC VALIDATEXN_PRT @CXNID,@NUPDATEMODE,@BCALLEDFORPRINT, @CCMD OUTPUT,@CDEPT_ID
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('ARC')		-- CUSTOMER RECEIPTS
	BEGIN
		EXEC VALIDATEXN_ARC @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('HBD')		-- Hold back
	BEGIN
		EXEC VALIDATEXN_HBD @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	ELSE
	IF @CXNTYPE IN ('SDL')		-- Hold back
	BEGIN
		EXEC VALIDATEXN_SDL @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	ELSE
	IF @CXNTYPE IN ('CHO')		-- CHALLAN OUT
	BEGIN
		EXEC VALIDATEXN_CHO @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('CHI')		-- CHALLAN IN
	BEGIN
		EXEC VALIDATEXN_CHI @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('CNC')		-- CANCELLATION/UNCANCELLATION
	BEGIN
		EXEC VALIDATEXN_CNC @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('IRR')		-- ITEM RATE REVISION
	BEGIN
		EXEC VALIDATEXN_IRR @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('PCR')		-- PETTY CASH ENTRY
	BEGIN
		EXEC VALIDATEXN_PCR @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END 
	
	ELSE
	IF @CXNTYPE IN ('ACT')		-- ACCOUNTS
	BEGIN
		EXEC VALIDATEXN_ACT @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END

	ELSE
	IF @CXNTYPE IN ('SLSSET')	-- SETUP BARGAIN COUNTER
	BEGIN
		EXEC VALIDATEXN_SLSSET @CXNID,@NUPDATEMODE, @CCMD OUTPUT
		RETURN
	END
	
	ELSE
	IF @CXNTYPE IN ('WSL')	-- WHOLESALE INVOICE
	BEGIN
		EXEC VALIDATEXN_WSL @CXNID,@NUPDATEMODE,@BCALLEDFORPRINT, @CCMD OUTPUT, @CDEPT_ID
		RETURN
	END

	ELSE
	IF @CXNTYPE IN ('WSR')	-- WHOLESALE CREDIT NOTE
	BEGIN
		EXEC VALIDATEXN_WSR @CXNID,@NUPDATEMODE,@BCALLEDFORPRINT, @CCMD OUTPUT
		RETURN
	END
	ELSE  
	IF @CXNTYPE IN ('PRDCNC')  -- PRODUCTION CANCELLATION
	BEGIN  
	  EXEC VALIDATEXN_PRD_CNC @CXNID,@NUPDATEMODE, @CCMD OUTPUT  
	  RETURN  
	END 
	ELSE
	IF @CXNTYPE IN ('WPS')  -- WPS CANCELLATION
	BEGIN  
	  EXEC VALIDATEXN_WPS @CXNID,@NUPDATEMODE, @CCMD OUTPUT  
	  RETURN  
	END   

END_PROC:
END