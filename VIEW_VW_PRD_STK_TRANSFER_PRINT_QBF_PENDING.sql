CREATE VIEW VW_PRD_STK_TRANSFER_PRINT_QBF_PENDING       
AS 
    
      
SELECT T1.MEMO_NO AS MST_MEMO_NO    
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MST_MEMO_DATE     
,T1.MEMO_DT AS MST_MEMO_DT    
,T3.DEPARTMENT_NAME AS MST_TARGET_DEPARTMENT_NAME      
,T4.DEPARTMENT_NAME AS MST_SOURCE_DEPARTMENT_NAME    
,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED    
,ART.ARTICLE_NO,ART.ARTICLE_NAME,ART.ARTICLE_CODE,ART.ARTICLE_DESC    
,U.UOM_NAME     
,DET.QUANTITY    
,PARA1.PARA1_NAME ,PARA2.PARA2_NAME    
,T1.MEMO_NO    
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MEMO_DT    
,T1.MEMO_ID    
,T1.SOURCE_DEPARTMENT_ID    
,SEC.SECTION_NAME    
,SSEC.SUB_SECTION_NAME    
,WM.MEMO_NO AS MST_WO_NO    
,1 AS CHCK    
FROM PRD_STK_TRANSFER_MST_PENDING T1     
JOIN PRD_STK_TRANSFER_DET_PENDING DET ON DET.MEMO_ID = T1.MEMO_ID    
JOIN PRD_WO_MST WM ON DET.REF_WO_ID = WM.MEMO_ID     
JOIN SKU ON SKU.PRODUCT_CODE = DET.PRODUCT_CODE     
JOIN ARTICLE ART ON SKU.ARTICLE_CODE = ART.ARTICLE_CODE     
JOIN UOM U ON ART.UOM_CODE = U.UOM_CODE     
JOIN PARA1 ON PARA1.PARA1_CODE = SKU.PARA1_CODE    
JOIN PARA2 ON PARA2.PARA2_CODE = SKU.PARA2_CODE    
JOIN SECTIOND SSEC ON SSEC.SUB_SECTION_CODE = ART.SUB_SECTION_CODE     
JOIN SECTIONM SEC ON SEC.SECTION_CODE  = SSEC.SECTION_CODE      
JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID = T1.TARGET_DEPARTMENT_ID    
JOIN PRD_DEPARTMENT_MST T4 ON T4.DEPARTMENT_ID = T1.SOURCE_DEPARTMENT_ID
