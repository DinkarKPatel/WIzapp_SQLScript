CREATE PROCEDURE SP3S_ARTILCE_SYNCH_SET_SIZE
(
	@cArticle_Code	VARCHAR(50)
)
AS
BEGIN
	WITH SIZE
	AS
	(
		--SELECT PARA2_CODE,PARA2_NAME,ISNULL(PARA2_ORDER,0) AS PARA2_ORDER
		--FROM PARA2(NOLOCK)
		--WHERE PARA2_CODE<>'0000000  '
		--UNION 
		SELECT A.PARA2_CODE,B.PARA2_NAME,ISNULL(PARA2_ORDER,0) AS PARA2_ORDER
		FROM ART_DET A (NOLOCK)
		JOIN PARA2 B (NOLOCK) ON B.PARA2_CODE=A.PARA2_CODE
		WHERE A.PARA2_CODE<>'0000000  ' AND ARTICLE_CODE=@cArticle_Code
	)
	,ART
	AS
	(
		--SELECT ARTICLE_NO,ARTICLE_CODE,ARTICLE_SET_CODE 
		--FROM ARTICLE 
		--WHERE ARTICLE_CODE='010000014'
		--UNION 
		SELECT ARTICLE_NO,ARTICLE_CODE AS COMPONENT_ARTICLE_CODE,ARTICLE_SET_CODE AS ARTICLE_CODE
		FROM ARTICLE WHERE ARTICLE_SET_CODE=@cArticle_Code
	)
	SELECT Z.ARTICLE_CODE,Z.PARA2_CODE,Z.COMPONENT_ARTICLE_CODE,Z.PARA2_NAME,
	CAST(ISNULL(X.COMPONENT_PARA2_CODE,'0000000  ') AS VARCHAR(50)) AS COMPONENT_PARA2_CODE,CAST(ISNULL(X.COMPONENT_PARA2_NAME,'') AS VARCHAR(50)) AS COMPONENT_PARA2_NAME,
	Z.ARTICLE_NO,Z.PARA2_ORDER
	FROM
	(
	SELECT ARTICLE_CODE,PARA2_CODE,COMPONENT_ARTICLE_CODE,PARA2_NAME,CAST('0000000  ' AS VARCHAR(50)) AS COMPONENT_PARA2_CODE,CAST('' AS VARCHAR(50)) AS COMPONENT_PARA2_NAME,
	ARTICLE_NO,PARA2_ORDER
	FROM ART,SIZE
	)Z
	LEFT OUTER JOIN
	(
		SELECT a.ARTICLE_CODE,a.PARA2_CODE,a.COMPONENT_ARTICLE_CODE,b.para2_name,a.COMPONENT_PARA2_CODE ,b1.PARA2_NAME AS COMPONENT_PARA2_NAME,c1.ARTICLE_NO
		,b.para2_order
		FROM ART_COMPONENT_PARA2 a
		JOIN PARA2 b ON b.para2_code=a.para2_code
		JOIN article c On c.article_code=a.article_code
		JOIN PARA2 b1 ON b1.para2_code=a.COMPONENT_PARA2_CODE
		JOIN article c1 On c1.article_code=a.COMPONENT_article_code
		WHERE a.Article_Code=@cArticle_Code
	)X ON X.ARTICLE_CODE=Z.ARTICLE_CODE 
	AND X.PARA2_CODE=Z.PARA2_CODE 
	AND X.COMPONENT_ARTICLE_CODE=Z.COMPONENT_ARTICLE_CODE
	--AND X.COMPONENT_PARA2_CODE=Z.COMPONENT_PARA2_CODE
	ORDER BY Z.ARTICLE_NO,Z.PARA2_ORDER,Z.PARA2_NAME
END	