CREATE PROCEDURE SP_PPC_ISSUE_TERMS
(
 @NQUERYID INT=0,
 @CJOB_CODE VARCHAR(22)='',
 @CMEMO_ID VARCHAR(22)=''
)
AS
BEGIN

IF @NQUERYID=1
   GOTO LBLMST
ELSE IF @NQUERYID=2
   GOTO LBLDET
ELSE IF @NQUERYID=3
   GOTO LBLFIDET_VIEW
ELSE IF @NQUERYID=4
   GOTO LBLSIDET_VIEW
ELSE
   GOTO END_PROC
   
   LBLMST: 
        
        SELECT A.MEMO_ID ,A.TERM_NAME  FROM PPC_TERM_CONDITION_MST A
        WHERE A.XN_TYPE ='JWI'
        AND A.CANCELLED =0
        AND A.JOB_CODE =@CJOB_CODE
       
   GOTO END_PROC
   
   LBLDET:
            SELECT CAST('LATER' AS VARCHAR(22)) AS MEMO_ID,A.REMARKS,GETDATE () AS LAST_UPDATE  
            FROM PPC_TERM_CONDITION_DET  A
            JOIN PPC_TERM_CONDITION_MST B ON A.MEMO_ID =B.MEMO_ID 
            WHERE B.CANCELLED =0
            AND B.MEMO_ID =@CMEMO_ID 
        
   GOTO END_PROC
   
   LBLFIDET_VIEW:
   
        SELECT A.MEMO_ID,A.REMARKS,A.LAST_UPDATE FROM PPC_ISSUE_FI_TERMS A
        WHERE A.MEMO_ID=@CMEMO_ID 
           
    GOTO END_PROC    
    
    LBLSIDET_VIEW:
         
          SELECT A.MEMO_ID,A.REMARKS,A.LAST_UPDATE FROM PPC_ISSUE_SI_TERMS A
          WHERE A.MEMO_ID=@CMEMO_ID 
    
    GOTO END_PROC 
  
    
 END_PROC:
 
END
