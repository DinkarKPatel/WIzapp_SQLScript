CREATE PROCEDURE SP_DELETEUPLOADTABLES
(
	@CXN_TYPE           VARCHAR(20),
	@NSPID				VARCHAR(40)=''
)
AS
BEGIN
    
    DECLARE @CCMD NVARCHAR(MAX)
    IF @CXN_TYPE='PUR'
    BEGIN
          DELETE FROM PUR_PIM01106_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
          DELETE FROM PUR_PID01106_UPLOAD  WITH (ROWLOCK)   WHERE SP_ID=@NSPID
      	  DELETE FROM gst_taxinfo_calc WITH (ROWLOCK) WHERE sp_id=@nSpId
		  DELETE FROM gst_taxinfo_calc_oh WITH (ROWLOCK) WHERE sp_id=@nSpId
		  DELETE FROM GENBARCODE_ROWS WITH (ROWLOCK) WHERE sp_id=@nSpId
		  DELETE FROM PIM_POID_UPLOAD WITH (ROWLOCK) WHERE sp_id=@nSpId
        GOTO END_PRC
    END 
	
	ELSE IF @CXN_TYPE='PURMERGE'
    BEGIN
          DELETE FROM PUR_PIM01106_UPLOAD WITH (ROWLOCK)  WHERE SP_ID=@NSPID
          DELETE FROM PUR_PID01106_UPLOAD WITH (ROWLOCK)   WHERE SP_ID=@NSPID
        GOTO END_PRC
    END 

    ELSE IF @CXN_TYPE='WSL'
    BEGIN

        DELETE FROM WSL_INM01106_UPLOAD   WHERE SP_ID=@NSPID
        DELETE FROM WSL_IND01106_UPLOAD   WHERE SP_ID=@NSPID
		DELETE FROM WSL_paymode_xn_det_UPLOAD   WHERE SP_ID=@NSPID
		DELETE FROM gst_taxinfo_calc WHERE sp_id=@nSpId
		DELETE FROM gst_taxinfo_calc_oh WHERE sp_id=@nSpId
		
        GOTO END_PRC
    END 
    ELSE IF @CXN_TYPE='WPS'
    BEGIN

        DELETE FROM WPS_WPS_DET_UPLOAD   WHERE SP_ID=@NSPID
        DELETE FROM WPS_WPS_MST_UPLOAD   WHERE SP_ID=@NSPID
		  
        GOTO END_PRC
    END 
    ELSE IF @CXN_TYPE='HBD'
    BEGIN

        DELETE FROM PSHBD_hold_back_deliver_mst_UPLOAD with (rowlock)  WHERE SP_ID=@NSPID
        DELETE FROM PSHBD_hold_back_deliver_DET_UPLOAD with (rowlock)   WHERE SP_ID=@NSPID
		  
        GOTO END_PRC
    END 

    ELSE IF @CXN_TYPE='APR'
    BEGIN

        DELETE FROM APR_APPROVAL_RETURN_MST_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
        DELETE FROM APR_APPROVAL_RETURN_DET_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
		  
        GOTO END_PRC
    END 

    ELSE IF @CXN_TYPE='PRT'
    BEGIN
        DELETE FROM PRT_RMD01106_UPLOAD   WHERE SP_ID=LTRIM(RTRIM(@NSPID))
        DELETE FROM PRT_RMM01106_UPLOAD   WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM gst_taxinfo_calc WHERE sp_id=@nSpId
		DELETE FROM gst_taxinfo_calc_oh WHERE sp_id=@nSpId
        GOTO END_PRC
    
    END

    ELSE IF @CXN_TYPE='VCH'
    BEGIN
        DELETE FROM VCH_VM01106_UPLOAD  with (rowlock)   WHERE SP_ID=LTRIM(RTRIM(@NSPID))
        DELETE FROM VCH_VD01106_UPLOAD  with (rowlock)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM VCH_VDT01106_UPLOAD  with (rowlock)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM VCH_bill_by_bill_ref_UPLOAD  with (rowlock)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM VCH_VD_chqbook_UPLOAD  with (rowlock)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM VCH_postact_voucher_link_UPLOAD  with (rowlock)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))
		DELETE FROM vch_costcenterref_upload WITH (ROWLOCK)  WHERE SP_ID=LTRIM(RTRIM(@NSPID))

        GOTO END_PRC
    
    END


    ELSE IF @CXN_TYPE='WSR'
    BEGIN

        DELETE FROM WSR_CNM01106_UPLOAD   WHERE SP_ID=LTRIM(RTRIM(@NSPID))
        DELETE FROM WSR_CND01106_UPLOAD   WHERE SP_ID=LTRIM(RTRIM(@NSPID))
        
		DELETE FROM gst_taxinfo_calc WHERE sp_id=@nSpId
		DELETE FROM gst_taxinfo_calc_oh WHERE sp_id=@nSpId
        GOTO END_PRC
    
    END
	ELSE IF @CXN_TYPE='SLS'
    BEGIN

        DELETE FROM SLS_CMM01106_UPLOAD WITH (ROWLOCK)   WHERE SP_ID=@NSPId
        DELETE FROM SLS_CMD01106_UPLOAD WITH (ROWLOCK)   WHERE SP_ID=@NSPID
        DELETE FROM SLS_PAYMODE_XN_DET_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
		DELETE FROM SLS_COUPON_REDEMPTION_INFO_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
		DELETE FROM SLS_PACK_SLIP_Ref_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
		DELETE FROM SLS_DAILOGFILE_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID
		DELETE FROM SLS_CMD_MANUALBILL_ERRORS_UPLOAD WITH (ROWLOCK) WHERE SP_ID=@NSPID	
		DELETE FROM gst_taxinfo_calc WITH (ROWLOCK) WHERE sp_id=@nSpId
		DELETE FROM gst_xns_hsn WITH (ROWLOCK) WHERE sp_id=@nSpId	 

        GOTO END_PRC
    
    END


END_PRC:

END
