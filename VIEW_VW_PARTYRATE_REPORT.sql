CREATE VIEW VW_PARTYRATE_REPORT    

AS     
SELECT '' AS SUPPLIER_NAME, 
T2.MEMO_DT AS MEMO_DT, T2.MEMO_ID AS MEMO_NO,  T2. PARTY_RATE_DESCRIPTION,       
T2.FIN_YEAR , T1.*,B.ARTICLE_NAME,CC.SUB_SECTION_NAME,DD.SECTION_NAME,    
B.ARTICLE_NO,C.PARA1_NAME,D.PARA2_NAME,E.PARA3_NAME, F.PARA4_NAME, G.PARA5_NAME, H.PARA6_NAME,D.PARA2_ORDER,C.PARA1_ORDER ,  
B.ALIAS AS ARTICLE_ALIAS, (CASE WHEN BASE_PRICE=1 THEN 'MRP'  WHEN BASE_PRICE=2 THEN 'WSP' ELSE 'PURCHASE_PRICE' END) AS  BASE_PRICE_NAME,
(CASE WHEN CAL_MODE=2 THEN 'LESS' ELSE 'ADD' END) AS  CAL_MODE_NAME  
FROM PARTY_RATE_DET T1    
JOIN ARTICLE B (NOLOCK)  ON T1.ARTICLE_CODE = B.ARTICLE_CODE
JOIN SECTIOND CC ON CC.SUB_SECTION_CODE = B.SUB_SECTION_CODE
JOIN SECTIONM DD ON DD.SECTION_CODE = CC.SECTION_CODE      
JOIN PARA1 C (NOLOCK)  ON T1.PARA1_CODE = C.PARA1_CODE      
JOIN PARA2 D (NOLOCK)  ON T1.PARA2_CODE = D.PARA2_CODE       
JOIN PARA3 E (NOLOCK)  ON T1.PARA3_CODE = E.PARA3_CODE       
JOIN PARA4 F (NOLOCK)  ON T1.PARA4_CODE = F.PARA4_CODE       
JOIN PARA5 G (NOLOCK)  ON T1.PARA5_CODE = G.PARA5_CODE       
JOIN PARA6 H (NOLOCK) ON T1.PARA6_CODE = H.PARA6_CODE 
JOIN PARTY_RATE_MST T2 ON T2.MEMO_ID=T1.MEMO_ID
