CREATE VIEW VW_TRANSFER_TO_TRADING    

AS    
  SELECT  A.MEMO_ID,A.MEMO_NO,A.MEMO_DT,A.FIN_YEAR, ART.ARTICLE_NAME,  
  SM.SECTION_NAME, SD.SUB_SECTION_NAME,  
  P1.PARA1_NAME,P2.PARA2_NAME,P3.PARA3_NAME,           
  P4.PARA4_NAME,P5.PARA5_NAME,P6.PARA6_NAME,  
  E.UOM_NAME,LM.AC_NAME,B.BIN_NAME,  
  A.REMARKS AS REMARKS   ,A.CANCELLED
 FROM TRANSFER_TO_TRADING_MST A (NOLOCK)                 
 JOIN TRANSFER_TO_TRADING_DET G (NOLOCK)  ON A.MEMO_ID = G.MEMO_ID                            
 JOIN SKU ON SKU.PRODUCT_CODE=G.PRODUCT_CODE    
 JOIN ARTICLE ART ON SKU.ARTICLE_CODE = ART.ARTICLE_CODE              
 JOIN SECTIOND SD ON ART.SUB_SECTION_CODE = SD.SUB_SECTION_CODE            
 JOIN SECTIONM SM ON SD.SECTION_CODE = SM.SECTION_CODE            
 JOIN PARA1 P1 ON SKU.PARA1_CODE = P1.PARA1_CODE              
 JOIN PARA2 P2 ON SKU.PARA2_CODE = P2.PARA2_CODE              
 JOIN PARA3 P3 ON SKU.PARA3_CODE = P3.PARA3_CODE              
 JOIN PARA4 P4 ON SKU.PARA4_CODE = P4.PARA4_CODE              
 JOIN PARA5 P5 ON SKU.PARA5_CODE = P5.PARA5_CODE              
 JOIN PARA6 P6 ON SKU.PARA6_CODE = P6.PARA6_CODE        
 JOIN UOM E ON ART.UOM_CODE = E.UOM_CODE     
 JOIN BIN B ON B.BIN_ID=G.BIN_ID     
 JOIN LM01106 LM (NOLOCK) ON LM.AC_CODE = G.AC_CODE   
 group by A.MEMO_ID,A.MEMO_NO,A.MEMO_DT,A.FIN_YEAR, ART.ARTICLE_NAME,  
  SM.SECTION_NAME, SD.SUB_SECTION_NAME,  
  P1.PARA1_NAME,P2.PARA2_NAME,P3.PARA3_NAME,           
  P4.PARA4_NAME,P5.PARA5_NAME,P6.PARA6_NAME,  
  E.UOM_NAME,LM.AC_NAME,B.BIN_NAME,  
  A.REMARKS   ,A.CANCELLED          
--SELECT        
-- T1.MEMO_NO      
--,T1.MEMO_DT AS MEMO_DATE   
--,T3.DEPARTMENT_NAME AS [DEPARTMENT NAME]  
--,WO.MEMO_NO AS [WORK_ORDER_NO]   
--,WO.REF_NO AS [REFRENCE NO]  
--,ISNULL(T1.SUBTOTAL,0) AS SUBTOTAL    
--,T1.NET_AMOUNT      
--,T1.REMARKS AS MST_REMARKS       
--,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED      
--,T2.USERNAME AS USER_NAME     
--,T1.MEMO_ID     
--,T1.SOURCE_DEPARTMENT_ID AS DEPARTMENT_ID   
--,T1.FIN_YEAR, 
--K.QTY,
--K.COST_PRICE,
--K.PURCHASE_PRICE,
--K.WS_PRICE,
--K.INCREASE_PER,
--K.TOTAL_COST_PRICE 
--FROM PRD_TRANSFER_MAIN_MST T1     
--JOIN USERS T2 ON T1.USER_CODE = T2.USER_CODE  
--JOIN
--(
-- SELECT MEMO_ID,REF_PRD_WORKORDER_MEMOID,SUM(QTY) AS QTY,
--        SUM(COST_PRICE) AS COST_PRICE,
--        SUM(PURCHASE_PRICE) AS PURCHASE_PRICE,
--        SUM(WS_PRICE) AS WS_PRICE,
--        SUM(TOTAL_COST_PRICE) AS TOTAL_COST_PRICE,
--        SUM(INCREASE_PER) AS INCREASE_PER
-- FROM PRD_TRANSFER_MAIN_DET
-- GROUP BY MEMO_ID,REF_PRD_WORKORDER_MEMOID
--) K  ON T1.MEMO_ID = K.MEMO_ID 
----JOIN PRD_TRANSFER_MAIN_DET  K ON T1.MEMO_ID = K.MEMO_ID    
--JOIN PRD_DEPARTMENT_MST T3 ON T1.SOURCE_DEPARTMENT_ID=T3.DEPARTMENT_ID  
--JOIN PRD_WO_MST WO ON WO.MEMO_ID=K.REF_PRD_WORKORDER_MEMOID
