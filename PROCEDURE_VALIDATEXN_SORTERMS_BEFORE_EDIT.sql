CREATE PROC VALIDATEXN_SORTERMS_BEFORE_EDIT   
@CMEMOID VARCHAR(30),  
@BCANCELXN BIT,  
@CERRORMSG VARCHAR(200) OUTPUT,  
@CEXPRERRORMSG VARCHAR(200) OUTPUT  
--WITH ENCRYPTION
AS  
BEGIN  
   
 DECLARE @CTEXT VARCHAR(10),@CPRODUCTCODE VARCHAR(50) ,@CVALUE VARCHAR(2) 
   
 SELECT @CPRODUCTCODE=''  
 
   SELECT @CVALUE = VALUE  FROM CONFIG  WHERE CONFIG_OPTION ='NEW_ACCOUNT_SYSTEM'
    
   SET @CTEXT=(CASE WHEN @BCANCELXN=1 THEN 'CANCEL' ELSE 'EDIT' END)  
   
	IF EXISTS (SELECT TOP 1 id from TBL_EOSS_DISC_SHARE_MST (nolocK) where id=@cMemoId AND APPROVEDLEVELNO=99)
	BEGIN	
		SET @CERRORMSG='This Term has been Approved .......CAN NOT '+@CTEXT
		RETURN
	END 

	IF EXISTS (SELECT TOP 1 id from TBL_EOSS_DISC_SHARE_MST (nolocK) where id=@cMemoId AND Inactive=1)
	BEGIN	
		SET @CERRORMSG='This Term has been Inactive .......CAN NOT '+@CTEXT
		RETURN
	END 

END
