create PROCEDURE SP3S_PREPARE_MASTER_HO_DATA
(
	@DEPT_ID VARCHAR(5),
	@NMODE INT,			
	@REQCOLNAME VARCHAR(1000)=''
)
AS
BEGIN

--select @DEPT_ID as d,
--@NMODE as m,@REQCOLNAME r  into temp
          DECLARE @CTABLENAME NVARCHAR(MAX),@CCMD NVARCHAR(MAX),@CCURLOCTIONID VARCHAR(5)
          ,@CTEMPTABLE VARCHAR(1000),@LOCCTEMPTABLE NVARCHAR(MAX),
           @CERRMSG VARCHAR(1000)
          ,@CSTEP INT,@CWHERE NVARCHAR(MAX),@CODING BIT ,@CWHERE1 NVARCHAR(MAX),@CINSERTSKU BIT,
          @SKUCOL NVARCHAR(MAX),@SKUINS VARCHAR(2) 
          
          
          
BEGIN TRY          
              DECLARE @TABLE TABLE(ARTICLE_NO VARCHAR(50) ) 
              
              SET @CODING=0
                
        IF @NMODE=1
          BEGIN
          PRINT 'EXEC SP3S_PREPARE_MASTER_HO_DATA_SKU @DEPT_ID=@DEPT_ID--,@NMODE=@NMODE'
			   EXEC SP3S_PREPARE_MASTER_HO_DATA_SKU @DEPT_ID=@DEPT_ID--,@NMODE=@NMODE
			   return
          END
                
      --  IF @NMODE=1
      --    BEGIN
			   --SET @CTABLENAME='SKU'
			   --SET @CTEMPTABLE ='TEMP_SYNCH_'+@CTABLENAME+'_'+@DEPT_ID
			   --SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

      --    END
         IF EXISTS(SELECT TOP 1'U' FROM ARTICLE WHERE ARTICLE_NO=@REQCOLNAME  and article_code <> '00000000 ')
         SET @CODING=1
         ELSE
         SET @CODING=0
          
          
          IF @NMODE IN (2,9)
          BEGIN
			   SET @CTABLENAME='ARTICLE'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'
			    SET @CTEMPTABLE ='TEMP_SYNCH_'+@CTABLENAME+'_'+@DEPT_ID
			    
			    
			   IF @NMODE=2
			   SET @CWHERE=' WHERE ARTICLE_NO IN (SELECT A.ARTICLE_NO FROM ARTICLE A 
								JOIN ART_BOM B ON A.ARTICLE_CODE=B.BOM_ARTICLE_CODE
								JOIN ARTICLE C ON C.ARTICLE_CODE=B.ARTICLE_CODE
							    WHERE C.ARTICLE_NO='''+@REQCOLNAME+'''
							    UNION
							    SELECT '''+@REQCOLNAME+''') '
							    
				IF @NMODE=9	
				BEGIN
				--SET @LOCCTEMPTABLE='TEMP_SYNCH_'+@CTABLENAME+'_'+@DEPT_ID
				 SET @CWHERE= 'WHERE AR.ARTICLE_CODE IN (SELECT CODE FROM '+@CTEMPTABLE+')'
				END		    
				
          END
          
         IF EXISTS(SELECT TOP 1'U' FROM ARTICLE WHERE ARTICLE_NO=@REQCOLNAME AND coding_scheme=1  and article_code <> '00000000 ')
         BEGIN
         
          SET @CWHERE1='LEFT JOIN 
			(
			  SELECT A.PARA2_CODE AS Z_PARA2_CODE , 
				A.LAST_UPDATE AS Z_LAST_UPDATE , 
				A.PURCHASE_PRICE AS Z_PURCHASE_PRICE , 
				A.PARA3_CODE AS Z_PARA3_CODE , 
				A.INV_DT AS Z_INV_DT , 
				A.INV_NO AS Z_INV_NO , A.AC_CODE AS Z_AC_CODE , 
				A.RECEIPT_DT AS Z_RECEIPT_DT , A.PARA4_CODE AS Z_PARA4_CODE , 
				A.PARA5_CODE AS Z_PARA5_CODE , A.PARA6_CODE AS Z_PARA6_CODE , 
				A.FORM_ID AS Z_FORM_ID , A.MRP AS Z_MRP , 
				A.DT_CREATED AS Z_DT_CREATED , A.WS_PRICE AS Z_WS_PRICE , 
				A.IMAGE_NAME AS Z_IMAGE_NAME , A.TAX_AMOUNT AS Z_TAX_AMOUNT , 
				A.CHALLAN_NO AS Z_CHALLAN_NO , A.FIX_MRP AS Z_FIX_MRP , 
				A.PRODUCT_NAME AS Z_PRODUCT_NAME , A.PRODUCT_CODE AS Z_PRODUCT_CODE , 
				A.ARTICLE_CODE AS Z_ARTICLE_CODE , A.PARA1_CODE AS Z_PARA1_CODE , 
				A.ER_FLAG AS Z_ER_FLAG , 
				A.UPLOADED_TO_ACTIVSTREAM AS Z_UPLOADED_TO_ACTIVSTREAM , 
				A.BARCODE_CODING_SCHEME AS Z_BARCODE_CODING_SCHEME , 
				A.EMP_CODE AS Z_EMP_CODE , A.VENDOR_EAN_NO AS Z_VENDOR_EAN_NO , 
				A.ONLINE_PRODUCT_CODE AS Z_ONLINE_PRODUCT_CODE , 
				A.LAST_MODIFIED_ON AS Z_LAST_MODIFIED_ON , 
				A.BASIC_PURCHASE_PRICE AS Z_BASIC_PURCHASE_PRICE , 
				A.HSN_CODE AS Z_HSN_CODE , A.GST_PERCENTAGE AS Z_GST_PERCENTAGE , 
				A.BATCH_NO AS Z_BATCH_NO , A.EXPIRY_DT AS Z_EXPIRY_DT  
               FROM SKU A(NOLOCK) 
               JOIN ARTICLE B(NOLOCK) ON A.ARTICLE_CODE=B.ARTICLE_CODE
			  '+@CWHERE+' AND B.CODING_SCHEME=1 
			)Z ON Z.Z_ARTICLE_CODE=AR.ARTICLE_CODE'
			
			SET @SKUCOL='Z.*,'
			SET @SKUINS='Y'
         
         END
         ELSE
          BEGIN
               SET @CWHERE1=''
				SET @SKUCOL=''
				SET @SKUINS='N'
			END
  
          
          IF @NMODE=3
          BEGIN
			   SET @CTABLENAME='PARA1'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          
          IF @NMODE=4
          BEGIN
			   SET @CTABLENAME='PARA2'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          IF @NMODE=5
          BEGIN
			   SET @CTABLENAME='PARA3'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          IF @NMODE=6
          BEGIN
			   SET @CTABLENAME='PARA4'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          IF @NMODE=7
          BEGIN
			   SET @CTABLENAME='PARA5'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          IF @NMODE=8
          BEGIN
			   SET @CTABLENAME='PARA6'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@DEPT_ID+'_DETAIL'

          END 
          
          
             --- DROP TEMP TABLE IF EXISTS 
			SET @CCMD=N'IF OBJECT_ID('''+@LOCCTEMPTABLE+''',''U'') IS NOT NULL 
						   DROP TABLE '+@LOCCTEMPTABLE+''          
			PRINT @CCMD
			EXEC SP_EXECUTESQL @CCMD
			
          


 --IF @NMODE=1
 -- BEGIN
	--	SET @CSTEP=10         
	--	SET @CCMD=N'SELECT A.*, 
	--	--- SECTIOND
	--	SD.SUB_SECTION_NAME,SD.ALIAS AS SD_ALIAS,SD.INACTIVE AS SD_INACTIVE,SD.MFG_CATEGORY AS SD_MFG_CATEGORY,SD.SECTION_CODE AS SD_SECTION_CODE,
	--	--- SECTIONM
	--	SM.SECTION_NAME,SM.ALIAS AS SM_ALIAS,SM.INACTIVE AS SM_INACTIVE,
	--	---PARA1
	--	P1.PARA1_NAME AS P1_PARA1_NAME,P1.ALIAS AS P1_ALIAS,P1.INACTIVE AS P1_INACTIVE,
	--	---PARA2
	--	P2.ALIAS AS P2_ALIAS,P2.INACTIVE AS P2_INACTIVE,P2.PARA2_ORDER AS P2_PARA2_ORDER,P2.PARA2_NAME AS P2_PARA2_NAME,
	--	---PARA3
	--	P3.PARA3_NAME AS P3_PARA3_NAME,P3.ALIAS AS P3_ALIAS,P3.INACTIVE AS P3_INACTIVE,
	--	---PARA4
	--	P4.PARA4_NAME AS P4_PARA4_NAME,P4.ALIAS AS P4_ALIAS,P4.INACTIVE AS P4_INACTIVE,
	--	---PARA5
	--	P5.ALIAS AS P5_ALIAS,P5.INACTIVE AS P5_INACTIVE,P5.PARA5_NAME AS P5_PARA5_NAME,
	--	---PARA6
	--	P6.PARA6_NAME AS P6_PARA6_NAME,P6.ALIAS AS P6_ALIAS,P6.INACTIVE AS P6_INACTIVE,
	--	---- HSN MASTER RELATED TO SKU
		
 --       HM.HSN_TYPE AS HM_HSN_TYPE,HM.TAXABLE_ITEM AS HM_TAXABLE_ITEM,
 --       HD.HSN_TYPE AS HD_HSN_TYPE,HD.TAXABLE_ITEM AS HD_TAXABLE_ITEM,
        
        
 --       HD1.HSN_CODE AS HD1_HSN_CODE,HD1.TAX_PERCENTAGE AS HD1_TAX_PERCENTAGE,
 --       HD1.RATE_CUTOFF AS HD1_RATE_CUTOFF,HD1.RATE_CUTOFF_TAX_PERCENTAGE AS HD1_RATE_CUTOFF_TAX_PERCENTAGE,
	--	HD1.WEF AS HD1_WEF,HD1.ROW_ID AS HD1_ROW_ID,

	--	HD2.HSN_CODE AS HD2_HSN_CODE,HD2.TAX_PERCENTAGE AS HD2_TAX_PERCENTAGE,
 --       HD2.RATE_CUTOFF AS HD2_RATE_CUTOFF,HD2.RATE_CUTOFF_TAX_PERCENTAGE AS HD2_RATE_CUTOFF_TAX_PERCENTAGE,
	--	HD2.WEF AS HD2_WEF,HD2.ROW_ID AS HD2_ROW_ID
		
	--	--- LM01106 
	--	,L.INACTIVE AS LM_INACTIVE,L.AC_NAME AS LM_AC_NAME,L.PRINT_LEDGER AS LM_PRINT_LEDGER,
	--	L.HEAD_CODE AS LM_HEAD_CODE,L.ALIAS AS LM_ALIAS,
		
	--	---UOM
	--	U.UOM_TYPE AS U_UOM_TYPE,U.INACTIVE AS U_INACTIVE,U.UOM_NAME AS U_UOM_NAME ,
	--	-- ARTICLE 
		
	--	AR.DISCON AS AR_DISCON,AR.STOCK_NA AS AR_STOCK_NA,AR.ARTICLE_CODE AS AR_ARTICLE_CODE,AR.ARTICLE_NO AS AR_ARTICLE_NO,
	--	AR.ARTICLE_NAME AS AR_ARTICLE_NAME,AR.ARTICLE_DESC AS AR_ARTICLE_DESC,
	--	AR.SUB_SECTION_CODE AS AR_SUB_SECTION_CODE,
	--	AR.GENERATE_BARCODES_WITHARTICLE_PREFIX AS AR_GENERATE_BARCODES_WITHARTICLE_PREFIX,
	--	AR.GEN_EAN_CODES AS AR_GEN_EAN_CODES,AR.ORDERITEM AS AR_ORDERITEM,AR.CODING_SCHEME AS AR_CODING_SCHEME,
	--	AR.UOM_CODE AS AR_UOM_CODE,AR.ALIAS AS AR_ALIAS,AR.INACTIVE AS AR_INACTIVE,AR.SKU_CODE AS AR_SKU_CODE,
	--	AR.HSN_CODE AS AR_HSN_CODE,

	--	H.HEAD_NAME AS H_HEAD_NAME,
 --       H.MAJOR_HEAD_CODE AS H_MAJOR_HEAD_CODE,H.PHYSICAL AS H_PHYSICAL,H.ALIAS AS H_ALIAS,
	--	H.PRINT_HEAD AS H_PRINT_HEAD,H.CREDITOR_DEBTOR_CODE AS H_CREDITOR_DEBTOR_CODE,
	--	H.INACTIVE AS H_INACTIVE,
		
	--  INTO '+@LOCCTEMPTABLE+'
	--	FROM SKU A(NOLOCK) 
	--	JOIN ARTICLE AR(NOLOCK) ON A.ARTICLE_CODE=AR.ARTICLE_CODE 
	--	JOIN SECTIOND SD(NOLOCK) ON SD.SUB_SECTION_CODE=AR.SUB_SECTION_CODE
	--	JOIN SECTIONM SM(NOLOCK) ON SM.SECTION_CODE=SD.SECTION_CODE
	--	JOIN PARA1 P1(NOLOCK) ON P1.PARA1_CODE=A.PARA1_CODE
	--	JOIN PARA2 P2(NOLOCK) ON P2.PARA2_CODE=A.PARA2_CODE
	--	JOIN PARA3 P3(NOLOCK) ON P3.PARA3_CODE=A.PARA3_CODE
	--	JOIN PARA4 P4(NOLOCK) ON P4.PARA4_CODE=A.PARA4_CODE
	--	JOIN PARA5 P5(NOLOCK) ON P5.PARA5_CODE=A.PARA5_CODE
	--	JOIN PARA6 P6(NOLOCK) ON P6.PARA6_CODE=A.PARA6_CODE
		
	--	LEFT JOIN HSN_MST HM(NOLOCK) ON HM.HSN_CODE=A.HSN_CODE
	--	LEFT JOIN HSN_MST HD(NOLOCK) ON HD.HSN_CODE=AR.HSN_CODE
	--	LEFT JOIN HSN_DET HD1(NOLOCK) ON HD1.HSN_CODE=A.HSN_CODE
	--	LEFT JOIN HSN_DET HD2(NOLOCK) ON HD2.HSN_CODE=AR.HSN_CODE
		
	--	JOIN FORM F(NOLOCK) ON F.FORM_ID=A.FORM_ID
	--	JOIN LM01106 L(NOLOCK) ON L.AC_CODE=A.AC_CODE
	--	JOIN UOM U(NOLOCK) ON U.UOM_CODE=AR.UOM_CODE
	--	JOIN HD01106 H(NOLOCK) ON H.HEAD_CODE=L.HEAD_CODE
	--	WHERE PRODUCT_CODE IN (SELECT CODE FROM '+@CTEMPTABLE+')'
	--PRINT @CCMD 
	--EXEC SP_EXECUTESQL @CCMD		
			   
 -- END
  
	  

IF @NMODE IN (2,9) AND @CODING=0
BEGIN
     if object_id(@CTEMPTABLE,'u') is null
	 begin
	    SET @CERRMSG ='ARTICLE DOES NOT EXISTS'
		GOTO END_PROC
	 end

	SET @CSTEP=10         
	SET @CCMD=N'SELECT 
	   0 AS CODING, ''N'' AS SKUINS, 
	SD.SUB_SECTION_NAME,SD.ALIAS AS SD_ALIAS,SD.INACTIVE AS SD_INACTIVE,SD.MFG_CATEGORY AS SD_MFG_CATEGORY,SD.SECTION_CODE AS SD_SECTION_CODE,
	SM.SECTION_NAME,SM.ALIAS AS SM_ALIAS,SM.INACTIVE AS SM_INACTIVE,SM.ITEM_TYPE AS SM_ITEM_TYPE
	,U.UOM_TYPE AS U_UOM_TYPE,U.INACTIVE AS U_INACTIVE,U.UOM_NAME AS U_UOM_NAME ,
	AR.DISCON AS AR_DISCON,AR.STOCK_NA AS AR_STOCK_NA,AR.ARTICLE_CODE AS AR_ARTICLE_CODE,AR.ARTICLE_NO AS AR_ARTICLE_NO,
	AR.ARTICLE_NAME AS AR_ARTICLE_NAME,AR.ARTICLE_DESC AS AR_ARTICLE_DESC,
	AR.SUB_SECTION_CODE AS AR_SUB_SECTION_CODE,
	AR.GENERATE_BARCODES_WITHARTICLE_PREFIX AS AR_GENERATE_BARCODES_WITHARTICLE_PREFIX,
	AR.GEN_EAN_CODES AS AR_GEN_EAN_CODES,AR.ORDERITEM AS AR_ORDERITEM,AR.CODING_SCHEME AS AR_CODING_SCHEME,
	AR.UOM_CODE AS AR_UOM_CODE,AR.ALIAS AS AR_ALIAS,AR.INACTIVE AS AR_INACTIVE,AR.SKU_CODE AS AR_SKU_CODE,
	AR.HSN_CODE AS AR_HSN_CODE,AR.PARA1_SET AS AR_PARA1_SET,AR.PARA2_SET AS AR_PARA2_SET,
	AR.ARTICLE_PURCHASE_MODE AS AR_ARTICLE_PURCHASE_MODE,AR.ARTICLE_TYPE AS AR_ARTICLE_TYPE,AR.MRP AS AR_MRP,
   
    Y.ATTR1_KEY_CODE  AS  Y_ATTR1_KEY_CODE,  Y.ATTR2_KEY_CODE  AS  Y_ATTR2_KEY_CODE,  Y.ATTR3_KEY_CODE  AS  Y_ATTR3_KEY_CODE, 
    Y.ATTR4_KEY_CODE  AS  Y_ATTR4_KEY_CODE,  Y.ATTR5_KEY_CODE  AS  Y_ATTR5_KEY_CODE,  Y.ATTR6_KEY_CODE  AS  Y_ATTR6_KEY_CODE, 
    Y.ATTR7_KEY_CODE  AS  Y_ATTR7_KEY_CODE,  Y.ATTR8_KEY_CODE  AS  Y_ATTR8_KEY_CODE,  Y.ATTR9_KEY_CODE  AS  Y_ATTR9_KEY_CODE, 
    Y.ATTR10_KEY_CODE AS  Y_ATTR10_KEY_CODE, Y.ATTR11_KEY_CODE AS  Y_ATTR11_KEY_CODE, Y.ATTR12_KEY_CODE AS  Y_ATTR12_KEY_CODE, 
    Y.ATTR13_KEY_CODE AS  Y_ATTR13_KEY_CODE, Y.ATTR14_KEY_CODE AS  Y_ATTR14_KEY_CODE, Y.ATTR15_KEY_CODE AS  Y_ATTR15_KEY_CODE,
    Y.ATTR16_KEY_CODE AS  Y_ATTR16_KEY_CODE, Y.ATTR17_KEY_CODE AS  Y_ATTR17_KEY_CODE, Y.ATTR18_KEY_CODE AS  Y_ATTR18_KEY_CODE, 
    Y.ATTR19_KEY_CODE AS  Y_ATTR19_KEY_CODE, Y.ATTR20_KEY_CODE AS  Y_ATTR20_KEY_CODE, Y.ATTR21_KEY_CODE AS  Y_ATTR21_KEY_CODE, 
    Y.ATTR22_KEY_CODE AS  Y_ATTR22_KEY_CODE, Y.ATTR23_KEY_CODE AS  Y_ATTR23_KEY_CODE, Y.ATTR24_KEY_CODE AS  Y_ATTR24_KEY_CODE, 
    Y.ATTR25_KEY_CODE AS  Y_ATTR25_KEY_CODE, 
    
      Y1.ATTR1_KEY_NAME AS Y1_ATTR1_KEY_NAME,Y1.ATTR1_ALIAS AS Y1_ATTR1_ALIAS, Y1.ATTR1_INACTIVE AS Y1_ATTR1_INACTIVE, 
	  Y2.ATTR2_KEY_NAME AS Y2_ATTR2_KEY_NAME,Y2.ATTR2_ALIAS AS Y2_ATTR2_ALIAS, Y2.ATTR2_INACTIVE AS Y2_ATTR2_INACTIVE ,
	  Y3.ATTR3_KEY_NAME AS Y3_ATTR3_KEY_NAME,Y3.ATTR3_ALIAS AS Y3_ATTR3_ALIAS, Y3.ATTR3_INACTIVE AS Y3_ATTR3_INACTIVE ,
	  Y4.ATTR4_KEY_NAME AS Y4_ATTR4_KEY_NAME,Y4.ATTR4_ALIAS AS Y4_ATTR4_ALIAS, Y4.ATTR4_INACTIVE AS Y4_ATTR4_INACTIVE ,
	  Y5.ATTR5_KEY_NAME AS Y5_ATTR5_KEY_NAME,Y5.ATTR5_ALIAS AS Y5_ATTR5_ALIAS, Y5.ATTR5_INACTIVE AS Y5_ATTR5_INACTIVE ,
	  Y6.ATTR6_KEY_NAME AS Y6_ATTR6_KEY_NAME,Y6.ATTR6_ALIAS AS Y6_ATTR6_ALIAS, Y6.ATTR6_INACTIVE AS Y6_ATTR6_INACTIVE ,
	  Y7.ATTR7_KEY_NAME AS Y7_ATTR7_KEY_NAME,Y7.ATTR7_ALIAS AS Y7_ATTR7_ALIAS, Y7.ATTR7_INACTIVE AS Y7_ATTR7_INACTIVE ,
	  Y8.ATTR8_KEY_NAME AS Y8_ATTR8_KEY_NAME,Y8.ATTR8_ALIAS AS Y8_ATTR8_ALIAS, Y8.ATTR8_INACTIVE AS Y8_ATTR8_INACTIVE ,
	  Y9.ATTR9_KEY_NAME AS Y9_ATTR9_KEY_NAME,Y9.ATTR9_ALIAS AS Y9_ATTR9_ALIAS, Y9.ATTR9_INACTIVE AS Y9_ATTR9_INACTIVE ,
	  Y10.ATTR10_KEY_NAME AS Y10_ATTR10_KEY_NAME,Y10.ATTR10_ALIAS AS Y10_ATTR10_ALIAS, Y10.ATTR10_INACTIVE AS Y10_ATTR10_INACTIVE ,
	  Y11.ATTR11_KEY_NAME AS Y11_ATTR11_KEY_NAME,Y11.ATTR11_ALIAS AS Y11_ATTR11_ALIAS, Y11.ATTR11_INACTIVE AS Y11_ATTR11_INACTIVE ,
	  Y12.ATTR12_KEY_NAME AS Y12_ATTR12_KEY_NAME,Y12.ATTR12_ALIAS AS Y12_ATTR12_ALIAS, Y12.ATTR12_INACTIVE AS Y12_ATTR12_INACTIVE ,
	  Y13.ATTR13_KEY_NAME AS Y13_ATTR13_KEY_NAME,Y13.ATTR13_ALIAS AS Y13_ATTR13_ALIAS, Y13.ATTR13_INACTIVE AS Y13_ATTR13_INACTIVE ,
	  Y14.ATTR14_KEY_NAME AS Y14_ATTR14_KEY_NAME,Y14.ATTR14_ALIAS AS Y14_ATTR14_ALIAS, Y14.ATTR14_INACTIVE AS Y14_ATTR14_INACTIVE ,
	  Y15.ATTR15_KEY_NAME AS Y15_ATTR15_KEY_NAME,Y15.ATTR15_ALIAS AS Y15_ATTR15_ALIAS, Y15.ATTR15_INACTIVE AS Y15_ATTR15_INACTIVE ,
	  Y16.ATTR16_KEY_NAME AS Y16_ATTR16_KEY_NAME,Y16.ATTR16_ALIAS AS Y16_ATTR16_ALIAS, Y16.ATTR16_INACTIVE AS Y16_ATTR16_INACTIVE ,
	  Y17.ATTR17_KEY_NAME AS Y17_ATTR17_KEY_NAME,Y17.ATTR17_ALIAS AS Y17_ATTR17_ALIAS, Y17.ATTR17_INACTIVE AS Y17_ATTR17_INACTIVE ,
	  Y18.ATTR18_KEY_NAME AS Y18_ATTR18_KEY_NAME,Y18.ATTR18_ALIAS AS Y18_ATTR18_ALIAS, Y18.ATTR18_INACTIVE AS Y18_ATTR18_INACTIVE ,
	  Y19.ATTR19_KEY_NAME AS Y19_ATTR19_KEY_NAME,Y19.ATTR19_ALIAS AS Y19_ATTR19_ALIAS, Y19.ATTR19_INACTIVE AS Y19_ATTR19_INACTIVE ,
	  Y20.ATTR20_KEY_NAME AS Y20_ATTR20_KEY_NAME,Y20.ATTR20_ALIAS AS Y20_ATTR20_ALIAS, Y20.ATTR20_INACTIVE AS Y20_ATTR20_INACTIVE ,
	  Y21.ATTR21_KEY_NAME AS Y21_ATTR21_KEY_NAME,Y21.ATTR21_ALIAS AS Y21_ATTR21_ALIAS, Y21.ATTR21_INACTIVE AS Y21_ATTR21_INACTIVE ,
	  Y22.ATTR22_KEY_NAME AS Y22_ATTR22_KEY_NAME,Y22.ATTR22_ALIAS AS Y22_ATTR22_ALIAS, Y22.ATTR22_INACTIVE AS Y22_ATTR22_INACTIVE ,
	  Y23.ATTR23_KEY_NAME AS Y23_ATTR23_KEY_NAME,Y23.ATTR23_ALIAS AS Y23_ATTR23_ALIAS, Y23.ATTR23_INACTIVE AS Y23_ATTR23_INACTIVE ,
	  Y24.ATTR24_KEY_NAME AS Y24_ATTR24_KEY_NAME,Y24.ATTR24_ALIAS AS Y24_ATTR24_ALIAS, Y24.ATTR24_INACTIVE AS Y24_ATTR24_INACTIVE ,
	  Y25.ATTR25_KEY_NAME AS Y25_ATTR25_KEY_NAME,Y25.ATTR25_ALIAS AS Y25_ATTR25_ALIAS, Y25.ATTR25_INACTIVE AS Y25_ATTR25_INACTIVE ,
	  SA.SUB_SECTION_CODE AS SA_SUB_SECTION_CODE,SA.ATTR1_MST AS SA_ATTR1_MST,
	  SA.ATTR2_MST AS SA_ATTR2_MST,SA.ATTR3_MST AS SA_ATTR3_MST,
	  SA.ATTR4_MST AS SA_ATTR4_MST,SA.ATTR5_MST AS SA_ATTR5_MST,
	  SA.ATTR6_MST AS SA_ATTR6_MST,SA.ATTR7_MST AS SA_ATTR7_MST,
	  SA.ATTR8_MST AS SA_ATTR8_MST,SA.ATTR9_MST AS SA_ATTR9_MST,
	  SA.ATTR10_MST AS SA_ATTR10_MST,SA.ATTR11_MST AS SA_ATTR11_MST,
	  SA.ATTR12_MST AS SA_ATTR12_MST,SA.ATTR13_MST AS SA_ATTR13_MST,
	  SA.ATTR14_MST AS SA_ATTR14_MST,SA.ATTR15_MST AS SA_ATTR15_MST,
	  SA.ATTR16_MST AS SA_ATTR16_MST,SA.ATTR17_MST AS SA_ATTR17_MST,
	  SA.ATTR18_MST AS SA_ATTR18_MST,SA.ATTR19_MST AS SA_ATTR19_MST,
	  SA.ATTR20_MST AS SA_ATTR20_MST,SA.ATTR21_MST AS SA_ATTR21_MST,
	  SA.ATTR22_MST AS SA_ATTR22_MST,SA.ATTR23_MST AS SA_ATTR23_MST,
	  SA.ATTR24_MST AS SA_ATTR24_MST,SA.ATTR25_MST AS SA_ATTR25_MST

  INTO '+@LOCCTEMPTABLE+'
	FROM  
	ARTICLE AR(NOLOCK)
	JOIN  '+@CTEMPTABLE+' TS(NOLOCK) ON TS.CODE=AR.ARTICLE_CODE
	JOIN SECTIOND SD(NOLOCK) ON SD.SUB_SECTION_CODE=AR.SUB_SECTION_CODE
	JOIN SECTIONM SM(NOLOCK) ON SM.SECTION_CODE=SD.SECTION_CODE
	JOIN UOM U(NOLOCK) ON U.UOM_CODE=AR.UOM_CODE
	LEFT JOIN ARTICLE_FIX_ATTR Y(NOLOCK) ON Y.ARTICLE_CODE=AR.ARTICLE_CODE
	LEFT JOIN ATTR1_MST Y1(NOLOCK) ON Y.attr1_key_code=Y1.attr1_key_code
	LEFT JOIN ATTR2_MST Y2(NOLOCK) ON Y.attr2_key_code=Y2.attr2_key_code
	LEFT JOIN ATTR3_MST Y3(NOLOCK) ON Y.attr3_key_code=Y3.attr3_key_code
	LEFT JOIN ATTR4_MST Y4(NOLOCK) ON Y.attr4_key_code=Y4.attr4_key_code
	LEFT JOIN ATTR5_MST Y5(NOLOCK) ON Y.attr5_key_code=Y5.attr5_key_code
	LEFT JOIN ATTR6_MST Y6(NOLOCK) ON Y.attr6_key_code=Y6.attr6_key_code
	LEFT JOIN ATTR7_MST Y7(NOLOCK) ON Y.attr7_key_code=Y7.attr7_key_code
	LEFT JOIN ATTR8_MST Y8(NOLOCK) ON Y.attr8_key_code=Y8.attr8_key_code
	LEFT JOIN ATTR9_MST Y9(NOLOCK) ON Y.attr9_key_code=Y9.attr9_key_code
	LEFT JOIN ATTR10_MST Y10(NOLOCK) ON Y.attr10_key_code=Y10.attr10_key_code
	LEFT JOIN ATTR11_MST Y11(NOLOCK) ON Y.attr11_key_code=Y11.attr11_key_code
	LEFT JOIN ATTR12_MST Y12(NOLOCK) ON Y.attr12_key_code=Y12.attr12_key_code
	LEFT JOIN ATTR13_MST Y13(NOLOCK) ON Y.attr13_key_code=Y13.attr13_key_code
	LEFT JOIN ATTR14_MST Y14(NOLOCK) ON Y.attr14_key_code=Y14.attr14_key_code
	LEFT JOIN ATTR15_MST Y15(NOLOCK) ON Y.attr15_key_code=Y15.attr15_key_code
	LEFT JOIN ATTR16_MST Y16(NOLOCK) ON Y.attr16_key_code=Y16.attr16_key_code
	LEFT JOIN ATTR17_MST Y17(NOLOCK) ON Y.attr17_key_code=Y17.attr17_key_code
	LEFT JOIN ATTR18_MST Y18(NOLOCK) ON Y.attr18_key_code=Y18.attr18_key_code
	LEFT JOIN ATTR19_MST Y19(NOLOCK) ON Y.attr19_key_code=Y19.attr19_key_code
	LEFT JOIN ATTR20_MST Y20(NOLOCK) ON Y.attr20_key_code=Y20.attr20_key_code
	LEFT JOIN ATTR21_MST Y21(NOLOCK) ON Y.attr21_key_code=Y21.attr21_key_code
	LEFT JOIN ATTR22_MST Y22(NOLOCK) ON Y.attr22_key_code=Y22.attr22_key_code
	LEFT JOIN ATTR23_MST Y23(NOLOCK) ON Y.attr23_key_code=Y23.attr23_key_code
	LEFT JOIN ATTR24_MST Y24(NOLOCK) ON Y.attr24_key_code=Y24.attr24_key_code
	LEFT JOIN ATTR25_MST Y25(NOLOCK) ON Y.attr25_key_code=Y25.attr25_key_code
	LEFT JOIN SD_ATTR_AVATAR SA(NOLOCK) ON SA.SUB_SECTION_CODE=SD.SUB_SECTION_CODE'
	
PRINT @CCMD 
EXEC SP_EXECUTESQL @CCMD		
		   
END
	  
	  IF @NMODE IN (2,9) AND @CODING=1
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT 
			DISTINCT  1 AS CODING, '''+@SKUINS+''' AS SKUINS, '+@SKUCOL+'  
			SD.SUB_SECTION_NAME,SD.ALIAS AS SD_ALIAS,SD.INACTIVE AS SD_INACTIVE,SD.MFG_CATEGORY AS SD_MFG_CATEGORY,SD.SECTION_CODE AS SD_SECTION_CODE,
			SM.SECTION_NAME,SM.ALIAS AS SM_ALIAS,SM.INACTIVE AS SM_INACTIVE,SM.ITEM_TYPE AS SM_ITEM_TYPE,
			P1.PARA1_CODE AS P1_PARA1_CODE,P1.PARA1_NAME AS P1_PARA1_NAME,P1.ALIAS AS P1_ALIAS,P1.INACTIVE AS P1_INACTIVE,
			P2.PARA2_CODE AS P2_PARA2_CODE,P2.ALIAS AS P2_ALIAS,P2.INACTIVE AS P2_INACTIVE,P2.PARA2_ORDER AS P2_PARA2_ORDER,P2.PARA2_NAME AS P2_PARA2_NAME,
			P3.PARA3_CODE AS P3_PARA3_CODE,P3.PARA3_NAME AS P3_PARA3_NAME,P3.ALIAS AS P3_ALIAS,P3.INACTIVE AS P3_INACTIVE,
			P4.PARA4_CODE AS P4_PARA4_CODE,P4.PARA4_NAME AS P4_PARA4_NAME,P4.ALIAS AS P4_ALIAS,P4.INACTIVE AS P4_INACTIVE,
			P5.PARA5_CODE AS P5_PARA5_CODE,P5.ALIAS AS P5_ALIAS,P5.INACTIVE AS P5_INACTIVE,P5.PARA5_NAME AS P5_PARA5_NAME,
			P6.PARA6_CODE AS P6_PARA6_CODE,P6.PARA6_NAME AS P6_PARA6_NAME,P6.ALIAS AS P6_ALIAS,P6.INACTIVE AS P6_INACTIVE,	
            HD.HSN_TYPE AS HD_HSN_TYPE,HD.TAXABLE_ITEM AS HD_TAXABLE_ITEM,
        	HD2.HSN_CODE AS HD2_HSN_CODE,HD2.TAX_PERCENTAGE AS HD2_TAX_PERCENTAGE,
			HD2.RATE_CUTOFF AS HD2_RATE_CUTOFF,HD2.RATE_CUTOFF_TAX_PERCENTAGE AS HD2_RATE_CUTOFF_TAX_PERCENTAGE,
			HD2.WEF AS HD2_WEF,HD2.ROW_ID AS HD2_ROW_ID
			,U.UOM_TYPE AS U_UOM_TYPE,U.INACTIVE AS U_INACTIVE,U.UOM_NAME AS U_UOM_NAME ,		
			AR.DISCON AS AR_DISCON,AR.STOCK_NA AS AR_STOCK_NA,AR.ARTICLE_CODE AS AR_ARTICLE_CODE,AR.ARTICLE_NO AS AR_ARTICLE_NO,
			AR.ARTICLE_NAME AS AR_ARTICLE_NAME,AR.ARTICLE_DESC AS AR_ARTICLE_DESC,
			AR.SUB_SECTION_CODE AS AR_SUB_SECTION_CODE,
			AR.GENERATE_BARCODES_WITHARTICLE_PREFIX AS AR_GENERATE_BARCODES_WITHARTICLE_PREFIX,
			AR.GEN_EAN_CODES AS AR_GEN_EAN_CODES,AR.ORDERITEM AS AR_ORDERITEM,AR.CODING_SCHEME AS AR_CODING_SCHEME,
			AR.UOM_CODE AS AR_UOM_CODE,AR.ALIAS AS AR_ALIAS,AR.INACTIVE AS AR_INACTIVE,AR.SKU_CODE AS AR_SKU_CODE,
			AR.HSN_CODE AS AR_HSN_CODE,AR.PARA1_SET AS AR_PARA1_SET,AR.PARA2_SET AS AR_PARA2_SET,
			AR.ARTICLE_PURCHASE_MODE AS AR_ARTICLE_PURCHASE_MODE,AR.ARTICLE_TYPE AS AR_ARTICLE_TYPE,AR.MRP AS AR_MRP,
			ARTPARA.PARA1_DESC AS ARTPARA_PARA1_DESC,ARTPARA.ROW_ID AS ARTPARA_ROW_ID,
			ARDET.MRP AS ARDET_MRP,
			ARDET.WS_PRICE AS ARTDET_WS_PRICE,ARDET.MRP_INC_AMT  AS ARTDET_MRP_INC_AMT,
			ARDET.MRP2  AS ARTDET_MRP2,ARDET.PARA2_RATIO  AS ARTDET_PARA2_RATIO,
			ARDET.PURCHASE_PRICE  AS ARTDET_PURCHASE_PRICE,ARDET.CENTER_POINT  AS ARTDET_CENTER_POINT,
			ARDET.SIZEGROUP_CODE  AS ARTDET_SIZEGROUP_CODE,ARDET.ROW_ID AS ARDET_ROW_ID,
			AP1.PARA1_CODE AS AP1_PARA1_CODE,AP1.PARA1_NAME AS AP1_PARA1_NAME,AP1.ALIAS AS AP1_ALIAS,AP1.INACTIVE AS AP1_INACTIVE,
			ADP2.PARA2_CODE AS ADP2_PARA2_CODE,ADP2.ALIAS AS ADP2_ALIAS,ADP2.INACTIVE AS ADP2_INACTIVE,ADP2.PARA2_ORDER AS ADP2_PARA2_ORDER,ADP2.PARA2_NAME AS ADP2_PARA2_NAME,
            AB.BOM_ARTICLE_CODE AS AB_BOM_ARTICLE_CODE ,AB.AVG_QTY AS AB_AVG_QTY,AB.ROW_ID AS AB_ROW_ID,AB.COMPANY_CODE AS AB_COMPANY_CODE,AB.RATE AS AB_RATE,AB.USES AS AB_USES,AB.ADD_AVG_QTY AS AB_ADD_AVG_QTY,
            AB1.PARA1_CODE AS AB1_PARA1_CODE,AB1.PARA1_NAME AS AB1_PARA1_NAME,AB1.ALIAS AS AB1_ALIAS,AB1.INACTIVE AS AB1_INACTIVE,
			AB2.PARA2_CODE AS AB2_PARA2_CODE,AB2.ALIAS AS AB2_ALIAS,AB2.INACTIVE AS AB2_INACTIVE,AB2.PARA2_ORDER AS AB2_PARA2_ORDER,AB2.PARA2_NAME AS AB2_PARA2_NAME,
			AJ.JOB_REMARKS AS AJ_JOB_REMARKS,AJ.ROW_ID  AS AJ_ROW_ID,AJ.COMPANY_CODE AS AJ_COMPANY_CODE,
			AJ.JOB_RATE AS AJ_JOB_RATE,AJ.DAYS AS AJ_DAYS,
			AJ.HOURS AS AJ_HOURS,AJ.DEFAULT_BASIS AS AJ_DEFAULT_BASIS,
			AJ.JOB_RATE_PCS AS AJ_JOB_RATE_PCS,AJ.JOB_RATE_DAYS AS AJ_JOB_RATE_DAYS,
			AJ.JOB_RATE_HOURS AS AJ_JOB_RATE_HOURS,AJ.JOB_ORDER AS AJ_JOB_ORDER,
            JO.LAST_UPDATE AS JO_LAST_UPDATE,JO.JOB_RATE_BASIS AS JO_JOB_RATE_BASIS,
            JO.INACTIVE AS JO_INACTIVE ,JO.JOB_CODE AS JO_JOB_CODE,JO.JOB_NAME AS JO_JOB_NAME,
            JO.COMPANY_CODE AS JO_COMPANY_CODE,JO.PER_DAYS AS JO_PER_DAYS,JO.JOBRATE AS JO_JOBRATE,
            -- 
            Y.ATTR1_KEY_CODE  AS  Y_ATTR1_KEY_CODE,  Y.ATTR2_KEY_CODE  AS  Y_ATTR2_KEY_CODE,  Y.ATTR3_KEY_CODE  AS  Y_ATTR3_KEY_CODE, 
            Y.ATTR4_KEY_CODE  AS  Y_ATTR4_KEY_CODE,  Y.ATTR5_KEY_CODE  AS  Y_ATTR5_KEY_CODE,  Y.ATTR6_KEY_CODE  AS  Y_ATTR6_KEY_CODE, 
            Y.ATTR7_KEY_CODE  AS  Y_ATTR7_KEY_CODE,  Y.ATTR8_KEY_CODE  AS  Y_ATTR8_KEY_CODE,  Y.ATTR9_KEY_CODE  AS  Y_ATTR9_KEY_CODE, 
            Y.ATTR10_KEY_CODE AS  Y_ATTR10_KEY_CODE, Y.ATTR11_KEY_CODE AS  Y_ATTR11_KEY_CODE, Y.ATTR12_KEY_CODE AS  Y_ATTR12_KEY_CODE, 
            Y.ATTR13_KEY_CODE AS  Y_ATTR13_KEY_CODE, Y.ATTR14_KEY_CODE AS  Y_ATTR14_KEY_CODE, Y.ATTR15_KEY_CODE AS  Y_ATTR15_KEY_CODE,
            Y.ATTR16_KEY_CODE AS  Y_ATTR16_KEY_CODE, Y.ATTR17_KEY_CODE AS  Y_ATTR17_KEY_CODE, Y.ATTR18_KEY_CODE AS  Y_ATTR18_KEY_CODE, 
            Y.ATTR19_KEY_CODE AS  Y_ATTR19_KEY_CODE, Y.ATTR20_KEY_CODE AS  Y_ATTR20_KEY_CODE, Y.ATTR21_KEY_CODE AS  Y_ATTR21_KEY_CODE, 
            Y.ATTR22_KEY_CODE AS  Y_ATTR22_KEY_CODE, Y.ATTR23_KEY_CODE AS  Y_ATTR23_KEY_CODE, Y.ATTR24_KEY_CODE AS  Y_ATTR24_KEY_CODE, 
            Y.ATTR25_KEY_CODE AS  Y_ATTR25_KEY_CODE, 
            
              Y1.ATTR1_KEY_NAME AS Y1_ATTR1_KEY_NAME,Y1.ATTR1_ALIAS AS Y1_ATTR1_ALIAS, Y1.ATTR1_INACTIVE AS Y1_ATTR1_INACTIVE, 
			  Y2.ATTR2_KEY_NAME AS Y2_ATTR2_KEY_NAME,Y2.ATTR2_ALIAS AS Y2_ATTR2_ALIAS, Y2.ATTR2_INACTIVE AS Y2_ATTR2_INACTIVE ,
			  Y3.ATTR3_KEY_NAME AS Y3_ATTR3_KEY_NAME,Y3.ATTR3_ALIAS AS Y3_ATTR3_ALIAS, Y3.ATTR3_INACTIVE AS Y3_ATTR3_INACTIVE ,
			  Y4.ATTR4_KEY_NAME AS Y4_ATTR4_KEY_NAME,Y4.ATTR4_ALIAS AS Y4_ATTR4_ALIAS, Y4.ATTR4_INACTIVE AS Y4_ATTR4_INACTIVE ,
			  Y5.ATTR5_KEY_NAME AS Y5_ATTR5_KEY_NAME,Y5.ATTR5_ALIAS AS Y5_ATTR5_ALIAS, Y5.ATTR5_INACTIVE AS Y5_ATTR5_INACTIVE ,
			  Y6.ATTR6_KEY_NAME AS Y6_ATTR6_KEY_NAME,Y6.ATTR6_ALIAS AS Y6_ATTR6_ALIAS, Y6.ATTR6_INACTIVE AS Y6_ATTR6_INACTIVE ,
			  Y7.ATTR7_KEY_NAME AS Y7_ATTR7_KEY_NAME,Y7.ATTR7_ALIAS AS Y7_ATTR7_ALIAS, Y7.ATTR7_INACTIVE AS Y7_ATTR7_INACTIVE ,
			  Y8.ATTR8_KEY_NAME AS Y8_ATTR8_KEY_NAME,Y8.ATTR8_ALIAS AS Y8_ATTR8_ALIAS, Y8.ATTR8_INACTIVE AS Y8_ATTR8_INACTIVE ,
			  Y9.ATTR9_KEY_NAME AS Y9_ATTR9_KEY_NAME,Y9.ATTR9_ALIAS AS Y9_ATTR9_ALIAS, Y9.ATTR9_INACTIVE AS Y9_ATTR9_INACTIVE ,
			  Y10.ATTR10_KEY_NAME AS Y10_ATTR10_KEY_NAME,Y10.ATTR10_ALIAS AS Y10_ATTR10_ALIAS, Y10.ATTR10_INACTIVE AS Y10_ATTR10_INACTIVE ,
			  Y11.ATTR11_KEY_NAME AS Y11_ATTR11_KEY_NAME,Y11.ATTR11_ALIAS AS Y11_ATTR11_ALIAS, Y11.ATTR11_INACTIVE AS Y11_ATTR11_INACTIVE ,
			  Y12.ATTR12_KEY_NAME AS Y12_ATTR12_KEY_NAME,Y12.ATTR12_ALIAS AS Y12_ATTR12_ALIAS, Y12.ATTR12_INACTIVE AS Y12_ATTR12_INACTIVE ,
			  Y13.ATTR13_KEY_NAME AS Y13_ATTR13_KEY_NAME,Y13.ATTR13_ALIAS AS Y13_ATTR13_ALIAS, Y13.ATTR13_INACTIVE AS Y13_ATTR13_INACTIVE ,
			  Y14.ATTR14_KEY_NAME AS Y14_ATTR14_KEY_NAME,Y14.ATTR14_ALIAS AS Y14_ATTR14_ALIAS, Y14.ATTR14_INACTIVE AS Y14_ATTR14_INACTIVE ,
			  Y15.ATTR15_KEY_NAME AS Y15_ATTR15_KEY_NAME,Y15.ATTR15_ALIAS AS Y15_ATTR15_ALIAS, Y15.ATTR15_INACTIVE AS Y15_ATTR15_INACTIVE ,
			  Y16.ATTR16_KEY_NAME AS Y16_ATTR16_KEY_NAME,Y16.ATTR16_ALIAS AS Y16_ATTR16_ALIAS, Y16.ATTR16_INACTIVE AS Y16_ATTR16_INACTIVE ,
			  Y17.ATTR17_KEY_NAME AS Y17_ATTR17_KEY_NAME,Y17.ATTR17_ALIAS AS Y17_ATTR17_ALIAS, Y17.ATTR17_INACTIVE AS Y17_ATTR17_INACTIVE ,
			  Y18.ATTR18_KEY_NAME AS Y18_ATTR18_KEY_NAME,Y18.ATTR18_ALIAS AS Y18_ATTR18_ALIAS, Y18.ATTR18_INACTIVE AS Y18_ATTR18_INACTIVE ,
			  Y19.ATTR19_KEY_NAME AS Y19_ATTR19_KEY_NAME,Y19.ATTR19_ALIAS AS Y19_ATTR19_ALIAS, Y19.ATTR19_INACTIVE AS Y19_ATTR19_INACTIVE ,
			  Y20.ATTR20_KEY_NAME AS Y20_ATTR20_KEY_NAME,Y20.ATTR20_ALIAS AS Y20_ATTR20_ALIAS, Y20.ATTR20_INACTIVE AS Y20_ATTR20_INACTIVE ,
			  Y21.ATTR21_KEY_NAME AS Y21_ATTR21_KEY_NAME,Y21.ATTR21_ALIAS AS Y21_ATTR21_ALIAS, Y21.ATTR21_INACTIVE AS Y21_ATTR21_INACTIVE ,
			  Y22.ATTR22_KEY_NAME AS Y22_ATTR22_KEY_NAME,Y22.ATTR22_ALIAS AS Y22_ATTR22_ALIAS, Y22.ATTR22_INACTIVE AS Y22_ATTR22_INACTIVE ,
			  Y23.ATTR23_KEY_NAME AS Y23_ATTR23_KEY_NAME,Y23.ATTR23_ALIAS AS Y23_ATTR23_ALIAS, Y23.ATTR23_INACTIVE AS Y23_ATTR23_INACTIVE ,
			  Y24.ATTR24_KEY_NAME AS Y24_ATTR24_KEY_NAME,Y24.ATTR24_ALIAS AS Y24_ATTR24_ALIAS, Y24.ATTR24_INACTIVE AS Y24_ATTR24_INACTIVE ,
			  Y25.ATTR25_KEY_NAME AS Y25_ATTR25_KEY_NAME,Y25.ATTR25_ALIAS AS Y25_ATTR25_ALIAS, Y25.ATTR25_INACTIVE AS Y25_ATTR25_INACTIVE ,
			  SA.SUB_SECTION_CODE AS SA_SUB_SECTION_CODE,SA.ATTR1_MST AS SA_ATTR1_MST,
			  SA.ATTR2_MST AS SA_ATTR2_MST,SA.ATTR3_MST AS SA_ATTR3_MST,
			  SA.ATTR4_MST AS SA_ATTR4_MST,SA.ATTR5_MST AS SA_ATTR5_MST,
			  SA.ATTR6_MST AS SA_ATTR6_MST,SA.ATTR7_MST AS SA_ATTR7_MST,
			  SA.ATTR8_MST AS SA_ATTR8_MST,SA.ATTR9_MST AS SA_ATTR9_MST,
			  SA.ATTR10_MST AS SA_ATTR10_MST,SA.ATTR11_MST AS SA_ATTR11_MST,
			  SA.ATTR12_MST AS SA_ATTR12_MST,SA.ATTR13_MST AS SA_ATTR13_MST,
			  SA.ATTR14_MST AS SA_ATTR14_MST,SA.ATTR15_MST AS SA_ATTR15_MST,
			  SA.ATTR16_MST AS SA_ATTR16_MST,SA.ATTR17_MST AS SA_ATTR17_MST,
			  SA.ATTR18_MST AS SA_ATTR18_MST,SA.ATTR19_MST AS SA_ATTR19_MST,
			  SA.ATTR20_MST AS SA_ATTR20_MST,SA.ATTR21_MST AS SA_ATTR21_MST,
			  SA.ATTR22_MST AS SA_ATTR22_MST,SA.ATTR23_MST AS SA_ATTR23_MST,
			  SA.ATTR24_MST AS SA_ATTR24_MST,SA.ATTR25_MST AS SA_ATTR25_MST

		  INTO '+@LOCCTEMPTABLE+'
			FROM  
			ARTICLE AR(NOLOCK) 
			JOIN SECTIOND SD(NOLOCK) ON SD.SUB_SECTION_CODE=AR.SUB_SECTION_CODE
			JOIN SECTIONM SM(NOLOCK) ON SM.SECTION_CODE=SD.SECTION_CODE
			LEFT JOIN PARA1 P1(NOLOCK) ON P1.PARA1_CODE=AR.PARA1_CODE
			LEFT JOIN PARA2 P2(NOLOCK) ON P2.PARA2_CODE=AR.PARA2_CODE
			LEFT JOIN PARA3 P3(NOLOCK) ON P3.PARA3_CODE=AR.PARA3_CODE
			LEFT JOIN PARA4 P4(NOLOCK) ON P4.PARA4_CODE=AR.PARA4_CODE
			LEFT JOIN PARA5 P5(NOLOCK) ON P5.PARA5_CODE=AR.PARA5_CODE
			LEFT JOIN PARA6 P6(NOLOCK) ON P6.PARA6_CODE=AR.PARA6_CODE
			LEFT JOIN ART_PARA1 ARTPARA(NOLOCK) ON ARTPARA.ARTICLE_CODE=AR.ARTICLE_CODE
			LEFT JOIN ART_DET ARDET(NOLOCK)ON ARDET.ARTICLE_CODE=AR.ARTICLE_CODE
			LEFT JOIN PARA1 AP1(NOLOCK) ON AP1.PARA1_CODE=ARTPARA.PARA1_CODE
			LEFT JOIN PARA2 ADP2(NOLOCK) ON ADP2.PARA2_CODE=ARDET.PARA2_CODE 
			LEFT JOIN HSN_MST HD(NOLOCK) ON HD.HSN_CODE=AR.HSN_CODE
			LEFT JOIN HSN_DET HD2(NOLOCK) ON HD2.HSN_CODE=AR.HSN_CODE
			left JOIN UOM U(NOLOCK) ON U.UOM_CODE=AR.UOM_CODE
			LEFT JOIN ART_BOM AB(NOLOCK) ON AB.ARTICLE_CODE=AR.ARTICLE_CODE
			LEFT JOIN ART_JOBS AJ(NOLOCK) ON AJ.ARTICLE_CODE=AR.ARTICLE_CODE
			LEFT JOIN PARA1 AB1(NOLOCK) ON AB1.PARA1_CODE=AB.BOM_PARA1_CODE
			LEFT JOIN PARA2 AB2(NOLOCK) ON AB2.PARA2_CODE=AB.BOM_PARA2_CODE
			LEFT JOIN JOBS JO(NOLOCK) ON JO.JOB_CODE=AJ.JOB_CODE
			'+@CWHERE1+'
			LEFT JOIN ARTICLE_FIX_ATTR Y(NOLOCK) ON Y.ARTICLE_CODE=AR.ARTICLE_CODE
			LEFT JOIN ATTR1_MST Y1(NOLOCK) ON Y.attr1_key_code=Y1.attr1_key_code
			LEFT JOIN ATTR2_MST Y2(NOLOCK) ON Y.attr2_key_code=Y2.attr2_key_code
			LEFT JOIN ATTR3_MST Y3(NOLOCK) ON Y.attr3_key_code=Y3.attr3_key_code
			LEFT JOIN ATTR4_MST Y4(NOLOCK) ON Y.attr4_key_code=Y4.attr4_key_code
			LEFT JOIN ATTR5_MST Y5(NOLOCK) ON Y.attr5_key_code=Y5.attr5_key_code
			LEFT JOIN ATTR6_MST Y6(NOLOCK) ON Y.attr6_key_code=Y6.attr6_key_code
			LEFT JOIN ATTR7_MST Y7(NOLOCK) ON Y.attr7_key_code=Y7.attr7_key_code
			LEFT JOIN ATTR8_MST Y8(NOLOCK) ON Y.attr8_key_code=Y8.attr8_key_code
			LEFT JOIN ATTR9_MST Y9(NOLOCK) ON Y.attr9_key_code=Y9.attr9_key_code
			LEFT JOIN ATTR10_MST Y10(NOLOCK) ON Y.attr10_key_code=Y10.attr10_key_code
			LEFT JOIN ATTR11_MST Y11(NOLOCK) ON Y.attr11_key_code=Y11.attr11_key_code
			LEFT JOIN ATTR12_MST Y12(NOLOCK) ON Y.attr12_key_code=Y12.attr12_key_code
			LEFT JOIN ATTR13_MST Y13(NOLOCK) ON Y.attr13_key_code=Y13.attr13_key_code
			LEFT JOIN ATTR14_MST Y14(NOLOCK) ON Y.attr14_key_code=Y14.attr14_key_code
			LEFT JOIN ATTR15_MST Y15(NOLOCK) ON Y.attr15_key_code=Y15.attr15_key_code
			LEFT JOIN ATTR16_MST Y16(NOLOCK) ON Y.attr16_key_code=Y16.attr16_key_code
			LEFT JOIN ATTR17_MST Y17(NOLOCK) ON Y.attr17_key_code=Y17.attr17_key_code
			LEFT JOIN ATTR18_MST Y18(NOLOCK) ON Y.attr18_key_code=Y18.attr18_key_code
			LEFT JOIN ATTR19_MST Y19(NOLOCK) ON Y.attr19_key_code=Y19.attr19_key_code
			LEFT JOIN ATTR20_MST Y20(NOLOCK) ON Y.attr20_key_code=Y20.attr20_key_code
			LEFT JOIN ATTR21_MST Y21(NOLOCK) ON Y.attr21_key_code=Y21.attr21_key_code
			LEFT JOIN ATTR22_MST Y22(NOLOCK) ON Y.attr22_key_code=Y22.attr22_key_code
			LEFT JOIN ATTR23_MST Y23(NOLOCK) ON Y.attr23_key_code=Y23.attr23_key_code
			LEFT JOIN ATTR24_MST Y24(NOLOCK) ON Y.attr24_key_code=Y24.attr24_key_code
			LEFT JOIN ATTR25_MST Y25(NOLOCK) ON Y.attr25_key_code=Y25.attr25_key_code
			LEFT JOIN SD_ATTR_AVATAR SA(NOLOCK) ON SA.SUB_SECTION_CODE=SD.SUB_SECTION_CODE
			
			'+@CWHERE+''
			
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	  
	  
	 IF @NMODE=3--PARA1
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA1_CODE,PARA1_NAME,ALIAS,INACTIVE INTO '+@LOCCTEMPTABLE+' FROM PARA1(NOLOCK)
						WHERE PARA1_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	   IF @NMODE=4--PARA2
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA2_CODE,PARA2_NAME,ALIAS,INACTIVE,PARA2_ORDER INTO '+@LOCCTEMPTABLE+' FROM  PARA2 (NOLOCK) 
						WHERE PARA2_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	   IF @NMODE=5--PARA3
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA3_CODE,PARA3_NAME,ALIAS,INACTIVE INTO '+@LOCCTEMPTABLE+' FROM PARA3(NOLOCK)
						WHERE PARA3_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	   IF @NMODE=6--PARA4
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA4_CODE,PARA4_NAME,ALIAS,INACTIVE INTO '+@LOCCTEMPTABLE+' FROM PARA4(NOLOCK)
						WHERE PARA4_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	   IF @NMODE=7--PARA5
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA5_CODE,PARA5_NAME,ALIAS,INACTIVE INTO '+@LOCCTEMPTABLE+' FROM PARA5(NOLOCK) 
						WHERE PARA5_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	   IF @NMODE=8--PARA6
	  BEGIN
			SET @CSTEP=10         
			SET @CCMD=N'SELECT PARA6_CODE,PARA6_NAME ,ALIAS ,INACTIVE INTO '+@LOCCTEMPTABLE+' FROM  PARA6(NOLOCK) 
						WHERE PARA6_NAME=LTRIM(RTRIM('''+@REQCOLNAME+'''))'
		PRINT @CCMD 
		EXEC SP_EXECUTESQL @CCMD		
				   
	  END
	 
         
END TRY  
	BEGIN CATCH  
		SET @CERRMSG='P: SP3S_PREPARE_MASTER_HO_DATA, STEP: '+CAST(@CSTEP AS VARCHAR(5))+', MESSAGE: ' + ERROR_MESSAGE()
		GOTO END_PROC  
	END CATCH   

END_PROC:
    IF  ISNULL(@CERRMSG,'')<>'' 
		SELECT ISNULL(@CERRMSG,'') AS ERRMSG
	ELSE 
	  BEGIN
         
	      SET @CCMD=N'SELECT *,'''' AS ERRMSG  FROM  '+@LOCCTEMPTABLE+' '
           PRINT @CCMD
           EXEC SP_EXECUTESQL @CCMD

		 
      END
END

---END OF PROCEDURE - SP3S_PREPARE_MASTER_HO_DATA

