CREATE PROCEDURE SP3S_CREATE_TEMP_SCHEMECOPY
@nSpId VARCHAR(50),
@cLocationId VARCHAR(4),
@NCOPYSCHEMEMODE NUMERIC(1,0),
@cErrormsg VARCHAR(1000) OUTPUT
AS
BEGIN
	DECLARE @CSTEP VARCHAR(5),@cCmd NVARCHAR(MAX)

BEGIN TRY
	
	SET @CSTEP = '10'
	SET @cErrormsg=''
			
	DECLARE @CTEMPSCHEMECOPYTABLE VARCHAR(500),@cJoinstr VARCHAR(500),@cFilterCondition VARCHAR(500),
			@CINSSPID VARCHAR(50)

	--SET @CTEMPSCHEMECOPYTABLE='TEMP_SCHEMECOPYTITLE_'+LTRIM(RTRIM(STR(@NSPID)))      
			
	SET @CSTEP = '20'
	IF @NCOPYSCHEMEMODE=1
		SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_mst_UPLOAD c (NOLOCK) ON c.MEMO_NO=B.MEMO_NO'
	ELSE
		SET @cJoinStr=' JOIN SCHNEW_schemecopytitle_UPLOAD c (NOLOCK) ON c.ROW_ID=B.ROW_ID'

	SET  @cFilterCondition=' c.SP_ID='''+@NsPiD+''''	

	SET @CSTEP = '30'
	SET @CINSSPID=@nSpId+'copy'

	print 'Create copy of titles now'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_sETUP_DET',@CDESTDB=''
								,@CDESTTABLE='SCHNEW_SCHEME_sETUP_DET_UPLOAD',@CKEYFIELD1='memo_no'
								,@CKEYFIELD2='',@CKEYFIELD3=''
								,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
								,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
								,@CJOINSTR=@CJOINSTR
								,@CSEARCHTABLE='SCHEME_sETUP_DET'
						
	IF @NCOPYSCHEMEMODE=2
	BEGIN
		SET @CSTEP = '40'
		UPDATE A WITH (ROWLOCK) SET SCHEME_NAME=B.new_SCHEME_NAME 
		FROM SCHNEW_SCHEME_sETUP_DET_UPLOAD A
		JOIN SCHNEW_schemecopytitle_UPLOAD B (NOLOCK) ON A.ROW_ID=B.ROW_ID
		WHERE a.sp_id=@CINSSPID AND b.sp_id=@nSpId
			
	END
			

	--SELECT 'BEFORE',* FROM TEMP_SCHEME_SETUP_DET_127
			
	SET @CSTEP = '42'
	DECLARE @NCNT INT,@cRowId VARCHAR(50)
	SET @NCNT=1

	DECLARE @cSchemeName VARCHAR(500)

	--select  'check copied scheme',@cInsSpid insspid, sp_id,* FROM SCHNEW_SCHEME_sETUP_DET_UPLOAD (NOLOCK) 
	--			  where scheme_name='Flat 10%' -- sp_id=@cInsSpId

	WHILE EXISTS (SELECT TOP 1 memo_no FROM SCHNEW_SCHEME_sETUP_DET_UPLOAD (NOLOCK) 
				  where sp_id=@cInsSpId AND left(row_id,5)<>'LATER')
	BEGIN
		

		SET @CSTEP = '43'
		SELECT TOP 1 @cRowId=row_id,@cSchemeName=scheme_name from  SCHNEW_SCHEME_sETUP_DET_UPLOAD (NOLOCK) 
		WHERE sp_id=@cInsSpId AND left(row_id,5)<>'LATER'


		
		print 'Create Temp copy of Scheme:'+@cSchemeName+' RowId:'+@cRowId
		SET @CSTEP = '43.5'
		UPDATE SCHNEW_SCHEME_sETUP_DET_UPLOAD WITH (ROWLOCK) SET old_row_id=row_id
		WHERE sp_id=@cInsSpId AND row_id=@cRowId

		SET @CSTEP = '43.8'
		UPDATE SCHNEW_SCHEME_sETUP_DET_UPLOAD WITH (ROWLOCK)
		SET MEMO_NO='LATER',ROW_ID='LATER'+LTRIM(RTRIM(STR(@NCNT))) WHERE sp_id=@cInsSpId
		AND row_id=@cRowId

		SET @NCNT=@NCNT+1
	END

	SET @CSTEP = '46.5'
	UPDATE SCHNEW_SCHEME_sETUP_MST_UPLOAD WITH (ROWLOCK) SET sp_id=@cInsSpId WHERE sp_id=@nSpId

	SET  @cFilterCondition=' c.SP_ID='''+@cInsSpId+''''	
	SET @CSTEP = '48'
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_mst_UPLOAD c (NOLOCK) ON c.memo_no=B.memo_no'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_sETUP_loc',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_sETUP_loc_UPLOAD',@CKEYFIELD1='memo_no'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_sETUP_loc'
						
			
	SET @CSTEP = 52
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_mst_UPLOAD c (NOLOCK) ON c.memo_no=B.memo_no'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_HAPPYHOURS',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_HAPPYHOURS_UPLOAD',@CKEYFIELD1='memo_no'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_HAPPYHOURS'


	SET @CSTEP = 55
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_slsbc',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_sETUP_slsbc_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_slsbc'

					
	IF @NCOPYSCHEMEMODE=1
	BEGIN
		SET @CSTEP = 57
		UPDATE SCHNEW_SCHEME_sETUP_loc_UPLOAD WITH (ROWLOCK) SET MEMO_NO='LATER' WHERE sp_id=@cInsSpId

		SET @CSTEP = 60
		UPDATE SCHNEW_SCHEME_SETUP_HAPPYHOURS_UPLOAD WITH (ROWLOCK) SET MEMO_NO='LATER' WHERE sp_id=@cInsSpId

		SET @CSTEP = 63
		UPDATE SCHNEW_SCHEME_SETUP_HAPPYHOURS_UPLOAD WITH (ROWLOCK)  SET MEMO_NO='LATER' WHERE sp_id=@cInsSpId
	END
			
	SET @CSTEP = 66
			
	UPDATE SCHNEW_SCHEME_sETUP_slsbc_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId
	
	SET @CSTEP = 69		
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_slsart',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_sETUP_slsart_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_slsart'

	SET @CSTEP = 71
	UPDATE SCHNEW_SCHEME_sETUP_slsart_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 73
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCH0002_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCH0002_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCH0002_1'
			
			
	SET @CSTEP = 75	
	UPDATE SCHNEW_SCHEME_SETUP_SCH0002_1_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 77
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCH0006_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCH0006_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCH0006_1'
			
			
	SET @CSTEP = 80
	UPDATE SCHNEW_SCHEME_SETUP_SCH0006_1_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 82
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCH0007_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCH0007_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCH0007_1'
			
			
	SET @CSTEP = 85
	UPDATE SCHNEW_SCHEME_SETUP_SCH0006_1_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 87
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCH0014_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCH0014_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCH0014_1'
			
	
	SET @CSTEP = 90
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCH0012',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCH0012_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCH0012'
			
			
	SET @CSTEP = 92
	UPDATE SCHNEW_SCHEME_SETUP_SCH0012_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 95
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCHB001_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCHB001_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCHB001_1'
			
			
	SET @CSTEP = 98
	UPDATE SCHNEW_SCHEME_SETUP_SCHB001_1_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 100
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SCHB002_1',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SCHB002_1_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SCHB002_1'
			
			
	SET @CSTEP = 103
	UPDATE SCHNEW_SCHEME_SETUP_SCHB002_1_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 105
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SLSBC_GET',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SLSBC_GET_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SLSBC_GET'
			
			
	SET @CSTEP = 108
	UPDATE SCHNEW_SCHEME_SETUP_SLSBC_GET_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 111
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SLSART_GET',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SLSART_GET_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SLSART_GET'
			
			
	SET @CSTEP = 113
	UPDATE SCHNEW_SCHEME_SETUP_SLSART_GET_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 115
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SLSEAN',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SLSEAN_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SLSEAN'
			
			
	SET @CSTEP = 118
	UPDATE SCHNEW_SCHEME_SETUP_SLSEAN_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 120
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_SLSEAN_GET',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_SLSEAN_GET_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_SLSEAN_GET'
			
			
	SET @CSTEP = 123
	UPDATE SCHNEW_SCHEME_SETUP_SLSEAN_GET_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 125
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_ALLMASTERS',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_ALLMASTERS_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_ALLMASTERS'
			
			
	SET @CSTEP = 128
	UPDATE SCHNEW_SCHEME_SETUP_ALLMASTERS_UPLOAD WITH (ROWLOCK) SET ROW_ID='LATER' 
	WHERE sp_id=@cInsSpId

	SET @CSTEP = 130
	SET @cJoinStr=' JOIN SCHNEW_SCHEME_sETUP_det_UPLOAD c (NOLOCK) ON c.old_row_id=B.SCHEME_SETUP_DET_ROW_ID'
	EXEC UPDATEMASTERXN_MIRROR @CSOURCEDB='',@CSOURCETABLE='SCHEME_SETUP_ALLMASTERS_CONFIG',@CDESTDB=''
							,@CDESTTABLE='SCHNEW_SCHEME_SETUP_ALLMASTERS_CONFIG_UPLOAD',@CKEYFIELD1='row_id'
							,@CKEYFIELD2='',@CKEYFIELD3=''
							,@LINSERTONLY=1,@CFILTERCONDITION=@CFILTERCONDITION,@LUPDATEONLY=0
							,@BALWAYSUPDATE=0,@BUPDATEXNS=1,@CINSSPID=@CINSSPID
							,@CJOINSTR=@CJOINSTR
							,@CSEARCHTABLE='SCHEME_SETUP_ALLMASTERS_CONFIG'
			
			
	SET @CSTEP = 135
	EXEC SP3S_COPYSCHEME_FILTERS
	@cCurLocId=@cLocationId,
	@nSpId=@cInSSpId,
	@cErrormsg=@cErrormsg OUTPUT
	
	

	GOTO END_PROC
END TRY

BEGIN CATCH
	print 'Enter catch of SP3S_CREATE_TEMP_SCHEMECOPY'
	SET @cErrormsg='Error in Procedure SP3S_CREATE_TEMP_SCHEMECOPY at Step#'+@cStep+' '+error_message()
	print 'Enter catch of SP3S_CREATE_TEMP_SCHEMECOPY:'+@cErrormsg
	GOTO END_PROC
END CATCH

END_PROC:

END
