CREATE VIEW VW_WL_WSLCRNOTE_QBF  

AS   
SELECT T1.CN_ID ,  
T1.CN_DT AS MST_CN_DT ,  
T1.CN_NO AS MST_CN_NO,  
T1.SUBTOTAL AS MST_SUBTOTAL,  
T1.DISCOUNT_PERCENTAGE AS MST_DISCOUNT_PERCENTAGE ,  
T1.DISCOUNT_AMOUNT AS MST_DISCOUNT_AMOUNT ,  
T1.FREIGHT AS MST_FREIGHT ,  
T1.OTHER_CHARGES AS MST_OTHER_CHARGES ,  
T1.TOTAL_AMOUNT AS MST_TOTAL_AMOUNT ,  
T1.REMARKS AS MST_REMARKS ,  
T1.GRLR_DATE AS MST_GRLR_DATE ,  
T1.BANDALS AS MST_BANDALS ,  
T1.THROUGH AS MST_THROUGH ,  
0 AS MST_TAX_PERCENTAGE ,  
0 AS MST_TAX_AMOUNT ,  
T1.MANUAL_INV_NO AS MST_MANUAL_INV_NO,  
T1.ROUND_OFF AS MST_ROUND_OFF,  
T2.PRODUCT_CODE ,  
T2.QUANTITY,  
T2.RATE, 
T2.GROSS_RATE, 
T2.IND_DISCOUNT_PERCENTAGE,
T2.IND_DISCOUNT_AMOUNT,
T2.INM_DISCOUNT_PERCENTAGE,
T2.INM_DISCOUNT_AMOUNT,
T2.INV_NET_RATE,
T2.IND_RATE ,
T2.DISCOUNT_PERCENTAGE,  
T2.DISCOUNT_AMOUNT,  
T2.QUANTITY*T2.RATE AS AMOUNT,  
T3.AC_NAME AS MST_AC_NAME,  
ARTICLE_NO,  
S.MRP,  
T2.SCHEME_QUANTITY,  
T2.INVOICE_QUANTITY,  
T2.ITEM_TAX_AMOUNT,  
(CASE WHEN T2.BILL_LEVEL_TAX_METHOD=1 THEN 'EXCLUSIVE' ELSE 'INCLUSIVE' END)AS TAX_METHOD_NAME,  
T1. MEMO_PREFIX AS MST_MEMO_PREFIX,  
T2.NET_RATE,  
T1.TAXFORM_STORAGE_MODE  AS MST_TAXFORM_STORAGE_MODE,  
T1.CN_TYPE AS MST_CN_TYPE,  
T2.BILL_LEVEL_TAX_METHOD AS MST_BILL_LEVEL_TAX_METHOD,  
T1.FIN_YEAR AS MST_FIN_YEAR,  
'1' AS MST_MEMO_TYPE,  
T1.MODE AS MST_MODE,  
T2.ITEM_TAX_PERCENTAGE,  
T7.FORM_NAME  , T1.MANUAL_DN_AMOUNT AS MST_MANUAL_DN_AMOUNT,  
T8.DEPT_NAME AS MST_PARTY_DEPT_NAME,  
T9.EMP_NAME AS MST_EMP_NAME,    
T10.EMP_NAME AS MST_EMP_NAME1,    
T11.EMP_NAME AS MST_EMP_NAME2,  
T9.EMP_NAME AS EMP_NAME,    
T10.EMP_NAME AS EMP_NAME1,    
T11.EMP_NAME AS EMP_NAME2,  
 T1.MANUAL_DN_NO AS MST_MANUAL_DN_NO ,  
 SM.SECTION_NAME,  
 SD.SUB_SECTION_NAME,  
 C.PARA1_NAME,D.PARA2_NAME,F.PARA3_NAME,G.PARA4_NAME,H.PARA5_NAME,  
 I.PARA6_NAME,S.PRODUCT_NAME,  
T1.MEMO_TYPE  ,T1.location_CODE
FROM CNM01106 T1  
JOIN CND01106 T2 ON T1.CN_ID = T2.CN_ID  
JOIN FORM   T7 ON T7.FORM_ID = T2.ITEM_FORM_ID   
JOIN LMV01106 T3 ON T3.AC_CODE = T1.AC_CODE  
--JOIN PMV01106 T6 ON T6.PRODUCT_CODE = T2.PRODUCT_CODE --- OPTIMIZATION AFTER REMOVING VIEWS  
LEFT OUTER JOIN LOCATION T8 ON T8.DEPT_ID = T1.PARTY_DEPT_ID   
LEFT OUTER JOIN EMPLOYEE T9 ON T9.EMP_CODE = T2.EMP_CODE  
LEFT OUTER JOIN EMPLOYEE T10 ON T10.EMP_CODE = T2.EMP_CODE1  
LEFT OUTER JOIN EMPLOYEE T11 ON T11.EMP_CODE = T2.EMP_CODE2  
JOIN SKU S ON T2.PRODUCT_CODE = S.PRODUCT_CODE       
JOIN ARTICLE B ON S.ARTICLE_CODE = B.ARTICLE_CODE        
JOIN SECTIOND SD ON B.SUB_SECTION_CODE = SD.SUB_SECTION_CODE      
JOIN SECTIONM SM ON SD.SECTION_CODE = SM.SECTION_CODE      
JOIN PARA1 C ON S.PARA1_CODE = C.PARA1_CODE        
JOIN PARA2 D ON S.PARA2_CODE = D.PARA2_CODE        
JOIN PARA3 F ON S.PARA3_CODE = F.PARA3_CODE        
JOIN PARA4 G ON S.PARA4_CODE = G.PARA4_CODE        
JOIN PARA5 H ON S.PARA5_CODE = H.PARA5_CODE        
JOIN PARA6 I ON S.PARA6_CODE = I.PARA6_CODE        
JOIN UOM   E ON B.UOM_CODE = E.UOM_CODE
