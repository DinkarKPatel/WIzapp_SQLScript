CREATE FUNCTION DBO.CURR_GROUPING(@AMT NUMERIC(20,2),@SEP VARCHAR(1))
RETURNS VARCHAR(100)
AS
BEGIN
DECLARE @RS VARCHAR(100)
SET @RS=LEFT(CAST(@AMT AS VARCHAR),CHARINDEX('.',CAST(@AMT AS VARCHAR))-1)
SELECT @RS=CASE WHEN LEN(@RS) BETWEEN 1 AND 3 THEN @RS
			WHEN LEN(@RS) BETWEEN 4 AND 5 THEN LEFT(@RS,LEN(@RS)-3)+@SEP+RIGHT(@RS,3)
			WHEN LEN(@RS) BETWEEN 6 AND 7 THEN LEFT(@RS,LEN(@RS)-5)+@SEP+LEFT(RIGHT(@RS,5),2)+@SEP+RIGHT(@RS,3)
			WHEN LEN(@RS) BETWEEN 8 AND 9 THEN LEFT(@RS,LEN(@RS)-7)+@SEP+LEFT(RIGHT(@RS,7),2)+@SEP+LEFT(RIGHT(@RS,5),2)+@SEP+RIGHT(@RS,3)
			ELSE @RS
       END
+CASE RIGHT(CAST(@AMT AS VARCHAR),3) WHEN '.00' THEN '' 
ELSE SUBSTRING(CAST(@AMT AS VARCHAR),CHARINDEX('.',CAST(@AMT AS VARCHAR)),3) END

IF CHARINDEX('.',@RS)>0 AND RIGHT(@RS,1)='0'
   SET @RS=LEFT(@RS,LEN(@RS)-1)
RETURN @RS
END
