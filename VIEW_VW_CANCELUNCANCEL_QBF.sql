CREATE VIEW VW_CANCELUNCANCEL_QBF

AS
SELECT T1.CNC_MEMO_NO AS MST_CNC_MEMO_NO,
T1.CNC_MEMO_ID AS XN_ID,
T1.CNC_MEMO_DT AS MST_MEMO_DT,
T1.CNC_TYPE AS MST_CNC_TYPE,
T1.REMARKS AS MST_REMARKS,
T1.TOTAL_AMOUNT AS MST_TOTAL_AMOUNT,
T1.FIN_YEAR AS MST_FIN_YEAR,
T2.QUANTITY AS MST_TOTAL_QUANTITY,
T2.PRODUCT_CODE,
SKU.PURCHASE_PRICE*T2.QUANTITY AS AMOUNT,
T2.QUANTITY,
SKU.MRP, SKU.PURCHASE_PRICE, SKU.WS_PRICE, ARTICLE_NO, ARTICLE_NAME, CODING_SCHEME, 
SECTION_NAME,SUB_SECTION_NAME,PARA1_NAME,PARA2_NAME,PARA3_NAME,PARA4_NAME, 
PARA5_NAME,PARA6_NAME,ARTICLE_DESC,AC_NAME,SKU.INV_NO,SKU.INV_DT,SKU.CHALLAN_NO,LM.ALIAS,
UOM_NAME,UOM_TYPE,SKU.FIX_MRP,SKU.PRODUCT_NAME
,AT1.ATTR1_KEY_NAME,AT2.ATTR2_KEY_NAME,AT3.ATTR3_KEY_NAME,AT4.ATTR4_KEY_NAME,AT5.ATTR5_KEY_NAME,AT6.ATTR6_KEY_NAME,
AT7.ATTR7_KEY_NAME,AT8.ATTR8_KEY_NAME,AT9.ATTR9_KEY_NAME,AT10.ATTR10_KEY_NAME,AT11.ATTR11_KEY_NAME,AT12.ATTR12_KEY_NAME,
AT13.ATTR13_KEY_NAME,AT14.ATTR14_KEY_NAME,AT15.ATTR15_KEY_NAME,AT16.ATTR16_KEY_NAME,AT17.ATTR17_KEY_NAME,AT18.ATTR18_KEY_NAME,
AT19.ATTR19_KEY_NAME,AT20.ATTR20_KEY_NAME,AT21.ATTR21_KEY_NAME,AT22.ATTR22_KEY_NAME,AT23.ATTR23_KEY_NAME,AT24.ATTR24_KEY_NAME,
AT25.ATTR25_KEY_NAME 
FROM ICM01106 T1
JOIN ICD01106 T2 ON T1.CNC_MEMO_ID = T2.CNC_MEMO_ID
--  JOIN ITV01106 ITV ON    A.PRODUCT_CODE = ITV.PRODUCT_CODE   --- OPTIMIZATION AFTER REMOVING VIEWS
JOIN SKU ON SKU.PRODUCT_CODE=T2.PRODUCT_CODE 
JOIN ARTICLE ART ON ART.ARTICLE_CODE = SKU.ARTICLE_CODE
JOIN SECTIOND SD ON SD.SUB_SECTION_CODE = ART.SUB_SECTION_CODE
JOIN SECTIONM SM ON SM.SECTION_CODE = SD.SECTION_CODE
LEFT OUTER JOIN ARTICLE_FIX_ATTR ATTR  (NOLOCK) ON SKU.ARTICLE_CODE = ATTR.ARTICLE_CODE 
LEFT OUTER JOIN ATTR1_MST AT1 (NOLOCK) ON AT1.ATTR1_KEY_CODE=ATTR.ATTR1_KEY_CODE
LEFT OUTER JOIN ATTR2_MST AT2 (NOLOCK) ON AT2.ATTR2_KEY_CODE=ATTR.ATTR2_KEY_CODE
LEFT OUTER JOIN ATTR3_MST AT3 (NOLOCK) ON AT3.ATTR3_KEY_CODE=ATTR.ATTR3_KEY_CODE
LEFT OUTER JOIN ATTR4_MST AT4 (NOLOCK) ON AT4.ATTR4_KEY_CODE=ATTR.ATTR4_KEY_CODE
LEFT OUTER JOIN ATTR5_MST AT5 (NOLOCK) ON AT5.ATTR5_KEY_CODE=ATTR.ATTR5_KEY_CODE
LEFT OUTER JOIN ATTR6_MST AT6 (NOLOCK) ON AT6.ATTR6_KEY_CODE=ATTR.ATTR6_KEY_CODE
LEFT OUTER JOIN ATTR7_MST AT7 (NOLOCK) ON AT7.ATTR7_KEY_CODE=ATTR.ATTR7_KEY_CODE
LEFT OUTER JOIN ATTR8_MST AT8 (NOLOCK) ON AT8.ATTR8_KEY_CODE=ATTR.ATTR8_KEY_CODE
LEFT OUTER JOIN ATTR9_MST AT9 (NOLOCK) ON AT9.ATTR9_KEY_CODE=ATTR.ATTR9_KEY_CODE
LEFT OUTER JOIN ATTR10_MST AT10 (NOLOCK) ON AT10.ATTR10_KEY_CODE=ATTR.ATTR10_KEY_CODE
LEFT OUTER JOIN ATTR11_MST AT11 (NOLOCK) ON AT11.ATTR11_KEY_CODE=ATTR.ATTR11_KEY_CODE
LEFT OUTER JOIN ATTR12_MST AT12 (NOLOCK) ON AT12.ATTR12_KEY_CODE=ATTR.ATTR12_KEY_CODE
LEFT OUTER JOIN ATTR13_MST AT13 (NOLOCK) ON AT13.ATTR13_KEY_CODE=ATTR.ATTR13_KEY_CODE
LEFT OUTER JOIN ATTR14_MST AT14 (NOLOCK) ON AT14.ATTR14_KEY_CODE=ATTR.ATTR14_KEY_CODE
LEFT OUTER JOIN ATTR15_MST AT15 (NOLOCK) ON AT15.ATTR15_KEY_CODE=ATTR.ATTR15_KEY_CODE
LEFT OUTER JOIN ATTR16_MST AT16 (NOLOCK) ON AT16.ATTR16_KEY_CODE=ATTR.ATTR16_KEY_CODE
LEFT OUTER JOIN ATTR17_MST AT17 (NOLOCK) ON AT17.ATTR17_KEY_CODE=ATTR.ATTR17_KEY_CODE
LEFT OUTER JOIN ATTR18_MST AT18 (NOLOCK) ON AT18.ATTR18_KEY_CODE=ATTR.ATTR18_KEY_CODE
LEFT OUTER JOIN ATTR19_MST AT19 (NOLOCK) ON AT19.ATTR19_KEY_CODE=ATTR.ATTR19_KEY_CODE
LEFT OUTER JOIN ATTR20_MST AT20 (NOLOCK) ON AT20.ATTR20_KEY_CODE=ATTR.ATTR20_KEY_CODE
LEFT OUTER JOIN ATTR21_MST AT21 (NOLOCK) ON AT21.ATTR21_KEY_CODE=ATTR.ATTR21_KEY_CODE
LEFT OUTER JOIN ATTR22_MST AT22 (NOLOCK) ON AT22.ATTR22_KEY_CODE=ATTR.ATTR22_KEY_CODE
LEFT OUTER JOIN ATTR23_MST AT23 (NOLOCK) ON AT23.ATTR23_KEY_CODE=ATTR.ATTR23_KEY_CODE
LEFT OUTER JOIN ATTR24_MST AT24 (NOLOCK) ON AT24.ATTR24_KEY_CODE=ATTR.ATTR24_KEY_CODE
LEFT OUTER JOIN ATTR25_MST AT25(NOLOCK) ON AT25.ATTR25_KEY_CODE=ATTR.ATTR25_KEY_CODE
JOIN PARA1 P1 ON P1.PARA1_CODE = SKU.PARA1_CODE
JOIN PARA2 P2 ON P2.PARA2_CODE = SKU.PARA2_CODE
JOIN PARA3 P3 ON P3.PARA3_CODE = SKU.PARA3_CODE
JOIN PARA4 P4 ON P4.PARA4_CODE = SKU.PARA4_CODE
JOIN PARA5 P5 ON P5.PARA5_CODE = SKU.PARA5_CODE
JOIN PARA6 P6 ON P6.PARA6_CODE = SKU.PARA6_CODE
JOIN LM01106 LM ON LM.AC_CODE=SKU.AC_CODE 
JOIN UOM ON UOM.UOM_CODE=ART.UOM_CODE
