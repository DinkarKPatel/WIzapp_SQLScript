CREATE PROCEDURE SP3S_XN_AUDIT_TRAIL_DETAILS
(      
 @CXN_TYPE VARCHAR(10),
 @CXN_ID VARCHAR(100)='',
 @CFMDT DATETIME='',
 @CTODT DATETIME=''
)       
AS
BEGIN
  SET NOCOUNT ON
  DECLARE @QID INT,@DT DATE

  SELECT @QID=CASE @CXN_TYPE	WHEN 'WSL' THEN 1 
								WHEN 'SLS' THEN 2 
								WHEN 'PUR' THEN 3 
								WHEN 'VCH' THEN 4 
								WHEN 'PRT' THEN 5 
								WHEN 'PO'  THEN 7 
								WHEN 'BO'  THEN 8 
								WHEN 'WSR'  THEN 9	
								WHEN 'arc'  THEN 10	
								END
  IF @CTODT IN('','1900-01-01')
  SET @DT=CONVERT(DATE,GETDATE())
  ELSE
  SET @DT=@CTODT

  EXEC SP_AUDIT_TRIAL_DETAILS @NQUERYID=@QID,@CFMDT=@CFMDT,@USER_CODE= '',@LOC_ID= '',@CMEMO_ID=@CXN_ID,@SHOW_DATASET1=0,@CTODT=@DT
  SET NOCOUNT OFF
END
