CREATE FUNCTION UDF_PROPERCASE 
(
 @TEXT AS VARCHAR(8000)
 )
RETURNS VARCHAR(8000)
AS
BEGIN
   DECLARE @RESET BIT;
   DECLARE @RET VARCHAR(8000);
   DECLARE @I INT;
   DECLARE @C CHAR(1);

   SELECT @RESET = 1, @I=1, @RET = '';

   WHILE (@I <= LEN(@TEXT))
    SELECT @C= SUBSTRING(@TEXT,@I,1),
               @RET = @RET + CASE WHEN @RESET=1 THEN UPPER(@C) ELSE LOWER(@C) END,
               @RESET = CASE WHEN @C LIKE '[A-ZA-Z]' THEN 0 ELSE 1 END,
               @I = @I +1
   RETURN @RET
END
