CREATE VIEW VW_PRD_CANCELUNCANCEL_PRINT

AS  
SELECT T1.CNC_MEMO_NO AS MST_CNC_MEMO_NO,  
CONVERT(VARCHAR, T1.CNC_MEMO_DT,105) AS MST_MEMO_DT,  
CASE WHEN T1.CNC_TYPE=1 THEN 'CANCELLATION' ELSE 'UNCANCELLATION' END MST_CNC_TYPE,  
T3.DEPARTMENT_NAME,
T4.DEPT_NAME,
T5.[USERNAME] AS [USER],
CASE WHEN T1.CANCELLED=1 THEN 'CANCELLED' ELSE '' END CANCELLED,
T1.REMARKS AS MST_REMARKS,  
T1.FIN_YEAR AS MST_FIN_YEAR,
T2.*,S.ARTICLE_CODE,S.PURCHASE_PRICE,S.MRP,S.WS_PRICE,PARA1.PARA1_NAME,PARA2.PARA2_NAME,COM.COMPANY_NAME
FROM PRD_ICM01106 T1  
JOIN PRD_ICD01106 T2 ON T1.CNC_MEMO_ID=T2.CNC_MEMO_ID
JOIN PRD_SKU S ON T2.PRODUCT_UID=S.PRODUCT_UID AND S.WORK_ORDER_ID=''
JOIN PARA1 ON PARA1.PARA1_CODE=S.PARA1_CODE
JOIN PARA2 ON PARA2.PARA2_CODE=S.PARA2_CODE
JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID=T1.DEPARTMENT_ID
JOIN LOCATION T4 ON T4.DEPT_ID =T1.DEPT_ID
JOIN USERS T5 ON T5.USER_CODE=T1.USER_CODE  
LEFT OUTER JOIN COMPANY COM ON 1=1 AND COM.COMPANY_CODE='01'
