CREATE VIEW VW_PICKLIST_QBF
   
AS     
SELECT  
MST.AC_CODE,
MST.PICK_LIST_NO AS MST_PICK_LIST_NO,
MST.PICK_LIST_DT AS MST_PICK_LIST_DT,
MST.FIN_YEAR AS MST_FIN_YEAR,
LMV.AC_NAME AS MST_AC_NAME,
U.USERNAME AS MST_USERNAME,
B.ARTICLE_NAME,DET.*,CC.SUB_SECTION_NAME,DD.SECTION_NAME,    
B.ARTICLE_NO,C.PARA1_NAME,D.PARA2_NAME,E.PARA3_NAME, F.PARA4_NAME, G.PARA5_NAME, H.PARA6_NAME,D.PARA2_ORDER,C.PARA1_ORDER ,  
(A.QUANTITY * A.WS_PRICE) AS AMOUNT,'0000001' AS UOM_CODE,'PCS' AS UOM_NAME,1 AS UOM_TYPE,B.DT_CREATED  
,B.CODING_SCHEME,B.PARA1_SET,B.PARA2_SET,A.ROW_ID AS BO_ROW_ID,R.ORDER_NO,ISNULL(LMV.ADDRESS0,'') + ' ' + ISNULL(LMV.ADDRESS1,'') + ' ' + ISNULL(LMV.ADDRESS2,'') + ', ' + ISNULL(LMV.AREA_NAME,'') + ' ' + ISNULL(LMV.CITY,'') + ' ' +   ISNULL(LMV.STATE,'') AS 'SUPP_ADDRESS',
B.ALIAS AS ARTICLE_ALIAS,MST.REMARKS       
FROM WSL_PICKLIST_DET DET (NOLOCK)
JOIN WSL_PICKLIST_MST MST (NOLOCK) ON MST.PICK_LIST_ID=DET.PICK_LIST_ID 
JOIN LMV01106 LMV (NOLOCK) ON LMV.AC_CODE=MST.AC_CODE 
JOIN USERS U (NOLOCK) ON U.USER_CODE=MST.USER_CODE 
JOIN BUYER_ORDER_DET A (NOLOCK) ON A.ORDER_ID=DET.ORDER_ID AND A.ARTICLE_CODE= DET.ARTICLE_CODE  AND A.PARA1_CODE= DET.PARA1_CODE  AND A.PARA2_CODE= DET.PARA2_CODE  
JOIN ARTICLE B (NOLOCK)  ON A.ARTICLE_CODE = B.ARTICLE_CODE
JOIN SECTIOND CC ON CC.SUB_SECTION_CODE = B.SUB_SECTION_CODE
JOIN SECTIONM DD ON DD.SECTION_CODE = CC.SECTION_CODE      
JOIN PARA1 C (NOLOCK)  ON A.PARA1_CODE = C.PARA1_CODE      
JOIN PARA2 D (NOLOCK)  ON A.PARA2_CODE = D.PARA2_CODE       
JOIN PARA3 E (NOLOCK)  ON B.PARA3_CODE = E.PARA3_CODE       
JOIN PARA4 F (NOLOCK)  ON B.PARA4_CODE = F.PARA4_CODE       
JOIN PARA5 G (NOLOCK)  ON B.PARA5_CODE = G.PARA5_CODE       
JOIN PARA6 H (NOLOCK) ON B.PARA6_CODE = H.PARA6_CODE      
JOIN BUYER_ORDER_MST R ON R.ORDER_ID= A.ORDER_ID
