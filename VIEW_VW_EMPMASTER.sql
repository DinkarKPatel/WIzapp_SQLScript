CREATE VIEW VW_EMPMASTER
--WITH ENCRYPTION      
AS                  
	SELECT	T1.EMP_ID,       
			T1.EMP_ID   AS MST_EMP_ID,      
			T1.REF_ID   AS MST_REF_ID,       
			T1.EMP_FNAME  AS MST_EMP_FNAME,       
			T1.EMP_LNAME  AS MST_EMP_LNAME,                   
			T1.EMP_TITLE  AS MST_EMP_TITLE,      
			T1.ADDRESS1  AS MST_ADDRESS1,      
			T1.ADDRESS2  AS MST_ADDRESS2,      
			T1.DATE_OF_BIRTH AS MST_DATE_OF_BIRTH,                  
			T1.DATE_OF_JOINING AS MST_DATE_OF_JOINING,       
			T1.EMAIL1   AS MST_EMAIL1,       
			T1.EMAIL2   AS MST_EMAIL2,                  
			T1.PHONES_H  AS MST_PHONES_H,      
			T1.MOBILE1   AS MST_MOBILE1,      
			T1.ID_PROOF_ISSUING_AUTHORITY AS MST_ID_PROOF_ISSUING_AUTHORITY,      
			T1.ID_PROOF_DOC_NO AS MST_ID_PROOF_DOC_NO,      
			T1.ID_PROOF_DOC_VALUE   AS MST_ID_PROOF_DOC_VALUE,       
			T2.AREA_NAME  AS MST_AREA_NAME,      
			T3.CITY   AS MST_CITY,      
			T4.STATE   AS MST_STATE,                  
			T1.PAN_NO   AS MST_PAN_NO,      
			T1.MAILING_ADDRESS1   AS MST_MAILING_ADDRESS1,       
			T1.MAILING_ADDRESS2   AS MST_MAILING_ADDRESS2,          
			T5.AREA_NAME  AS MST_MAILING_AREA_NAME,      
			T6.CITY   AS MST_MAILING_CITY,      
			T7.STATE   AS MST_MAILING_STATE,            
			T5.PINCODE   AS MST_MAILING_PINCODE,    
			T2.PINCODE   AS MST_PINCODE,            
			T1.WEEKLY_OFF1  AS MST_WEEKLY_OFF1,       
			T1.WEEKLY_OFF2  AS MST_WEEKLY_OFF2,      
			T9.DEPARTMENT_NAME AS MST_DEPARTMENT_NAME,       
			T10.DESIG_NAME  AS MST_DESIG_NAME,      
			T1.PARENT_NAME  AS MST_PARENT_NAME,    
			T1.BASIC_SALARY AS MST_BASIC_SALARY,      
			CASE       
			WHEN T1.EMP_TYPE = 0 THEN 'MALE'       
			WHEN T1.EMP_TYPE = 1 THEN 'FEMALE'       
			WHEN T1.EMP_TYPE = 2 THEN 'SENIOR-CITIZEN'       
			WHEN T1.EMP_TYPE = 3 THEN 'HANDICAPPED'       
			ELSE 'N.R.I.'       
			END AS MST_EMP_TYPE,      
			CASE       
			WHEN ID_PROOF_DOC_TYPE = 0 THEN 'DRIVING-LICENCE'       
			WHEN ID_PROOF_DOC_TYPE = 1 THEN 'PASS-PORT'       
			WHEN ID_PROOF_DOC_TYPE = 2 THEN 'VOTER-ID-CARD'       
			WHEN ID_PROOF_DOC_TYPE = 3 THEN 'PAN CARD'       
			ELSE 'OTHERS'       
			END AS MST_ID_PROOF_DOC_TYPE,       
			CASE       
			WHEN T1.EMP_STATUS = 0 THEN 'ACTIVE'       
			WHEN T1.EMP_STATUS = 1 THEN 'INACTIVE'       
			ELSE 'LEFT'       
			END AS MST_EMP_STATUS,T8.SHIFT_NAME AS MST_SHIFT_NAME ,
		    T12.DEPT_NAME AS MST_DEPT_NAME,
			T1.CO_ALIAS AS MST_CO_ALIAS,
			T1.PF_AMOUNT AS MST_PF_AMOUNT,
			T1.PF_NO AS MST_PF_NO,
			T1.ESI_NO AS MST_ESI_NO 
	FROM EMP_MST T1                  
	JOIN AREA T2   (NOLOCK) ON T1.AREA_CODE = T2.AREA_CODE                  
	JOIN CITY T3   (NOLOCK) ON T2.CITY_CODE = T3.CITY_CODE                  
	JOIN STATE T4   (NOLOCK) ON T3.STATE_CODE = T4.STATE_CODE            
	JOIN AREA T5   (NOLOCK) ON T5.AREA_CODE = T1.MAILING_AREA_CODE            
	JOIN CITY T6   (NOLOCK) ON T6.CITY_CODE = T5.CITY_CODE            
	JOIN STATE T7   (NOLOCK) ON T6.STATE_CODE = T7.STATE_CODE        
	JOIN EMP_SHIFTS T8  (NOLOCK) ON T1.SHIFT_ID = T8.SHIFT_ID        
	JOIN EMP_DEPARTMENT T9 (NOLOCK) ON T9.DEPARTMENT_ID = T1.DEPARTMENT_ID        
	JOIN EMP_DESIG T10  (NOLOCK) ON T10.DESIG_ID = T1.DESIG_ID
	JOIN LOCATION T12 ON T1.DEPT_ID=T12.DEPT_ID
