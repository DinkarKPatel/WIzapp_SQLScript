CREATE VIEW VW_WL_CANCELUNCANCEL_QBF

AS         
SELECT 
A.CNC_MEMO_ID AS 'XN_ID',
A.CNC_MEMO_NO AS 'MST_CNC_MEMO_NO',
A.CNC_MEMO_DT AS 'MST_MEMO_DT',
A.CNC_TYPE AS 'MST_CNC_TYPE',
A.REMARKS AS 'MST_REMARKS',
A.TOTAL_AMOUNT AS 'MST_TOTAL_AMOUNT',
A.FIN_YEAR AS 'MST_FIN_YEAR',
ICD.TOTQTY AS 'MST_TOTAL_QUANTITY',

B.PRODUCT_CODE AS 'PRODUCT_CODE',
D.ARTICLE_CODE AS 'ARTICLE_CODE',
D.ARTICLE_DESC AS 'ARTICLE_DESC',
D.ARTICLE_NAME AS 'ARTICLE_NAME',
D.ARTICLE_NO AS 'ARTICLE_NO',
E.SUB_SECTION_NAME AS 'SUB_SECTION_NAME',
F.SECTION_NAME AS 'SECTION_NAME',
G.UOM_NAME AS 'UOM_NAME',
H.PARA1_NAME AS 'PARA1_NAME',
I.PARA2_NAME AS 'PARA2_NAME',
B.QUANTITY AS 'QUANTITY',
C.PURCHASE_PRICE AS 'PURCHASE_PRICE',
C.MRP AS 'MRP',
C.PURCHASE_PRICE * B.QUANTITY AS 'AMOUNT'

FROM ICM01106 (NOLOCK) A
JOIN ICD01106 B (NOLOCK) ON A.CNC_MEMO_ID = B.CNC_MEMO_ID
JOIN ( SELECT CNC_MEMO_ID, SUM(QUANTITY) AS TOTQTY FROM ICD01106 GROUP BY CNC_MEMO_ID ) 
ICD ON A.CNC_MEMO_ID = ICD.CNC_MEMO_ID
JOIN SKU (NOLOCK) C ON B.PRODUCT_CODE = C.PRODUCT_CODE
JOIN ARTICLE (NOLOCK) D ON C.ARTICLE_CODE = D.ARTICLE_CODE
JOIN SECTIOND (NOLOCK) E ON D.SUB_SECTION_CODE = E.SUB_SECTION_CODE
JOIN SECTIONM (NOLOCK) F ON E.SECTION_CODE = F.SECTION_CODE
JOIN UOM (NOLOCK) G ON D.UOM_CODE = G.UOM_CODE
JOIN PARA1 (NOLOCK) H ON C.PARA1_CODE = H.PARA1_CODE
JOIN PARA2 (NOLOCK) I ON C.PARA2_CODE = I.PARA2_CODE
JOIN PARA3 (NOLOCK) J ON C.PARA3_CODE = J.PARA3_CODE



 


--*************************************** END OF VIEW VW_WL_CANCELUNCANCEL_QBF
