CREATE  VIEW XN_PARTY   
--WITH ENCRYPTION
AS  
SELECT 'LM' + AC_CODE AS XN_PARTY_CODE, AC_NAME AS XN_PARTY_NAME,AREA_NAME AS XN_AREA_NAME,CITY AS XN_CITY_NAME,
      STATE AS XN_STATE_NAME,ALIAS AS XN_PARTY_ALIAS,REGION_NAME AS XN_REGION_NAME
FROM LMV01106  

UNION ALL  

SELECT 'CUS' + CUSTOMER_CODE AS XN_PARTY_CODE, LTRIM(isnull(CUSTOMER_TITLE,'') + ' ' + CUSTOMER_FNAME + ' ' + CUSTOMER_LNAME) AS XN_PARTY_NAME,
       b.AREA_name AS XN_AREA_NAME,CITY AS XN_CITY_NAME, STATE AS XN_STATE_NAME,'' AS XN_PARTY_ALIAS ,
       REGION_NAME AS XN_REGION_NAME  
FROM custdym a (nolock) 
JOIN AREA B (nolock) ON A.AREA_CODE = B.AREA_CODE   
JOIN CITY C (nolock) ON B.CITY_CODE = C.CITY_CODE   
JOIN STATE D (nolock) ON C.STATE_CODE = D.STATE_CODE  
JOIN REGIONM E ON D.REGION_CODE = E.REGION_CODE
 
UNION ALL 
 
SELECT 'LOC' + DEPT_ID AS XN_PARTY_CODE, DEPT_NAME AS XN_PARTY_NAME,AREA_NAME AS XN_AREA_NAME,CITY AS XN_CITY_NAME,
 STATE AS XN_STATE_NAME,  DEPT_ALIAS  AS XN_PARTY_ALIAS,REGION_NAME AS XN_REGION_NAME
FROM LOC_VIEW
