
IF NOT EXISTS (SELECT TOP 1 'U' FROM CONFIG_BUYERORDER)
BEGIN
    INSERT CONFIG_BUYERORDER	( COLUMN_CAPTION, COLUMN_NAME, OPEN_KEY, SR_NO )  
	SELECT  COLUMN_CAPTION, a.COLUMN_NAME, 
	case WHEN B.VALUE ='1' THEN 1 ELSE 0 END AS OPEN_KEY, SR_NO FROM 
	(
	SELECT 	 'PRODUCT CODE' COLUMN_CAPTION,'PRODUCT_CODE' COLUMN_NAME,0 OPEN_KEY,1 SR_NO UNION ALL
	SELECT 	 'ARTICLE' COLUMN_CAPTION,'ARTICLE_NO' COLUMN_NAME,1 OPEN_KEY,2 SR_NO UNION ALL
	SELECT 	 'SECTION' COLUMN_CAPTION,'SECTION_NAME' COLUMN_NAME,0 OPEN_KEY,3 SR_NO UNION ALL
	SELECT 	 'SUB SECTION' COLUMN_CAPTION,'SUB_SECTION_NAME' COLUMN_NAME,0 OPEN_KEY,4 SR_NO UNION ALL
	SELECT 	 'PARA1_NAME' COLUMN_CAPTION,'PARA1_NAME' COLUMN_NAME,0 OPEN_KEY,5 SR_NO UNION ALL
	SELECT 	 'PARA2_NAME' COLUMN_CAPTION,'PARA2_NAME' COLUMN_NAME,0 OPEN_KEY,6 SR_NO UNION ALL
    SELECT 	 'PARA3_NAME' COLUMN_CAPTION,'PARA3_NAME' COLUMN_NAME,0 OPEN_KEY,7 SR_NO UNION ALL
	SELECT 	 'PARA4_NAME' COLUMN_CAPTION,'PARA4_NAME' COLUMN_NAME,0 OPEN_KEY,8 SR_NO UNION ALL
	SELECT 	 'PARA5_NAME' COLUMN_CAPTION,'PARA5_NAME' COLUMN_NAME,0 OPEN_KEY,9 SR_NO UNION ALL
	SELECT 	 'PARA6_NAME' COLUMN_CAPTION,'PARA6_NAME' COLUMN_NAME,0 OPEN_KEY,10 SR_NO UNION ALL
	SELECT 	 'MRP_FROM_TO' COLUMN_CAPTION,'MRP_FROM_TO' COLUMN_NAME,0 OPEN_KEY,11 SR_NO UNION ALL
	SELECT CASE WHEN TABLE_CAPTION<>'' THEN TABLE_CAPTION ELSE 	COLUMN_NAME END AS  COLUMN_CAPTION ,
	COLUMN_NAME AS COLUMN_NAME ,0 AS OPEN_KEY,
	11+ROW_NUMBER() OVER (ORDER BY LEN(B.TABLE_NAME),B.TABLE_NAME) AS SR_NO
    FROM  CONFIG_ATTR B
	) A
	left join
	(
		SELECT value,'PARA1_NAME' AS COLUMN_NAME  FROM config WHERE config_option ='CONSIDER_PARA1'  union all
		SELECT value,'PARA2_NAME' AS COLUMN_NAME  FROM config WHERE config_option ='CONSIDER_PARA2' union all
		SELECT value,'PARA3_NAME' AS COLUMN_NAME  FROM config WHERE config_option ='CONSIDER_PARA3'  union all
		SELECT value,'PARA4_NAME' AS COLUMN_NAME  FROM config WHERE config_option ='CONSIDER_PARA4' union all
		SELECT value,'PARA5_NAME' AS COLUMN_NAME  FROM config WHERE config_option ='CONSIDER_PARA5' union all
		SELECT value ,'PARA6_NAME' AS COLUMN_NAME FROM config WHERE config_option ='CONSIDER_PARA6' union all
		SELECT 1 value ,'article_no' AS COLUMN_NAME  
    ) b on a.column_name =b.column_name



END

IF  EXISTS (SELECT TOP 1 'U' FROM CONFIG_BUYERORDER where COLUMN_NAME='Para7_name')
BEGIN
      DELETE  FROM CONFIG_BUYERORDER WHERE COLUMN_NAME='PARA7_NAME'
end
