
--exec SP_PRODUCT_STATUS_REPORT 11, '2018-02-14','2019-02-14' ,'LU-002870'
CREATE PROCEDURE SP_PRODUCT_STATUS_REPORT  
(
 @nQueryID		INT,  
 @DFM_DT		DATETIME='',  
 @DTO_DT		DATETIME='',  
 @REF_NO		VARCHAR(100)='',  
 @BUYER_NAME	VARCHAR(100)='',  
 @CORDER_NO		VARCHAR(100)='',  
 @JOBCARD_NO	VARCHAR(100)='', 
 @AGENCY_NAME	VARCHAR(100)=''   
)  
AS  
BEGIN  

	if isnull(@REF_NO,'')<>'' or isnull(@BUYER_NAME,'')<>'' or isnull(@CORDER_NO,'')<>'' or isnull(@JOBCARD_NO,'')<>''
	set @DFM_DT=''

	  

	IF @nQueryID=10
	BEGIN
		SELECT DISTINCT TOP 50 MEMO_ID,MEMO_NO,CONVERT(VARCHAR,MEMO_DT,105) AS MEMO_DT FROM ORD_PLAN_MST WHERE CANCELLED=0 AND MEMO_NO LIKE @JOBCARD_NO
		ORDER BY MEMO_DT,MEMO_NO
	END
	ELSE IF @nQueryID=20
	BEGIN
		SELECT DISTINCT TOP 50  Ref_no,Ref_no AS Ref_no1 FROM BUYER_ORDER_MST WHERE CANCELLED=0 AND ISNULL(Ref_no,'')<>''
		AND ISNULL(Ref_no,'') LIKE @REF_NO
		ORDER BY Ref_no
	END
	ELSE IF @nQueryID=30
	BEGIN
		SELECT DISTINCT TOP 50 order_no,CONVERT(VARCHAR,order_dt,105) AS order_dt,order_id FROM BUYER_ORDER_MST WHERE CANCELLED=0 
		AND ISNULL(order_no,'') LIKE @CORDER_NO
		ORDER BY order_dt,order_no
	END
	ELSE IF @nQueryID=40
	BEGIN
		SELECT DISTINCT TOP 50 a.AC_CODE,b.AC_NAME 
		FROM BUYER_ORDER_MST a
		JOIN LM01106 b ON b.ac_code=a.ac_code
		WHERE a.CANCELLED=0 AND b.ac_name LIKE @BUYER_NAME 
		ORDER BY b.AC_NAME
		
	END
		ELSE IF @nQueryID=50
	BEGIN
		SELECT DISTINCT TOP 50 a.agency_code,a.agency_name
		FROM prd_agency_mst (NOLOCK) a
		WHERE a.agency_name LIKE @AGENCY_NAME 
		ORDER BY agency_name
		
	END

	ELSE IF @nQueryID=5
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_5 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=6
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_6 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=7
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_7 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=8
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_8 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=9
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_9 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=10
	BEGIN           
		EXEC SP_PRODUCT_STATUS_REPORT_10 @nQueryID=@nQueryID,@DFM_DT =@DFM_DT, @DTO_DT =@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO 
	END
	ELSE IF @nQueryID=11
	BEGIN           
		EXEC SP3S_MATERIAL_ISSUE_CHART @DASONDATE=@DTO_DT,@REF_NO =@REF_NO,@BUYER_NAME =@BUYER_NAME,@CORDER_NO =@CORDER_NO,@JOBCARD_NO =@JOBCARD_NO , @AGENCY_NAME	=@AGENCY_NAME
	END
end





