CREATE FUNCTION FN_GETENCRYPTVAL
( @NVAL		INT) RETURNS VARCHAR(4000)	
--WITH ENCRYPTION
AS
BEGIN
DECLARE @CRETVAL	NVARCHAR(4000),@CGETSTR VARCHAR(50),@NLEN INT,@CCHAR	NVARCHAR(20)
SET @CGETSTR=CONVERT(VARCHAR(50),@NVAL)
SET @NLEN=1

SET @CRETVAL=ISNULL(@CRETVAL,'')
WHILE @NLEN<= LEN(@CGETSTR)
BEGIN
SELECT  @CCHAR=(CASE WHEN ISNULL(CODE,'')='' THEN SUBSTRING(@CGETSTR,@NLEN,1) ELSE CODE END)
FROM ENCRYPTVAL WHERE FIGURE_FROM=SUBSTRING(@CGETSTR,@NLEN,1)
SET @CRETVAL=@CRETVAL+LTRIM(RTRIM(@CCHAR))
SET @NLEN=@NLEN+1

END
RETURN ISNULL(@CRETVAL,'')
END
