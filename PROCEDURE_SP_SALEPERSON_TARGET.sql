CREATE PROCEDURE SP_SALEPERSON_TARGET    
@NQUERYID NUMERIC(2,0),    
@CMEMOID VARCHAR(MAX),    
@CWHERE VARCHAR(MAX),    
@CFINYEAR VARCHAR(5),    
@NNAVMODE NUMERIC(2,0),    
@CDEPTCODE VARCHAR(10)=''    
-- WITH ENCRYPTION
   
AS    
BEGIN      
      
DECLARE @CCMD NVARCHAR(4000)      
DECLARE @CRETCOLSTR NVARCHAR(4000)      
DECLARE  @INT INT          
        
IF @NQUERYID = 1      
GOTO LBLNAVIGATE      
      
ELSE      
IF @NQUERYID = 2      
GOTO LBLGETMASTERS      
      
ELSE      
IF @NQUERYID = 3      
GOTO LBLGETDETAILS 
     
IF @NQUERYID = 4      
GOTO LBLGETSUBDETAILS         
        
ELSE      
GOTO LAST      
      
LBLNAVIGATE:      
      
 EXECUTE SP_NAVIGATE_LOCSPACE 'SALEPERSON_TARGET_MST',@NNAVMODE,@CMEMOID,'','MEMO_NO','MEMO_DT','MEMO_ID',@CWHERE      
      
GOTO LAST      
      
LBLGETMASTERS:      
      
 SELECT T1.*, T2.USERNAME     
 FROM SALEPERSON_TARGET_MST T1      
 JOIN USERS T2 ON T1.USER_CODE = T2.USER_CODE      
 WHERE T1.MEMO_ID = @CMEMOID      
      
GOTO LAST      
      
LBLGETDETAILS:      
  
 SELECT CAST(1 AS BIT) AS CHK, A.*         
 FROM SALEPERSON_TARGET_DET A      
 WHERE A.MEMO_ID = @CMEMOID      
          
 GOTO LAST      

LBLGETSUBDETAILS:
 SELECT CAST(1 AS BIT) AS CHK, A.*         
 FROM SALEPERSON_TARGET_SUBDET A      
 WHERE A.MEMO_ID = @CMEMOID       
      
      

LAST:      
END
