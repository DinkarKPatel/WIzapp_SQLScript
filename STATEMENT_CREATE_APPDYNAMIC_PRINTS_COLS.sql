
DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('APP','APM.memo_time','memo_time',0,'Approval_Issue','APP')
INSERT INTO @dtLocal VALUES('APP','APM.MEMO_DT','MEMO_DT',0,'Approval_Issue','APP')
INSERT INTO @dtLocal VALUES('APP','APM.MEMO_NO','MEMO_NO',0,'Approval_Issue','APP')
INSERT INTO @dtLocal VALUES('APP','APM.SUBTOTAL','SUBTOTAL',0,'Approval_Issue','APP')
INSERT INTO @DTLOCAL VALUES('APP','APM.DISCOUNT_PERCENTAGE','DISCOUNT_PERCENTAGE',0,'APPROVAL_ISSUE','APM_MST') 
INSERT INTO @DTLOCAL VALUES('APP','APM.DISCOUNT_AMOUNT','DISCOUNT_AMOUNT',0,'APPROVAL_ISSUE','APM_MST') 
INSERT INTO @DTLOCAL VALUES('APP','APM.ATD_CHARGES','ATD_CHARGES',0,'APPROVAL_ISSUE','APM_MST') 
INSERT INTO @DTLOCAL VALUES('APP','APM.NET_AMOUNT','NET_AMOUNT',0,'APPROVAL_ISSUE','APM_MST')  
INSERT INTO @DTLOCAL VALUES('APP','APM.ROUND_OFF','ROUND_OFF',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','APM.REMARKS','REMARKS',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','APM.CANCELLED','CANCELLED',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','APM.MEMO_TYPE','MEMO_TYPE',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','APM.COMPUTER_NAME','COMPUTER_NAME',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','APM.REF_NO','REF_NO',0,'APPROVAL_ISSUE','APM_MST')


INSERT INTO @DTLOCAL VALUES('APP','LEFT(SKU_NAMES.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SKU_NAMES.PRODUCT_CODE)-1,-1),LEN(SKU_NAMES.PRODUCT_CODE )))','PRODUCT_CODE',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.QUANTITY','QUANTITY',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.MRP','MRP',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.NET','NET',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.DISCOUNT_PERCENTAGE','ITEM_DISC_PERCENTAGE',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.DISCOUNT_AMOUNT','ITEM_DISC_AMOUNT',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.RFNET','RFNET',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.DEPT_ID','DEPT_ID',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.QUANTITY*APD01106.MRP','AMOUNT',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.MRP','RATE',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','APD01106.ITEM_REMARKS','ITEM_REMARKS',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','''''','HSN_Summary',0,'APPROVAL_ISSUE','APM_DETAILS')


INSERT INTO @DTLOCAL VALUES('APP','SKU.PURCHASE_PRICE','PURCHASE_PRICE',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.INV_DT','INV_DT',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.INV_NO','INV_NO',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.RECEIPT_DT','RECEIPT_DT',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.WS_PRICE','WS_PRICE',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.CHALLAN_NO','CHALLAN_NO',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU.FIX_MRP','FIX_MRP',0,'APPROVAL_ISSUE','APM_DETAILS')
--INSERT INTO @DTLOCAL VALUES('APP','SKU.HSN_CODE','HSN_CODE',0,'APPROVAL_ISSUE','APM_DETAILS') --shn_code shift in hsn summary

INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA1_NAME','PARA1_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA2_NAME','PARA2_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA3_NAME','PARA3_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA4_NAME','PARA4_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA5_NAME','PARA5_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA6_NAME','PARA6_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ARTICLE_NO','ARTICLE_NO',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ARTICLE_NAME','ARTICLE_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.UOM','UOM_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SUB_SECTION_NAME','SUB_SECTION_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SECTION_NAME','SECTION_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.PARA2_ORDER','PARA2_ORDER',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.SN_ARTICLE_DESC','ARTICLE_DESC',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ARTICLE_ALIAS','ALIAS',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.para1_set','para1_set',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.para2_set','para2_set',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.stock_na','stock_na',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.sn_barcode_coding_scheme','CODING_SCHEME',0,'APPROVAL_ISSUE','APM_DETAILS')


INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR1_KEY_NAME','ATTR1_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR2_KEY_NAME','ATTR2_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR3_KEY_NAME','ATTR3_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR4_KEY_NAME','ATTR4_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR5_KEY_NAME','ATTR5_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR6_KEY_NAME','ATTR6_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR7_KEY_NAME','ATTR7_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR8_KEY_NAME','ATTR8_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR9_KEY_NAME','ATTR9_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR10_KEY_NAME','ATTR10_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR11_KEY_NAME','ATTR11_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR12_KEY_NAME','ATTR12_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR13_KEY_NAME','ATTR13_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR14_KEY_NAME','ATTR14_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR15_KEY_NAME','ATTR15_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR16_KEY_NAME','ATTR16_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR17_KEY_NAME','ATTR17_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR18_KEY_NAME','ATTR18_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR19_KEY_NAME','ATTR19_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR20_KEY_NAME','ATTR20_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR21_KEY_NAME','ATTR21_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR22_KEY_NAME','ATTR22_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR23_KEY_NAME','ATTR23_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR24_KEY_NAME','ATTR24_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','SKU_NAMES.ATTR25_KEY_NAME','ATTR25_KEY_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')

INSERT INTO @DTLOCAL VALUES('APP','CUST.USER_CUSTOMER_CODE','USER_CUSTOMER_CODE',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.MOBILE','MOBILE',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUSTCT.CITY','CITY',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.CUS_GST_STATE_CODE','PARTY_STATE_CODE',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUSTST.GST_STATE_NAME','PARTY_STATE_NAME',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.CUS_GST_NO','PARTY_GST_NO',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','isnull(CUST.DT_ANNIVERSARY,'''')','DT_ANNIVERSARY',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.LOCATION_ID','LOCATION_ID',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.ADDRESS9','ADDRESS9',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.CUSTOMER_TITLE','CUSTOMER_TITLE',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP',' ISNULL(CUST.CUSTOMER_FNAME,'''')','CUSTOMER_FNAME',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.CUSTOMER_LNAME,'''')','CUSTOMER_LNAME',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.ADDRESS0','ADDRESS0',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.ADDRESS1','ADDRESS1',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','CUST.ADDRESS2','ADDRESS2',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.PHONE1,'''')','PHONE1',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.PHONE2,'''')','PHONE2',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.EMAIL,'''')','EMAIL',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.OPENING_BALANCE,'''')','OPENING_BALANCE',0,'APPROVAL_ISSUE','CUSTOMER')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(CUST.DT_BIRTH,'''')','DT_BIRTH',0,'APPROVAL_ISSUE','CUSTOMER')

INSERT INTO @DTLOCAL VALUES('APP','USERS.USERNAME','USERNAME',0,'APPROVAL_ISSUE','APM_MST')
INSERT INTO @DTLOCAL VALUES('APP','USERS.USER_ALIAS','USER_ALIAS',0,'APPROVAL_ISSUE','APM_MST')

INSERT INTO @DTLOCAL VALUES('APP','BIN.BIN_NAME','BIN_NAME',0,'APPROVAL_ISSUE','APM_MST')

INSERT INTO @DTLOCAL VALUES('APP','EMPLOYEE.EMP_NAME','EMP_NAME',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','EMPLOYEE.EMP_ALIAS','EMP_ALIAS',0,'APPROVAL_ISSUE','APM_DETAILS')
INSERT INTO @DTLOCAL VALUES('APP','EMPLOYEE.EMP_HEAD','EMP_HEAD',0,'APPROVAL_ISSUE','APM_DETAILS')

INSERT INTO @DTLOCAL VALUES('APP','SL.DEPT_PRINT_NAME','LOCATION_PRINT_NAME',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.REGISTERED_ADD','SOURCE_LOCATION_REGISTERED_ADDRESS',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.LOC_GST_NO','SOURCE_LOCATION_GST_NO',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','ISNULL(LEFT(SL.LOC_GST_NO,2),'''')','SOURCE_LOCATION_STATE_CODE',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SLA.AREA_NAME','SOURCE_LOCATION_AREA',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SLR.REGION_NAME','SOURCE_LOCATION_COUNTRY_NAME',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.CONTACT_NO','SOURCE_LOCATION_CONTACT_NO',0,'APPROVAL_ISSUE','SOURCE_LOCATION')

INSERT INTO @DTLOCAL VALUES('APP','SL.PAN_NO','COMP_PANNO',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','APPGST.GST_STATE_NAME','COMP_STATE',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.DEPT_NAME','COMP_COMPANYNAME',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.PHONE','COMP_MOBILE',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.DEPT_ALIAS','COMP_ALIAS',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.ADDRESS1','COMP_ADDRESS1',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.ADDRESS2','COMP_ADDRESS2',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SLC.CITY','COMP_CITY',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.TAN_NO','COMP_TANNO',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.PHONE','COMP_PHONES_FAX',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.CST_DT','COMP_CST_DT',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SLA.PINCODE','COMP_PIN',0,'APPROVAL_ISSUE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('APP','SL.TIN_NO','COMP_TIN_NO',0,'APPROVAL_ISSUE','SOURCE_LOCATION')

INSERT INTO @DTLOCAL VALUES('APP','CMP.COMPANY_NAME','COMPANY_NAME',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.CONTACT_NAME','COMP_CONTACTNAME',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.EMAIL_ID','COMP_EMAILID',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.LOGO_PATH','COMP_LOGOPATH',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.COMPANY_NAME','COMPANY_NAME',0,'APPROVAL_ISSUE','COMPANY')

INSERT INTO @DTLOCAL VALUES('APP','CMP.ADDRESS1','COMPANY_ADDRESS1',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.ADDRESS2','COMPANY_ADDRESS2',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.CITY','COMPANY_CITY',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.[STATE]','COMPANY_STATE',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.COUNTRY','COMPANY_COUNTRY',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.GST_NO','COMPANY_GST_NO',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.CIN','COMPANY_CIN',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.PAN_NO','COMPANY_PAN_NO',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.PIN','COMPANY_PIN',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','CMP.WEB_ADDRESS','COMPANY_WEBSITE',0,'APPROVAL_ISSUE','COMPANY')
INSERT INTO @DTLOCAL VALUES('APP','IMG.PROD_IMAGE','PROD_IMAGE',0,'APPROVAL_ISSUE','APM_DETAILS')


UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1



DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'APPROVAL_ISSUE'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='APP'
WHERE b.COLUMN_NAME IS NULL  

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='APP'
)

DELETE  FROM CTE WHERE SR>1
