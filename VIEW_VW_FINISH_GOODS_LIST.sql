CREATE VIEW VW_FINISH_GOODS_LIST 

AS 
SELECT DISTINCT T1.MEMO_NO 
,T1.MEMO_DT AS MEMO_DATE 
,ISNULL(T6.MEMO_NO,'') AS WORK_ORDER_MEMO_NO
,(CASE WHEN T6.MEMO_DT <> '' THEN CONVERT(CHAR(10),ISNULL(T6.MEMO_DT,''),105) ELSE ''  END) AS WORK_ORDER_DATE
,ISNULL(T6.REF_NO,'') AS WORK_ORDER_REFNO ,ART.ARTICLE_NO AS SET_NO,ART.ARTICLE_NAME AS SET_NAME
,T3.DEPARTMENT_NAME AS DEPARTMENT_NAME
,CASE WHEN T1.CANCELLED = 0 THEN '' ELSE 'CANCELLED' END AS CANCELLED
,T2.USERNAME AS USER_NAME 
,T1.DEPARTMENT_ID,T1.MEMO_ID,T1.FIN_YEAR
FROM PRD_FINISH_MST T1
JOIN USERS T2 ON T1.USER_CODE = T2.USER_CODE
JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID = T1.DEPARTMENT_ID
JOIN PRD_WO_MST T6 ON T1.REF_PRD_WORKORDER_MEMOID= T6.MEMO_ID
JOIN ARTICLE ART ON ART.ARTICLE_CODE=T6.ARTICLE_SET_CODE
