CREATE VIEW VW_CODE_CONV_PRINT

AS
SELECT 
		 M.MEMO_NO 
		,M.MEMO_DT 
		,M.MEMO_ID 
		,M.DEPARTMENT_ID AS SOURCE_DEPARTMENT_ID
		,SDEP.DEPARTMENT_NAME AS SOURCE_DEPARTMENT_NAME
		,M.CANCELLED 
		,M.USER_CODE 
		,USERS.USERNAME
		,M.REF_PRD_WORKORDER_MEMOID  
		,WOM.MEMO_NO AS WORK_ORDER_MEMO_NO
		,ARTSET.ARTICLE_NO AS WO_ARTICLE_SET_NO
		,ARTSET.ARTICLE_NAME AS WO_ARTICLE_SET_NAME
		,ARTDET.ARTICLE_NO AS CC_ARTICLE_NO
		,ARTDET.ARTICLE_NAME AS CC_ARTICLE_NAME
		,ARTDET.ARTICLE_DESC AS CC_ARTICLE_DESC
		,P1DET.PARA1_NAME AS CC_ARTICLE_PARA1_NAME
		,P2DET.PARA2_NAME AS CC_ARTICLE_PARA2_NAME
		,D.QUANTITY 
		,SEG.SEGMENT_NAME 
		,D.ROW_ID AS CC_ROW_ID 
		 
		,ARTDETCON.ARTICLE_NO AS RMCON_ARTICLE_NO
		,ARTDETCON.ARTICLE_NAME AS RMCON_ARTICLE_NAME
		,ARTDETCON.ARTICLE_DESC AS RMCON_ARTICLE_DESC
		,P1DETCON.PARA1_NAME AS RMCON_ARTICLE_PARA1_NAME
		,P2DETCON.PARA2_NAME AS RMCON_ARTICLE_PARA2_NAME
		,RMCON.AVG_QTY AS RMCON_AVG_QTY
		,RMCON.QUANTITY AS RMCON_QUANTITY
		,RMCON.ROW_ID AS RMCON_ROW_ID
FROM PRD_DEPARTMENT_OUTPUT_MST M 
JOIN PRD_WO_MST WOM ON M.REF_PRD_WORKORDER_MEMOID = WOM.MEMO_ID 
JOIN ARTICLE ARTSET ON WOM.ARTICLE_SET_CODE = ARTSET.ARTICLE_CODE
JOIN USERS ON M.USER_CODE = USERS.USER_CODE 
JOIN PRD_DEPARTMENT_MST SDEP ON M.DEPARTMENT_ID  = SDEP.DEPARTMENT_ID
JOIN PRD_DEPARTMENT_OUTPUT_DET D ON M.MEMO_ID = D.MEMO_ID 
JOIN ARTICLE ARTDET ON D.ARTICLE_CODE = ARTDET.ARTICLE_CODE 
JOIN PARA1 P1DET ON D.PARA1_CODE = P1DET.PARA1_CODE 
JOIN PARA2 P2DET ON D.PARA2_CODE = P2DET.PARA2_CODE 
JOIN PRD_SEGMENT_MST SEG ON D.SEGMENT_ID = SEG.SEGMENT_ID 

JOIN PRD_DEPARTMENT_RMCONSUMPTION_DET RMCON ON M.MEMO_ID = RMCON.MEMO_ID 
JOIN ARTICLE ARTDETCON ON RMCON.ARTICLE_CODE = ARTDETCON.ARTICLE_CODE 
JOIN PARA1 P1DETCON ON RMCON.PARA1_CODE = P1DETCON.PARA1_CODE 
JOIN PARA2 P2DETCON ON RMCON.PARA2_CODE = P2DETCON.PARA2_CODE
