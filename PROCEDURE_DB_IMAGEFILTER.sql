CREATE PROCEDURE DB_IMAGEFILTER
(
 @nMODE INT =1,
 @cParaMeter varchar(150) ='',
 @cTableName varchar(150) =''
)
AS 
BEGIN
SET NOCOUNT ON
IF @nMODE = 1  
	SELECT 'SECTION' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR         
	UNION ALL              
	SELECT 'SUB SECTION' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR       
    UNION ALL              
	SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR
    UNION ALL              
	SELECT 'DEPT NAME' AS MASTER_COL,'DEPT_NAME' AS MASTER_COL_EXPR
    UNION ALL              
	SELECT 'DEPT ID' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR
    UNION ALL              
	SELECT 'SUPPLIER' AS MASTER_COL,'AC_CODE' AS MASTER_COL_EXPR
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE config_option LIKE 'PARA1_caption') AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR   
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE  config_option LIKE 'PARA2_caption') AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR   
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE   config_option LIKE 'PARA3_caption') AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR   
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE   config_option LIKE 'PARA4_caption') AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR   
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE  config_option LIKE 'PARA5_caption') AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR   
	UNION ALL              
	SELECT (SELECT TOP 1 VALUE FROM CONFIG WHERE  config_option LIKE 'PARA6_caption') AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR   
	--
	UNION ALL              
	SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR
	UNION ALL              
	SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR
	UNION ALL              
	SELECT 'IMAGE' AS MASTER_COL,'IMAGE_NAME' AS MASTER_COL_EXPR
	UNION ALL              
	SELECT 'CBS QTY' AS MASTER_COL,'CBC_QTY' AS MASTER_COL_EXPR
	UNION ALL              
	SELECT 'SLS QTY' AS MASTER_COL,'SLS_QTY' AS MASTER_COL_EXPR
	
IF @nMODE = 2	
   BEGIN
      DECLARE @SQL VARCHAR(MAX),@cField VARCHAR(99)
      SET @cTableName=CASE	WHEN @cParaMeter='SECTION' THEN 'SECTIONM'
							WHEN @cParaMeter='SUB SECTION'THEN 'SECTIOND'
							WHEN @cParaMeter='ARTICLE NO' THEN 'ARTICLE'
							WHEN @cParaMeter='DEPT NAME' THEN 'LOCATION'
							WHEN @cParaMeter='DEPT ID' THEN 'LOCATION'
							WHEN @cParaMeter='SUPPLIER' THEN 'LM01106'
							WHEN @cParaMeter='MRP' THEN 'SKU'
							WHEN @cParaMeter='IMAGE' THEN 'IMAGE_INFO'
							WHEN @cParaMeter='CBS QTY' THEN 'PMT01106'
							WHEN @cParaMeter='SLS QTY' THEN 'CMD01106'
							WHEN @cParaMeter='PRODUCT CODE' THEN 'SKU'
							WHEN @cParaMeter LIKE 'PARA%' THEN @cParaMeter
					  END
					  
      SET @cField=CASE	WHEN @cParaMeter='SECTION'		THEN 'SECTION_NAME'
						WHEN @cParaMeter='SUB SECTION'	THEN 'SUB_SECTION_NAME'
						WHEN @cParaMeter='ARTICLE NO'	THEN 'ARTICLE_NO'
						WHEN @cParaMeter='DEPT NAME'	THEN 'DEPT_NAME'
						WHEN @cParaMeter='DEPT ID'		THEN 'DEPT_ID'
						WHEN @cParaMeter='SUPPLIER'		THEN 'AC_NAME'
						WHEN @cParaMeter='MRP'			THEN 'MRP'
						WHEN @cParaMeter='PRODUCT CODE' THEN 'PRODUCT_CODE'
						WHEN @cParaMeter='IMAGE'		THEN 'IMAGE_NAME'
						WHEN @cParaMeter='CBS QTY'		THEN 'CBS_QTY'
						WHEN @cParaMeter='SLS QTY'		THEN 'SLS_QTY'
						WHEN @cParaMeter LIKE 'PARA%'	THEN @cParaMeter+'_NAME'
				  END

	  SET @SQL='SELECT '+CASE WHEN @cTableName='SKU' THEN 'TOP 500 ' ELSE '' END+@cField+' FROM '+@cTableName+CASE WHEN @cTableName IN ('SKU','pmt01106','cmd01106','IMAGE_INFO') THEN '' ELSE ' WHERE ISNULL(INACTIVE,0)=0' END
      EXEC(@SQL)
   END

IF @nMODE = 3
   BEGIN
     SELECT 1 ID,'SALE'SortingOn
     UNION
     SELECT 2 ID,'SUPPLIER'
   END
   	
SET NOCOUNT OFF
END