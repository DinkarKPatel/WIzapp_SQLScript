CREATE VIEW LOC_VIEW
--WITH ENCRYPTION
AS
SELECT B.AREA_NAME, B.PINCODE, C.CITY_CODE, C.CITY, D.STATE_CODE, D.STATE,   
  D.OCTROI_PERCENTAGE, E.REGION_CODE, E.REGION_NAME, '' AS LOC_GROUP_NAME,   
  A.*, (CASE WHEN A.LOC_TYPE =1 THEN 'COMPANY OWNED' ELSE 'FRANCHISE OWNED' END) AS LOC_TYPE_NAME,  
  (CASE WHEN A.FR_TYPE =1 THEN 'CONSIGNMENT' ELSE 'OUTRIGHT' END) AS FR_TYPE_NAME,
  (CASE WHEN SIS_LOC= 1 THEN 'SIS' ELSE 'EBO' END ) AS LOC_GROUP,
  CON.COUNTRY_NAME 
FROM LOCATION A (NOLOCK)  
JOIN AREA B (NOLOCK) ON A.AREA_CODE = B.AREA_CODE  
JOIN CITY C (NOLOCK) ON B.CITY_CODE = C.CITY_CODE  
JOIN [STATE] D (NOLOCK) ON C.STATE_CODE = D.STATE_CODE  
JOIN REGIONM E (NOLOCK) ON D.REGION_CODE = E.REGION_CODE
LEFT JOIN COUNTRY CON (NOLOCK)  ON CON.COUNTRY_CODE =E.COUNTRY_CODE 
