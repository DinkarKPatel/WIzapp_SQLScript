create PROCEDURE SP3S_UPDATE_MASTERS_SKU
(
	@DEPT_ID VARCHAR(5)='07'
)
AS 
BEGIN




			DECLARE @CSTEP INT,@CERRMSG VARCHAR(MAX)
			DECLARE @CTABLENAME NVARCHAR(MAX),@CCMD NVARCHAR(MAX),@CCURLOCTIONID VARCHAR(5)
			,@CCLONAME NVARCHAR(MAX),@CTEMPTABLE VARCHAR(1000),@LOCCTEMPTABLE NVARCHAR(1000)
			,@CLOCTYPE INT,@UPD_PURINFO BIT,@CODING BIT,@SKUINS VARCHAR(2)
			DECLARE @Table_Name VARCHAR(100),@Temp_Table_Name VARCHAR(500)
			DECLARE @dtTable TABLE(SRNO INT ,Table_Name		VARCHAR(100), Temp_Table_Name VARCHAR(MAX))
			
		BEGIN TRY 

			SELECT @CCURLOCTIONID=VALUE FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID'
			SET @CLOCTYPE=''
			SET @UPD_PURINFO=''
			SELECT @CLOCTYPE=ISNULL(LOC_TYPE,0),@UPD_PURINFO=ISNULL(UPD_PURINFO,0) FROM LOCATION WHERE DEPT_ID=@CCURLOCTIONID
                 
                IF LTRIM(RTRIM(ISNULL(@DEPT_ID,'')))=''
					SELECT @DEPT_ID=@CCURLOCTIONID
			
		        	SET @TEMP_TABLE_NAME='TEMP_SKU_'+@DEPT_ID+'_DETAIL'
		

						SET @CSTEP=10--UPDATE PARA1
						SET @CCMD=N' UPDATE A1 SET A1.PARA1_NAME = A2.PARA1_NAME, A1.ALIAS = A2.PARA1_ALIAS
						FROM PARA1 A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PARA1_CODE = A2.PARA1_CODE'
						PRINT @CCMD 
						EXEC SP_EXECUTESQL @CCMD


						SET @CSTEP=20 --INSERT PARA1
						SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
						SELECT DISTINCT A.PARA1_CODE,A.PARA1_NAME,GETDATE() ,ISNULL(A.para1_ALIAS,''''),0 as INACTIVE, 0, '''', ''''
						FROM  '+@Temp_Table_Name+' A(NOLOCK) 
						LEFT JOIN PARA1 B(NOLOCK) ON A.PARA1_CODE = B.PARA1_CODE 
						WHERE B.PARA1_CODE IS NULL'
						PRINT @CCMD 
						EXEC SP_EXECUTESQL @CCMD


					SET @CSTEP=31 --UPDATE PARA2
					SET @CCMD=N' UPDATE A1 SET A1.PARA2_NAME = A2.PARA2_NAME,A1.ALIAS = A2.para2_ALIAS,
					A1.PARA2_ORDER = A2.PARA2_ORDER 
					FROM PARA2 A1 WITH (ROWLOCK) 
					JOIN '+@Temp_Table_Name+' A2(NOLOCK) ON A1.PARA2_CODE = A2.PARA2_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD


					SET @CSTEP=40 -- INSERT PARA2
					SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
					SELECT DISTINCT GETDATE(),ISNULL(A.para2_ALIAS,''''),0 as INACTIVE,ISNULL(A.PARA2_ORDER,0),'''',
					A.PARA2_CODE,A.PARA2_NAME,''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.PARA2_CODE = B.PARA2_CODE 
					WHERE B.PARA2_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
		

					SET @CSTEP=50 --UPDATE PARA3
					SET @CCMD=N' UPDATE A1 SET A1.PARA3_NAME = A2.PARA3_NAME,A1.ALIAS = A2.para3_ALIAS
					FROM PARA3 A1 WITH (ROWLOCK) 
					JOIN '+@Temp_Table_Name+' A2(NOLOCK) ON A1.PARA3_CODE = A2.PARA3_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD

					SET @CSTEP=60 -- INSERT PARA3
					SET @CCMD=N'INSERT PARA3(PARA3_CODE, PARA3_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)
					SELECT DISTINCT A.PARA3_CODE, A.PARA3_NAME, GETDATE() AS LAST_UPDATE,ISNULL(A.para3_ALIAS,''''),0 as INACTIVE, ''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) LEFT JOIN PARA3 B(NOLOCK) ON A.PARA3_CODE = B.PARA3_CODE WHERE B.PARA3_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
		
			
					SET @CSTEP=70 --UPDATE PARA4
					SET @CCMD=N' UPDATE A1 SET A1.PARA4_NAME = A2.PARA4_NAME, A1.ALIAS = A2.para4_ALIAS
					FROM PARA4 A1 WITH (ROWLOCK)JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PARA4_CODE = A2.PARA4_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD


					SET @CSTEP=80 -- INSERT PARA4
					SET @CCMD=N' INSERT PARA4( PARA4_CODE, PARA4_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS) 
					SELECT DISTINCT A.PARA4_CODE,A.PARA4_NAME, GETDATE(),ISNULL(A.para4_ALIAS,''''), 0 as INACTIVE,''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) LEFT JOIN PARA4 B(NOLOCK) ON A.PARA4_CODE = B.PARA4_CODE 
					WHERE B.PARA4_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
        
					SET @CSTEP=90 --UPDATE PARA5
					SET @CCMD=N' UPDATE A1
					SET A1.PARA5_NAME = A2.PARA5_NAME,A1.ALIAS = A2.para5_ALIAS
					FROM PARA5 A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PARA5_CODE = A2.PARA5_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD


					SET @CSTEP=100 -- INSERT PARA5
					SET @CCMD=N' INSERT PARA5( ALIAS, INACTIVE, PARA5_CODE, PARA5_NAME, LAST_UPDATE, REMARKS)
					SELECT DISTINCT ISNULL(A.para5_ALIAS,''''),0 as INACTIVE,A.PARA5_CODE,A.PARA5_NAME, GETDATE() ,''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) LEFT JOIN PARA5 B(NOLOCK) ON A.PARA5_CODE = B.PARA5_CODE 
					WHERE B.PARA5_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
		
					SET @CSTEP=110 --UPDATE PARA6
					SET @CCMD=N' UPDATE A1
					SET A1.PARA6_NAME = A2.PARA6_NAME,A1.ALIAS = A2.para6_ALIAS
					FROM PARA6 A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PARA6_CODE = A2.PARA6_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD

					SET @CSTEP=120 --- INSERT PARA6
					SET @CCMD=N'INSERT PARA6( PARA6_CODE, PARA6_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)  
					SELECT DISTINCT A.PARA6_CODE, A.PARA6_NAME, GETDATE(),ISNULL(A.para6_ALIAS,''''), 0 as INACTIVE,''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) LEFT JOIN PARA6 B(NOLOCK) ON A.PARA6_CODE = B.PARA6_CODE 
					WHERE B.PARA6_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
 

		           
					SET @CSTEP=190 --UPDATE HSN(SKU)---HSN_MST
					SET @CCMD=N' UPDATE A1 SET TAXABLE_ITEM=A2.TAXABLE_ITEM,HSN_TYPE=A2.HSN_TYPE 
					FROM HSN_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.HSN_CODE = A2.HSN_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD


					SET @CSTEP=200 --INSERT HSN(SKU)---HSN_MST
					SET @CCMD=N'INSERT HSN_MST	( HSN_CODE, TAXABLE_ITEM, HSN_TYPE ) 
					SELECT DISTINCT A.HSN_CODE,A.TAXABLE_ITEM, ISNULL(A.HSN_TYPE,0) 
					FROM '+@Temp_Table_Name+' A(NOLOCK) 
					LEFT JOIN HSN_MST B (NOLOCK) ON A.HSN_CODE=B.HSN_CODE
					WHERE B.HSN_CODE IS NULL AND ISNULL(A.HSN_CODE,'''')<>'''''  
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
			
	
			
	
					SET @CSTEP=250 -- UPDATE SECTIONM(SECTIOND)
					SET @CCMD=N' UPDATE A1 SET SECTION_NAME=A2.SECTION_NAME,ALIAS=A2.section_ALIAS
					FROM SECTIONM A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.SECTION_CODE = A2.SECTION_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD



					SET @CSTEP=260 --INSERT SECTIONM(SECTIOND)
					SET @CCMD=N'INSERT SECTIONM	( SECTION_CODE, SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS )  
					SELECT DISTINCT A.SECTION_CODE, A.SECTION_NAME, GETDATE() ,ISNULL(A.section_ALIAS,''''), 0 as INACTIVE, ''''
					FROM '+@Temp_Table_Name+' A(NOLOCK)LEFT JOIN SECTIONM B (NOLOCK) ON A.SECTION_CODE=B.SECTION_CODE
					WHERE B.SECTION_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD



					SET @CSTEP=270 --UPDATE SECTIOND(ARTICLE)
					SET @CCMD=N' UPDATE A1 SET SUB_SECTION_NAME=A2.SUB_SECTION_NAME,ALIAS=A2.SUB_SECTION_ALIAS,
					MFG_CATEGORY=A2.MFG_CATEGORY,SECTION_CODE=A2.SECTION_CODE
					FROM SECTIOND A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) 
					ON A1.SUB_SECTION_CODE = A2.SUB_SECTION_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD



					SET @CSTEP=280 --INSERT SECTIOND(ARTICLE)
					SET @CCMD=N'INSERT SECTIOND( SUB_SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, MFG_CATEGORY, SECTION_CODE, 
					SUB_SECTION_CODE, REMARKS )  
					SELECT DISTINCT A.SUB_SECTION_NAME, GETDATE(), ISNULL(A.SUB_SECTION_ALIAS,''''),0 as INACTIVE,ISNULL(A.MFG_CATEGORY,0),A.SECTION_CODE,
					A.SUB_SECTION_CODE, ''''
					FROM '+@Temp_Table_Name+' A(NOLOCK) 
					LEFT JOIN SECTIOND B (NOLOCK) ON A.SUB_SECTION_CODE=B.SUB_SECTION_CODE
					WHERE B.SUB_SECTION_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD




					SET @CSTEP=290 --UPDATAE UOM(ARTICLE)
					SET @CCMD=N' UPDATE A1 SET UOM_TYPE=A2.UOM_TYPE,UOM_NAME=A2.UOM_NAME
					FROM UOM A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.UOM_CODE = A2.UOM_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD

					SET @CSTEP=300---INSERT UOM(ARTICLE)
					SET @CCMD=N'INSERT UOM	( UOM_TYPE, INACTIVE, UOM_CODE, UOM_NAME, LAST_UPDATE ) 
					SELECT DISTINCT A.UOM_TYPE, 0 as INACTIVE, A.UOM_CODE, A.UOM_NAME, GETDATE()FROM '+@Temp_Table_Name+' A(NOLOCK) 
					LEFT JOIN UOM B (NOLOCK) ON A.UOM_CODE=B.UOM_CODE
					WHERE B.UOM_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD
			
	
			

		

					SET @CSTEP=310 ---  UPDATE ARTICLE(SKU)
					SET @CCMD=N' UPDATE A1 SET	A1.UOM_CODE = A2.UOM_CODE, A1.CODING_SCHEME = A2.CODING_SCHEME,
					A1.SUB_SECTION_CODE = A2.SUB_SECTION_CODE, A1.ARTICLE_NAME = A2.ARTICLE_NAME, 
					A1.ARTICLE_NO = A2.ARTICLE_NO,A1.ALIAS = A2.article_ALIAS,
					A1.DISCON = A2.DISCON,A1.STOCK_NA = A2.STOCK_NA,
					A1.GENERATE_BARCODES_WITHARTICLE_PREFIX = A2.GENERATE_BARCODES_WITHARTICLE_PREFIX,
					A1.SKU_CODE = A2.SKU_CODE,A1.ARTICLE_DESC = A2.ARTICLE_DESC,
					A1.GEN_EAN_CODES=A2.GEN_EAN_CODES,A1.ORDERITEM=A2.ORDERITEM,
					A1.HSN_CODE=A2.HSN_CODE
					FROM ARTICLE A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ARTICLE_CODE = A2.ARTICLE_CODE' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD




					SET @CSTEP=320 --INSERT ARTICLE(SKU)
					SET @CCMD=N'INSERT ARTICLE	( PARA2_CODE, PARA3_CODE, PARA4_CODE, PARA5_CODE, PARA6_CODE, DISCON, 
					WHOLESALE_PRICE, WSP_PERCENTAGE, MIN_PRICE, STOCK_NA, ARTICLE_TYPE, CREATED_ON, ARTICLE_GROUP_CODE,
					COMPANY_CODE, GENERATE_BARCODES_WITHARTICLE_PREFIX, ARTICLE_GEN_MODE, ARTICLE_PRD_MODE, ARTICLE_SET_CODE,
					OH_PERCENTAGE, OH_AMOUNT, FIX_MRP, ENABLE_FIXWT_ENTRY, FIX_WEIGHT, EXP_AMOUNT, SUPP_SPECIFIC, SUPP_AC_CODE,
					SUPP_ITEM_CODE, REMARKS, FIX_PRICE_ARTICLE, GROSS_PURCHASE_PRICE, DISCOUNT_PERCENTAGE, DISCOUNT_AMOUNT, 
					GEN_EAN_CODES, SIZE_CENTER_POINT, SIZE_RATE_DIFF, MANUAL_DISC, MANUAL_WSP, MANUAL_RSP, 
					AREA_WISE_RATE_APPLICABLE, ORDERITEM,  DO_AMOUNT, DO_PERCENTAGE, EXP_PERCENTAGE,
					ARTICLE_SET_TYPE, STYLE_NO, COLOR_NAME, COLOR_CODE, SIZE, DEBIT_MATERIAL,
					CODING_SCHEME, LAST_UPDATE, UOM_CODE, ALIAS, MP_PERCENTAGE, PURCHASE_PRICE, MRP, PARA1_SET,
					PARA2_SET, INACTIVE, SKU_CODE, DT_CREATED, USER_CODE, EDT_USER_CODE, ARTICLE_CODE, ARTICLE_NO,
					ARTICLE_NAME, ARTICLE_DESC, SUB_SECTION_CODE, PARA1_CODE,HSN_CODE )  

					SELECT DISTINCT ''0000000'', ''0000000'', ''0000000'',''0000000'',''0000000'', ISNULL(A.DISCON,0), 0,0, 0,
					A.STOCK_NA, 0, '''','''',''01'',  A.GENERATE_BARCODES_WITHARTICLE_PREFIX, 0,0,'''',0,0, 0, 0,0, 0, 0,
					'''', '''', '''', 0, 0, 0, 0, A.GEN_EAN_CODES, 0, 0,  0, 0, 0, 0, A.ORDERITEM,
					0, 0, 0,  0, '''', '''', '''', '''', 0, ISNULL(A.CODING_SCHEME,0), GETDATE(), A.UOM_CODE, 
					ISNULL(A.article_ALIAS,''''),0, 0, 0, 0, 0, 0 as INACTIVE, ISNULL(A.SKU_CODE,''''), '''',
					''0000000'', ''0000000'', A.ARTICLE_CODE, A.ARTICLE_NO, A.ARTICLE_NAME, A.ARTICLE_DESC,
					A.SUB_SECTION_CODE, ''0000000'',ISNULL(A.HSN_CODE,''0000000000'') 
					FROM '+@Temp_Table_Name+' A(NOLOCK) 
					LEFT JOIN ARTICLE B (NOLOCK) ON A.ARTICLE_CODE=B.ARTICLE_CODE
					WHERE B.ARTICLE_CODE IS NULL' 
					PRINT @CCMD 
					EXEC SP_EXECUTESQL @CCMD


	
			IF ( @CLOCTYPE=2 OR @UPD_PURINFO=0 )

			BEGIN
			SET @CSTEP=330 -- UPDATE SKU
			SET @CCMD=N' UPDATE A1 SET PARA2_CODE=A2.PARA2_CODE, LAST_UPDATE=GETDATE(), 
			PARA3_CODE=A2.PARA3_CODE,
			PARA4_CODE=A2.PARA4_CODE,PARA5_CODE=A2.PARA5_CODE,
			PARA6_CODE=A2.PARA6_CODE,FORM_ID=''0000000'',
			MRP=A2.MRP,DT_CREATED=A2.DT_CREATED,WS_PRICE=A2.WS_PRICE,IMAGE_NAME=A2.IMAGE_NAME,TAX_AMOUNT=A2.TAX_AMOUNT,
			CHALLAN_NO=A2.CHALLAN_NO,FIX_MRP=A2.FIX_MRP,PRODUCT_NAME=A2.PRODUCT_NAME,ARTICLE_CODE=A2.ARTICLE_CODE,
			PARA1_CODE=A2.PARA1_CODE,ER_FLAG=A2.ER_FLAG,UPLOADED_TO_ACTIVSTREAM=A2.UPLOADED_TO_ACTIVSTREAM,
			BARCODE_CODING_SCHEME=A2.BARCODE_CODING_SCHEME,EMP_CODE=A2.EMP_CODE,VENDOR_EAN_NO=A2.VENDOR_EAN_NO,
			ONLINE_PRODUCT_CODE=A2.ONLINE_PRODUCT_CODE,
			BASIC_PURCHASE_PRICE=A2.BASIC_PURCHASE_PRICE,HSN_CODE=A2.HSN_CODE
			FROM SKU A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PRODUCT_CODE = A2.PRODUCT_CODE' 
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD
			END



			IF ( @CLOCTYPE=1 AND @UPD_PURINFO=1)
			BEGIN
			SET @CCMD=N' UPDATE A SET AC_CODE=SKU.AC_CODE FROM '+@TEMP_TABLE_NAME+' A
			JOIN SKU (NOLOCK) ON SKU.PRODUCT_CODE=A.PRODUCT_CODE
			LEFT JOIN LM01106 B ON A.AC_CODE=B.AC_CODE 
			WHERE B.AC_CODE IS NULL '
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

			SET @CSTEP=340 -- UPDATE SKU
			SET @CCMD=N' UPDATE A1 SET PARA2_CODE=A2.PARA2_CODE, LAST_UPDATE=GETDATE(), 
			PURCHASE_PRICE=A2.PURCHASE_PRICE,PARA3_CODE=A2.PARA3_CODE,INV_DT=A2.INV_DT,INV_NO=A2.INV_NO,
			AC_CODE=A2.AC_CODE,RECEIPT_DT=A2.RECEIPT_DT,PARA4_CODE=A2.PARA4_CODE,PARA5_CODE=A2.PARA5_CODE,
			PARA6_CODE=A2.PARA6_CODE,FORM_ID=''0000000'',
			MRP=A2.MRP,DT_CREATED=A2.DT_CREATED,WS_PRICE=A2.WS_PRICE,IMAGE_NAME=A2.IMAGE_NAME,TAX_AMOUNT=A2.TAX_AMOUNT,
			CHALLAN_NO=A2.CHALLAN_NO,FIX_MRP=A2.FIX_MRP,PRODUCT_NAME=A2.PRODUCT_NAME,ARTICLE_CODE=A2.ARTICLE_CODE,
			PARA1_CODE=A2.PARA1_CODE,ER_FLAG=A2.ER_FLAG,UPLOADED_TO_ACTIVSTREAM=A2.UPLOADED_TO_ACTIVSTREAM,
			BARCODE_CODING_SCHEME=A2.BARCODE_CODING_SCHEME,EMP_CODE=A2.EMP_CODE,VENDOR_EAN_NO=A2.VENDOR_EAN_NO,
			ONLINE_PRODUCT_CODE=A2.ONLINE_PRODUCT_CODE,
			BASIC_PURCHASE_PRICE=A2.BASIC_PURCHASE_PRICE,HSN_CODE=A2.HSN_CODE
			FROM SKU A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.PRODUCT_CODE = A2.PRODUCT_CODE' 
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD
			END


			
	

			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.attr1_key_code = A2.attr1_key_code, A1.attr1_key_name = A2.attr1_key_name
			FROM ATTR1_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.attr1_key_code = A2.attr1_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR1_MST( attr1_key_code, attr1_key_name, attr1_alias, attr1_inactive)  
			SELECT DISTINCT A.attr1_key_code,A.attr1_key_name,'''',0 as attr1_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR1_MST B(NOLOCK) ON A.attr1_key_code = B.attr1_key_code 
			WHERE B.attr1_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	

			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.attr2_key_code = A2.attr2_key_code, A1.attr2_key_name = A2.attr2_key_name
			FROM attr2_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.attr2_key_code = A2.attr2_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT attr2_MST( attr2_key_code, attr2_key_name, attr2_alias, attr2_inactive)  
			SELECT DISTINCT A.attr2_key_code,A.attr2_key_name,'''' as attr2_alias,0 as attr2_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN attr2_MST B(NOLOCK) ON A.attr2_key_code = B.attr2_key_code 
			WHERE B.attr2_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.attr3_key_code = A2.attr3_key_code, A1.attr3_key_name = A2.attr3_key_name
			FROM attr3_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.attr3_key_code = A2.attr3_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT attr3_MST( attr3_key_code, attr3_key_name, attr3_alias, attr3_inactive)  
			SELECT DISTINCT A.attr3_key_code,A.attr3_key_name,'''' as attr3_alias,0 as attr3_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN attr3_MST B(NOLOCK) ON A.attr3_key_code = B.attr3_key_code 
			WHERE B.attr3_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	

			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR4_key_code = A2.ATTR4_key_code, A1.ATTR4_key_name = A2.ATTR4_key_name
			FROM ATTR4_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR4_key_code = A2.ATTR4_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR4_MST( attr4_key_code, ATTR4_key_name, ATTR4_alias, ATTR4_inactive)  
			SELECT DISTINCT A.ATTR4_key_code,A.ATTR4_key_name,'''' as ATTR4_alias,0 as ATTR4_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR4_MST B(NOLOCK) ON A.ATTR4_key_code = B.ATTR4_key_code 
			WHERE B.ATTR4_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR5_key_code = A2.ATTR5_key_code, A1.ATTR5_key_name = A2.ATTR5_key_name
			FROM ATTR5_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR5_key_code = A2.ATTR5_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR5_MST( attr5_key_code, ATTR5_key_name, ATTR5_alias, ATTR5_inactive)  
			SELECT DISTINCT A.ATTR5_key_code,A.ATTR5_key_name,'''' as ATTR5_alias,0 as ATTR5_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR5_MST B(NOLOCK) ON A.ATTR5_key_code = B.ATTR5_key_code 
			WHERE B.ATTR5_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR6_key_code = A2.ATTR6_key_code, A1.ATTR6_key_name = A2.ATTR6_key_name
			FROM ATTR6_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR6_key_code = A2.ATTR6_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR6_MST( attr6_key_code, ATTR6_key_name, ATTR6_alias, ATTR6_inactive)  
			SELECT DISTINCT A.ATTR6_key_code,A.ATTR6_key_name,'''' as ATTR6_alias,0 as ATTR6_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR6_MST B(NOLOCK) ON A.ATTR6_key_code = B.ATTR6_key_code 
			WHERE B.ATTR6_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	
			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR7_key_code = A2.ATTR7_key_code, A1.ATTR7_key_name = A2.ATTR7_key_name
			FROM ATTR7_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR7_key_code = A2.ATTR7_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR7_MST( attr7_key_code, ATTR7_key_name, ATTR7_alias, ATTR7_inactive)  
			SELECT DISTINCT A.ATTR7_key_code,A.ATTR7_key_name,'''' as ATTR7_alias,0 as ATTR7_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR7_MST B(NOLOCK) ON A.ATTR7_key_code = B.ATTR7_key_code 
			WHERE B.ATTR7_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

					
			

			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR8_key_code = A2.ATTR8_key_code, A1.ATTR8_key_name = A2.ATTR8_key_name
			FROM ATTR8_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR8_key_code = A2.ATTR8_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR8_MST( attr8_key_code, ATTR8_key_name, ATTR8_alias, ATTR8_inactive)  
			SELECT DISTINCT A.ATTR8_key_code,A.ATTR8_key_name,'''' as ATTR8_alias,0 as ATTR8_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR8_MST B(NOLOCK) ON A.ATTR8_key_code = B.ATTR8_key_code 
			WHERE B.ATTR8_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	

			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR9_key_code = A2.ATTR9_key_code, A1.ATTR9_key_name = A2.ATTR9_key_name
			FROM ATTR9_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR9_key_code = A2.ATTR9_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR9_MST( attr9_key_code, ATTR9_key_name, ATTR9_alias, ATTR9_inactive)  
			SELECT DISTINCT A.ATTR9_key_code,A.ATTR9_key_name,'''' as ATTR9_alias,0 as ATTR9_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR9_MST B(NOLOCK) ON A.ATTR9_key_code = B.ATTR9_key_code 
			WHERE B.ATTR9_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR10_key_code = A2.ATTR10_key_code, A1.ATTR10_key_name = A2.ATTR10_key_name
			FROM ATTR10_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR10_key_code = A2.ATTR10_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR10_MST( ATTR10_key_code, ATTR10_key_name, ATTR10_alias, ATTR10_inactive)  
			SELECT DISTINCT A.ATTR10_key_code,A.ATTR10_key_name,'''' as ATTR10_alias,0 as ATTR10_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR10_MST B(NOLOCK) ON A.ATTR10_key_code = B.ATTR10_key_code 
			WHERE B.ATTR10_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE PARA1
			SET @CCMD=N' UPDATE A1 SET A1.ATTR11_key_code = A2.ATTR11_key_code, A1.ATTR11_key_name = A2.ATTR11_key_name
			FROM ATTR11_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR11_key_code = A2.ATTR11_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT PARA1
			SET @CCMD=N'INSERT ATTR11_MST( ATTR11_key_code, ATTR11_key_name, ATTR11_alias, ATTR11_inactive)  
			SELECT DISTINCT A.ATTR11_key_code,A.ATTR11_key_name,'''' as ATTR11_alias,0 as ATTR11_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR11_MST B(NOLOCK) ON A.ATTR11_key_code = B.ATTR11_key_code 
			WHERE B.ATTR11_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD




			SET @CSTEP=10--UPDATE ATTR12_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR12_key_code = A2.ATTR12_key_code, A1.ATTR12_key_name = A2.ATTR12_key_name
			FROM ATTR12_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR12_key_code = A2.ATTR12_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR12_MST
			SET @CCMD=N'INSERT ATTR12_MST( ATTR12_key_code, ATTR12_key_name, ATTR12_alias, ATTR12_inactive)  
			SELECT DISTINCT A.ATTR12_key_code,A.ATTR12_key_name,'''' as ATTR12_alias,0 as ATTR12_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR12_MST B(NOLOCK) ON A.ATTR12_key_code = B.ATTR12_key_code 
			WHERE B.ATTR12_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE ATTR13_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR13_key_code = A2.ATTR13_key_code, A1.ATTR13_key_name = A2.ATTR13_key_name
			FROM ATTR13_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR13_key_code = A2.ATTR13_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR13_MST
			SET @CCMD=N'INSERT ATTR13_MST( ATTR13_key_code, ATTR13_key_name, ATTR13_alias, ATTR13_inactive)  
			SELECT DISTINCT A.ATTR13_key_code,A.ATTR13_key_name,'''' as ATTR13_alias,0 as ATTR13_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR13_MST B(NOLOCK) ON A.ATTR13_key_code = B.ATTR13_key_code 
			WHERE B.ATTR13_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE ATTR14_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR14_key_code = A2.ATTR14_key_code, A1.ATTR14_key_name = A2.ATTR14_key_name
			FROM ATTR14_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR14_key_code = A2.ATTR14_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR14_MST
			SET @CCMD=N'INSERT ATTR14_MST( ATTR14_key_code, ATTR14_key_name, ATTR14_alias, ATTR14_inactive)  
			SELECT DISTINCT A.ATTR14_key_code,A.ATTR14_key_name,'''' as ATTR14_alias,0 as ATTR14_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR14_MST B(NOLOCK) ON A.ATTR14_key_code = B.ATTR14_key_code 
			WHERE B.ATTR14_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE ATTR15_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR15_key_code = A2.ATTR15_key_code, A1.ATTR15_key_name = A2.ATTR15_key_name
			FROM ATTR15_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR15_key_code = A2.ATTR15_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR15_MST
			SET @CCMD=N'INSERT ATTR15_MST( ATTR15_key_code, ATTR15_key_name, ATTR15_alias, ATTR15_inactive)  
			SELECT DISTINCT A.ATTR15_key_code,A.ATTR15_key_name,'''' as ATTR15_alias,0 as ATTR15_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR15_MST B(NOLOCK) ON A.ATTR15_key_code = B.ATTR15_key_code 
			WHERE B.ATTR15_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD





			SET @CSTEP=10--UPDATE ATTR16_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR16_key_code = A2.ATTR16_key_code, A1.ATTR16_key_name = A2.ATTR16_key_name
			FROM ATTR16_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR16_key_code = A2.ATTR16_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR16_MST
			SET @CCMD=N'INSERT ATTR16_MST( ATTR16_key_code, ATTR16_key_name, ATTR16_alias, ATTR16_inactive)  
			SELECT DISTINCT A.ATTR16_key_code,A.ATTR16_key_name,'''' as ATTR16_alias,0 as ATTR16_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR16_MST B(NOLOCK) ON A.ATTR16_key_code = B.ATTR16_key_code 
			WHERE B.ATTR16_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=10--UPDATE ATTR17_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR17_key_code = A2.ATTR17_key_code, A1.ATTR17_key_name = A2.ATTR17_key_name
			FROM ATTR17_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR17_key_code = A2.ATTR17_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR17_MST
			SET @CCMD=N'INSERT ATTR17_MST( ATTR17_key_code, ATTR17_key_name, ATTR17_alias, ATTR17_inactive)  
			SELECT DISTINCT A.ATTR17_key_code,A.ATTR17_key_name,'''' as ATTR17_alias,0 as ATTR17_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR17_MST B(NOLOCK) ON A.ATTR17_key_code = B.ATTR17_key_code 
			WHERE B.ATTR17_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

					
		

			SET @CSTEP=10--UPDATE ATTR18_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR18_key_code = A2.ATTR18_key_code, A1.ATTR18_key_name = A2.ATTR18_key_name
			FROM ATTR18_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR18_key_code = A2.ATTR18_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR18_MST
			SET @CCMD=N'INSERT ATTR18_MST( ATTR18_key_code, ATTR18_key_name, ATTR18_alias, ATTR18_inactive)  
			SELECT DISTINCT A.ATTR18_key_code,A.ATTR18_key_name,'''' as ATTR18_alias,0 as ATTR18_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR18_MST B(NOLOCK) ON A.ATTR18_key_code = B.ATTR18_key_code 
			WHERE B.ATTR18_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

				

			SET @CSTEP=10--UPDATE ATTR19_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR19_key_code = A2.ATTR19_key_code, A1.ATTR19_key_name = A2.ATTR19_key_name
			FROM ATTR19_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR19_key_code = A2.ATTR19_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR19_MST
			SET @CCMD=N'INSERT ATTR19_MST( ATTR19_key_code, ATTR19_key_name, ATTR19_alias, ATTR19_inactive)  
			SELECT DISTINCT A.ATTR19_key_code,A.ATTR19_key_name,'''' as ATTR19_alias,0 as ATTR19_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR19_MST B(NOLOCK) ON A.ATTR19_key_code = B.ATTR19_key_code 
			WHERE B.ATTR19_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	
			SET @CSTEP=10--UPDATE ATTR20_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR20_key_code = A2.ATTR20_key_code, A1.ATTR20_key_name = A2.ATTR20_key_name
			FROM ATTR20_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR20_key_code = A2.ATTR20_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR20_MST
			SET @CCMD=N'INSERT ATTR20_MST( ATTR20_key_code, ATTR20_key_name, ATTR20_alias, ATTR20_inactive)  
			SELECT DISTINCT A.ATTR20_key_code,A.ATTR20_key_name,'''' as ATTR20_alias,0 as ATTR20_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR20_MST B(NOLOCK) ON A.ATTR20_key_code = B.ATTR20_key_code 
			WHERE B.ATTR20_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE ATTR21_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR21_key_code = A2.ATTR21_key_code, A1.ATTR21_key_name = A2.ATTR21_key_name
			FROM ATTR21_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR21_key_code = A2.ATTR21_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR21_MST
			SET @CCMD=N'INSERT ATTR21_MST( ATTR21_key_code, ATTR21_key_name, ATTR21_alias, ATTR21_inactive)  
			SELECT DISTINCT A.ATTR21_key_code,A.ATTR21_key_name,'''' as ATTR21_alias,0 as ATTR21_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR21_MST B(NOLOCK) ON A.ATTR21_key_code = B.ATTR21_key_code 
			WHERE B.ATTR21_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD



			SET @CSTEP=10--UPDATE ATTR22_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR22_key_code = A2.ATTR22_key_code, A1.ATTR22_key_name = A2.ATTR22_key_name
			FROM ATTR22_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR22_key_code = A2.ATTR22_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR22_MST
			SET @CCMD=N'INSERT ATTR22_MST( ATTR22_key_code, ATTR22_key_name, ATTR22_alias, ATTR22_inactive)  
			SELECT DISTINCT A.ATTR22_key_code,A.ATTR22_key_name,'''' as ATTR22_alias,0 as ATTR22_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR22_MST B(NOLOCK) ON A.ATTR22_key_code = B.ATTR22_key_code 
			WHERE B.ATTR22_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	


			SET @CSTEP=10--UPDATE ATTR23_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR23_key_code = A2.ATTR23_key_code, A1.ATTR23_key_name = A2.ATTR23_key_name
			FROM ATTR23_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR23_key_code = A2.ATTR23_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR23_MST
			SET @CCMD=N'INSERT ATTR23_MST( ATTR23_key_code, ATTR23_key_name, ATTR23_alias, ATTR23_inactive)  
			SELECT DISTINCT A.ATTR23_key_code,A.ATTR23_key_name,'''' as ATTR23_alias,0 as ATTR23_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR23_MST B(NOLOCK) ON A.ATTR23_key_code = B.ATTR23_key_code 
			WHERE B.ATTR23_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=10--UPDATE ATTR24_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR24_key_code = A2.ATTR24_key_code, A1.ATTR24_key_name = A2.ATTR24_key_name
			FROM ATTR24_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR24_key_code = A2.ATTR24_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR24_MST
			SET @CCMD=N'INSERT ATTR24_MST( ATTR24_key_code, ATTR24_key_name, ATTR24_alias, ATTR24_inactive)  
			SELECT DISTINCT A.ATTR24_key_code,A.ATTR24_key_name,'''' as ATTR24_alias,0 as ATTR24_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR24_MST B(NOLOCK) ON A.ATTR24_key_code = B.ATTR24_key_code 
			WHERE B.ATTR24_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD





			SET @CSTEP=10--UPDATE ATTR25_MST
			SET @CCMD=N' UPDATE A1 SET A1.ATTR25_key_code = A2.ATTR25_key_code, A1.ATTR25_key_name = A2.ATTR25_key_name
			FROM ATTR25_MST A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.ATTR25_key_code = A2.ATTR25_key_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ATTR25_MST
			SET @CCMD=N'INSERT ATTR25_MST( ATTR25_key_code, ATTR25_key_name, ATTR25_alias, ATTR25_inactive)  
			SELECT DISTINCT A.ATTR25_key_code,A.ATTR25_key_name,'''' as ATTR25_alias,0 as ATTR25_inactive
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ATTR25_MST B(NOLOCK) ON A.ATTR25_key_code = B.ATTR25_key_code 
			WHERE B.ATTR25_key_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	
			SET @CSTEP=10--UPDATE SD_ATTR_AVATAR
			SET @CCMD=N' UPDATE A1 SET A1.SUB_SECTION_CODE = A2.SUB_SECTION_CODE, A1.ATTR1_MST = A2.ATTR1_MST,A1.ATTR2_MST = A2.ATTR2_MST,A1.ATTR3_MST = A2.ATTR3_MST
			,A1.ATTR4_MST = A2.ATTR4_MST, A1.ATTR5_MST = A2.ATTR5_MST,A1.ATTR6_MST = A2.ATTR6_MST,A1.ATTR7_MST = A2.ATTR7_MST
			,A1.ATTR8_MST = A2.ATTR8_MST, A1.ATTR9_MST = A2.ATTR9_MST,A1.ATTR10_MST = A2.ATTR10_MST,A1.ATTR11_MST = A2.ATTR11_MST
			,A1.ATTR12_MST = A2.ATTR12_MST, A1.ATTR13_MST = A2.ATTR13_MST,A1.ATTR14_MST = A2.ATTR14_MST,A1.ATTR15_MST = A2.ATTR15_MST
			,A1.ATTR16_MST = A2.ATTR16_MST, A1.ATTR17_MST = A2.ATTR17_MST,A1.ATTR18_MST = A2.ATTR18_MST,A1.ATTR19_MST = A2.ATTR19_MST
			,A1.ATTR20_MST = A2.ATTR20_MST, A1.ATTR21_MST = A2.ATTR21_MST,A1.ATTR22_MST = A2.ATTR22_MST,A1.ATTR23_MST = A2.ATTR23_MST
			,A1.ATTR24_MST = A2.ATTR24_MST, A1.ATTR25_MST = A2.ATTR25_MST
			FROM SD_ATTR_AVATAR A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.SUB_SECTION_CODE = A2.SUB_SECTION_CODE'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT SD_ATTR_AVATAR
			SET @CCMD=N'INSERT SD_ATTR_AVATAR( SUB_SECTION_CODE,ATTR1_MST,ATTR2_MST,ATTR3_MST,ATTR4_MST,ATTR5_MST,ATTR6_MST
            ,ATTR7_MST,ATTR8_MST,ATTR9_MST,ATTR10_MST,ATTR11_MST,ATTR12_MST,ATTR13_MST,ATTR14_MST,ATTR15_MST,ATTR16_MST,ATTR17_MST,ATTR18_MST
            ,ATTR19_MST,ATTR20_MST,ATTR21_MST,ATTR22_MST,ATTR23_MST,ATTR24_MST,ATTR25_MST)  
			SELECT DISTINCT A.SUB_SECTION_CODE,A.ATTR1_MST,A.ATTR2_MST,A.ATTR3_MST,A.ATTR4_MST,A.ATTR5_MST,A.ATTR6_MST
            ,A.ATTR7_MST,A.ATTR8_MST,A.ATTR9_MST,A.ATTR10_MST,A.ATTR11_MST,A.ATTR12_MST,A.ATTR13_MST,A.ATTR14_MST,A.ATTR15_MST,A.ATTR16_MST,A.ATTR17_MST,A.ATTR18_MST
            ,A.ATTR19_MST,A.ATTR20_MST,A.ATTR21_MST,A.ATTR22_MST,A.ATTR23_MST,A.ATTR24_MST,A.ATTR25_MST
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN SD_ATTR_AVATAR B(NOLOCK) ON A.SUB_SECTION_CODE = B.SUB_SECTION_CODE 
			WHERE B.SUB_SECTION_CODE IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

	
			SET @CSTEP=10--UPDATE ARTICLE_FIX_ATTR
			SET @CCMD=N' UPDATE A1 SET A1.article_code = A2.article_code, A1.attr1_key_code = A2.attr1_key_code,A1.attr2_key_code = A2.attr2_key_code,A1.attr3_key_code = A2.attr3_key_code
			,A1.attr4_key_code = A2.attr4_key_code, A1.attr5_key_code = A2.attr5_key_code,A1.attr6_key_code = A2.attr6_key_code,A1.attr7_key_code = A2.attr7_key_code
			,A1.attr8_key_code = A2.attr8_key_code, A1.attr9_key_code = A2.attr9_key_code,A1.attr10_key_code = A2.attr10_key_code,A1.attr11_key_code = A2.attr11_key_code
			,A1.attr12_key_code = A2.attr12_key_code, A1.attr13_key_code = A2.attr13_key_code,A1.attr14_key_code = A2.attr14_key_code,A1.attr15_key_code = A2.attr15_key_code
			,A1.attr16_key_code = A2.attr16_key_code, A1.attr17_key_code = A2.attr17_key_code,A1.attr18_key_code = A2.attr18_key_code,A1.attr19_key_code = A2.attr19_key_code
			,A1.attr20_key_code = A2.attr20_key_code, A1.attr21_key_code = A2.attr21_key_code,A1.attr22_key_code = A2.attr22_key_code,A1.attr23_key_code = A2.attr23_key_code
			,A1.attr24_key_code = A2.attr24_key_code, A1.attr25_key_code = A2.attr25_key_code
			FROM ARTICLE_FIX_ATTR A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.article_code = A2.article_code'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD


			SET @CSTEP=20 --INSERT ARTICLE_FIX_ATTR
			SET @CCMD=N'INSERT ARTICLE_FIX_ATTR( article_code,attr1_key_code,attr2_key_code,attr3_key_code,attr4_key_code,attr5_key_code,attr6_key_code
            ,attr7_key_code,attr8_key_code,attr9_key_code,attr10_key_code,attr11_key_code,attr12_key_code,attr13_key_code,attr14_key_code,attr15_key_code,attr16_key_code,attr17_key_code,attr18_key_code
            ,attr19_key_code,attr20_key_code,attr21_key_code,attr22_key_code,attr23_key_code,attr24_key_code,attr25_key_code)  
			SELECT DISTINCT A.article_code,A.attr1_key_code,A.attr2_key_code,A.attr3_key_code,A.attr4_key_code,A.attr5_key_code,A.attr6_key_code
            ,A.attr7_key_code,A.attr8_key_code,A.attr9_key_code,A.attr10_key_code,A.attr11_key_code,A.attr12_key_code,A.attr13_key_code,A.attr14_key_code,A.attr15_key_code,A.attr16_key_code,A.attr17_key_code,A.attr18_key_code
            ,A.attr19_key_code,A.attr20_key_code,A.attr21_key_code,A.attr22_key_code,A.attr23_key_code,A.attr24_key_code,A.attr25_key_code
			FROM  '+@Temp_Table_Name+' A(NOLOCK) 
			LEFT JOIN ARTICLE_FIX_ATTR B(NOLOCK) ON A.article_code = B.article_code 
			WHERE B.article_code IS NULL'
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD

							
	--IF @Table_Name='ART_DET'
 --    BEGIN

	--		SET @CSTEP=10--UPDATE ARTICLE_FIX_ATTR
	--		SET @CCMD=N' UPDATE A1 SET A1.article_code = A2.article_code, A1.para2_code = A2.para2_code,A1.mrp = A2.mrp,A1.WS_PRICE = A2.WS_PRICE
	--		,A1.company_code = A2.company_code, A1.mrp_inc_amt = A2.mrp_inc_amt,A1.mrp2 = A2.mrp2,A1.para1_code = A2.para1_code
	--		,A1.para2_ratio = A2.para2_ratio, A1.purchase_price = A2.purchase_price,A1.center_point = A2.center_point,A1.sizegroup_code = A2.sizegroup_code
	--		FROM ART_DET A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.article_code = A2.article_code'
	--		PRINT @CCMD 
	--		EXEC SP_EXECUTESQL @CCMD


	--		SET @CSTEP=20 --INSERT ARTICLE_FIX_ATTR
	--		SET @CCMD=N'INSERT ART_DET( article_code,para2_code,mrp,WS_PRICE,company_code,mrp_inc_amt,mrp2,para1_code,para2_ratio,purchase_price,center_point,sizegroup_code)  
	--		SELECT DISTINCT A.article_code,A.para2_code,A.mrp,A.WS_PRICE,A.company_code,A.mrp_inc_amt,A.mrp2,A.para1_code,A.para2_ratio,A.purchase_price,A.center_point,A.sizegroup_code
	--		FROM  '+@Temp_Table_Name+' A(NOLOCK) 
	--		LEFT JOIN ART_DET B(NOLOCK) ON A.article_code = B.article_code 
	--		WHERE B.article_code IS NULL'
	--		PRINT @CCMD 
	--		EXEC SP_EXECUTESQL @CCMD

	-- END							
										
	--	IF @Table_Name='ART_BOM'
 --    BEGIN

	--		SET @CSTEP=10--UPDATE ARTICLE_FIX_ATTR
	--		SET @CCMD=N' UPDATE A1 SET A1.article_code = A2.article_code, A1.bom_article_code = A2.bom_article_code,A1.avg_qty = A2.avg_qty,A1.company_code = A2.company_code
	--		,A1.rate = A2.rate, A1.bom_para1_code = A2.bom_para1_code,A1.uses = A2.uses,A1.bom_para2_code = A2.bom_para2_code
	--		,A1.ADD_AVG_QTY = A2.ADD_AVG_QTY, A1.JOB_CODE = A2.JOB_CODE,A1.TOL_PER = A2.TOL_PER
	--		FROM ART_BOM A1 WITH (ROWLOCK) JOIN '+@Temp_Table_Name+' A2 (NOLOCK) ON A1.article_code = A2.article_code'
	--		PRINT @CCMD 
	--		EXEC SP_EXECUTESQL @CCMD


	--		SET @CSTEP=20 --INSERT ARTICLE_FIX_ATTR
	--		SET @CCMD=N'INSERT ART_BOM( article_code,bom_article_code,avg_qty,row_id,last_update,company_code
	--		            ,rate,bom_para1_code,uses,bom_para2_code,ADD_AVG_QTY,JOB_CODE,TOL_PER)  
	--		SELECT DISTINCT A.article_code,A.bom_article_code,A.avg_qty,A.ROWID,A.company_code,A.rate,A.bom_para1_code,A.uses
	--		,A.bom_para2_code,A.ADD_AVG_QTY,A.JOB_CODE,A.TOL_PER
	--		FROM  '+@Temp_Table_Name+' A(NOLOCK) 
	--		LEFT JOIN ART_BOM B(NOLOCK) ON A.article_code = B.article_code 
	--		WHERE B.article_code IS NULL'
	--		PRINT @CCMD 
	--		EXEC SP_EXECUTESQL @CCMD

	-- END							
						
	--		END
	--		FETCH NEXT FROM XYZ INTO @Table_Name,@Temp_Table_Name
	--	END	
	--	CLOSE XYZ
	--	DEALLOCATE XYZ
END TRY
BEGIN CATCH
	SET @CERRMSG='P: SP3S_UPDATE_MASTERS_SKU, STEP: '+CAST(@CSTEP AS VARCHAR(5))+', MESSAGE: ' + ERROR_MESSAGE()
END CATCH

IF  ISNULL(@CERRMSG,'')<>''
BEGIN
	SELECT @Temp_Table_Name=Temp_Table_Name FROM @dtTable WHERE Table_Name='SKU'
 
		SET @CCMD=N'
		IF OBJECT_ID('''+@Temp_Table_Name+''',''U'') IS NOT NULL
		BEGIN
		 DELETE A
		 FROM MASTERDATA A 
		 JOIN '+ @Temp_Table_Name+' B ON B.PRODUCT_CODE=A.code
		END'
	PRINT @CCMD
	EXEC SP_EXECUTESQL @CCMD
	SELECT ISNULL(@CERRMSG,'') AS ERRMSG
END
ELSE 
BEGIN

	SET @CCMD=N'INSERT INTO MASTERDATA 
				SELECT DISTINCT PRODUCT_CODE FROM TEMP_SKU_'+@DEPT_ID+'_DETAIL   A  (NOLOCK)
				LEFT JOIN MASTERDATA B (NOLOCK) ON A.PRODUCT_CODE=B.CODE
				WHERE B.CODE IS NULL'
	PRINT @CCMD
	EXEC SP_EXECUTESQL @CCMD

	SELECT '' AS ERRMSG

END
END