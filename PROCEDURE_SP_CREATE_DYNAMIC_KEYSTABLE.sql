
-- PROCEDURE TO CREATE KEYS TABLE DYNAMICALLY

CREATE PROCEDURE SP_CREATE_DYNAMIC_KEYSTABLE
@CTABLENAMEPREFIX VARCHAR(20),
@CTABLENAMESUFFIX VARCHAR(10)
--WITH ENCRYPTION
AS
BEGIN
	DECLARE @CCMD NVARCHAR(MAX),@CKEYSTABLE VARCHAR(50)
	
	SET @CKEYSTABLE=@CTABLENAMEPREFIX+'_'+@CTABLENAMESUFFIX
	
	SET @CCMD=N'IF OBJECT_ID('''+@CKEYSTABLE+''',''U'') IS  NULL
					SELECT * INTO ['+@CKEYSTABLE+'] FROM KEYS WHERE 1=2'
	
	EXEC SP_EXECUTESQL @CCMD				
		
END

