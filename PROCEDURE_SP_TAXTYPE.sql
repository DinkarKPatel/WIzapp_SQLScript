CREATE PROCEDURE SP_TAXTYPE
(
	 @NQUERYID NUMERIC(5)
	,@CVALUE VARCHAR(MAX)=''
)
--WITH ENCRYPTION
AS
BEGIN
	IF @NQUERYID=1
		GOTO LBL_PURCHASE
	ELSE IF @NQUERYID=2 
		GOTO LBL_SALE	
   ELSE IF @NQUERYID=3
		GOTO LBL_TAX	
 ELSE IF @NQUERYID=4
		GOTO LBL_TEX	
	
	ELSE GOTO END_PROC	
		
	DECLARE @CHEADCODE VARCHAR(4000)
LBL_PURCHASE:		
		
		SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000029') 
		SELECT AC_CODE, AC_NAME,
		REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  
		AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
		FROM LMV01106 (NOLOCK) 
		WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0  AND ISNULL(INACTIVE,0)=0 AND AC_NAME LIKE @CVALUE
			
GOTO END_PROC

LBL_SALE:
		 
		SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000030') 
		SELECT AC_CODE, AC_NAME,
		REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  
		AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
		FROM LMV01106 (NOLOCK) 
		WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0  AND ISNULL(INACTIVE,0)=0 AND AC_NAME LIKE @CVALUE

GOTO END_PROC

LBL_TAX:

	SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000019') 
	SELECT AC_CODE, AC_NAME,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC_NAME,'.',''),'@',''),' ',''),'_',''),'(',''),')',''),'-','')  
	AS PARSE_AC_NAME,AC_NAME AS REPL_AC_NAME 
	FROM LMV01106 (NOLOCK) 
	WHERE CHARINDEX(HEAD_CODE,@CHEADCODE)>0  AND ISNULL(INACTIVE,0)=0 AND AC_NAME LIKE @CVALUE

GOTO END_PROC

LBL_TEX:

 SELECT  AC_CODE, AC_NAME ,HEAD_CODE 
 FROM LM01106 (NOLOCK)   
 WHERE CHARINDEX(HEAD_CODE,'0000000019,0000000029,0000000030')>0 AND INACTIVE=0 AND AC_NAME LIKE @CVALUE
 
 
GOTO END_PROC
END_PROC:	
END
--END OF PROCEDURE - SP_TAXTYPE
