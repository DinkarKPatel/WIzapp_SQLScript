CREATE PROCEDURE SP_SEND_MIRROR_MSTSTKCNT --(LocId 3 digit change by Sanjay:30-10-2024)
@cTargetLocId VARCHAR(4),
@nMode NUMERIC(1,0)
AS
BEGIN
	IF @nMode=3
	BEGIN
		UPDATE STOCK_COUNT_SETUP_LINK_LOC SET sent_to_loc=1 WHERE dept_id=@cTargetLocId

		GOTO END_PROC
	END

	SELECT distinct 'MSTSTKCNT_STOCK_COUNT_SETUP_mst_MIRROR' AS TARGET_TABLENAME,a.*,1 as pick_from_current_db FROM STOCK_COUNT_SETUP_mst a JOIN STOCK_COUNT_SETUP_LINK_LOC b ON a.STK_COUNT_SETUP_ID=b.STK_COUNT_SETUP_ID
	WHERE dept_id=@cTargetLocId

	SELECT 'MSTSTKCNT_STOCK_COUNT_SETUP_LINK_LOC_MIRROR' AS TARGET_TABLENAME,a.*,1 as pick_from_current_db FROM  STOCK_COUNT_SETUP_LINK_LOC a WHERE 
	dept_id=@cTargetLocId

	SELECT DISTINCT 'MSTSTKCNT_STOCK_COUNT_SETUP_COL_LIST_MIRROR' AS TARGET_TABLENAME,a.*,1 as pick_from_current_db FROM  STOCK_COUNT_SETUP_COL_LIST a 
	JOIN STOCK_COUNT_SETUP_LINK_LOC b ON a.STK_COUNT_SETUP_ID=b.STK_COUNT_SETUP_ID
	WHERE dept_id=@cTargetLocId 

END_PROC:

	select '' as errmsg
END