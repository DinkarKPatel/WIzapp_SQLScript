CREATE PROCEDURE SP_RCM_FILTER  
(  
  @FRMDT DATETIME
 ,@TODT DATETIME
 ,@AC_CODE VARCHAR(10)=''--IF BLANK THEN ALL ELSE APPLY FILTER
 ,@CANCEL NUMERIC(1)=2--2 THEN ALL ELSE APPLY FILTER
)  
AS  
BEGIN
   SELECT MEMO_NO,MEMO_DT,LM.AC_NAME,A.MEMO_ID AS ID,
   (CASE WHEN A.CANCELLED = 1 THEN 'CANCELLED' ELSE '' END) AS CANCELLED
   FROM RCM01106 A (NOLOCK) 
   JOIN LM01106 LM ON A.AC_CODE=LM.AC_CODE 
   WHERE MEMO_DT BETWEEN @FRMDT AND @TODT  
   AND (ISNULL(@AC_CODE,'')='' OR A.AC_CODE=@AC_CODE)  
   AND (ISNULL(@CANCEL,0)=2 OR A.CANCELLED=@CANCEL)  
END
