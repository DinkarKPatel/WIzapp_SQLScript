CREATE PROC SP3S_GETDATATOAPPEND  
(  
 @CFROMDT VARCHAR(10),  
 @CTODT VARCHAR(10),
 @cDEPT_ID	VARCHAR(5)=''  
 )  
AS  
BEGIN      
 SELECT DISTINCT A.CM_ID,A.CM_NO,A.CM_DT,A.NET_AMOUNT 
 FROM CMM01106	A		(NOLOCK)    
 JOIN CUSTDYM	B		(NOLOCK) ON A.CUSTOMER_CODE=B.CUSTOMER_CODE     
 JOIN PAYMODE_XN_DET C(NOLOCK) ON C.MEMO_ID=A.CM_ID AND XN_TYPE='SLS'    
 JOIN PAYMODE_MST D(NOLOCK) ON C.PAYMODE_CODE=D.PAYMODE_CODE    
 WHERE A.CANCELLED=0 
 AND A.location_Code =@cDEPT_ID
 AND CM_DT BETWEEN @CFROMDT  AND @CTODT      
 AND ( ISNULL(A.CUSTOMER_CODE,'000000000000')='000000000000' OR     
     (ISNULL(A.CUSTOMER_CODE,'000000000000')<>'000000000000' AND     
      ISNULL(B.CARD_NO,'')='')) AND D.PAYMODE_GRP_CODE IN ('0000001','0000002')   
AND ISNULL(A.Party_Gst_No,'')=''	  
AND ISNULL(B.cus_gst_no,'')=''
 ORDER BY A.CM_ID
END
