-- GET ALL SIZE LIST RELATED TO A ARTICLE
CREATE PROCEDURE SP_WL_ARTICLEPARA2LIST 
(
@ARTICLE_CODE VARCHAR(9)
)
--WITH ENCRYPTION
AS

		DECLARE @CMD NVARCHAR(MAX)
		DECLARE @PARA NUMERIC(10,2)

		SELECT @PARA = COUNT(A.PARA2_CODE)
		FROM PARA2 A  
		JOIN ART_DET (NOLOCK) B ON A.PARA2_CODE = B.PARA2_CODE  
		WHERE B.ARTICLE_CODE = @ARTICLE_CODE  

		IF @PARA > 0
		BEGIN
			SET @CMD = N'SELECT A.PARA2_CODE, A.PARA2_NAME, A.PARA2_ORDER  ,
			B.PURCHASE_PRICE,B.WS_PRICE,B.MRP,B.MRP AS MRP1,B.CENTER_POINT   ,B.PURCHASE_PRICE AS GROSS_PURCHASE_PRICE
			FROM PARA2 A  
			JOIN ART_DET (NOLOCK) B ON A.PARA2_CODE = B.PARA2_CODE  
			WHERE B.ARTICLE_CODE = '''+@ARTICLE_CODE+''' ORDER BY A.PARA2_ORDER '  
		END
		ELSE
		BEGIN
			SET @CMD = N'SELECT A.PARA2_CODE, A.PARA2_NAME, A.PARA2_ORDER,  
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  PURCHASE_PRICE,
			ISNULL((SELECT WHOLESALE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS WS_PRICE,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP1 
			,CONVERT(BIT,0) AS CENTER_POINT  ,
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  GROSS_PURCHASE_PRICE
			FROM PARA2 A  
			WHERE A.PARA2_CODE = ''0000000'' 
			ORDER BY A.PARA2_ORDER '
		END
		PRINT @CMD
		EXEC SP_EXECUTESQL @CMD
--************************* END OF PROCEDURE SP_WL_ARTICLEPARA2LIST
