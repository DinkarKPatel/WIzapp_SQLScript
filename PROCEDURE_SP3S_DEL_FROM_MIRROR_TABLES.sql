create PROCEDURE SP3S_DEL_FROM_MIRROR_TABLES
(
@CMEMOID VARCHAR(MAX),
@CXN_TYPE VARCHAR(10)
)
AS
BEGIN

					DECLARE @NSTEP INT,@CERRMSG NVARCHAR(MAX),@VERSION INT
					
BEGIN TRANSACTION
	
	BEGIN TRY
	SET @VERSION=0
			IF ISNULL(@CMEMOID,'')=''
				BEGIN
					SET @CERRMSG='MEMO ID CAN''T BE BLANK' 
					GOTO END_PROC
				END
			IF ISNULL(@CXN_TYPE,'')=''
				BEGIN
					SET @CERRMSG='XN TYPE CAN''T BE BLANK' 
					GOTO END_PROC
				END

SET @NSTEP=10
 IF @CXN_TYPE='SLS'
 BEGIN
 
		DELETE FROM SLS_APM01106_REF_MIRROR WHERE MEMO_ID=@CMEMOID
		DELETE B FROM SLS_CMD01106_MIRROR A JOIN
		SLS_CMD_MANUALBILL_ERRORS_MIRROR  B ON A.ROW_ID=B.CMD_ROW_ID WHERE CM_ID=@CMEMOID
		DELETE B FROM SLS_CMD01106_MIRROR A JOIN
		SLS_CMD_SCHEME_DET_MIRROR  B ON A.ROW_ID=B.CMD_ROW_ID WHERE CM_ID=@CMEMOID
		DELETE FROM SLS_CMD01106_MIRROR WHERE CM_ID=@CMEMOID
		DELETE FROM SLS_CMM_FLIGHT_MIRROR WHERE CM_ID=@CMEMOID
		DELETE FROM SLS_CMM01106_MIRROR WHERE CM_ID=@CMEMOID
		DELETE FROM SLS_COUPON_REDEMPTION_INFO_MIRROR WHERE CM_ID=@CMEMOID
		DELETE FROM SLS_CUSTDYM_MIRROR WHERE SLS_MEMO_ID=@CMEMOID
		DELETE FROM SLS_DAILOGFILE_MIRROR WHERE MEMONO=@CMEMOID
		DELETE FROM SLS_GV_MST_REDEMPTION_MIRROR WHERE REDEMPTION_CM_ID=@CMEMOID
		DELETE FROM SLS_IMAGE_XN_DET_MIRROR WHERE MEMO_ID=@CMEMOID AND XN_TYPE='SLS'
		--DELETE FROM SLS_PACK_SLIP_R_MIRROR WHERE CM_ID=@CMEMOID 
		DELETE FROM SLS_PAYMODE_XN_DET_MIRROR WHERE MEMO_ID=@CMEMOID AND XN_TYPE='SLS'
		DELETE B FROM SLS_CMD01106_MIRROR A JOIN
		SLS_SKU_MIRROR  B ON A.PRODUCT_CODE=B.PRODUCT_CODE WHERE CM_ID=@CMEMOID

		DELETE A FROM SLS_CMD_CONS_MIRROR A WHERE CM_ID=@CMEMOID
				
		SET @VERSION=1
		      
 END
 
 SET @NSTEP=20
 IF @CXN_TYPE='WSL'
 BEGIN
 
        
			DELETE FROM WSL_ANGM_MIRROR WHERE WSL_MEMO_ID=@CMEMOID
			DELETE FROM WSL_IND01106_MIRROR WHERE INV_ID=@CMEMOID
			DELETE FROM WSL_INM01106_MIRROR WHERE INV_ID=@CMEMOID
			DELETE FROM WSL_paymode_xn_det_MIRROR WHERE memo_id=@CMEMOID
			DELETE A FROM WSL_PARCEL_DET_MIRROR A JOIN  WSL_PARCEL_MST_MIRROR B ON A.PARCEL_MEMO_ID=B.PARCEL_MEMO_ID
			 WHERE A.WSL_MEMO_ID=@CMEMOID AND XN_TYPE='WSL' 
			DELETE FROM WSL_PARCEL_MST_MIRROR WHERE WSL_MEMO_ID=@CMEMOID AND XN_TYPE='WSL'
			SET @VERSION=1

		      
 END
 
  SET @NSTEP=30
 IF @CXN_TYPE='PRT'
 BEGIN
 
        
			DELETE FROM PRT_ANGM_MIRROR WHERE PRT_MEMO_ID=@CMEMOID
			DELETE FROM PRT_RMD01106_MIRROR WHERE RM_ID=@CMEMOID
			DELETE FROM PRT_RMM01106_MIRROR WHERE RM_ID=@CMEMOID
			DELETE A FROM PRT_PARCEL_DET_MIRROR A JOIN  PRT_PARCEL_MST_MIRROR B ON A.PARCEL_MEMO_ID=B.PARCEL_MEMO_ID
			WHERE A.PRT_MEMO_ID=@CMEMOID AND XN_TYPE='PRT' 
			DELETE FROM PRT_PARCEL_MST_MIRROR WHERE PRT_MEMO_ID=@CMEMOID AND XN_TYPE='PRT'
			SET @VERSION=1


		      
 END
 
SET @NSTEP=40
IF @CXN_TYPE='PUR'
 BEGIN
 
        
			DELETE FROM PUR_ART_ATTR_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ARTICLE_FIX_ATTR_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ARTICLE_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR_KEY_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR1_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR10_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR11_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR12_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR13_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR14_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR15_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR16_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR17_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR18_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR19_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR2_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR20_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR21_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR22_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR23_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR24_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR25_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR3_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR4_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR5_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR6_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR7_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR8_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTR9_MST_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_ATTRM_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_BOXD_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_BOXM_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_DAILOGFILE_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_LOC_WISE_PURHISTORY_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA1_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA2_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA3_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA4_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA5_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PARA6_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PID01106_MIRROR WHERE MRR_ID=@CMEMOID
			DELETE FROM PUR_PIM01106_MIRROR WHERE MRR_ID=@CMEMOID
			DELETE FROM PUR_PPC_PID01106_BARCODE_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PPC_PID01106_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PPC_PIM01106_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_PPC_PO_PUR_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_SD_ATTR_AVATAR_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_SECTIOND_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_SECTIONM_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_SKU_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			DELETE FROM PUR_SKU_OH_MIRROR WHERE PUR_MEMO_ID=@CMEMOID
			SET @VERSION=1


		      
 END

 
  SET @NSTEP=50
 IF @CXN_TYPE='DOCWSL'
 BEGIN
 
        
			DELETE FROM DOCWSL_SD_ATTR_AVATAR_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_UOM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_BOXM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_BOXD_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ANGM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_AREA_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ART_ATTR_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ARTICLE_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR_KEY_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTRM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_CITY_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ARTICLE_FIX_ATTR_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR1_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_FORM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR2_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR3_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_HD01106_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR4_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR5_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_HSN_DET_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR6_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR7_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_HSN_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR8_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR9_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_IND01106_MIRROR WHERE INV_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR10_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR11_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_INM01106_MIRROR WHERE INV_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR12_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR13_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR14_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_LM01106_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR15_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR16_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_LMP01106_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR17_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR18_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_LOCSST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR19_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_LOCSST_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR20_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR21_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR22_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_LOCSSTADD_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR23_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR24_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA1_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_ATTR25_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA2_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA3_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA4_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA5_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA6_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARA7_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID

			DELETE A FROM DOCWSL_PARCEL_DET_MIRROR A WHERE A.DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_PARCEL_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID AND XN_TYPE='WSL'DELETE FROM DOCWSL_REGIONM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SCHEME_SETUP_DET_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SCHEME_SETUP_MST_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SCHEME_SETUP_SLSBC_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SECTIOND_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SECTIONM_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SKU_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_SKU_OH_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID
			DELETE FROM DOCWSL_STATE_MIRROR WHERE DOCWSL_MEMO_ID=@CMEMOID

			DELETE FROM DOCWSL_art_det_mirror WITH (ROWLOCK) where DOCWSL_MEMO_ID=@CMEMOID
            DELETE FROM DOCWSL_art_para1_mirror WITH (ROWLOCK) where DOCWSL_MEMO_ID=@CMEMOID

			SET @VERSION=1
		      
 END
 
 
  SET @NSTEP=60
 IF @CXN_TYPE='DOCPRT'
 BEGIN
 
        
			DELETE FROM DOCPRT_ANGM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_AREA_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_ART_ATTR_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_ARTICLE_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_ATTR_KEY_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_ATTRM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_BOXD_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_BOXM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_CITY_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_FORM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_HD01106_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_HSN_DET_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_HSN_MST_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_LM01106_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_LMP01106_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_LOCSST_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_LOCSST_MST_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_LOCSSTADD_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA1_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA2_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA3_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA4_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA5_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_PARA6_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE A FROM DOCPRT_PARCEL_DET_MIRROR A WHERE A.DOCPRT_MEMO_ID=@CMEMOID 
			DELETE FROM DOCPRT_PARCEL_MST_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID AND XN_TYPE='PRT'
			DELETE FROM DOCPRT_REGIONM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_RMD01106_MIRROR WHERE RM_ID=@CMEMOID
			DELETE FROM DOCPRT_RMM01106_MIRROR WHERE RM_ID=@CMEMOID
			DELETE FROM DOCPRT_SECTIOND_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_SECTIONM_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_SKU_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_SKU_OH_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			DELETE FROM DOCPRT_STATE_MIRROR WHERE DOCPRT_MEMO_ID=@CMEMOID
			SET @VERSION=1

		      
 END
 else
 IF @CXN_TYPE='DOCPO'
 BEGIN
		DELETE A FROM DOCPO_POD01106_MIRROR A WITH (ROWLOCK) WHERE a.PO_ID =@cMemoId 
		DELETE A FROM DOCPO_POM01106_MIRROR A			 WITH (ROWLOCK) WHERE a.PO_ID  =@cMemoId 
		DELETE a FROM DOCPO_HD01106_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_LM01106_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_LMP01106_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_SECTIONM_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_SECTIOND_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA1_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA2_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA3_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA4_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA5_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_PARA6_mirror a				 WITH (ROWLOCK) WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_ARTICLE_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_UOM_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_ATTRM_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_ART_ATTR_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_ATTR_KEY_mirror a			 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE a FROM DOCPO_SKU_mirror a				 WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 

		DELETE A FROM DOCPO_attr1_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr10_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr11_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr12_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr13_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr14_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr15_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr16_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr17_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr18_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr19_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr2_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr20_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr21_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr22_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr23_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr24_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr25_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr3_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr4_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr5_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr6_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr7_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr8_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_attr9_mst_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_ARTICLE_FIX_ATTR_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_ART_DET_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 
		DELETE A FROM DOCPO_ART_PARA1_MIRROR A WITH (ROWLOCK)  WHERE a.DOCPO_MEMO_ID =@cMemoId 

 END
 
 SET @NSTEP=60
 IF @CXN_TYPE='WSR'
 BEGIN
	 DELETE FROM WSR_cnd01106_MIRROR WHERE CN_ID=@CMEMOID
	 DELETE FROM WSR_cnm01106_MIRROR WHERE CN_ID=@CMEMOID
	 SET @VERSION=1
 END
 
END TRY
BEGIN CATCH

		SET @CERRMSG = 'PROCEDURE SP3S_DEL_FROM_MIRROR_TABLES: STEP- ' + LTRIM(STR(@NSTEP)) + ' SQL ERROR: #' + LTRIM(STR(ERROR_NUMBER())) + ' ' + ERROR_MESSAGE()
		GOTO END_PROC
    
END CATCH

END_PROC:
   
     IF @@TRANCOUNT>0  
		 BEGIN  
		  IF ISNULL(@CERRMSG,'')=''  
		  BEGIN
				COMMIT TRANSACTION
		  END	
			  ELSE  
			   ROLLBACK  
 END
      
 


SELECT ISNULL(@CERRMSG,'') AS ERRMSG ,@VERSION AS VERSION_NO     
      

END
