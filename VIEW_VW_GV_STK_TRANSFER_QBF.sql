CREATE VIEW VW_GV_STK_TRANSFER_QBF   

AS   
  SELECT    
    T1.MEMO_NO AS MST_MEMO_NO  
   ,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MST_MEMO_DATE   
   ,T1.MEMO_DT AS MST_MEMO_DT  
   ,T3.DEPT_NAME  AS MST_TARGET_DEPT_NAME    
   ,T4.DEPT_NAME AS MST_SOURCE_DEPT_NAME  
   ,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED  
   ,DET.QUANTITY  
   ,DET.GV_SRNO
   ,T1.MEMO_NO  
   ,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MEMO_DT  
   ,T1.MEMO_ID  
   ,T1.FIN_YEAR AS MST_FIN_YEAR
   ,T1.location_code/*LEFT(T1.MEMO_ID,2)*//*Rohit 04-11-2024*/ AS DEPT_ID
   ,T1.TARGET_DEPT_ID
   ,S.DT_CREATED
   ,S.DT_EXPIRY    

  FROM GV_STKXFER_MST T1   
  JOIN GV_STKXFER_DET DET ON DET.MEMO_ID = T1.MEMO_ID  
  JOIN SKU_GV_MST S ON S.GV_SRNO = DET.GV_SRNO   
  JOIN LOCATION T3 ON T3.DEPT_ID = T1.TARGET_DEPT_ID   
  JOIN LOCATION T4 ON T4.DEPT_ID =T1.location_code /*LEFT(T1.MEMO_ID,2)*//*Rohit 04-11-2024*/
