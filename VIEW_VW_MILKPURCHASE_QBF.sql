CREATE VIEW DBO.VW_MILKPURCHASE_QBF
AS 
 SELECT M.MEMO_ID,M.MEMO_NO,M.MEMO_DT,M.BILL_NO,M.BILL_DT,LV.AC_NAME AS [SUPPLIER_NAME]    
         ,ISNULL(ADDRESS0,'')+' '+ ISNULL(ADDRESS1,'')+' '+ ISNULL(ADDRESS2,'') AS [ADDRESS]    
         ,D.MILK_QTY,D.FSN_QTY,D.FSN_PERCENTAGE,D.FSN_RATE    
         ,D.FSN_AMOUNT,D.FAT_QTY,D.FAT_PERCENTAGE,D.FAT_RATE,D.FAT_AMOUNT   
         ,M.FIN_YEAR    
         ,(CASE M.CANCELED WHEN 1 THEN 'CANCELED' WHEN 0 THEN 'UNCANCELED' END) AS [CANCELED]
         ,M.TOTAL_AMOUNT,M.LAST_UPDATE,ISNULL(D.CLR_PERCENTAGE,0) AS CLR_PERCENTAGE    
         FROM DBO. MILK_PURCHASE_MST M
  JOIN DBO.MILK_PURCHASE_DET D ON M.MEMO_ID=D.MEMO_ID
  JOIN DBO.LMV01106 LV WITH(NOLOCK) ON M.AC_CODE=LV.AC_CODE
