CREATE PROCEDURE GETPARA3LIST
(
 @CWHERE VARCHAR(100)
)
-- WITH ENCRYPTION

AS
BEGIN

IF OBJECT_ID ('TEMPDB..#TEMP','U') IS NOT NULL
DROP TABLE #TEMP

 
SELECT  B.PARA3_NAME AS IMAGE_NAME,'' AS IMAGE_PATH,CAST(0 AS BIT )AS SAVE_IMAGE,
CAST(1 AS BIT )AS CHKIMG,(CASE WHEN ISNULL(B.DT_CREATED,'')= '' 
THEN 'ND' ELSE B.DT_CREATED END) AS DT_CREATED,A.SRNO
INTO #TEMP 
FROM PID01106 A (NOLOCK)
JOIN PARA3 B (NOLOCK) ON A.PARA3_CODE = B.PARA3_CODE
WHERE A.MRR_ID =  @CWHERE ;

 
WITH TEMP
AS
(
 
SELECT  IMAGE_NAME, ROW_NUMBER() OVER (PARTITION BY IMAGE_NAME ORDER BY SRNO) AS DUPLICATE
FROM #TEMP  (NOLOCK)
)

DELETE  FROM TEMP WHERE DUPLICATE>1

SELECT * FROM #TEMP ORDER BY SRNO

END
