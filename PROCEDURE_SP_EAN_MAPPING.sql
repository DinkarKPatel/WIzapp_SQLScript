CREATE PROCEDURE SP_EAN_MAPPING
( 
	@NQUERYID		NUMERIC(1),
	@CWHERE			VARCHAR(200)
)
--WITH ENCRYPTION
AS
BEGIN
	IF @NQUERYID=1 
	GOTO CASE_1
	ELSE IF @NQUERYID=2 
	GOTO CASE_2

CASE_1:
	SELECT * FROM EAN_SYNC WHERE PRODUCT_CODE=@CWHERE
	GOTO LAST

CASE_2:
	SELECT TOP 50 A.ARTICLE_CODE, A.ARTICLE_DESC, A.ARTICLE_NAME,A.ARTICLE_NO , A1.PRODUCT_CODE,A1.BARCODE_CODING_SCHEME AS CODING_SCHEME,
	A1.PURCHASE_PRICE, A1.MRP,A1.WS_PRICE ,  
	A2.PARA1_NAME, A3.PARA2_NAME, A4.PARA3_NAME,A5.PARA4_NAME,A6.PARA5_NAME,A7.PARA6_NAME,
	B.UOM_NAME, B.UOM_TYPE, A.MP_PERCENTAGE,A1.FIX_MRP ,D.SUB_SECTION_NAME,M.SECTION_NAME
	FROM SKU		A1	(NOLOCK)
	JOIN ARTICLE	A	(NOLOCK)   ON A.ARTICLE_CODE=A1.ARTICLE_CODE
	JOIN SECTIOND	D	(NOLOCK)	ON D.SUB_SECTION_CODE=A.SUB_SECTION_CODE
	JOIN SECTIONM	M	(NOLOCK)	ON M.SECTION_CODE=D.SECTION_CODE
	JOIN PARA1		A2	(NOLOCK) ON A2.PARA1_CODE=A1.PARA1_CODE
	JOIN PARA2		A3	(NOLOCK) ON A3.PARA2_CODE=A1.PARA2_CODE
	JOIN PARA3		A4	(NOLOCK) ON A4.PARA3_CODE=A1.PARA3_CODE
	JOIN PARA4		A5	(NOLOCK) ON A5.PARA4_CODE=A1.PARA4_CODE
	JOIN PARA5		A6	(NOLOCK) ON A6.PARA5_CODE=A1.PARA5_CODE
	JOIN PARA6		A7	(NOLOCK) ON A7.PARA6_CODE=A1.PARA6_CODE
	JOIN UOM		B	(NOLOCK) ON A.UOM_CODE = B.UOM_CODE 
	WHERE A1.BARCODE_CODING_SCHEME=1 AND PRODUCT_CODE LIKE @CWHERE
	ORDER BY PRODUCT_CODE
GOTO LAST

LAST:

END
