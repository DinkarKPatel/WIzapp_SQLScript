CREATE VIEW VW_STKRECON  
--WITH ENCRYPTION
AS  
SELECT  A.STM_TITLE AS MST_TITLE, A.STM_START_DT AS MST_XN_DT, B.LOT_NO  AS MST_LOT_NO,    
XN.AC_NAME  AS MST_SUPPLIER,  
AREA.AREA_NAME AS MST_AREA,CITY.CITY AS CITY,STATE.STATE AS STATE,  
MT.SECTION_NAME AS  MST_SECTION_NAME,IT.SUB_SECTION_NAME AS SUB_SECTION_NAME,AR.ARTICLE_NO AS MST_ARTICLE_NO,P1.PARA1_NAME AS MST_PARA1,P2.PARA2_NAME AS MST_PARA2,P3.PARA3_NAME AS MST_PARA3,  
P.QUANTITY_IN_STOCK AS CALC_COMPUTER_STOCK
--,P.SCANNED_QTY AS CAL_SCANNED_QTY
--,P.SHORTAGE_QTY AS CAL_SHORTAGE_QTY 
--,P.EXCESS_QTY AS CAL_EXCESS_QTY
,CASE WHEN A.RECONCILED=1 THEN  P.PRODUCT_CODE ELSE '' END AS MST_PRODUCT_CODE  
FROM STKRECON_HEADER A  
JOIN STKRECON_LOT_MST B ON A.MEMO_ID = B.MEMO_ID   
JOIN STKRECON_LOT_DET C ON B.LOT_NO = C.LOT_NO   
JOIN PMTVIEW_STK  P ON C.PRODUCT_CODE=P.PRODUCT_CODE  
JOIN SKU ON SKU.PRODUCT_CODE=P.PRODUCT_CODE  
JOIN LMV01106 XN(NOLOCK) ON XN.AC_CODE=SKU.AC_CODE  
JOIN ARTICLE AR(NOLOCK) ON AR.ARTICLE_CODE=P.ARTICLE_CODE  
JOIN PARA1 P1(NOLOCK) ON P1.PARA1_CODE=P.PARA1_CODE  
JOIN PARA2 P2(NOLOCK) ON P2.PARA2_CODE=P.PARA2_CODE  
JOIN PARA3 P3(NOLOCK) ON P3.PARA3_CODE=P.PARA3_CODE  
JOIN SECTIOND IT(NOLOCK) ON IT.SUB_SECTION_CODE=AR.SUB_SECTION_CODE  
JOIN SECTIONM MT(NOLOCK) ON MT.SECTION_CODE=IT.SECTION_CODE  
JOIN AREA  (NOLOCK) ON AREA.AREA_CODE=XN.AREA_CODE  
JOIN CITY  (NOLOCK) ON AREA .CITY_CODE=CITY.CITY_CODE  
JOIN STATE  (NOLOCK) ON CITY.STATE_CODE=STATE.STATE_CODE
