CREATE VIEW VW_QBF_LEAVEAPPLICATION 
--WITH ENCRYPTION
AS      
	SELECT DISTINCT            
			B.APPLICATION_ID,            
			B.APPLICATION_NO	AS 'MST_MEMO_NO',            
			B.APPLICATION_DT	AS 'MST_MEMO_DT',            
			A.NO_OF_LEAVES		AS 'MST_TOTAL_LEAVES',            
			B.NO_OF_LEAVES		AS 'MST_APPLIED_LEAVES',    
			B.LEAVES_APPROVED	AS 'MST_APPROVED_LEAVES',            
			A.LEAVE_NAME		AS 'MST_LEAVE_NAME',            
			B.LEAVE_DR_CR		AS 'MST_DB_CR',            
			B.DATE_FROM		AS 'MST_FROM_DATE',            
			B.DATE_TO			AS 'MST_TO_DATE',            
			B.REMARKS			AS 'MST_REMARKS',        
			B.LEAVE_REMARKS	AS 'MST_LEAVE_REMARKS',            
			C.REF_ID			AS 'MST_REF_ID',            
			B.EMP_ID			AS 'MST_EMP_ID',            
			C.EMP_TITLE + ' ' + C.EMP_FNAME	AS 'MST_EMP_FNAME',            
			C.EMP_LNAME		AS 'MST_EMP_LNAME',            
			C.EMAIL1			AS 'MST_EMAIL1',            
			C.EMAIL2			AS 'MST_EMAIL2',            
			C.MOBILE1			AS 'MST_MOBILE_NO',            
			C.PHONES_H			AS 'MST_PHONES_H',        
			C.MOBILE1			AS 'MST_MOBILE1',            
			C.PAN_NO			AS 'PAN_NO',            
			C.ID_PROOF_DOC_TYPE				AS 'MST_ID_PROOF_DOCK_TYPE',
			C.ID_PROOF_DOC_NO	AS 'MST_ID_PROOF_DOCK_NO',            
			E.DESIG_NAME		AS 'MST_DESIG_NAME',            
			F.DEPARTMENT_NAME	AS 'MST_DEPARTMENT_NAME',      
			CASE       
			WHEN B.APPROVED=0 THEN 'UNTOUCHED'       
			WHEN B.APPROVED=1 THEN 'APPROVED'       
			ELSE 'UNAPPROVED'       
			END				AS 'MST_LEAVE_STATUS'      
	FROM EMP_LEAVE_MASTER A       
	JOIN EMP_LEAVE_DETAILS B	(NOLOCK) ON A.LEAVE_CODE=B.LEAVE_CODE             
	JOIN EMP_MST C				(NOLOCK) ON B.EMP_ID=C.EMP_ID       
	JOIN AREA_VIEW D			(NOLOCK) ON C.AREA_CODE=D.AREA_CODE            
	JOIN EMP_DESIG E			(NOLOCK) ON C.DESIG_ID=E.DESIG_ID       
	JOIN EMP_DEPARTMENT F		(NOLOCK) ON C.DEPARTMENT_ID=F.DEPARTMENT_ID
