CREATE PROCEDURE SP_CUSTOMER_SEARCH
(
    @CTEXTSEARCH VARCHAR(1000)=''
)
AS
BEGIN
     
	SELECT DISTINCT CUSTDYM.CUSTOMER_CODE,USER_CUSTOMER_CODE,ORD.REF_NO,
		  CUSTOMER_TITLE,CUSTOMER_FNAME,CUSTOMER_LNAME,STATE='',ADDRESS1,ADDRESS2,AREA='',	
		  CITY='',PINCODE='',PHONE1,PHONE2,MOBILE,EMAIL,AREA_CODE='',ADDRESS9,CARD_NO,INACTIVE,PRIVILEGE_CUSTOMER,	
		  DT_CARD_ISSUE,DT_CARD_EXPIRY,DT_BIRTH,FLAT_DISC_CUSTOMER,REF_CUSTOMER_CODE,LOCATION_ID
	FROM  CUSTDYM (NOLOCK)
	LEFT JOIN
	(
	 SELECT DISTINCT  CUSTOMER_CODE, REF_NO FROM WSL_ORDER_MST 
	) ORD ON ORD.CUSTOMER_CODE=CUSTDYM.CUSTOMER_CODE
	WHERE  ISNULL(CUSTOMER_FNAME,'')LIKE ''+RTRIM(LTRIM(@CTEXTSEARCH))+''
	OR ISNULL(CUSTOMER_LNAME,'') LIKE ''+RTRIM(LTRIM(@CTEXTSEARCH))+''
	OR ISNULL(MOBILE,'') LIKE '%'+RTRIM(LTRIM(@CTEXTSEARCH))+'%'
	OR ISNULL(CARD_NO,'') LIKE '%'+RTRIM(LTRIM(@CTEXTSEARCH))+'%'
	OR ISNULL(USER_CUSTOMER_CODE,'') LIKE '%'+RTRIM(LTRIM(@CTEXTSEARCH))+'%'
	OR ISNULL(CUSTOMER_FNAME,'')+ ' '+ISNULL(CUSTOMER_LNAME,'') LIKE ''+RTRIM(LTRIM(@CTEXTSEARCH))+'%'
	OR ORD.REF_NO LIKE '%'+RTRIM(LTRIM(@CTEXTSEARCH))+'%'
	OR ISNULL(CUSTDYM.CUSTOMER_CODE,'') LIKE ''+RTRIM(LTRIM(@CTEXTSEARCH))+''


END
