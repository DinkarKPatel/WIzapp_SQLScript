CREATE PROCEDURE SP3S_DELETE_PUR_MIRROR_TABLES
@cMemoId VARCHAR(50)
AS
BEGIN
	DECLARE @cMemoIdCopy VARCHAR(50)
		
	SET @cMemoIdCopy=@cMemoId+LEFT(@cMemoId,2)

	TRUNCATE TABLE #t

	INSERT #T
	SELECT MRR_ID  
	FROM PUR_PIM01106_MIRROR B (NOLOCK) WHERE mrr_id=@cMemoId OR mrr_id=@cMemoIdCopy
    
	IF EXISTS (SELECT TOP 1 'U' FROM #T)
	BEGIN
		DELETE A FROM PUR_PIM01106_MIRROR A JOIN #T B ON  A.MRR_ID=B.MRR_ID
		DELETE A FROM PUR_PID01106_MIRROR A JOIN #T B ON  A.MRR_ID=B.MRR_ID
	    DELETE A FROM PUR_DAILOGFILE_MIRROR A JOIN #T B ON  A.MEMONO=B.MRR_ID
		DELETE A FROM PUR_SECTIONM_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_SECTIOND_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_ARTICLE_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA1_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA2_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA3_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA4_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA5_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_PARA6_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
	    DELETE A FROM PUR_ATTRM_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
    	DELETE A FROM PUR_ATTR_KEY_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_ART_ATTR_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_SKU_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		DELETE A FROM PUR_SKU_OH_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
    	DELETE A FROM PUR_BOXM_MIRROR A WITH (ROWLOCK) JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
	    DELETE A FROM PUR_BOXD_MIRROR A WITH (ROWLOCK)JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
	    DELETE A FROM PUR_LOC_WISE_PURHISTORY_MIRROR A WITH (ROWLOCK)JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
	    DELETE A FROM PUR_ATTR1_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR10_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR11_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR12_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR13_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR14_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR15_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR16_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR17_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR18_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR19_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR2_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR20_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR21_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR22_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR23_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR24_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR25_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR3_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR4_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR5_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR6_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR7_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR8_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ATTR9_MST_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_ARTICLE_FIX_ATTR_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_SD_ATTR_AVATAR_MIRROR A JOIN #T B ON  A.PUR_MEMO_ID=B.MRR_ID
		 DELETE A FROM PUR_PMT01106_MIRROR A JOIN #T B ON  A.pur_memo_id=B.MRR_ID  
	END	 


END