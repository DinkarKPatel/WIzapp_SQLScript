CREATE FUNCTION FN_GETNEWMEMOID
(@CXNTYPE VARCHAR(10),@CMEMOID VARCHAR(40),@NNETAMOUNT NUMERIC(10,2))
RETURNS VARCHAR(40)
--WITH ENCRYPTION
AS
BEGIN
	DECLARE @CNEWMEMOID VARCHAR(40)
	
	IF @CXNTYPE='APP'
		SET @CNEWMEMOID=(CASE WHEN CHARINDEX('N-',@CMEMOID)>0 THEN SUBSTRING(@CMEMOID,1,
						 CHARINDEX('N-',@CMEMOID)+1)+RIGHT(@CMEMOID,4)
						 WHEN CHARINDEX('A-',@CMEMOID)>0 THEN SUBSTRING(@CMEMOID,1,
						 CHARINDEX('A-',@CMEMOID)+1)+RIGHT(@CMEMOID,4) ELSE SUBSTRING(@CMEMOID,1,CHARINDEX('-',
						 @CMEMOID))+RIGHT(@CMEMOID,5) END)
	ELSE
		SET @CNEWMEMOID=@CMEMOID
		
	RETURN @CNEWMEMOID					 
END
