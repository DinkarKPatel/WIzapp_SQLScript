CREATE PROCEDURE SP3S_GET_WSLDET
(
	@CAC_CODE VARCHAR(20)
   ,@CARTICLE_CODE VARCHAR(20)
   ,@CPARA1_CODE VARCHAR(20)=''
   ,@CPARA2_CODE VARCHAR(20)=''
   ,@CPARA3_CODE VARCHAR(20)=''
   ,@CPARA4_CODE VARCHAR(20)=''
   ,@CPARA5_CODE VARCHAR(20)=''
   ,@CPARA6_CODE VARCHAR(20)=''
)
--WITH ENCRYPTION
AS
BEGIN
/*
	THIS PROCEDURE WILL RETURN THE DETAILS OF WHOLESALE INVOICE FOR THE INPUT PARTY WITH THE 
	PASSED ARTICLE PARAMETER COMBINATION DURING THE LAST SIX MONTHS
*/
--GETTING THE ARTICLE DETAILS WITH QUANTITY FOR THE SUPPLIED COMBINATION FOR THE INVOICE
SELECT LM.AC_NAME AS [CUSTOMER NAME],INM.INV_NO AS [BILL NO],CONVERT(VARCHAR(10),INM.INV_DT,105) AS [BILL DT]
	  ,C.ARTICLE_NO AS [ARTICLE NO]
	  ,P1.PARA1_NAME AS [COLOR],P2.PARA2_NAME AS [SIZE]
	  ,SUM(IND.QUANTITY) AS QUANTITY
FROM INM01106 INM(NOLOCK)
JOIN LM01106 LM (NOLOCK) ON INM.AC_CODE=LM.AC_CODE
JOIN IND01106 IND(NOLOCK) ON INM.INV_ID=IND.INV_ID
JOIN SKU B(NOLOCK) ON IND.PRODUCT_CODE=B.PRODUCT_CODE
JOIN ARTICLE C(NOLOCK) ON B.ARTICLE_CODE=C.ARTICLE_CODE
JOIN PARA1 P1(NOLOCK) ON B.PARA1_CODE=P1.PARA1_CODE
JOIN PARA2 P2(NOLOCK) ON B.PARA2_CODE=P2.PARA2_CODE
JOIN PARA3 P3(NOLOCK) ON B.PARA3_CODE=P3.PARA3_CODE
JOIN PARA4 P4(NOLOCK) ON B.PARA4_CODE=P4.PARA4_CODE
JOIN PARA5 P5(NOLOCK) ON B.PARA5_CODE=P5.PARA5_CODE
JOIN PARA6 P6(NOLOCK) ON B.PARA6_CODE=P6.PARA6_CODE
WHERE INM.CANCELLED=0 AND INM.INV_MODE=1 AND INM.AC_CODE=@CAC_CODE
AND INM.INV_DT>=DATEADD(MONTH,-6,CONVERT(VARCHAR(10),GETDATE(),110))
AND B.ARTICLE_CODE=@CARTICLE_CODE 
AND (ISNULL(@CPARA1_CODE,'')='' OR B.PARA1_CODE=@CPARA1_CODE)
AND (ISNULL(@CPARA2_CODE,'')='' OR B.PARA2_CODE=@CPARA2_CODE)
AND (ISNULL(@CPARA3_CODE,'')='' OR B.PARA3_CODE=@CPARA3_CODE)
AND (ISNULL(@CPARA4_CODE,'')='' OR B.PARA4_CODE=@CPARA4_CODE)
AND (ISNULL(@CPARA5_CODE,'')='' OR B.PARA5_CODE=@CPARA5_CODE)
AND (ISNULL(@CPARA6_CODE,'')='' OR B.PARA6_CODE=@CPARA6_CODE)
GROUP BY LM.AC_NAME,INM.INV_NO,INM.INV_DT,C.ARTICLE_NO,P1.PARA1_NAME,P2.PARA2_NAME

END
--END OF PROCEDURE - SP3S_GET_WSLDET
