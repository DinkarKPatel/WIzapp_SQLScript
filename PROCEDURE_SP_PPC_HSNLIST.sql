CREATE PROCEDURE SP_PPC_HSNLIST
(
 @CHSN_CODE VARCHAR(10)=''
)
AS
BEGIN
    
    SELECT A.HSN_CODE ,
           A.TAXABLE_ITEM,
           CAST(CASE WHEN ISNULL(A.HSN_TYPE,0)=1 THEN 'TAXABLE' ELSE 'TAXFREE' END AS VARCHAR(100)) AS TAX_TYPE,
           A.GST_VARIATION,
		   b.GST_CAL_BASIS,
		   ISNULL(A.DESCRIPTIONS,'') AS DESCRIPTIONS,
           ISNULL(CONVERT(VARCHAR,B.WEF,105),'') AS CUT_OFF_DATE,
           ISNULL(B.RATE_CUTOFF_TAX_PERCENTAGE,0) AS CUT_OFF_AMOUNT,
           ISNULL(B.TAX_PERCENTAGE,0) AS LESS_RATE,
           ISNULL(B.RATE_CUTOFF_TAX_PERCENTAGE,0) AS GREATER_RATE
    FROM HSN_MST A
    LEFT JOIN HSN_DET B ON A.HSN_CODE =B.HSN_CODE 
    WHERE (@CHSN_CODE='' OR A.HSN_CODE =@CHSN_CODE)
END
