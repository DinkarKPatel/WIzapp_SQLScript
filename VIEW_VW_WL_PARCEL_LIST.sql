CREATE VIEW VW_WL_PARCEL_LIST  
AS       
 SELECT T1.PARCEL_MEMO_NO AS MEMO_NO,    
 T1.PARCEL_MEMO_DT AS MEMO_DT ,    
 T1.RECEIPT_DT ,    
 T1.REMARKS ,    
 T1.XN_TYPE,  
 T1.TOTAL_AMOUNT ,    
 T1.PARCEL_MEMO_ID AS MEMO_ID,    
 T1.CASH_RECEIPT_NO,    
 T1.BILTY_NO  ,    
 T3.AC_NAME AS PARTY_NAME  ,    
 AN.ANGADIA_NAME AS TRANSPORTER_NAME ,     
 (CASE WHEN T1.PAY_TYPE= 1 THEN 'PAID'  ELSE 'TOPAY' END) AS PAYMENT_TYPE,    
 (CASE WHEN T1.MODE= 1 THEN 'OUTWARD'  ELSE 'INWARD' END) AS MEMO_TYPE,  
 (CASE WHEN T1.CANCELLED = 1 THEN 'CANCELLED' ELSE '' END) AS CANCELLED,    
 (CASE WHEN ISNULL( PB.REF_MEMO_ID,'') = '' THEN 'UNOPENED' ELSE 'OPENED' END) AS PARCEL_STATUS,    
 T1.FIN_YEAR ,  
 PB.GOODS_DESC  ,  
 PB.REF_MEMO_ID ,  
 PB.REF_MEMO_NO ,  
 pb.quantity ,  
 PB.QTY AS WEIGHT,  
 PB.AMOUNT, 
 u.username as USERNAME,
 u1.username as EDT_USERNAME, 
 T1.CASH_AMOUNT,
 CONVERT(NUMERIC(10,2),CASE WHEN QTY<> 0 THEN AMOUNT /QTY ELSE 0 END ) AS RATE  
 ,T1.location_code
 FROM PARCEL_MST T1        
 JOIN parcel_det  PB ON T1.PARCEL_MEMO_ID =PB.PARCEL_MEMO_ID      
 JOIN LMV01106 T3 ON T3.AC_CODE = pb.AC_CODE        
 JOIN ANGM AN ON AN.ANGADIA_CODE=T1.ANGADIA_CODE    
 JOIN USERS U ON U.USER_CODE=T1.USER_CODE  
 LEFT OUTER JOIN users u1 ON T1.EDT_USER_CODE=U1.user_code  
 
 
 

