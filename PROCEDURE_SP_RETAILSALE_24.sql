CREATE PROCEDURE SP_RETAILSALE_24--(LocId 3 digit change only increased the parameter width by Sanjay:30-10-2024)
(  
	 @CQUERYID			NUMERIC(2),  
	 @CWHERE			VARCHAR(MAX)='',  
	 @CFINYEAR			VARCHAR(5)='',  
	 @CDEPTID			VARCHAR(4)='',  
	 @NNAVMODE			NUMERIC(2)=1,  
	 @CWIZAPPUSERCODE	VARCHAR(10)='',  
	 @CREFMEMOID		VARCHAR(40)='',  
	 @CREFMEMODT		DATETIME='',  
	 @BINCLUDEESTIMATE	BIT=1,  
	 @CFROMDT			DATETIME='',  
	 @CTODT				VARCHAR(50)='',
	 @bCardDiscount		BIT=0,
	 @cCustCode			VARCHAR(15)=''
) 
AS  
BEGIN  
	  SELECT  A.PRODUCT_CODE,CONVERT(VARCHAR(20),B.MRP) AS [MRP],CONVERT(VARCHAR(20), B.WS_PRICE) AS [WS_PRICE]  ,B.MRP AS [MRP1]  
  FROM PMT01106 A (NOLOCK)    
  JOIN SKU  B (NOLOCK) ON B.PRODUCT_CODE=A.PRODUCT_CODE  
  LEFT OUTER JOIN LOCSKUSP L (NOLOCK) ON   L.PRODUCT_CODE=A.PRODUCT_CODE
  WHERE A.DEPT_ID=@CDEPTID AND L.PRODUCT_CODE IS NULL AND B.PRODUCT_CODE=@CWHERE
  UNION    
  SELECT  A.PRODUCT_CODE,CONVERT(VARCHAR(20),A.MRP) AS [MRP],CONVERT(VARCHAR(20), A.WS_PRICE) AS [WS_PRICE]   ,A.MRP AS [MRP1]  
  FROM LOCSKUSP A (NOLOCK)    
  JOIN SKU  B (NOLOCK) ON B.PRODUCT_CODE=A.PRODUCT_CODE    
  WHERE A.DEPT_ID=@CDEPTID  AND B.PRODUCT_CODE=@CWHERE   
  ORDER BY PRODUCT_CODE      

end
