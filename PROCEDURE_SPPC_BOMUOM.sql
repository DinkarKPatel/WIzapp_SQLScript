CREATE PROC SPPC_BOMUOM  
(
	@NMODE INT,  
	@STOCKUOMNAME VARCHAR(100)='',  
	@STOCKUOMCODE VARCHAR(50)  =''
)
	AS BEGIN  
	IF (@NMODE=1)  
			BEGIN  
			SELECT U.UOM_NAME,U.UOM_CODE,ISNULL(B.CONVERSION_UOM_CODE,'') AS CONVERSION_UOM_CODE,
			ISNULL(BU.CONVERSION_UOM_NAME,'') AS CONVERSION_UOM_NAME,ISNULL(B.CONVERSION_VALUE,0) AS CONVERSION_VALUE 
			FROM UOM AS U 
			LEFT JOIN  PPC_UOM_CONVERSION AS B ON U.UOM_CODE=B.UOM_CODE  
			LEFT JOIN PPC_BOM_UOM BU ON BU.CONVERSION_UOM_CODE=B.CONVERSION_UOM_CODE
	END  
	  
	  
	IF (@NMODE=2)  
	BEGIN  
			SELECT U.UOM_NAME,U.UOM_CODE,
			ISNULL(B.CONVERSION_UOM_CODE,'') AS CONVERSION_UOM_CODE,
			ISNULL(BU.CONVERSION_UOM_NAME,'') AS CONVERSION_UOM_NAME,
			ISNULL(B.CONVERSION_VALUE,0) AS CONVERSION_VALUE
			FROM UOM AS U    
			LEFT JOIN PPC_UOM_CONVERSION AS B ON U.UOM_CODE=B.UOM_CODE  
			LEFT JOIN PPC_BOM_UOM BU ON BU.CONVERSION_UOM_CODE=B.CONVERSION_UOM_CODE
			WHERE U.UOM_CODE=@STOCKUOMCODE  
	END  
	  
	IF (@NMODE=3)  
	BEGIN  
			SELECT U.UOM_NAME,U.UOM_CODE,
			ISNULL(B.CONVERSION_UOM_CODE,'') AS CONVERSION_UOM_CODE,
			ISNULL(BU.CONVERSION_UOM_NAME,'') AS CONVERSION_UOM_NAME,ISNULL(B.CONVERSION_VALUE,0) AS CONVERSION_VALUE
			FROM UOM AS U    
			LEFT JOIN PPC_UOM_CONVERSION AS B ON U.UOM_CODE=B.UOM_CODE  
			LEFT JOIN PPC_BOM_UOM BU ON BU.CONVERSION_UOM_CODE=B.CONVERSION_UOM_CODE
			WHERE U.UOM_CODE=@STOCKUOMCODE  
	END  
	  
	IF (@NMODE=4)  
			BEGIN  
			SELECT A.UOM_NAME,A.UOM_CODE 
			FROM UOM  A
			WHERE INACTIVE=0
			
	END  
  
END
