CREATE VIEW VW_REP_ARTICLE   
AS    
SELECT A.ARTICLE_CODE AS MEMO_ID,  
ISNULL(G.ARTICLE_NO,'') AS ARTICLE_SET_NAME,  
A.ARTICLE_NO AS ARTICLE_NO,  
A.ALIAS AS ALIAS,  
A.ARTICLE_DESC AS ARTICLE_DESC,  
A.ARTICLE_NAME AS ARTICLE_NAME,  
E.SECTION_NAME AS SECTION_NAME,  
D.SUB_SECTION_NAME AS SUB_SECTION_NAME,  
(CASE WHEN A.CODING_SCHEME =1 THEN 'FIXED' WHEN A.CODING_SCHEME =2 THEN 'LOT' ELSE 'UNIQUE' END) AS CODING_SCHEME,  
A.MP_PERCENTAGE AS MP_PERCENTAGE,  
A.MRP AS MRP,  
A.PURCHASE_PRICE AS PURCHASE_PRICE,  
A.WSP_PERCENTAGE AS WP_PERCENTAGE,  
A.WHOLESALE_PRICE AS WS_PRICE,  
C.UOM_NAME AS UOM_NAME, 
ISNULL(A.HSN_CODE,'') AS HSN_CODE ,  
--ISNULL(F.KEY_NAME ,'') AS KEY_NAME,  
(CASE WHEN A.INACTIVE =1 THEN 'TRUE'  ELSE 'FALSE' END) AS INACTIVE ,
(CASE WHEN A.PERISHABLE =1 THEN 'TRUE'  ELSE 'FALSE' END) AS PERISHABLE ,
AT1.ATTR1_KEY_NAME,AT2.ATTR2_KEY_NAME,AT3.ATTR3_KEY_NAME,AT4.ATTR4_KEY_NAME,AT5.ATTR5_KEY_NAME,AT6.ATTR6_KEY_NAME,AT7.ATTR7_KEY_NAME,AT8.ATTR8_KEY_NAME,AT9.ATTR9_KEY_NAME,AT10.ATTR10_KEY_NAME,AT11.ATTR11_KEY_NAME,AT12.ATTR12_KEY_NAME,AT13.ATTR13_KEY_NAME,AT14.ATTR14_KEY_NAME,
AT15.ATTR15_KEY_NAME,AT16.ATTR16_KEY_NAME,AT17.ATTR17_KEY_NAME,AT18.ATTR18_KEY_NAME,AT19.ATTR19_KEY_NAME,AT20.ATTR20_KEY_NAME,AT21.ATTR21_KEY_NAME,AT22.ATTR22_KEY_NAME,AT23.ATTR23_KEY_NAME,AT24.ATTR24_KEY_NAME,AT25.ATTR25_KEY_NAME ,
Supplier = STUFF
(
    (
        SELECT ',' + AC_NAME
        FROM  artsuppliers art with (nolock) join lm01106 b (nolock) on art.ac_code= b.ac_code  
        WHERE A.Article_Code  =art.Article_Code
        ORDER BY AC_NAME
        FOR XML PATH (''), TYPE
    ).value('.', 'varchar(max)')
, 1, 1, '')
,ISNULL(A.created_on,'') AS CREATED_ON
,A.bl_Article_name
FROM ARTICLE A (NOLOCK)  
JOIN UOM C (NOLOCK) ON A.UOM_CODE = C.UOM_CODE  
JOIN SECTIOND D (NOLOCK) ON A.SUB_SECTION_CODE = D.SUB_SECTION_CODE  
JOIN SECTIONM E (NOLOCK) ON D.SECTION_CODE = E.SECTION_CODE  
LEFT JOIN ARTICLE_FIX_ATTR  ATTR (NOLOCK) on a.article_code =ATTR.article_code
LEFT OUTER JOIN ATTR1_MST AT1 (NOLOCK) ON AT1.ATTR1_KEY_CODE=ATTR.ATTR1_KEY_CODE 
LEFT OUTER JOIN ATTR2_MST AT2 (NOLOCK) ON AT2.ATTR2_KEY_CODE=ATTR.ATTR2_KEY_CODE
LEFT OUTER JOIN ATTR3_MST AT3 (NOLOCK) ON AT3.ATTR3_KEY_CODE=ATTR.ATTR3_KEY_CODE 
LEFT OUTER JOIN ATTR4_MST AT4 (NOLOCK) ON AT4.ATTR4_KEY_CODE=ATTR.ATTR4_KEY_CODE
LEFT OUTER JOIN ATTR5_MST AT5 (NOLOCK) ON AT5.ATTR5_KEY_CODE=ATTR.ATTR5_KEY_CODE 
LEFT OUTER JOIN ATTR6_MST AT6 (NOLOCK) ON AT6.ATTR6_KEY_CODE=ATTR.ATTR6_KEY_CODE
LEFT OUTER JOIN ATTR7_MST AT7 (NOLOCK) ON AT7.ATTR7_KEY_CODE=ATTR.ATTR7_KEY_CODE 
LEFT OUTER JOIN ATTR8_MST AT8 (NOLOCK) ON AT8.ATTR8_KEY_CODE=ATTR.ATTR8_KEY_CODE
LEFT OUTER JOIN ATTR9_MST AT9 (NOLOCK) ON AT9.ATTR9_KEY_CODE=ATTR.ATTR9_KEY_CODE 
LEFT OUTER JOIN ATTR10_MST AT10 (NOLOCK) ON AT10.ATTR10_KEY_CODE=ATTR.ATTR10_KEY_CODE
LEFT OUTER JOIN ATTR11_MST AT11 (NOLOCK) ON AT11.ATTR11_KEY_CODE=ATTR.ATTR11_KEY_CODE 
LEFT OUTER JOIN ATTR12_MST AT12 (NOLOCK) ON AT12.ATTR12_KEY_CODE=ATTR.ATTR12_KEY_CODE
LEFT OUTER JOIN ATTR13_MST AT13 (NOLOCK) ON AT13.ATTR13_KEY_CODE=ATTR.ATTR13_KEY_CODE 
LEFT OUTER JOIN ATTR14_MST AT14 (NOLOCK) ON AT14.ATTR14_KEY_CODE=ATTR.ATTR14_KEY_CODE
LEFT OUTER JOIN ATTR15_MST AT15 (NOLOCK) ON AT15.ATTR15_KEY_CODE=ATTR.ATTR15_KEY_CODE 
LEFT OUTER JOIN ATTR16_MST AT16 (NOLOCK) ON AT16.ATTR16_KEY_CODE=ATTR.ATTR16_KEY_CODE
LEFT OUTER JOIN ATTR17_MST AT17 (NOLOCK) ON AT17.ATTR17_KEY_CODE=ATTR.ATTR17_KEY_CODE
LEFT OUTER JOIN ATTR18_MST AT18 (NOLOCK) ON AT18.ATTR18_KEY_CODE=ATTR.ATTR18_KEY_CODE 
LEFT OUTER JOIN ATTR19_MST AT19 (NOLOCK) ON AT19.ATTR19_KEY_CODE=ATTR.ATTR19_KEY_CODE
LEFT OUTER JOIN ATTR20_MST AT20 (NOLOCK) ON AT20.ATTR20_KEY_CODE=ATTR.ATTR20_KEY_CODE 
LEFT OUTER JOIN ATTR21_MST AT21 (NOLOCK) ON AT21.ATTR21_KEY_CODE=ATTR.ATTR21_KEY_CODE
LEFT OUTER JOIN ATTR22_MST AT22 (NOLOCK) ON AT22.ATTR22_KEY_CODE=ATTR.ATTR22_KEY_CODE 
LEFT OUTER JOIN ATTR23_MST AT23 (NOLOCK) ON AT23.ATTR23_KEY_CODE=ATTR.ATTR23_KEY_CODE
LEFT OUTER JOIN ATTR24_MST AT24 (NOLOCK) ON AT24.ATTR24_KEY_CODE=ATTR.ATTR24_KEY_CODE 
LEFT OUTER JOIN ATTR25_MST AT25(NOLOCK) ON AT25.ATTR25_KEY_CODE=ATTR.ATTR25_KEY_CODE                 
LEFT OUTER JOIN  ARTICLE G ON A.ARTICLE_SET_CODE = G.ARTICLE_CODE   AND ISNULL(G.ARTICLE_CODE,'') <> ''    
WHERE A.ARTICLE_NO <> ''
