CREATE PROCEDURE SP3S_INACTIVE_DUP_PARA
AS
BEGIN

        
     
				IF OBJECT_ID('TEMPDB..#TMPPARA1','U') IS NOT NULL
				DROP TABLE #TMPPARA1
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA1_NAME 
				ORDER BY PARA1_NAME) AS SRNO,
				PARA1_CODE,PARA1_NAME 
				FROM PARA1 WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA1 FROM CTE WHERE SRNO > 1

				UPDATE PARA1 SET INACTIVE=1 WHERE PARA1_CODE IN (SELECT PARA1_CODE FROM #TMPPARA1)

				--PARA2

				IF OBJECT_ID('TEMPDB..#TMPPARA2','U') IS NOT NULL
				DROP TABLE #TMPPARA2
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA2_NAME ORDER BY PARA2_NAME) AS SRNO,
				PARA2_CODE,PARA2_NAME 
				FROM PARA2 WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA2 FROM CTE WHERE SRNO > 1

				UPDATE PARA2 SET INACTIVE=1 WHERE PARA2_CODE IN (SELECT PARA2_CODE FROM #TMPPARA2)


				--PARA3

				IF OBJECT_ID('TEMPDB..#TMPPARA3','U') IS NOT NULL
				DROP TABLE #TMPPARA3
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA3_NAME ORDER BY PARA3_NAME) AS SRNO,
				PARA3_CODE,PARA3_NAME 
				FROM PARA3 WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA3 FROM CTE WHERE SRNO > 1

				UPDATE PARA3 SET INACTIVE=1 WHERE PARA3_CODE IN (SELECT PARA3_CODE FROM #TMPPARA3)

				--PARA4
				IF OBJECT_ID('TEMPDB..#TMPPARA4','U') IS NOT NULL
				DROP TABLE #TMPPARA4
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA4_NAME ORDER BY PARA4_NAME) AS SRNO,
				PARA4_CODE,PARA4_NAME 
				FROM PARA4  WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA4 FROM CTE WHERE SRNO > 1

				UPDATE PARA4 SET INACTIVE=1 WHERE PARA4_CODE IN (SELECT PARA4_CODE FROM #TMPPARA4)

				---PARA5

				IF OBJECT_ID('TEMPDB..#TMPPARA5','U') IS NOT NULL
				DROP TABLE #TMPPARA5
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA5_NAME ORDER BY PARA5_NAME) AS SRNO,
				PARA5_CODE,PARA5_NAME 
				FROM PARA5 WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA5 FROM CTE WHERE SRNO > 1

				UPDATE PARA5 SET INACTIVE=1 WHERE PARA5_CODE IN (SELECT PARA5_CODE FROM #TMPPARA5)

				---PARA6 


				IF OBJECT_ID('TEMPDB..#TMPPARA6','U') IS NOT NULL
				DROP TABLE #TMPPARA6
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY PARA6_NAME ORDER BY PARA6_NAME) AS SRNO,
				PARA6_CODE,PARA6_NAME 
				FROM PARA6 WHERE INACTIVE=0
				)SELECT * INTO #TMPPARA6 FROM CTE WHERE SRNO > 1

				UPDATE PARA6 SET INACTIVE=1 WHERE PARA6_CODE IN (SELECT PARA6_CODE FROM #TMPPARA6)

                
                ---ARTICLE 


				IF OBJECT_ID('TEMPDB..#TMPARTICLE','U') IS NOT NULL
				DROP TABLE #TMPARTICLE
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY ARTICLE_NO ORDER BY ARTICLE_NO) AS SRNO,
				ARTICLE_CODE,ARTICLE_NO 
				FROM ARTICLE WHERE INACTIVE=0
				)SELECT * INTO #TMPARTICLE FROM CTE WHERE SRNO > 1

				UPDATE ARTICLE SET INACTIVE=1 WHERE ARTICLE_CODE IN (SELECT ARTICLE_CODE FROM #TMPARTICLE)
				
				
				--- SUBSECTION MASTER
				
				IF OBJECT_ID('TEMPDB..#TMPSUBSEC','U')IS NOT NULL
				DROP TABLE #TMPSUBSEC
				
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY SECTION_CODE,SUB_SECTION_NAME ORDER BY SECTION_CODE,SUB_SECTION_NAME) AS SRNO,
				SUB_SECTION_CODE,SUB_SECTION_NAME,SECTION_CODE
				FROM SECTIOND  WHERE INACTIVE=0
				)SELECT * INTO #TMPSUBSEC FROM CTE WHERE SRNO > 1

				UPDATE SECTIOND SET INACTIVE=1 WHERE SUB_SECTION_CODE IN (SELECT SUB_SECTION_CODE FROM #TMPSUBSEC)
				
               
                 --- SECTION MASTER
				
				IF OBJECT_ID('TEMPDB..#TMPSEC','U')IS NOT NULL
				DROP TABLE #TMPSEC
				
				;WITH CTE AS
				(
				SELECT ROW_NUMBER()OVER(PARTITION BY SECTION_NAME ORDER BY SECTION_NAME) AS SRNO,
				SECTION_CODE,SECTION_NAME
				FROM SECTIONM  WHERE INACTIVE=0
				)SELECT * INTO #TMPSEC FROM CTE WHERE SRNO > 1

				UPDATE SECTIONM SET INACTIVE=1 WHERE SECTION_CODE IN (SELECT SECTION_CODE FROM #TMPSEC)
				
		

END
