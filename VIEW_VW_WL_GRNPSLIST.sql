CREATE VIEW VW_WL_GRNPSLIST        
    
AS         
SELECT  T3.AC_NAME AS SUPPLIER_NAME,      
'' AS MEMO_MODE,       
T1.MEMO_DT, T1.MEMO_NO,                
T1.REMARKS ,         
(CASE WHEN T1.CANCELLED = 1 THEN 0 ELSE ISNULL(T2.TOTAL_QUANTITY,0) END) AS TOTAL_QUANTITY,   
  
          
T1.MEMO_ID,      
(CASE WHEN T1.CANCELLED = 1 THEN 'CANCELLED' ELSE '' END) AS CANCELLED  ,      
T1.FIN_YEAR  ,COM.COMPANY_CODE,    
L.DEPT_ID  AS LOC_ID,L.DEPT_NAME AS LOC_NAME,
u.username as USERNAME      ,T1.location_Code
FROM GRN_PS_MST T1        
JOIN LMV01106 T3 ON T3.AC_CODE = T1.AC_CODE  
JOIN USERS U (NOLOCK) ON T1.user_code=U.user_code        
LEFT OUTER JOIN         
(SELECT MEMO_ID,SUM(QUANTITY) AS TOTAL_QUANTITY     
 FROM GRN_PS_DET GROUP BY MEMO_ID)       
 T2 ON T2.MEMO_ID=T1.MEMO_ID       
 LEFT OUTER JOIN COMPANY COM ON 1=1 AND COM.COMPANY_CODE='01'      
 LEFT OUTER JOIN LOCATION  L (NOLOCK) ON T1.location_code/*LEFT(T1.MEMO_ID,2)*//*Rohit 05-11-2024*/ = L.DEPT_ID  