
create PROCEDURE SP_SEND_MIRROR_MSTCUSATTR
(
 @CTARGETLOCID VARCHAR(5)
)
--WITH ENCRYPTION
AS
BEGIN
     DECLARE @CTEMPDBNAME VARCHAR(100),@CSTEP VARCHAR(10),@CFILTERCONDITION VARCHAR(100),@CTABLENAME VARCHAR(100),
             @CTEMPTABLE VARCHAR(100),@DTSQL NVARCHAR(MAX),@CTEMPDETAILTABLE VARCHAR(100),
             @CTEMPAREATABLE VARCHAR(100),@CTEMPCITYTABLE VARCHAR(100),@CTEMPSTATETABLE VARCHAR(100),
             @CTEMPREGIONMTABLE VARCHAR(100),@CERRMSG VARCHAR(1000)

     DECLARE @TXNSSENDINFO TABLE (ORG_TABLENAME VARCHAR(100),TMP_TABLENAME VARCHAR(100),XN_ID VARCHAR(100)) 

     BEGIN TRY

     DECLARE @CTEMPDBNAME1 VARCHAR(100)
	 SET @CTEMPDBNAME1=''
	 SET @CTEMPDBNAME=''
	 SET @CERRMSG=''

	 
	SET @CSTEP=10
	SET @CFILTERCONDITION=''
	 
    LBLTABLEINFO:


	SET @CSTEP=20
	
	IF NOT EXISTS(SELECT TOP 1 'U' FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID' AND VALUE IN 
				  (SELECT LTRIM(RTRIM(VALUE)) FROM CONFIG WHERE CONFIG_OPTION='HO_LOCATION_ID'))
	RETURN  --CHECK IT
	
	
	
	
	SET @CSTEP=30
	--1 SEND THE CUSTDYM   TABLE
	SET @CTABLENAME ='CONFIG_CUST_ATTR'
	SELECT DISTINCT  'MSTCUSATTR_CONFIG_CUST_ATTR_MIRROR' AS TARGET_TABLENAME,CONFIG_CUST_ATTR.*,1 AS PICK_FROM_CURRENT_DB FROM CONFIG_CUST_ATTR (NOLOCK)
	
	


	
    DECLARE @NCOUNT INT,@BLOOP INT,@CCMD NVARCHAR(MAX)
	SET @NCOUNT=25
	SET @BLOOP=1
	WHILE (@BLOOP <=@NCOUNT )
	BEGIN
	      
	    
		   SET @CCMD=N' 

				SELECT 	DISTINCT ''MSTCUSATTR_cust_attr'+RTRIM(LTRIM(RTRIM(LTRIM(STR(@BLOOP)))))+'_MST_MIRROR'' AS TARGET_TABLENAME,cust_attr'+RTRIM(LTRIM(STR(@BLOOP)))+'_MST.* 
				FROM cust_attr'+RTRIM(LTRIM(STR(@BLOOP)))+'_MST(NOLOCK) '
								
		   PRINT  @CCMD
		   EXEC SP_EXECUTESQL @CCMD
	       
		   SET @BLOOP=@BLOOP +1
	END

	
	GOTO END_PROC


	
	
	 END TRY
BEGIN CATCH
	SET @CERRMSG='P: SP_SEND_MIRROR_MSTCUSATTR_DATA, STEP:'+@CSTEP+', MESSAGE:'+ERROR_MESSAGE()
	GOTO END_PROC
END CATCH 	
	
END_PROC:
		

    select  ISNULL(@CERRMSG,'') as errmsg
		
		
END
--- 'END OF PROCEDURE SP_SEND_MIRROR_MSTCUS_DATA'

