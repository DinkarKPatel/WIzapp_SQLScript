CREATE FUNCTION FN_CALCULATEDISCPER
( 
	@ND1 NUMERIC(14,2), 
	@ND2  NUMERIC(14,2), 
	@ND3  NUMERIC(14,2)
)RETURNS  NUMERIC(14,2)
--WITH ENCRYPTION
AS
BEGIN
    DECLARE  @ND  NUMERIC(14,2)
    SET @ND= 0
    SET @ND1=ISNULL(@ND1,0)
    SET @ND2=ISNULL(@ND2,0)
    SET @ND3=ISNULL(@ND3,0)
    
    IF (@ND1 > 0)
		SET @ND = @ND1
    IF(@ND2>0 AND @ND<100)
        SET @ND=@ND+((100-@ND) * (@ND2/100))
    IF (@ND3 > 0 AND @ND<100)
        SET @ND =@ND+ ((100-@ND) * (@ND3 / 100))

	 IF(@ND>100)
		SET @ND=100

    RETURN ISNULL(@ND,0)

END
