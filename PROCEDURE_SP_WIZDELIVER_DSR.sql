CREATE PROCEDURE SP_WIZDELIVER_DSR      --(LocId 3 digit change only increased the parameter width by Sanjay:01-11-2024)
(      
 @NQUERYID NUMERIC(3,0),      
 @CDEPT_ID VARCHAR(4) = '',      
 @DTFROM DATETIME,      
 @DTTO DATETIME,      
 @CUSERCODE VARCHAR(12) = '',      
 @CWHERE VARCHAR(100) =''
)
--WITH ENCRYPTION
      
AS      
BEGIN      
      
IF @NQUERYID = 1      
	GOTO LBLGETREPORTS      
      
ELSE IF @NQUERYID = 2      
	GOTO LBLGETLOCATION 
ELSE IF @NQUERYID= 3
	GOTO LBLCUSTOMER    
ELSE IF @NQUERYID= 4
	GOTO LBLHBD 

ELSE IF @NQUERYID= 5
	GOTO LBLAGENCY

ELSE IF @NQUERYID= 6
	GOTO LBLPRODUCT_CODE		
ELSE IF @NQUERYID= 7
	GOTO LBLPCUSTOMER_CODE		
ELSE      
	GOTO LAST      
      
LBLGETREPORTS:      
	  
	SELECT * FROM REPORTS WHERE MODULE_NAME = 'JWDFIXREPORTS' AND ISNULL(REPORT_HIDE,0)=0 ORDER BY REPORT_NO      
	  
GOTO LAST      
LBLGETLOCATION:      
	  
	SELECT *, DEPT_ID+' '+DEPT_NAME AS LOCATION_NAME FROM LOCATION       
	  
GOTO LAST  
LBLCUSTOMER:

	SELECT DISTINCT CUSTOMER_FNAME+' '+CUSTOMER_LNAME AS CUSTOMER_NAME,CUSTOMER_CODE,
	USER_CUSTOMER_CODE
	FROM CUSTDYM 
	WHERE CUSTOMER_CODE <>'000000000000'

GOTO LAST
LBLHBD:
	SELECT * FROM VW_POSTSALES_HBDPRINT WHERE MEMO_DT BETWEEN @DTFROM  AND @DTTO 
	ORDER BY DELIVERY_DT,CUSTOMER_CODE,CM_NO
GOTO LAST  

LBLAGENCY:
	SELECT * FROM PRD_AGENCY_MST  WHERE AGENCY_CODE<>'00000'
	GOTO LAST
	
LBLPRODUCT_CODE:
	SELECT DISTINCT  CMD.PRODUCT_CODE FROM CMD01106 CMD(NOLOCK) 
	JOIN HOLD_BACK_DELIVER_DET  M (NOLOCK) ON CMD.ROW_ID =M.REF_CMD_ROW_ID 
	WHERE CMD.PRODUCT_CODE<>'' AND 1=2
	GOTO LAST	
LBLPCUSTOMER_CODE:
 SELECT DISTINCT  M.CUSTOMER_CODE,ISNULL(CUSTOMER_FNAME,'')+' '+ISNULL(CUSTOMER_LNAME,'') AS CUSTOMER_NAME
 FROM  HOLD_BACK_DELIVER_MST  M 
 JOIN CUSTDYM C ON C.CUSTOMER_CODE=M.CUSTOMER_CODE
 WHERE M.CUSTOMER_CODE<>'000000000000'
	  
LAST:      
END
