create PROC VALIDATEXN_HBD_BEFORE_EDIT 
@CMEMOID VARCHAR(30),
@BCANCELXN BIT,
@CERRORMSG VARCHAR(200) OUTPUT,
@CEXPRERRORMSG VARCHAR(200) OUTPUT
--WITH ENCRYPTION
AS
BEGIN
	
	DECLARE @CTEXT VARCHAR(10)
	
	SET @CTEXT=(CASE WHEN @BCANCELXN=1 THEN 'CANCEL' ELSE 'EDIT' END)
		
	IF EXISTS(SELECT TOP 1 A.HBD_MEMO_ID   FROM  ITEM_STATUS  A (NOLOCK) 
			  WHERE A.HBD_MEMO_ID=@CMEMOID AND (ISNULL(A.issue_id,'')<>'' OR ISNULL(A.DELIVER_MEMO_ID,'')<>'')  )				  
	
	BEGIN
		SET @CERRORMSG='THIS HOLD BACK MEMO HAS BEEN ISSUED.........CAN NOT '+@CTEXT
		RETURN
	END
	

	--IF EXISTS (SELECT TOP 1 'U' FROM HOLD_BACK_DELIVER_MST WHERE MEMO_ID= @CMEMOID AND MODE=1 AND ENTRY_MODE =1)
	--   BEGIN
	--	     SET @CERRORMSG='Receipt from customer memo can not be modified only modified from cash memo'
	--	     return
 --      end


		
END
