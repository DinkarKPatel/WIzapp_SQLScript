CREATE PROCEDURE SP3S_DELETEupload_IRRmerge_TABLES
@nSpId VARCHAR(50),
@nSpIdCopy VARCHAR(50)
AS
BEGIN
	IF OBJECT_ID('TEMPDB..#T','U') IS NOT NULL
	    DROP TABLE #T
	SELECT sp_ID
	into #T
	FROM IRR_IRM01106_upload B (NOLOCK) WHERE sp_id=@nSpId OR sp_id=@nSpIdCopy
   


   --SELECT ' DELETE A FROM   '+NAME + ' A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id ' FROM SYS.TABLES WHERE NAME LIKE 'IRR%'
   --AND RIGHT(NAME,6)='UPLOAD'
  

	IF EXISTS (SELECT TOP 1 'U' FROM #T)
	BEGIN

	 DELETE A FROM   IRR_ARTICLE_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_IRD01106_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_IRM01106_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA1_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA2_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA3_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA4_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA5_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PARA6_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_PMT01106_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_SECTIOND_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_SECTIONM_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_SKU_OH_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
	 DELETE A FROM   IRR_SKU_UPLOAD A  WITH (ROWLOCK) join #t  B ON  A.sp_ID=B.sp_id 
 
END	 


END