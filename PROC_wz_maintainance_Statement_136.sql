

IF EXISTS (SELECT * FROM SYS.COLUMNS A JOIN SYS.OBJECTS B ON A.OBJECT_ID=B.OBJECT_ID 
           WHERE  B.NAME='HSN_MST' AND A.NAME IN ('TAX_PERCENTAGE','RATE_CUTOFF',
           'RATE_CUTOFF_TAX_PERCENTAGE','WEF')) 
BEGIN
   IF NOT EXISTS (SELECT TOP 1 'U' FROM HSN_DET)
BEGIN

DECLARE @DTSQL NVARCHAR(MAX)
SET @DTSQL=N' INSERT HSN_DET	( HSN_CODE, TAX_PERCENTAGE, RATE_CUTOFF, RATE_CUTOFF_TAX_PERCENTAGE, WEF,ROW_ID  )  
 SELECT 	  A.HSN_CODE, A.TAX_PERCENTAGE, A.RATE_CUTOFF, A.RATE_CUTOFF_TAX_PERCENTAGE, A.WEF ,NEWID()
 FROM HSN_MST A
 LEFT OUTER JOIN HSN_DET B ON A.HSN_CODE =B.HSN_CODE 
 WHERE B.HSN_CODE IS NULL'
 EXEC SP_EXECUTESQL @DTSQL
END
END


