CREATE PROCEDURE SP3S_ATTRIBUTES
(
	@nQueryID		INT,
	@nAttr_No		VARCHAR(50),
	@cWhere			NVARCHAR(MAX)=''
)
AS
BEGIN
	IF @nQueryID=1
	BEGIN
		SELECT UPPER(TABLE_NAME) AS TABLE_NAME,
		UPPER((CASE WHEN ISNULL(TABLE_CAPTION,'')<>'' THEN ISNULL(TABLE_CAPTION,'') ELSE REPLACE(TABLE_NAME,'_MST','') END)) AS TABLE_CAPTION 
		,OPEN_KEY,CAST(NEWID() AS VARCHAR(100)) AS ROW_ID
		FROM CONFIG_ATTR (NOLOCK)
		WHERE ISNULL(TABLE_CAPTION,'')<>''
		ORDER BY CAST(REPLACE(REPLACE(TABLE_NAME,'ATTR',''),'_MST','') AS INT) 
	END
	ELSE IF @nQueryID=2
	BEGIN
		SELECT 'ATTR1_MST'AS TABLE_NAME,attr1_key_name AS KEY_NAME,attr1_key_code AS KEY_CODE ,attr1_alias AS KEY_ALIAS,ISNULL(attr1_inactive,0) AS INACTIVE  
		FROM ATTR1_MST (NOLOCK) WHERE ISNULL(ATTR1_KEY_NAME,'')<>'' AND 'ATTR1_MST'=@nAttr_No
		UNION
		SELECT 'ATTR2_MST'AS TABLE_NAME,attr2_key_name AS KEY_NAME,attr2_key_code AS KEY_CODE  ,attr2_alias AS KEY_ALIAS,attr2_inactive AS INACTIVE  
		FROM ATTR2_MST (NOLOCK) WHERE ISNULL(ATTR2_KEY_NAME,'')<>'' AND  'ATTR2_MST'=@nAttr_No
		UNION
		SELECT 'ATTR3_MST'AS TABLE_NAME,attr3_key_name AS KEY_NAME,attr3_key_code AS KEY_CODE  ,attr3_alias AS KEY_ALIAS,attr3_inactive AS INACTIVE  
		FROM ATTR3_MST  (NOLOCK) WHERE ISNULL(ATTR3_KEY_NAME,'')<>'' AND  'ATTR3_MST'=@nAttr_No
		UNION
		SELECT 'ATTR4_MST'AS TABLE_NAME,attr4_key_name AS KEY_NAME,attr4_key_code AS KEY_CODE  ,attr4_alias AS KEY_ALIAS,attr4_inactive AS INACTIVE  
		FROM ATTR4_MST  (NOLOCK) WHERE ISNULL(ATTR4_KEY_NAME,'')<>'' AND  'ATTR4_MST'=@nAttr_No
		UNION
		SELECT 'ATTR5_MST'AS TABLE_NAME,attr5_key_name AS KEY_NAME,attr5_key_code AS KEY_CODE  ,attr5_alias AS KEY_ALIAS,attr5_inactive AS INACTIVE  
		FROM ATTR5_MST  (NOLOCK) WHERE ISNULL(ATTR5_KEY_NAME,'')<>'' AND  'ATTR5_MST'=@nAttr_No
		UNION
		SELECT 'ATTR6_MST'AS TABLE_NAME,attr6_key_name AS KEY_NAME,attr6_key_code AS KEY_CODE  ,attr6_alias AS KEY_ALIAS,attr6_inactive AS INACTIVE  
		FROM ATTR6_MST  (NOLOCK) WHERE ISNULL(ATTR6_KEY_NAME,'')<>'' AND  'ATTR6_MST'=@nAttr_No
		UNION
		SELECT 'ATTR7_MST'AS TABLE_NAME,attr7_key_name AS KEY_NAME,attr7_key_code AS KEY_CODE  ,attr7_alias AS KEY_ALIAS,attr7_inactive AS INACTIVE  
		FROM ATTR7_MST  (NOLOCK) WHERE ISNULL(ATTR7_KEY_NAME,'')<>'' AND  'ATTR7_MST'=@nAttr_No
		UNION
		SELECT 'ATTR8_MST'AS TABLE_NAME,attr8_key_name AS KEY_NAME,attr8_key_code AS KEY_CODE  ,attr8_alias AS KEY_ALIAS,attr8_inactive AS INACTIVE  
		FROM ATTR8_MST  (NOLOCK) WHERE ISNULL(ATTR8_KEY_NAME,'')<>'' AND  'ATTR8_MST'=@nAttr_No
		UNION
		SELECT 'ATTR9_MST'AS TABLE_NAME,attr9_key_name AS KEY_NAME,attr9_key_code AS KEY_CODE  ,attr9_alias AS KEY_ALIAS,attr9_inactive AS INACTIVE  
		FROM ATTR9_MST  (NOLOCK) WHERE ISNULL(ATTR9_KEY_NAME,'')<>'' AND  'ATTR9_MST'=@nAttr_No
		UNION
		SELECT 'ATTR10_MST'AS TABLE_NAME,attr10_key_name AS KEY_NAME,attr10_key_code AS KEY_CODE  ,attr10_alias AS KEY_ALIAS,attr10_inactive AS INACTIVE  
		FROM ATTR10_MST  (NOLOCK) WHERE ISNULL(ATTR10_KEY_NAME,'')<>'' AND  'ATTR10_MST'=@nAttr_No
		UNION
		SELECT 'ATTR11_MST'AS TABLE_NAME,attr11_key_name AS KEY_NAME,attr11_key_code AS KEY_CODE  ,attr11_alias AS KEY_ALIAS,attr11_inactive AS INACTIVE  
		FROM ATTR11_MST  (NOLOCK) WHERE ISNULL(ATTR11_KEY_NAME,'')<>'' AND  'ATTR11_MST'=@nAttr_No
		UNION
		SELECT 'ATTR12_MST'AS TABLE_NAME,attr12_key_name AS KEY_NAME,attr12_key_code AS KEY_CODE  ,attr12_alias AS KEY_ALIAS,attr12_inactive AS INACTIVE 
		FROM ATTR12_MST  (NOLOCK) WHERE ISNULL(ATTR12_KEY_NAME,'')<>'' AND  'ATTR12_MST'=@nAttr_No
		UNION
		SELECT 'ATTR13_MST'AS TABLE_NAME,attr13_key_name AS KEY_NAME,attr13_key_code AS KEY_CODE  , attr13_alias AS KEY_ALIAS,attr13_inactive AS INACTIVE  
		FROM ATTR13_MST  (NOLOCK) WHERE ISNULL(ATTR13_KEY_NAME,'')<>'' AND  'ATTR13_MST'=@nAttr_No
		UNION
		SELECT 'ATTR14_MST'AS TABLE_NAME,attr14_key_name AS KEY_NAME,attr14_key_code AS KEY_CODE  ,attr14_alias AS KEY_ALIAS,attr14_inactive AS INACTIVE  
		FROM ATTR14_MST  (NOLOCK) WHERE ISNULL(ATTR14_KEY_NAME,'')<>'' AND  'ATTR14_MST'=@nAttr_No
		UNION
		SELECT 'ATTR15_MST'AS TABLE_NAME,attr15_key_name AS KEY_NAME,attr15_key_code AS KEY_CODE  ,attr15_alias AS KEY_ALIAS,attr15_inactive AS INACTIVE  
		FROM ATTR15_MST  (NOLOCK) WHERE ISNULL(ATTR15_KEY_NAME,'')<>'' AND  'ATTR15_MST'=@nAttr_No
		UNION
		SELECT 'ATTR16_MST'AS TABLE_NAME,attr16_key_name AS KEY_NAME,attr16_key_code AS KEY_CODE  ,  attr16_alias AS KEY_ALIAS,attr16_inactive AS INACTIVE  
		FROM ATTR16_MST  (NOLOCK) WHERE ISNULL(ATTR16_KEY_NAME,'')<>'' AND  'ATTR16_MST'=@nAttr_No
		UNION
		SELECT 'ATTR17_MST'AS TABLE_NAME,attr17_key_name AS KEY_NAME,attr17_key_code AS KEY_CODE  ,attr17_alias AS KEY_ALIAS,attr17_inactive AS INACTIVE
		FROM ATTR17_MST  (NOLOCK) WHERE ISNULL(ATTR17_KEY_NAME,'')<>'' AND  'ATTR17_MST'=@nAttr_No
		UNION
		SELECT 'ATTR18_MST'AS TABLE_NAME,attr18_key_name AS KEY_NAME,attr18_key_code AS KEY_CODE  ,  attr18_alias AS KEY_ALIAS,attr18_inactive AS INACTIVE 
		FROM ATTR18_MST  (NOLOCK) WHERE ISNULL(ATTR18_KEY_NAME,'')<>'' AND  'ATTR18_MST'=@nAttr_No
		UNION
		SELECT 'ATTR19_MST'AS TABLE_NAME,attr19_key_name AS KEY_NAME,attr19_key_code AS KEY_CODE  , attr19_alias AS KEY_ALIAS,attr19_inactive AS INACTIVE
		FROM ATTR19_MST  (NOLOCK) WHERE ISNULL(ATTR19_KEY_NAME,'')<>'' AND  'ATTR19_MST'=@nAttr_No
		UNION
		SELECT 'ATTR20_MST'AS TABLE_NAME,attr20_key_name AS KEY_NAME,attr20_key_code AS KEY_CODE  ,  attr20_alias AS KEY_ALIAS,attr20_inactive AS INACTIVE  
		FROM ATTR20_MST  (NOLOCK) WHERE ISNULL(ATTR20_KEY_NAME,'')<>'' AND  'ATTR20_MST'=@nAttr_No
		UNION
		SELECT 'ATTR21_MST'AS TABLE_NAME,attr21_key_name AS KEY_NAME,attr21_key_code AS KEY_CODE  ,attr21_alias AS KEY_ALIAS,attr21_inactive AS INACTIVE 
		FROM ATTR21_MST  (NOLOCK) WHERE ISNULL(ATTR21_KEY_NAME,'')<>'' AND  'ATTR21_MST'=@nAttr_No
		UNION
		SELECT 'ATTR22_MST'AS TABLE_NAME,attr22_key_name AS KEY_NAME,attr22_key_code AS KEY_CODE , attr22_alias AS KEY_ALIAS,attr22_inactive AS INACTIVE 
		FROM ATTR22_MST  (NOLOCK) WHERE ISNULL(ATTR22_KEY_NAME,'')<>'' AND  'ATTR22_MST'=@nAttr_No
		UNION
		SELECT 'ATTR23_MST'AS TABLE_NAME,attr23_key_name AS KEY_NAME,attr23_key_code AS KEY_CODE ,attr23_alias AS KEY_ALIAS,attr23_inactive AS INACTIVE  
		FROM ATTR23_MST  (NOLOCK) WHERE ISNULL(ATTR23_KEY_NAME,'')<>'' AND  'ATTR23_MST'=@nAttr_No
		UNION
		SELECT 'ATTR24_MST'AS TABLE_NAME,attr24_key_name AS KEY_NAME,attr24_key_code AS KEY_CODE ,attr24_alias AS KEY_ALIAS,attr24_inactive AS INACTIVE  
		FROM ATTR24_MST  (NOLOCK) WHERE ISNULL(ATTR24_KEY_NAME,'')<>'' AND  'ATTR24_MST'=@nAttr_No
		UNION
		SELECT 'ATTR25_MST'AS TABLE_NAME,attr25_key_name AS KEY_NAME,attr25_key_code AS KEY_CODE ,attr25_alias AS KEY_ALIAS,attr25_inactive AS INACTIVE  
		FROM ATTR25_MST  (NOLOCK) WHERE ISNULL(ATTR25_KEY_NAME,'')<>'' AND  'ATTR25_MST'=@nAttr_No
	END
	ELSE IF @nQueryID=3
	BEGIN
		SELECT CAST((CASE WHEN ISNULL(TABLE_CAPTION,'')<>'' THEN 1 ELSE 0 END) AS BIT) AS CHK, UPPER(TABLE_NAME) AS CONFIG_OPTION,
		UPPER((CASE WHEN ISNULL(TABLE_CAPTION,'')<>'' THEN ISNULL(TABLE_CAPTION,'') ELSE '' END)) AS VALUE,NEWID() ROW_ID, 
		GETDATE() last_update,'' dept_id,'' REMARKS,'Attribute'+LTRIM(RTRIM(REPLACE(REPLACE(TABLE_NAME,'ATTR',''),'_MST',''))) AS Attr_Name
		FROM CONFIG_ATTR (NOLOCK)
		ORDER BY CAST(REPLACE(REPLACE(TABLE_NAME,'ATTR',''),'_MST','') AS INT) 
	END
	ELSE IF @nQueryID=4
	BEGIN  
		SELECT A.*
		,A1.ATTR1_KEY_NAME,A2.ATTR2_KEY_NAME,A3.ATTR3_KEY_NAME,A4.ATTR4_KEY_NAME,A5.ATTR5_KEY_NAME
		,A6.ATTR6_KEY_NAME,A7.ATTR7_KEY_NAME,A8.ATTR8_KEY_NAME,A9.ATTR9_KEY_NAME,A10.ATTR10_KEY_NAME
		,A11.ATTR11_KEY_NAME,A12.ATTR12_KEY_NAME,A13.ATTR13_KEY_NAME,A14.ATTR14_KEY_NAME,A15.ATTR15_KEY_NAME
		,A16.ATTR16_KEY_NAME,A17.ATTR17_KEY_NAME,A18.ATTR18_KEY_NAME,A19.ATTR19_KEY_NAME,A20.ATTR20_KEY_NAME
		,A21.ATTR21_KEY_NAME,A22.ATTR22_KEY_NAME,A23.ATTR23_KEY_NAME,A24.ATTR24_KEY_NAME,A25.ATTR25_KEY_NAME
		FROM ARTICLE_FIX_ATTR A (NOLOCK)
		JOIN attr1_mst A1 (NOLOCK) ON A1.attr1_key_code=A.attr1_key_code
		JOIN attr2_mst A2 (NOLOCK) ON A2.attr2_key_code=A.attr2_key_code
		JOIN attr3_mst A3 (NOLOCK) ON A3.attr3_key_code=A.attr3_key_code
		JOIN attr4_mst A4 (NOLOCK) ON A4.attr4_key_code=A.attr4_key_code
		JOIN attr5_mst A5 (NOLOCK) ON A5.attr5_key_code=A.attr5_key_code
		JOIN attr6_mst A6 (NOLOCK) ON A6.attr6_key_code=A.attr6_key_code
		JOIN attr7_mst A7 (NOLOCK) ON A7.attr7_key_code=A.attr7_key_code
		JOIN attr8_mst A8 (NOLOCK) ON A8.attr8_key_code=A.attr8_key_code
		JOIN attr9_mst A9 (NOLOCK) ON A9.attr9_key_code=A.attr9_key_code
		JOIN attr10_mst A10 (NOLOCK) ON A10.attr10_key_code=A.attr10_key_code
		JOIN attr11_mst A11 (NOLOCK) ON A11.attr11_key_code=A.attr11_key_code
		JOIN attr12_mst A12 (NOLOCK) ON A12.attr12_key_code=A.attr12_key_code
		JOIN attr13_mst A13 (NOLOCK) ON A13.attr13_key_code=A.attr13_key_code
		JOIN attr14_mst A14 (NOLOCK) ON A14.attr14_key_code=A.attr14_key_code
		JOIN attr15_mst A15 (NOLOCK) ON A15.attr15_key_code=A.attr15_key_code
		JOIN attr16_mst A16 (NOLOCK) ON A16.attr16_key_code=A.attr16_key_code
		JOIN attr17_mst A17 (NOLOCK) ON A17.attr17_key_code=A.attr17_key_code
		JOIN attr18_mst A18 (NOLOCK) ON A18.attr18_key_code=A.attr18_key_code
		JOIN attr19_mst A19 (NOLOCK) ON A19.attr19_key_code=A.attr19_key_code
		JOIN attr20_mst A20 (NOLOCK) ON A20.attr20_key_code=A.attr20_key_code
		JOIN attr21_mst A21 (NOLOCK) ON A21.attr21_key_code=A.attr21_key_code
		JOIN attr22_mst A22 (NOLOCK) ON A22.attr22_key_code=A.attr22_key_code
		JOIN attr23_mst A23 (NOLOCK) ON A23.attr23_key_code=A.attr23_key_code
		JOIN attr24_mst A24 (NOLOCK) ON A24.attr24_key_code=A.attr24_key_code
		JOIN attr25_mst A25 (NOLOCK) ON A25.attr25_key_code=A.attr25_key_code  
		WHERE A.article_code=@nAttr_No           
	END    
	ELSE IF @nQueryID=5
	BEGIN
		DECLARE @cCMD NVARCHAR(MAX)
		SET @cCMD=N'SELECT CAST(ISNULL('+@nAttr_No+',0) AS BIT) as [chk],B.SUB_SECTION_CODE,C.SECTION_CODE, c.section_name,b.sub_section_name,a.*
		FROM SECTIOND B(NOLOCK) 
		JOIN SECTIONM C(NOLOCK) ON B.SECTION_CODE=C.SECTION_CODE
		LEFT OUTER JOIN SD_ATTR_AVATAR A (NOLOCK) ON B.SUB_SECTION_CODE=A.SUB_SECTION_CODE
		WHERE B.SUB_SECTION_NAME<>'''' AND B.INACTIVE=0
		ORDER BY ISNULL('+@nAttr_No+',0) DESC'
		PRINT @cCMD
		EXEC SP_EXECUTESQL @cCMD
	END		
	ELSE IF @nQueryID=6
	BEGIN
		SELECT TOP 1 UPPER(TABLE_NAME) AS TABLE_NAME,
		UPPER((CASE WHEN ISNULL(TABLE_CAPTION,'')<>'' THEN ISNULL(TABLE_CAPTION,'') ELSE REPLACE(TABLE_NAME,'_MST','') END)) AS TABLE_CAPTION 
		FROM CONFIG_ATTR (NOLOCK)
		WHERE ISNULL(TABLE_CAPTION,'')=''
		ORDER BY CAST(REPLACE(REPLACE(TABLE_NAME,'ATTR',''),'_MST','') AS INT) 
	END
	ELSE IF @nQueryID=7
	BEGIN
		SELECT * FROM 
		( 
		SELECT 'ATTR1_MST'AS TABLE_NAME,attr1_key_name AS KEY_NAME,attr1_key_code AS KEY_CODE 
		FROM ATTR1_MST (NOLOCK) WHERE  ATTR1_INACTIVE=0 AND ISNULL(ATTR1_KEY_NAME,'')<>'' AND  'ATTR1_MST'=@nAttr_No
		UNION
		SELECT 'ATTR2_MST'AS TABLE_NAME,attr2_key_name AS KEY_NAME,attr2_key_code AS KEY_CODE 
		FROM ATTR2_MST (NOLOCK) WHERE ATTR2_INACTIVE=0 AND ISNULL(ATTR2_KEY_NAME,'')<>'' AND  'ATTR2_MST'=@nAttr_No
		UNION
		SELECT 'ATTR3_MST'AS TABLE_NAME,attr3_key_name AS KEY_NAME,attr3_key_code AS KEY_CODE 
		FROM ATTR3_MST  (NOLOCK) WHERE ATTR3_INACTIVE=0 AND  ISNULL(ATTR3_KEY_NAME,'')<>'' AND  'ATTR3_MST'=@nAttr_No
		UNION
		SELECT 'ATTR4_MST'AS TABLE_NAME,attr4_key_name AS KEY_NAME,attr4_key_code AS KEY_CODE 
		FROM ATTR4_MST  (NOLOCK) WHERE ATTR4_INACTIVE=0 AND  ISNULL(ATTR4_KEY_NAME,'')<>'' AND  'ATTR4_MST'=@nAttr_No
		UNION
		SELECT 'ATTR5_MST'AS TABLE_NAME,attr5_key_name AS KEY_NAME,attr5_key_code AS KEY_CODE 
		FROM ATTR5_MST  (NOLOCK) WHERE ATTR5_INACTIVE=0 AND  ISNULL(ATTR5_KEY_NAME,'')<>'' AND  'ATTR5_MST'=@nAttr_No
		UNION
		SELECT 'ATTR6_MST'AS TABLE_NAME,attr6_key_name AS KEY_NAME,attr6_key_code AS KEY_CODE 
		FROM ATTR6_MST  (NOLOCK) WHERE ATTR6_INACTIVE=0 AND ISNULL(ATTR6_KEY_NAME,'')<>'' AND  'ATTR6_MST'=@nAttr_No
		UNION
		SELECT 'ATTR7_MST'AS TABLE_NAME,attr7_key_name AS KEY_NAME,attr7_key_code AS KEY_CODE 
		FROM ATTR7_MST  (NOLOCK) WHERE ATTR7_INACTIVE=0 AND ISNULL(ATTR7_KEY_NAME,'')<>'' AND  'ATTR7_MST'=@nAttr_No
		UNION
		SELECT 'ATTR8_MST'AS TABLE_NAME,attr8_key_name AS KEY_NAME,attr8_key_code AS KEY_CODE 
		FROM ATTR8_MST  (NOLOCK) WHERE ATTR8_INACTIVE=0 AND ISNULL(ATTR8_KEY_NAME,'')<>'' AND  'ATTR8_MST'=@nAttr_No
		UNION
		SELECT 'ATTR9_MST'AS TABLE_NAME,attr9_key_name AS KEY_NAME,attr9_key_code AS KEY_CODE 
		FROM ATTR9_MST  (NOLOCK) WHERE ATTR9_INACTIVE=0 AND ISNULL(ATTR9_KEY_NAME,'')<>'' AND  'ATTR9_MST'=@nAttr_No
		UNION
		SELECT 'ATTR10_MST'AS TABLE_NAME,attr10_key_name AS KEY_NAME,attr10_key_code AS KEY_CODE 
		FROM ATTR10_MST  (NOLOCK) WHERE ATTR10_INACTIVE=0 AND ISNULL(ATTR10_KEY_NAME,'')<>'' AND  'ATTR10_MST'=@nAttr_No
		UNION
		SELECT 'ATTR11_MST'AS TABLE_NAME,attr11_key_name AS KEY_NAME,attr11_key_code AS KEY_CODE 
		FROM ATTR11_MST  (NOLOCK) WHERE ATTR11_INACTIVE=0 AND ISNULL(ATTR11_KEY_NAME,'')<>'' AND  'ATTR11_MST'=@nAttr_No
		UNION
		SELECT 'ATTR12_MST'AS TABLE_NAME,attr12_key_name AS KEY_NAME,attr12_key_code AS KEY_CODE 
		FROM ATTR12_MST  (NOLOCK) WHERE ATTR12_INACTIVE=0 AND ISNULL(ATTR12_KEY_NAME,'')<>'' AND  'ATTR12_MST'=@nAttr_No
		UNION
		SELECT 'ATTR13_MST'AS TABLE_NAME,attr13_key_name AS KEY_NAME,attr13_key_code AS KEY_CODE 
		FROM ATTR13_MST  (NOLOCK) WHERE ATTR13_INACTIVE=0 AND ISNULL(ATTR13_KEY_NAME,'')<>'' AND  'ATTR13_MST'=@nAttr_No
		UNION
		SELECT 'ATTR14_MST'AS TABLE_NAME,attr14_key_name AS KEY_NAME,attr14_key_code AS KEY_CODE 
		FROM ATTR14_MST  (NOLOCK) WHERE ATTR14_INACTIVE=0 AND ISNULL(ATTR14_KEY_NAME,'')<>'' AND  'ATTR14_MST'=@nAttr_No
		UNION
		SELECT 'ATTR15_MST'AS TABLE_NAME,attr15_key_name AS KEY_NAME,attr15_key_code AS KEY_CODE 
		FROM ATTR15_MST  (NOLOCK) WHERE ATTR15_INACTIVE=0 AND ISNULL(ATTR15_KEY_NAME,'')<>'' AND  'ATTR15_MST'=@nAttr_No
		UNION
		SELECT 'ATTR16_MST'AS TABLE_NAME,attr16_key_name AS KEY_NAME,attr16_key_code AS KEY_CODE 
		FROM ATTR16_MST  (NOLOCK) WHERE ATTR16_INACTIVE=0 AND ISNULL(ATTR16_KEY_NAME,'')<>'' AND  'ATTR16_MST'=@nAttr_No
		UNION
		SELECT 'ATTR17_MST'AS TABLE_NAME,attr17_key_name AS KEY_NAME,attr17_key_code AS KEY_CODE 
		FROM ATTR17_MST  (NOLOCK) WHERE ISNULL(ATTR17_KEY_NAME,'')<>'' AND  'ATTR17_MST'=@nAttr_No
		UNION
		SELECT 'ATTR18_MST'AS TABLE_NAME,attr18_key_name AS KEY_NAME,attr18_key_code AS KEY_CODE 
		FROM ATTR18_MST  (NOLOCK) WHERE ATTR18_INACTIVE=0 AND ISNULL(ATTR18_KEY_NAME,'')<>'' AND  'ATTR18_MST'=@nAttr_No
		UNION
		SELECT 'ATTR19_MST'AS TABLE_NAME,attr19_key_name AS KEY_NAME,attr19_key_code AS KEY_CODE 
		FROM ATTR19_MST  (NOLOCK) WHERE ATTR19_INACTIVE=0 AND ISNULL(ATTR19_KEY_NAME,'')<>'' AND  'ATTR19_MST'=@nAttr_No
		UNION
		SELECT 'ATTR20_MST'AS TABLE_NAME,attr20_key_name AS KEY_NAME,attr20_key_code AS KEY_CODE 
		FROM ATTR20_MST  (NOLOCK) WHERE ATTR20_INACTIVE=0 AND ISNULL(ATTR20_KEY_NAME,'')<>'' AND  'ATTR20_MST'=@nAttr_No
		UNION
		SELECT 'ATTR21_MST'AS TABLE_NAME,attr21_key_name AS KEY_NAME,attr21_key_code AS KEY_CODE 
		FROM ATTR21_MST  (NOLOCK) WHERE ATTR21_INACTIVE=0 AND ISNULL(ATTR21_KEY_NAME,'')<>'' AND  'ATTR21_MST'=@nAttr_No
		UNION
		SELECT 'ATTR22_MST'AS TABLE_NAME,attr22_key_name AS KEY_NAME,attr22_key_code AS KEY_CODE 
		FROM ATTR22_MST  (NOLOCK) WHERE ATTR22_INACTIVE=0 AND ISNULL(ATTR22_KEY_NAME,'')<>'' AND  'ATTR22_MST'=@nAttr_No
		UNION
		SELECT 'ATTR23_MST'AS TABLE_NAME,attr23_key_name AS KEY_NAME,attr23_key_code AS KEY_CODE 
		FROM ATTR23_MST  (NOLOCK) WHERE ATTR23_INACTIVE=0 AND ISNULL(ATTR23_KEY_NAME,'')<>'' AND  'ATTR23_MST'=@nAttr_No
		UNION
		SELECT 'ATTR24_MST'AS TABLE_NAME,attr24_key_name AS KEY_NAME,attr24_key_code AS KEY_CODE 
		FROM ATTR24_MST  (NOLOCK) WHERE ATTR24_INACTIVE=0 AND ISNULL(ATTR24_KEY_NAME,'')<>'' AND  'ATTR24_MST'=@nAttr_No
		UNION
		SELECT 'ATTR25_MST'AS TABLE_NAME,attr25_key_name AS KEY_NAME,attr25_key_code AS KEY_CODE 
		FROM ATTR25_MST  (NOLOCK) WHERE ATTR25_INACTIVE=0 AND ISNULL(ATTR25_KEY_NAME,'')<>'' AND  'ATTR25_MST'=@nAttr_No
		)X
		WHERE X.KEY_NAME LIKE @cWhere
	END
	ELSE IF @nQueryID=8
	BEGIN
		SELECT C.SECTION_CODE, c.section_name,b.sub_section_name,a.*
		FROM SECTIOND B(NOLOCK) 
		JOIN SECTIONM C(NOLOCK) ON B.SECTION_CODE=C.SECTION_CODE
		JOIN SD_ATTR_AVATAR A (NOLOCK) ON B.SUB_SECTION_CODE=A.SUB_SECTION_CODE
		WHERE B.SUB_SECTION_CODE=@cWhere
		
	END		
END	

