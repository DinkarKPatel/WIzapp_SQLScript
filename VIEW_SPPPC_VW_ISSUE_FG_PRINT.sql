CREATE VIEW SPPPC_VW_ISSUE_FG_PRINT
AS
     
     SELECT    IM.MEMO_ID,
               IM.MEMO_NO,
               IM.MEMO_DT,
			   A.AC_CODE,LM.AC_NAME ,
			   IM.BILL_NO,
			   B.ARTICLE_CODE,ART.ARTICLE_NO,ART.ARTICLE_NAME,
			   B.SIZEGROUP_CODE,SG.SIZEGROUP_NAME ,
			   B.PARA1_CODE,P1.PARA1_NAME AS COLOR,
			   B.PARA3_CODE,P3.PARA3_NAME ,
			   JOBS.JOB_CODE,
			   JOBS.JOB_NAME,
			   SUM(CASE WHEN PARA2_NAME='0' THEN ID.QUANTITY ELSE 0 END) AS [N0],
			   SUM(CASE WHEN PARA2_NAME='1' THEN ID.QUANTITY ELSE 0 END) AS [N1],
			   SUM(CASE WHEN PARA2_NAME='2' THEN ID.QUANTITY ELSE 0 END) AS [N2],
			   SUM(CASE WHEN PARA2_NAME='3' THEN ID.QUANTITY ELSE 0 END) AS [N3],
			   SUM(CASE WHEN PARA2_NAME='4' THEN ID.QUANTITY ELSE 0 END) AS [N4],
			   SUM(CASE WHEN PARA2_NAME='5' THEN ID.QUANTITY ELSE 0 END) AS [N5],
			   SUM(CASE WHEN PARA2_NAME='6' THEN ID.QUANTITY ELSE 0 END) AS [N6],
			   SUM(CASE WHEN PARA2_NAME='7' THEN ID.QUANTITY ELSE 0 END) AS [N7],
			   SUM(CASE WHEN PARA2_NAME='8' THEN ID.QUANTITY ELSE 0 END) AS [N8],
			   SUM(CASE WHEN PARA2_NAME='9' THEN ID.QUANTITY ELSE 0 END) AS [N9],
			   SUM(CASE WHEN PARA2_NAME='10' THEN ID.QUANTITY ELSE 0 END) AS [N10],
			   SUM(CASE WHEN PARA2_NAME='11' THEN ID.QUANTITY ELSE 0 END) AS [N11],
			   SUM(CASE WHEN PARA2_NAME='12' THEN ID.QUANTITY ELSE 0 END) AS [N12],
			   SUM(CASE WHEN PARA2_NAME='13' THEN ID.QUANTITY ELSE 0 END) AS [N13],
			   SUM(CASE WHEN PARA2_NAME='14' THEN ID.QUANTITY ELSE 0 END) AS [N14],
			   SUM(CASE WHEN PARA2_NAME='15' THEN ID.QUANTITY ELSE 0 END) AS [N15],
			   SUM(CASE WHEN PARA2_NAME='16' THEN ID.QUANTITY ELSE 0 END) AS [N16],
			   SUM(CASE WHEN PARA2_NAME='17' THEN ID.QUANTITY ELSE 0 END) AS [N17],
			   SUM(CASE WHEN PARA2_NAME='18' THEN ID.QUANTITY ELSE 0 END) AS [N18],
			   SUM(CASE WHEN PARA2_NAME='19' THEN ID.QUANTITY ELSE 0 END) AS [N19],
			   SUM(CASE WHEN PARA2_NAME='20' THEN ID.QUANTITY ELSE 0 END) AS [N20],
			   SUM(CASE WHEN PARA2_NAME='21' THEN ID.QUANTITY ELSE 0 END) AS [N21],
			   SUM(CASE WHEN PARA2_NAME='22' THEN ID.QUANTITY ELSE 0 END) AS [N22],
			   SUM(CASE WHEN PARA2_NAME='23' THEN ID.QUANTITY ELSE 0 END) AS [N23],
			   SUM(CASE WHEN PARA2_NAME='24' THEN ID.QUANTITY ELSE 0 END) AS [N24],
			   SUM(CASE WHEN PARA2_NAME='25' THEN ID.QUANTITY ELSE 0 END) AS [N25],
			   SUM(CASE WHEN PARA2_NAME='S' THEN ID.QUANTITY ELSE 0 END) AS [S],
			   SUM(CASE WHEN PARA2_NAME='M' THEN ID.QUANTITY ELSE 0 END) AS [M],
			   SUM(CASE WHEN PARA2_NAME='L' THEN ID.QUANTITY ELSE 0 END) AS [L],
			   SUM(CASE WHEN PARA2_NAME='XL' THEN ID.QUANTITY ELSE 0 END) AS [XL],
			   SUM(CASE WHEN PARA2_NAME='XXL' THEN ID.QUANTITY ELSE 0 END) AS [XXL],
			   SUM(CASE WHEN PARA2_NAME='XXXL' THEN ID.QUANTITY ELSE 0 END) AS [XXXL],
			   SUM(CASE WHEN PARA2_NAME='XS' THEN ID.QUANTITY ELSE 0 END) AS [XS]
		  FROM PPC_FGBCG_MST A
		  JOIN PPC_FGBCG_DET B ON A.MEMO_ID =B.MEMO_ID 
		  JOIN PPC_FG_SKU SKU ON SKU.PPC_FGBCG_DET_ROW_ID=B.ROW_ID 
		  JOIN PPC_FG_PMT PMT ON PMT.PRODUCT_CODE=SKU.PRODUCT_CODE 
		  JOIN ARTICLE ART ON ART.ARTICLE_CODE =SKU.ARTICLE_CODE 
		  JOIN PARA1 P1 ON P1.PARA1_CODE =SKU.PARA1_CODE 
		  JOIN PARA2 P2 ON P2.PARA2_CODE =SKU.PARA2_CODE 
		  JOIN PARA3 P3 ON P3.PARA3_CODE =SKU.PARA3_CODE 
		  JOIN PPC_SIZEGROUP SG ON SG.SIZEGROUP_CODE =SKU.SIZEGROUP_CODE 
		  JOIN LM01106 LM ON LM.AC_CODE =A.AC_CODE 
		  JOIN PPC_AGENCY_ISSUE_FG_FIRST_DET ID ON ID.PRODUCT_CODE=PMT.PRODUCT_CODE
		  JOIN PPC_AGENCY_ISSUE_FG_FIRST_MST IM ON ID.MEMO_ID=IM.MEMO_ID
		  JOIN JOBS ON JOBS.JOB_CODE=IM.JOB_CODE 
		  WHERE A.CANCELLED=0 AND IM.CANCELLED=0
		  --WHERE IM.MEMO_ID='01011170000001FI000008'
		  GROUP BY IM.MEMO_ID,
               IM.MEMO_NO,
               IM.MEMO_DT,
			   A.AC_CODE,LM.AC_NAME ,
			   IM.BILL_NO,
			   B.ARTICLE_CODE,ART.ARTICLE_NO,ART.ARTICLE_NAME,
			   B.SIZEGROUP_CODE,SG.SIZEGROUP_NAME ,
			   B.PARA1_CODE,P1.PARA1_NAME ,
			   B.PARA3_CODE,P3.PARA3_NAME ,
			   JOBS.JOB_CODE,
			   JOBS.JOB_NAME
