CREATE FUNCTION FN3S_GETDBCONFIG(@OPTION VARCHAR(100))
RETURNS VARCHAR(100)
--WITH ENCRYPTION
AS
BEGIN
	DECLARE @VALUE VARCHAR(100)
	
	IF @OPTION='RUN_DATE'
		SELECT TOP 1 @VALUE=dbo.fn_getlastrundate()
	ELSE IF @OPTION='DIV_FACTOR'
	BEGIN
		SELECT TOP 1 @VALUE=LTRIM(RTRIM(ISNULL(VALUE,1))) 
		FROM CONFIG WHERE  CONFIG_OPTION='POS_DIV_FACTOR'  		  	
	
		IF @VALUE=1
			SET @VALUE=1
		IF @VALUE=2
			SET @VALUE=100
		IF @VALUE=3
			SET @VALUE=1000
		IF @VALUE=4
			SET @VALUE=100000			  
			
		SELECT @VALUE=ISNULL(@VALUE,1)  
		
	END
	ELSE IF @OPTION='MGMT_DIV_FACTOR'
	BEGIN
		SELECT TOP 1 @VALUE=LTRIM(RTRIM(ISNULL(VALUE,1))) 
		FROM CONFIG WHERE  CONFIG_OPTION='DIV_FACTOR'  		  	
			
		SELECT @VALUE=ISNULL(@VALUE,1)  
		
		IF @VALUE=0
			SET @VALUE=1 
		
	END
	ELSE IF @OPTION='AGE1'
	BEGIN
		SELECT @VALUE=VALUE FROM CONFIG WHERE CONFIG_OPTION='AGEING_1'
		IF ISNULL(@VALUE,'0')='0'
			SET @VALUE=30
	END
	ELSE IF @OPTION='AGE2'
	BEGIN
		SELECT @VALUE=VALUE FROM CONFIG WHERE CONFIG_OPTION='AGEING_2'
		IF ISNULL(@VALUE,'0')='0'
			SET @VALUE=60
	END
	ELSE IF @OPTION='AGE3'
	BEGIN
		SELECT @VALUE=VALUE FROM CONFIG WHERE CONFIG_OPTION='AGEING_3'
		IF ISNULL(@VALUE,'0')='0'
			SET @VALUE=90
	END
	
RETURN @VALUE		
END	
---END OF FUNCTION : FN3S_GETDBCONFIG
