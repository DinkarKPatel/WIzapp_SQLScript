
create PROCEDURE SP3S_VALIDATE_PARAS
(
@CERRORMSG VARCHAR(MAX) OUTPUT
)
AS
BEGIN
      DECLARE @CSTEP VARCHAR(10)
	  BEGIN TRY
	  SET @CSTEP=10

	

	  DECLARE @CPARA1_CAPTION VARCHAR(50),@CPARA2_CAPTION VARCHAR(50),@CPARA3_CAPTION VARCHAR(50),@CPARA4_CAPTION VARCHAR(50),@CPARA5_CAPTION VARCHAR(50),@CPARA6_CAPTION VARCHAR(50)

	  DECLARE   @TBLERROR TABLE (SR INT,PARANAME VARCHAR(100),PARAVALUE VARCHAR(100),ERRMSG VARCHAR(MAX))


	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA1 P1 (NOLOCK) ON P1.PARA1_NAME =A.PARA1_NAME AND P1.INACTIVE =0
	   WHERE P1.PARA1_NAME IS NULL)
	   BEGIN
	          
	           SET @CERRORMSG=' COLOR NOT FOUND PLEASE CHECK'

			   SELECT @CPARA1_CAPTION=VALUE  FROM config WHERE config_option ='PARA1_CAPTION'
			   if isnull(@CPARA1_CAPTION,'')=''
			   SET @CPARA1_CAPTION='PARA1 NAME'

			   INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
			   SELECT DISTINCT 1 AS SR, @CPARA1_CAPTION AS PARANAME, A.PARA1_NAME ,
			   @CPARA1_CAPTION+CASE WHEN P11.PARA1_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
			   FROM #TMPMASTERSENC A (NOLOCK)
			   LEFT JOIN PARA1 P1 (NOLOCK) ON P1.PARA1_NAME =A.PARA1_NAME AND P1.INACTIVE =0
			   LEFT JOIN PARA1 P11 (NOLOCK) ON P11.PARA1_NAME =A.PARA1_NAME AND P11.INACTIVE =1
			   WHERE P1.PARA1_NAME IS NULL
	      
		
	   END





	    SET @CSTEP=20

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA2 P2 (NOLOCK) ON P2.PARA2_NAME =A.PARA2_NAME AND P2.INACTIVE =0
	   WHERE P2.PARA2_NAME IS NULL)
	   BEGIN
	         SET @CERRORMSG=' SIZE NOT FOUND PLEASE CHECK'
			 
			 
			   SELECT @CPARA2_CAPTION=VALUE  FROM config WHERE config_option ='PARA2_CAPTION'

			    if isnull(@CPARA2_CAPTION,'')=''
			   SET @CPARA2_CAPTION='PARA2 NAME'


			   INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
			   SELECT DISTINCT  2 AS SR, @CPARA2_CAPTION AS PARANAME, A.PARA2_NAME ,
			   @CPARA2_CAPTION+CASE WHEN P21.PARA2_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
			   FROM #TMPMASTERSENC A (NOLOCK)
			   LEFT JOIN PARA2 P2 (NOLOCK) ON P2.PARA2_NAME =A.PARA2_NAME AND P2.INACTIVE =0
			   LEFT JOIN PARA2 P21 (NOLOCK) ON P21.PARA2_NAME =A.PARA2_NAME AND P21.INACTIVE =1
			   WHERE P2.PARA2_NAME IS NULL

	   END

	   SET @CSTEP=30

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA3 P3 (NOLOCK) ON P3.PARA3_NAME =A.PARA3_NAME AND P3.INACTIVE =0
	   WHERE P3.PARA3_NAME IS NULL)
	   BEGIN
	       SET @CERRORMSG=' PARA3 NOT FOUND PLEASE CHECK'

		   SELECT @CPARA3_CAPTION=VALUE  FROM config WHERE config_option ='PARA3_CAPTION'

		     if isnull(@CPARA3_CAPTION,'')=''
			    SET @CPARA3_CAPTION='PARA3 NAME'


	        INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
		   SELECT DISTINCT  3 AS SR, @CPARA3_CAPTION AS PARANAME, A.PARA3_NAME ,
		   @CPARA3_CAPTION+CASE WHEN P31.PARA3_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
		   FROM #TMPMASTERSENC A (NOLOCK)
		   LEFT JOIN PARA3 P3 (NOLOCK) ON P3.PARA3_NAME =A.PARA3_NAME AND P3.INACTIVE =0
		   LEFT JOIN PARA3 P31 (NOLOCK) ON P31.PARA3_NAME =A.PARA3_NAME AND P31.INACTIVE =1
		   WHERE P3.PARA3_NAME IS NULL
	   END

	   SET @CSTEP=40

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA4 P4 (NOLOCK) ON P4.PARA4_NAME =A.PARA4_NAME AND P4.INACTIVE =0
	   WHERE P4.PARA4_NAME IS NULL)
	   BEGIN
	       SET @CERRORMSG=' PARA4 NOT FOUND PLEASE CHECK'

		   
		   SELECT @CPARA4_CAPTION=VALUE  FROM config WHERE config_option ='PARA4_CAPTION'

		    if isnull(@CPARA4_CAPTION,'')=''
			    SET @CPARA4_CAPTION='PARA4 NAME'

		    INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
		   SELECT DISTINCT  4 AS SR, @CPARA4_CAPTION AS PARANAME, A.PARA4_NAME ,
		   @CPARA4_CAPTION+CASE WHEN P41.PARA4_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
		   FROM #TMPMASTERSENC A (NOLOCK)
		   LEFT JOIN PARA4 P4 (NOLOCK) ON P4.PARA4_NAME =A.PARA4_NAME AND P4.INACTIVE =0
		   LEFT JOIN PARA4 P41 (NOLOCK) ON P41.PARA4_NAME =A.PARA4_NAME AND P41.INACTIVE =1
		   WHERE P4.PARA4_NAME IS NULL

		   
	   END

	   SET @CSTEP=50

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA5 P5 (NOLOCK) ON P5.PARA5_NAME =A.PARA5_NAME AND P5.INACTIVE =0
	   WHERE P5.PARA5_NAME IS NULL)
	   BEGIN
	       SET @CERRORMSG=' PARA5 NOT FOUND PLEASE CHECK'

		   SELECT @CPARA5_CAPTION=VALUE  FROM config WHERE config_option ='PARA5_CAPTION'

		   if isnull(@CPARA5_CAPTION,'')=''
			    SET @CPARA5_CAPTION='PARA5 NAME'

		   
		   INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
		   SELECT DISTINCT  5 AS SR, @CPARA5_CAPTION AS PARANAME, A.PARA5_NAME ,
		   @CPARA5_CAPTION+CASE WHEN p51.PARA5_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
		   FROM #TMPMASTERSENC A (NOLOCK)
		   LEFT JOIN PARA5 P5 (NOLOCK) ON P5.PARA5_NAME =A.PARA5_NAME AND P5.INACTIVE =0
		   LEFT JOIN PARA5 P51 (NOLOCK) ON P51.PARA5_NAME =A.PARA5_NAME AND P51.INACTIVE =1
		   WHERE P5.PARA5_NAME IS NULL
	   END

	   SET @CSTEP=60

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN PARA6 P6 (NOLOCK) ON P6.PARA6_NAME =A.PARA6_NAME AND P6.INACTIVE =0
	   WHERE P6.PARA6_NAME IS NULL)
	   BEGIN
	       SET @CERRORMSG=' PARA6 NOT FOUND PLEASE CHECK'

		   SELECT @CPARA6_CAPTION=VALUE  FROM config WHERE config_option ='PARA6_CAPTION'

		      if isnull(@CPARA6_CAPTION,'')=''
			    SET @CPARA6_CAPTION='PARA5 NAME'
		  
		   
		   INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
		   SELECT DISTINCT  6 AS SR, @CPARA6_CAPTION AS PARANAME, A.PARA6_NAME ,
		   @CPARA6_CAPTION+CASE WHEN p61.PARA6_NAME IS NOT NULL THEN ' Inactive found' ELSE  ' not found' END  AS ERRMSG
		   FROM #TMPMASTERSENC A (NOLOCK)
		   LEFT JOIN PARA6 P6 (NOLOCK) ON P6.PARA6_NAME =A.PARA6_NAME AND P6.INACTIVE =0
		   LEFT JOIN PARA6 P61 (NOLOCK) ON P61.PARA6_NAME =A.PARA6_NAME AND P61.INACTIVE =0
		   WHERE P6.PARA6_NAME IS NULL

	   END

	   IF EXISTS (SELECT TOP 1 'U'  FROM #TMPMASTERSENC A (NOLOCK)
	   LEFT JOIN ARTICLE  ART (NOLOCK) ON ART.ARTICLE_NO =A.ARTICLE_NO  AND ART.INACTIVE =0
	   WHERE ART.ARTICLE_NO  IS NULL)
	   BEGIN
	       SET @CERRORMSG=' ARTICLE NOT FOUND PLEASE CHECK'

		  
		   
		   INSERT INTO @TBLERROR(SR,PARANAME,PARAVALUE,ERRMSG)
		   SELECT DISTINCT  7 AS SR, 'ArticleNo' AS PARANAME, A.article_no ,'ARTICLE NOT FOUND' AS ERRMSG 
		   FROM #TMPMASTERSENC A (NOLOCK)
		   LEFT JOIN ARTICLE  ART (NOLOCK) ON ART.ARTICLE_NO =A.ARTICLE_NO  AND ART.INACTIVE =0
		   WHERE ART.ARTICLE_NO  IS NULL

	   END


	   IF ISNULL(@CERRORMSG,'')<>''
	   BEGIN
	        
			SELECT cast('' as varchar(100)) as Product_code,  * FROM @TBLERROR
			ORDER BY SR 
	   END


	  END TRY

BEGIN CATCH
	PRINT 'ENTER CATCH OF SP3S_VALIDATE_PARAS'+@CSTEP+' '+ERROR_MESSAGE()
	SET @CERRORMSG='ERROR IN SP3S_VALIDATE_PARAS AT STEP#'+@CSTEP+' '+ERROR_MESSAGE()
	GOTO END_PROC
END CATCH

END_PROC:

END

