CREATE VIEW VW_ORD_MATERIAL_ISSUE
AS      
		SELECT B.PRODUCT_CODE, B.HSN_CODE,SKU.MRP, B.PURCHASE_PRICE, SKU.WS_PRICE,A.COMPANY_CODE,  
		C.ARTICLE_NO, C.ARTICLE_NAME, SKU.BARCODE_CODING_SCHEME AS CODING_SCHEME,     
		C.DISCON, SM.SECTION_NAME, SD.SUB_SECTION_NAME, P1.PARA1_NAME,  
		P2.PARA2_NAME, P3.PARA3_NAME, P4.PARA4_NAME, P5.PARA5_NAME,P6.PARA6_NAME,JIM.ISSUE_NO AS JOBWORK_ISSUE_NO,    
		C.ARTICLE_DESC,LM.AC_NAME AS AGENCY_NAME, A.ISSUE_NO  AS INV_NO,A.ISSUE_ID AS MEMO_ID,A.ISSUE_ID,B.TS,    
		CONVERT(VARCHAR,A.ISSUE_DT,105) AS INV_DT,    
		B.STOCK_QTY AS QTY,U.UOM_NAME,SKU.PRODUCT_NAME, 
		B.QUANTITY AS BOM_QTY,
		ISNULL(bu.CONVERSION_UOM_NAME,U.UOM_NAME) as BOM_UOM ,
		B.GST_PERCENTAGE,
		B.IGST_AMOUNT,
		B.SGST_AMOUNT, 	
		B.CGST_AMOUNT, 
		B.XN_VALUE_WITHOUT_GST,
		B.XN_VALUE_WITH_GST,
		P1.ALIAS AS PARA1_ALIAS, P2.ALIAS AS PARA2_ALIAS, P3.ALIAS AS PARA3_ALIAS,   
		P4.ALIAS AS PARA4_ALIAS, P5.ALIAS AS PARA5_ALIAS, P6.ALIAS AS PARA6_ALIAS ,  
		A.EWAY_BILL_NO,A.REF_NO,LMV.AC_NAME,LMV.CLOSING_BALANCE,LMV.PRINT_LEDGER,LMV.PRINT_NAME,
		LMV.ADDRESS0 +' '+ LMV.ADDRESS1 +' '+ LMV.ADDRESS2 +' '+ LMV.AREA_NAME +' '+
		LMV.CITY+'-'+LMV.PINCODE +' '+LMV.STATE AS AGENCY_ADDRESS , LMV.TIN_NO,  
		LMV.TIN_DT,LMV.PHONES_R,LMV.PHONES_O,LMV.PHONES_FAX,LMV.MOBILE,LMV.E_MAIL,  
		LMV.PAN_NO,LMV.GLN_NO,LMV.USERNAME,LMV.REGION_NAME,LMV.SHIPPING_ADDRESS,  
		LMV.SHIPPING_ADDRESS2,LMV.SHIPPING_ADDRESS3,LMV.AC_GST_NO,LMV.ANGADIA_NAME,LMV.COUNTRY_NAME ,
		ISNULL(REF.REF_NO ,'') AS BUYER_REF_NO
		FROM BOM_ISSUE_MST A (NOLOCK)    
		JOIN BOM_ISSUE_DET B (NOLOCK) ON A.ISSUE_ID =B.ISSUE_ID  
		JOIN SKU SKU (NOLOCK) ON B.PRODUCT_CODE = SKU.PRODUCT_CODE
		--LEFT OUTER JOIN PID01106 PID (NOLOCK) ON PID.PRODUCT_CODE=SKU.PRODUCT_CODE     
		JOIN ARTICLE C (NOLOCK) ON SKU.ARTICLE_CODE=C.ARTICLE_CODE    
		LEFT OUTER JOIN ARTICLE_FIX_ATTR ATTR  (NOLOCK) ON C.ARTICLE_CODE = ATTR.ARTICLE_CODE 
		LEFT OUTER JOIN ATTR1_MST AT1 (NOLOCK) ON AT1.ATTR1_KEY_CODE=ATTR.ATTR1_KEY_CODE
		LEFT OUTER JOIN ATTR2_MST AT2 (NOLOCK) ON AT2.ATTR2_KEY_CODE=ATTR.ATTR2_KEY_CODE
		LEFT OUTER JOIN ATTR3_MST AT3 (NOLOCK) ON AT3.ATTR3_KEY_CODE=ATTR.ATTR3_KEY_CODE
		LEFT OUTER JOIN ATTR4_MST AT4 (NOLOCK) ON AT4.ATTR4_KEY_CODE=ATTR.ATTR4_KEY_CODE
		LEFT OUTER JOIN ATTR5_MST AT5 (NOLOCK) ON AT5.ATTR5_KEY_CODE=ATTR.ATTR5_KEY_CODE
		LEFT OUTER JOIN ATTR6_MST AT6 (NOLOCK) ON AT6.ATTR6_KEY_CODE=ATTR.ATTR6_KEY_CODE
		LEFT OUTER JOIN ATTR7_MST AT7 (NOLOCK) ON AT7.ATTR7_KEY_CODE=ATTR.ATTR7_KEY_CODE
		LEFT OUTER JOIN ATTR8_MST AT8 (NOLOCK) ON AT8.ATTR8_KEY_CODE=ATTR.ATTR8_KEY_CODE
		LEFT OUTER JOIN ATTR9_MST AT9 (NOLOCK) ON AT9.ATTR9_KEY_CODE=ATTR.ATTR9_KEY_CODE
		LEFT OUTER JOIN ATTR10_MST AT10 (NOLOCK) ON AT10.ATTR10_KEY_CODE=ATTR.ATTR10_KEY_CODE
		LEFT OUTER JOIN ATTR11_MST AT11 (NOLOCK) ON AT11.ATTR11_KEY_CODE=ATTR.ATTR11_KEY_CODE
		LEFT OUTER JOIN ATTR12_MST AT12 (NOLOCK) ON AT12.ATTR12_KEY_CODE=ATTR.ATTR12_KEY_CODE
		LEFT OUTER JOIN ATTR13_MST AT13 (NOLOCK) ON AT13.ATTR13_KEY_CODE=ATTR.ATTR13_KEY_CODE
		LEFT OUTER JOIN ATTR14_MST AT14 (NOLOCK) ON AT14.ATTR14_KEY_CODE=ATTR.ATTR14_KEY_CODE
		LEFT OUTER JOIN ATTR15_MST AT15 (NOLOCK) ON AT15.ATTR15_KEY_CODE=ATTR.ATTR15_KEY_CODE
		LEFT OUTER JOIN ATTR16_MST AT16 (NOLOCK) ON AT16.ATTR16_KEY_CODE=ATTR.ATTR16_KEY_CODE
		LEFT OUTER JOIN ATTR17_MST AT17 (NOLOCK) ON AT17.ATTR17_KEY_CODE=ATTR.ATTR17_KEY_CODE
		LEFT OUTER JOIN ATTR18_MST AT18 (NOLOCK) ON AT18.ATTR18_KEY_CODE=ATTR.ATTR18_KEY_CODE
		LEFT OUTER JOIN ATTR19_MST AT19 (NOLOCK) ON AT19.ATTR19_KEY_CODE=ATTR.ATTR19_KEY_CODE
		LEFT OUTER JOIN ATTR20_MST AT20 (NOLOCK) ON AT20.ATTR20_KEY_CODE=ATTR.ATTR20_KEY_CODE
		LEFT OUTER JOIN ATTR21_MST AT21 (NOLOCK) ON AT21.ATTR21_KEY_CODE=ATTR.ATTR21_KEY_CODE
		LEFT OUTER JOIN ATTR22_MST AT22 (NOLOCK) ON AT22.ATTR22_KEY_CODE=ATTR.ATTR22_KEY_CODE
		LEFT OUTER JOIN ATTR23_MST AT23 (NOLOCK) ON AT23.ATTR23_KEY_CODE=ATTR.ATTR23_KEY_CODE
		LEFT OUTER JOIN ATTR24_MST AT24 (NOLOCK) ON AT24.ATTR24_KEY_CODE=ATTR.ATTR24_KEY_CODE
		LEFT OUTER JOIN ATTR25_MST AT25(NOLOCK) ON AT25.ATTR25_KEY_CODE=ATTR.ATTR25_KEY_CODE		JOIN PARA1 P1 (NOLOCK) ON SKU.PARA1_CODE= P1.PARA1_CODE    
		JOIN PARA2 P2 (NOLOCK) ON SKU.PARA2_CODE= P2.PARA2_CODE    
		JOIN PARA3 P3 (NOLOCK) ON SKU.PARA3_CODE= P3.PARA3_CODE    
		JOIN PARA4 P4 (NOLOCK) ON SKU.PARA4_CODE= P4.PARA4_CODE    
		JOIN PARA5 P5 (NOLOCK) ON SKU.PARA5_CODE= P5.PARA5_CODE    
		JOIN PARA6 P6 (NOLOCK) ON SKU.PARA6_CODE= P6.PARA6_CODE    
		JOIN SECTIOND SD (NOLOCK) ON C.SUB_SECTION_CODE = SD.SUB_SECTION_CODE    
		JOIN SECTIONM SM (NOLOCK) ON SD.SECTION_CODE= SM.SECTION_CODE    
		LEFT OUTER JOIN PRD_AGENCY_MST AGN (NOLOCK) ON AGN.AGENCY_CODE=A.AGENCY_CODE  
		JOIN LM01106 LM (NOLOCK) ON AGN.AC_CODE=LM.AC_CODE  
		JOIN LMV01106 LMV ON LMV.AC_CODE=LM.AC_CODE  
		JOIN UOM U (NOLOCK) ON U.UOM_CODE=C.UOM_CODE
		LEFT OUTER JOIN JOBWORK_ISSUE_MST JIM (NOLOCK) ON JIM.ISSUE_ID=A.JOBWORK_ISSUE_ID   
		LEFT JOIN
		(
		   SELECT A.ISSUE_ID ,B.REF_NO 
		   FROM JOBWORK_ISSUE_DET A
		   JOIN VW_BUYER_REF_NO B ON A.PRODUCT_CODE =B.PRODUCT_CODE
		   GROUP BY A.ISSUE_ID ,B.REF_NO 
		)  REF ON REF.ISSUE_ID =A.JOBWORK_ISSUE_ID
		LEFT OUTER JOIN UOM_CONVERSION UC (NOLOCK) ON UC.UOM_CODE=U.UOM_CODE
        LEFT OUTER JOIN BOM_UOM BU (NOLOCK) ON BU.CONVERSION_UOM_CODE=UC.CONVERSION_UOM_CODE 
