CREATE PROCEDURE SP3S_MULTIPLE_FDN
(
	@NQUERYID		INT,
	@DFROMDT		DATETIME,
	@DTODT			DATETIME,
	@CWHERE			VARCHAR(200)=''
)
AS
BEGIN
	DECLARE @CHEADCODE VARCHAR(4000) 
	IF @NQUERYID=1
		EXEC SP3SGETPURCHASEDIFF_FDN @DFROMDT=@DFROMDT,@DTODT=@DTODT
	ELSE IF @NQUERYID=2
	BEGIN
		SELECT 0 AS ACTION_CODE, '--SELECT--' AS ACTION_NAME
		UNION
		SELECT 1 AS ACTION_CODE, 'CREATE' AS ACTION_NAME 
		--UNION
		--SELECT 2 AS ACTION_CODE, 'KEEP PENDING' AS ACTION_NAME 
		UNION
		SELECT 3 AS ACTION_CODE, 'CLOSE WITHOUT CREATING' AS ACTION_NAME 
		ORDER BY ACTION_CODE
	END
	ELSE IF @NQUERYID=3
	BEGIN
		SELECT DEPT_ID,DEPT_ID+' - '+DEPT_NAME AS DEPT_NAME
		FROM LOCATION 
		WHERE LOC_TYPE=1 
		UNION ALL
		SELECT '' AS DEPT_ID,'--ALL--' AS DEPT_NAME 
		ORDER BY DEPT_NAME
	END
	ELSE IF @NQUERYID=4
		BEGIN
		SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000021') 
		SELECT '' AS AC_CODE, '--ALL--' AS AC_NAME
		UNION
		SELECT AC_CODE, AC_NAME FROM LMV01106 (NOLOCK) 
		WHERE  ISNULL(INACTIVE,0)=0 AND (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ALLOW_CREDITOR_DEBTOR = 1) 
		AND LTRIM(RTRIM(ISNULL(AC_NAME,'')))<>''  
		ORDER BY AC_NAME
	END
	ELSE IF @NQUERYID=5
	BEGIN
		SET @CHEADCODE=DBO.FN_ACT_TRAVTREE('0000000018') 
		SELECT '' AS AC_CODE, '--ALL--' AS AC_NAME
		UNION
		SELECT AC_CODE, AC_NAME FROM LMV01106 (NOLOCK) 
		WHERE  ISNULL(INACTIVE,0)=0 AND (CHARINDEX(HEAD_CODE,@CHEADCODE)>0 OR ALLOW_CREDITOR_DEBTOR = 1) 
		AND LTRIM(RTRIM(ISNULL(AC_NAME,'')))<>''  
		ORDER BY AC_NAME
	END
END
