CREATE VIEW VW_CON_CONSUMPTION_QBF
--WITH ENCRYPTION
AS 
SELECT  
T1.MEMO_NO AS MST_MEMO_NO
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MST_MEMO_DATE 
,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED
,IMC.ARTICLE_NAME AS ITEM_NAME,IMC.ARTICLE_NO AS ITEM_CODE,IMC.ARTICLE_DESC AS ITEM_DESC
,U.UOM_NAME 
,DET.QUANTITY
,DET.PRODUCT_CODE 
,PARA1.PARA1_NAME ,PARA2.PARA2_NAME
,T1.MEMO_NO
,CONVERT(CHAR(10),T1.MEMO_DT,105) AS MEMO_DT
,T1.MEMO_ID,
T1.REMARKS AS MST_REMARKS
FROM CON_CONSUMPTION_MST T1 
JOIN CON_CONSUMPTION_DET DET ON DET.MEMO_ID = T1.MEMO_ID
JOIN SKU ON SKU.PRODUCT_CODE = DET.PRODUCT_CODE 
JOIN ARTICLE IMC ON SKU.ARTICLE_CODE=IMC.ARTICLE_CODE
JOIN UOM U ON IMC.UOM_CODE = U.UOM_CODE 
JOIN PARA1 ON PARA1.PARA1_CODE = SKU.PARA1_CODE
JOIN PARA2 ON PARA2.PARA2_CODE = SKU.PARA2_CODE
JOIN PARA3 ON PARA3.PARA3_CODE = SKU.PARA3_CODE
