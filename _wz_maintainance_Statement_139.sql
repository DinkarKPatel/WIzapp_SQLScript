

UPDATE A SET TOTAL_GST_AMOUNT=B.GST_AMOUNT 
FROM PIM01106 A (NOLOCK)
JOIN 
(
   SELECT A.MRR_ID ,
         SUM(ISNULL(IGST_AMOUNT,0)+ ISNULL(CGST_AMOUNT,0)+ISNULL(SGST_AMOUNT,0)) AS GST_AMOUNT
   FROM PID01106 A (NOLOCK)
   GROUP BY A.MRR_ID
) B ON A.MRR_ID =B.MRR_ID 
WHERE A.CANCELLED =0
AND A.RECEIPT_DT >='2017-07-01'
AND ISNULL(TOTAL_GST_AMOUNT,0)<>B.GST_AMOUNT 



UPDATE A SET Total_Gst_Amount=B.GST_AMOUNT 
FROM RMM01106 A (NOLOCK)
JOIN 
(
   SELECT A.RM_ID ,
         SUM(ISNULL(IGST_AMOUNT,0)+ ISNULL(CGST_AMOUNT,0)+ISNULL(SGST_AMOUNT,0)) AS GST_AMOUNT
   FROM rmd01106  A (NOLOCK)
   GROUP BY A.RM_ID
) B ON A.RM_ID =B.RM_ID 
WHERE A.CANCELLED =0
AND A.rm_dt  >='2017-07-01'
AND ISNULL(Total_Gst_Amount,0)<>B.GST_AMOUNT 



UPDATE A SET Total_Gst_Amount=B.GST_AMOUNT 
FROM INM01106 A (NOLOCK)
JOIN 
(
   SELECT A.INV_ID ,
         SUM(ISNULL(IGST_AMOUNT,0)+ ISNULL(CGST_AMOUNT,0)+ISNULL(SGST_AMOUNT,0)) AS GST_AMOUNT
   FROM IND01106   A (NOLOCK)
   GROUP BY A.INV_ID
) B ON A.INV_ID =B.INV_ID 
WHERE A.CANCELLED =0
AND A.INV_DT   >='2017-07-01'
AND ISNULL(Total_Gst_Amount,0)<>B.GST_AMOUNT 



UPDATE A SET Total_Gst_Amount=B.GST_AMOUNT 
FROM cnm01106  A (NOLOCK)
JOIN 
(
   SELECT A.cn_id  ,
         SUM(ISNULL(IGST_AMOUNT,0)+ ISNULL(CGST_AMOUNT,0)+ISNULL(SGST_AMOUNT,0)) AS GST_AMOUNT
   FROM cnd01106    A (NOLOCK)
   GROUP BY A.cn_id
) B ON A.cn_id =B.cn_id 
WHERE A.CANCELLED =0
AND A.cn_dt    >='2017-07-01'
AND ISNULL(Total_Gst_Amount,0)<>B.GST_AMOUNT 

