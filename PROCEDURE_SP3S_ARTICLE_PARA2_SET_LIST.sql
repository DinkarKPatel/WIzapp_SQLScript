CREATE PROCEDURE SP3S_ARTICLE_PARA2_SET_LIST 
(
	@ARTICLE_CODE VARCHAR(10),
	@cPARA2_SET_NAME VARCHAR(40)
)
--WITH ENCRYPTION
AS

		DECLARE @CMD NVARCHAR(MAX)
		DECLARE @PARA NUMERIC(10,2)

		SELECT @PARA = COUNT(A.PARA2_CODE)
		FROM SIZE_SET_DET A  (NOLOCK)
		JOIN SIZE_SET_MST B (NOLOCK) ON B.SIZE_SET_CODE=A.SIZE_SET_CODE
		WHERE ISNULL(b.SIZE_SET_NAME,'') = @cPARA2_SET_NAME  

		IF @PARA > 0
		BEGIN
			SET @CMD = N'SELECT A.PARA2_CODE, A.PARA2_NAME, A1.SIZE_ORDER AS PARA2_ORDER,  
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  PURCHASE_PRICE,
			ISNULL((SELECT WHOLESALE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS WS_PRICE,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP1 
			,CONVERT(BIT,0) AS CENTER_POINT  ,
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  GROSS_PURCHASE_PRICE
			FROM PARA2 A  (NOLOCK)
			JOIN SIZE_SET_DET A1  (NOLOCK) ON A1.PARA2_CODE=A.PARA2_CODE
			JOIN SIZE_SET_MST B (NOLOCK) ON B.SIZE_SET_CODE=A1.SIZE_SET_CODE
			WHERE ISNULL(b.SIZE_SET_NAME,'''') =  '''+@cPARA2_SET_NAME  +'''  
			ORDER BY A1.SIZE_ORDER '
		END
		ELSE
		BEGIN
			SET @CMD = N'SELECT A.PARA2_CODE, A.PARA2_NAME, A.PARA2_ORDER,  
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  PURCHASE_PRICE,
			ISNULL((SELECT WHOLESALE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS WS_PRICE,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP,
			ISNULL((SELECT MRP FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0) AS MRP1 
			,CONVERT(BIT,0) AS CENTER_POINT  ,
			ISNULL((SELECT PURCHASE_PRICE FROM ARTICLE (NOLOCK) WHERE ARTICLE_CODE = '''+@ARTICLE_CODE+'''),0)  AS  GROSS_PURCHASE_PRICE
			FROM PARA2 A  
			WHERE A.PARA2_CODE = ''0000000'' 
			ORDER BY A.PARA2_ORDER '
		END
		PRINT @CMD
		EXEC SP_EXECUTESQL @CMD
--************************* END OF PROCEDURE SP_WL_ARTICLEPARA2LIST