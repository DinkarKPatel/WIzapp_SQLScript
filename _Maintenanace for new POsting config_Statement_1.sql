IF NOT EXISTS (SELECT TOP 1 XN_TYPE FROM GST_ACCOUNTS_CONFIG_DET_REVENUE)
BEGIN
	INSERT GST_ACCOUNTS_CONFIG_DET_REVENUE	( XN_TYPE, GST_PERCENTAGE, SECTION_CODE, SUB_SECTION_CODE, 
	IGST_REVENUE_AC_CODE, LGST_REVENUE_AC_CODE, IGST_TAX_AC_CODE, CGST_TAX_AC_CODE, SGST_TAX_AC_CODE )  
	SELECT XN_TYPE, GST_PERCENTAGE,'0000000' AS SECTION_CODE,'0000000' AS SUB_SECTION_CODE, 
	ISNULL(IGST_XN_AC_CODE,'0000000000') AS IGST_XN_AC_CODE,ISNULL( LOCAL_GST_XN_AC_CODE,'0000000000') AS LOCAL_GST_XN_AC_CODE,
	ISNULL(IGST_TAX_AC_CODE,'0000000000') AS IGST_TAX_AC_CODE, ISNULL(CGST_TAX_AC_CODE,'0000000000') AS CGST_TAX_AC_CODE,
	ISNULL(SGST_TAX_AC_CODE,'0000000000') AS SGST_TAX_AC_CODE
	FROM 
	(	SELECT *
		FROM 
		(
		SELECT XN_TYPE, GST_PERCENTAGE ,COLUMNNAME,ISNULL(VALUE,'0000000000') AS VALUE
		FROM GST_ACCOUNTS_CONFIG_DET_2
		WHERE XN_TYPE<>'IWS'
		
		GROUP BY XN_TYPE,GST_PERCENTAGE,COLUMNNAME,VALUE
		) A
		PIVOT (MAX(VALUE) FOR COLUMNNAME IN ([CGST_TAX_AC_CODE],[IGST_TAX_AC_CODE],[IGST_XN_AC_CODE],[LOCAL_GST_XN_AC_CODE],[SGST_TAX_AC_CODE])) AS PTABLE
	) B WHERE GST_PERCENTAGE<100
END
