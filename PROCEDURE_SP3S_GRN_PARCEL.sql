CREATE PROCEDURE SP3S_GRN_PARCEL
(
 @CMEMO_ID VARCHAR(100)=''
)
AS
BEGIN
    
   
    SELECT DISTINCT CAST(1 AS BIT) AS CHK, F.PARCEL_MEMO_NO ,F.PARCEL_MEMO_DT ,
    e.party_inv_no as BILL_CHALLAN_NO,
           E.BOX_NO as TOTAL_BOXES,F.ANGADIA_CODE,ANGM.ANGADIA_NAME ,
           F.BILTY_NO,F.REMARKS,e.AC_CODE,LM.AC_NAME ,F.RECEIPT_DT,
           F.TOTAL_AMOUNT
    FROM GRN_PS_MST A (NOLOCK)
    JOIN GRN_PS_DET B ON A.MEMO_ID=B.MEMO_ID 
    JOIN ASN_DET C (NOLOCK) ON B.ASN_ROW_ID =C.ROW_ID 
    JOIN ASN_MST D (NOLOCK) ON D.MEMO_ID =C.MEMO_ID 
    JOIN parcel_det  E (NOLOCK) ON E.REF_MEMO_ID =D.MEMO_ID 
    JOIN PARCEL_MST F (NOLOCK) ON E.PARCEL_MEMO_ID =F.PARCEL_MEMO_ID 
    JOIN ANGM (NOLOCK) ON ANGM .ANGADIA_CODE =F.ANGADIA_CODE 
    JOIN LM01106 LM (NOLOCK) ON LM.AC_CODE =e.AC_CODE 
    WHERE (@CMEMO_ID='' OR A.MEMO_ID =@CMEMO_ID) AND F.CANCELLED=0
    AND D.CANCELLED =0 
   
END
