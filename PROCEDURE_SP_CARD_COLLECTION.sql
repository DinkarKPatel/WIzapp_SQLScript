CREATE PROC SP_CARD_COLLECTION  
 (  
   @CBATCHDT DATETIME,  
   @IMODE INT  
 )  
-- WITH ENCRYPTION

 AS  
   
 BEGIN  

		 SELECT A.PAYMODE_CODE,(CASE WHEN A.PAYMODE_NAME='INR' THEN 'CASH DEPOSIT' ELSE A.PAYMODE_NAME END) AS PAYMODE_NAME ,
		 B.BATCH_CLOSING_NO,B.AMOUNT,B.MODE  ,'0000000000' AS AC_CODE 
		 FROM PAYMODE_MST A  
		 JOIN CC_BATCH_COLLECTION  B ON A.PAYMODE_CODE = B.PAYMODE_CODE  
		 WHERE A.INACTIVE=0 AND (PAYMODE_GRP_CODE = '0000002' OR A.PAYMODE_CODE = '0000000') AND  BATCH_DT= @CBATCHDT  
		  
		 UNION ALL  
		   
		 SELECT  PAYMODE_CODE,(CASE WHEN PAYMODE_NAME= 'INR' THEN 'CASH DEPOSIT' ELSE PAYMODE_NAME END) AS PAYMODE_NAME,
		 NULL AS BATCH_CLOSING_NO,NULL AS AMOUNT,NULL  AS MODE ,'0000000000' AS AC_CODE  
		 FROM PAYMODE_MST A  
		 WHERE A.INACTIVE=0 AND (PAYMODE_GRP_CODE = '0000002' OR PAYMODE_CODE = '0000000') AND A.PAYMODE_CODE NOT IN  
		 (SELECT PAYMODE_CODE FROM CC_BATCH_COLLECTION WHERE BATCH_DT= @CBATCHDT )  
		 ORDER BY PAYMODE_NAME  
	 END
