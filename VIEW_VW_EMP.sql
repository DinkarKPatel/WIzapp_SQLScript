CREATE VIEW VW_EMP 
--WITH ENCRYPTION
AS           
SELECT 
	CAST(0 AS BIT) AS CHK,           
	T1.EMP_ID,          
	REF_ID,           
	T1.EMP_FNAME,          
	T1.EMP_LNAME,          
	T1.EMP_TITLE,          
	T1.ADDRESS1,          
	T1.ADDRESS2,                          
	CONVERT(CHAR(10),T1.DATE_OF_BIRTH,105) AS DOB,          
	CONVERT(CHAR(10),T1.DATE_OF_JOINING,105)AS DOJ,          
	DATE_OF_BIRTH,          
	DATE_OF_JOINING,                        
	T1.EMAIL1,          
	T1.EMAIL2,          
	T1.PHONES_H,        
	T1.BASIC_SALARY,        
	T1.EMP_TYPE,          
	CASE       
		WHEN T1.EMP_TYPE = 0 THEN 'MALE'       
		WHEN T1.EMP_TYPE = 1 THEN 'FEMALE'       
		WHEN T1.EMP_TYPE = 2 THEN 'SENIOR CITIZEN'          
		WHEN T1.EMP_TYPE = 3 THEN 'HANDICAPED'       
		ELSE 'NRI'       
	END AS [EMPLOYEE_TYPE],          
	CASE       
		WHEN T1.ID_PROOF_DOC_TYPE= 0 THEN ''       
		WHEN T1.ID_PROOF_DOC_TYPE= 1 THEN 'DRIVING-LICENCE'       
		WHEN T1.ID_PROOF_DOC_TYPE= 2 THEN 'PASSPORT'       
		WHEN T1.ID_PROOF_DOC_TYPE= 3 THEN 'VOTER ID CARD'          
		ELSE 'OTHERS'       
	END AS ID_PROOF_DOC_TYPE,              
	ID_PROOF_ISSUING_AUTHORITY,          
	ID_PROOF_DOC_NO,                  
	CASE       
		WHEN T1.ID_PROOF_DOC_TYPE= 4 THEN  ID_PROOF_DOC_VALUE       
		ELSE ''       
	END AS ID_PROOF_DOC_VALUE,          
	IMG_NAME,          
	T1.PAN_NO,          
	T1.PARENT_NAME,          
	T1.MOBILE1,          
	T2.AREA_NAME,          
	T3.CITY,          
	T4.STATE,          
	T5.DEPARTMENT_NAME,           
	T6.DESIG_NAME,          
	T7.SHIFT_NAME,          
	T2.PINCODE,                       
	T1.WEEKLY_OFF1,          
	T1.WEEKLY_OFF2,          
	CONVERT(CHAR(10),T1.LEAVING_DATE,105)AS DOL,                    
	T1.LEAVING_DATE,          
	T8.AREA_NAME AS MAILING_AREA_NAME,          
	T1.MAILING_AREA_CODE,          
	T1.MAILING_ADDRESS1,          
	T1.MAILING_ADDRESS2,                    
	T8.PINCODE  AS MAILING_PINCODE,          
	T9.CITY   AS MAILING_CITY,          
	T9.CITY_CODE AS MAILING_CITY_CODE,          
	T10.STATE  AS MAILING_STATE,                    
	T10.STATE_CODE AS MAILING_STATE_CODE,               
	T1.EMP_STATUS,           
	CASE       
		WHEN T1.EMP_STATUS = 0 THEN 'ACTIVE'       
		WHEN T1.EMP_STATUS = 1 THEN 'INACTIVE'       
		ELSE 'LEFT'       
	END AS [STATUS],          
	0 AS S_NO,           
	T1.COMPANY_CODE, 
	T1.CO_ALIAS ,           
	T1.DEPARTMENT_ID,          
	T1.DESIG_ID,          
	T1.SHIFT_ID, 
	T1.BANK_ACC_NO, 
    T1.PF_NO,              
	T1.SALARY_PROFILE_ID,  
	T1.DEPT_ID,T12.DEPT_NAME,  
	T7.SHIFT_TIME_IN,
	T7.SHIFT_TIME_OUT,
	T7.EARLY_CUTOFF,
	T7.LATE_CUTOFF,
	T7.HALFDAY_CUTOFF,
	T1.PF_ENABLED,
	T1.ESI_ENABLED,
	T1.MODE_OF_PAYMENT                                
FROM EMP_MST T1          
LEFT OUTER JOIN AREA T2				(NOLOCK) ON T1.AREA_CODE = T2.AREA_CODE            
LEFT OUTER JOIN CITY T3				(NOLOCK) ON T2.CITY_CODE = T3.CITY_CODE            
LEFT OUTER JOIN STATE T4			(NOLOCK) ON T3.STATE_CODE = T4.STATE_CODE            
LEFT OUTER JOIN EMP_DEPARTMENT T5	(NOLOCK) ON T1.DEPARTMENT_ID = T5.DEPARTMENT_ID            
LEFT OUTER JOIN EMP_DESIG T6		(NOLOCK) ON T1.DESIG_ID = T6.DESIG_ID            
LEFT OUTER JOIN EMP_SHIFTS T7		(NOLOCK) ON T1.SHIFT_ID = T7.SHIFT_ID            
LEFT OUTER JOIN AREA T8				(NOLOCK) ON T1.MAILING_AREA_CODE = T8.AREA_CODE            
LEFT OUTER JOIN CITY T9				(NOLOCK) ON T8.CITY_CODE = T9.CITY_CODE            
LEFT OUTER JOIN STATE T10			(NOLOCK) ON T10.STATE_CODE = T9.STATE_CODE            
JOIN LOCATION T12 ON T1.DEPT_ID=T12.DEPT_ID
