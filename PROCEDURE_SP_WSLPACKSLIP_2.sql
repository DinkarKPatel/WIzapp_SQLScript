CREATE PROCEDURE SP_WSLPACKSLIP_2--(LocId 3 digit change only increased the parameter width by Sanjay:04-11-2024)
 @CMEMOID VARCHAR(40) = '',  
 @CWHERE  VARCHAR(500) = '',
 @NNAVMODE NUMERIC(1,0) = 0,  
 @CFINYEAR VARCHAR(5)='',
 @CLOCID varchar(4)=''
--WITH ENCRYPTION
AS  
BEGIN  
  SELECT T1.*,T1.PRODUCT_CODE, B.ARTICLE_CODE, B.ARTICLE_NO, B.ARTICLE_NAME, S.PARA1_CODE,        
 S.PARA2_CODE, S.PARA3_CODE,CONVERT(NUMERIC, 0) AS S_NO,     
 T1.DEPT_ID, B.INACTIVE, ISNULL(P.QUANTITY_IN_STOCK,0) AS QUANTITY_IN_STOCK,        
 S.PURCHASE_PRICE, '' AS SCHEME_ID, b.sub_section_code,    
 S.PARA4_CODE,S.PARA5_CODE,S.PARA6_CODE,     
     
 B.DT_CREATED AS [ART_DT_CREATED],S.DT_CREATED AS [SKU_DT_CREATED],        
 B.STOCK_NA,    
 T1.QUANTITY AS PREVQTY,S.FIX_MRP,S.PRODUCT_NAME,J.FORM_NAME      
   
 ,B.UOM_CODE,ISNULL(T1.QUANTITY,0)*ISNULL(T1.RATE,0) AS AMOUNT,    S.WS_PRICE,  
 EMP.EMP_NAME, EMP1.EMP_NAME AS EMP_NAME1,    
 EMP2.EMP_NAME AS EMP_NAME2,UOM.UOM_NAME,UOM.UOM_TYPE ,BIN.BIN_NAME,
 B.ALIAS AS ARTICLE_ALIAS, B.ARTICLE_NAME,MST.ORDER_NO ,CAST('' AS VARCHAR(50)) AS SP_ID   ,
  T1.PRODUCT_CODE AS ORG_PRODUCT_CODE, 
 CAST(CASE WHEN CHARINDEX('@',T1.PRODUCT_CODE)=0 THEN '' ELSE 
(SUBSTRING(T1.PRODUCT_CODE,CHARINDEX('@',T1.PRODUCT_CODE)+1,15)) END  AS VARCHAR(100)) AS BATCH_LOT_NO,
   S.BATCH_NO,S.EXPIRY_DT  ,B.CODING_SCHEME  
  ,CASt('' as VARCHAR(100)) AS scheme_name,CASt('' as VARCHAR(100)) AS SLSDET_ROW_ID
,CAST(0 AS BIT) AS MAanual_DP,CAST(0 AS BIT) AS barcodebased_flatdisc_applied,CAST(0 AS BIT) AS bngn_not_applied,CAST(0 AS BIT) AS happy_hours_applied
,ISNULL(sn.SN_ARTICLE_PACK_SIZE,0) AS ARTICLE_PACK_SIZE,SN.*     
 FROM WPS_DET T1 (nolock)   
 LEFT OUTER JOIN PMT01106 P (nolock) ON T1.PRODUCT_CODE = P.PRODUCT_CODE
 AND P.DEPT_ID=T1.DEPT_ID  AND P.BIN_ID=T1.BIN_ID AND ISNULL( p.bo_order_id ,'')=''-- t1.ORDER_ID
 LEFT OUTER JOIN BUYER_ORDER_MST MST (nolock) ON MST.ORDER_ID=T1.ORDER_ID         
 JOIN SKU S (nolock) ON S.PRODUCT_CODE = T1.PRODUCT_CODE         
 JOIN ARTICLE B (nolock) ON S.ARTICLE_CODE = B.ARTICLE_CODE          
 --JOIN SECTIOND SD (nolock) ON B.SUB_SECTION_CODE = SD.SUB_SECTION_CODE        
 --JOIN SECTIONM SM (nolock) ON SD.SECTION_CODE = SM.SECTION_CODE        
 left JOIN FORM J (nolock) ON T1.ITEM_FORM_ID= J.FORM_ID     
 --JOIN PARA1 P1 (nolock) ON P1.PARA1_CODE=S.PARA1_CODE      
 --JOIN PARA2 P2 (nolock) ON P2.PARA2_CODE=S.PARA2_CODE      
 --JOIN PARA3 P3 (nolock) ON P3.PARA3_CODE=S.PARA3_CODE      
 --JOIN PARA4 P4 (nolock) ON P4.PARA4_CODE=S.PARA4_CODE      
 --JOIN PARA5 P5 (nolock) ON P5.PARA5_CODE=S.PARA5_CODE      
 --JOIN PARA6 P6 (nolock) ON P6.PARA6_CODE=S.PARA6_CODE  
 JOIN UOM (nolock)  ON UOM.UOM_CODE=B.UOM_CODE  
 JOIN BIN (nolock)  ON BIN.BIN_ID=ISNULL(T1.BIN_ID,'000')  
 LEFT OUTER  JOIN EMPLOYEE EMP (nolock) ON T1.EMP_CODE= EMP.EMP_CODE        
 LEFT OUTER JOIN EMPLOYEE EMP1 (nolock) ON T1.EMP_CODE1= EMP1.EMP_CODE        
 LEFT OUTER JOIN EMPLOYEE EMP2 (nolock) ON T1.EMP_CODE2= EMP2.EMP_CODE     
 LEFT JOIN SKU_NAMES SN (NOLOCK) ON SN.product_Code=T1.product_Code
 WHERE T1.PS_ID = @CMEMOID   ORDER BY SRNO  
  

END

