


DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('PRT','LEFT(SKU.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SKU.PRODUCT_CODE)-1,-1),LEN(SKU.PRODUCT_CODE )))','PRODUCT_CODE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','ARTICLE.ARTICLE_NAME','ARTICLE_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','UOM.UOM_NAME','UOM_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SUB_SECTION_NAME','SUB_SECTION_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SECTION_NAME','SECTION_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.XN_VALUE_WITHOUT_GST','TAXABLE_VALUE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.IGST_AMOUNT','IGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.CGST_AMOUNT','CGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.SGST_AMOUNT','SGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.XN_VALUE_WITH_GST','TOTAL_VALUE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.QUANTITY*RMD01106.GROSS_PURCHASE_PRICE','AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','CAST((RMD01106.DN_DISCOUNT_AMOUNT+ CASE WHEN RMM.SUBTOTAL>0 THEN ((RMM.DISCOUNT_AMOUNT/RMM.SUBTOTAL)*RMD01106.GROSS_PURCHASE_PRICE*RMD01106.INVOICE_QUANTITY) ELSE 0 END )   AS NUMERIC(12,2))','LESS_DISCOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('PRT','	CAST((CASE WHEN  RMD01106.	Gross_purchase_price=0 THEN 0 ELSE ((CONVERT(NUMERIC(10,2),
		 (ISNULL(RMD01106.DN_discount_amount,0)+ISNULL(RMD01106.RMMDiscountAmount,0))/RMD01106.QUANTITY  
		)* 100)/ RMD01106.Gross_purchase_price) END) AS NUMERIC(14,3))','DISCOUNT_PER',0,'DEBITNOTE','DEBITNOTE_DETAILS')


INSERT INTO @dtLocal VALUES('PRT','RMD01106.GROSS_PURCHASE_PRICE','RATE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.REMARKS','ITEM_LEVEL_REMARKS',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.HSN_CODE','HSN_CODE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU.MRP','MRP',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU.VENDOR_EAN_NO','VENDOR_EAN_NO',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU.challan_no','challan_no',0,'DEBITNOTE','DEBITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('PRT','RMD01106.DN_DISCOUNT_PERCENTAGE','DN_DISCOUNT_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('PRT','XNBOX.GROSSWEIGHT','GROSSWEIGHT',0,'DEBITNOTE','DEBITNOTE_DETAILS')




INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR1_KEY_NAME','ATTRIBUTE1_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR2_KEY_NAME','ATTRIBUTE2_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR3_KEY_NAME','ATTRIBUTE3_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR4_KEY_NAME','ATTRIBUTE4_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR5_KEY_NAME','ATTRIBUTE5_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR6_KEY_NAME','ATTRIBUTE6_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR7_KEY_NAME','ATTRIBUTE7_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR8_KEY_NAME','ATTRIBUTE8_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR9_KEY_NAME','ATTRIBUTE9_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR10_KEY_NAME','ATTRIBUTE10_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR11_KEY_NAME','ATTRIBUTE11_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR12_KEY_NAME','ATTRIBUTE12_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR13_KEY_NAME','ATTRIBUTE13_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR14_KEY_NAME','ATTRIBUTE14_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR15_KEY_NAME','ATTRIBUTE15_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR16_KEY_NAME','ATTRIBUTE16_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR17_KEY_NAME','ATTRIBUTE17_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR18_KEY_NAME','ATTRIBUTE18_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR19_KEY_NAME','ATTRIBUTE19_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR20_KEY_NAME','ATTRIBUTE20_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR21_KEY_NAME','ATTRIBUTE21_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR22_KEY_NAME','ATTRIBUTE22_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR23_KEY_NAME','ATTRIBUTE23_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR24_KEY_NAME','ATTRIBUTE24_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.ATTR25_KEY_NAME','ATTRIBUTE25_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','SKU_NAMES.SN_ARTICLE_PACK_SIZE','SN_ARTICLE_PACK_SIZE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.gst_percentage','GST_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.QUANTITY','QUANTITY',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.DISCOUNT_PERCENTAGE','ITEM_DISCOUNT_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.DISCOUNT_AMOUNT','ITEM_DISCOUNT_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.para2_order','PARA2_ORDER',0,'DEBITNOTE','DEBITNOTE_DETAILS')
--INSERT INTO @dtLocal VALUES('PRT','sku_names.para2_set','PARA2_SET',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.BOX_NO','BOX_NO',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA1_NAME','PARA1_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA2_NAME','PARA2_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA3_NAME','PARA3_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA4_NAME','PARA4_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA5_NAME','PARA5_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','sku_names.PARA6_NAME','PARA6_NAME',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','ARTICLE.ARTICLE_NO','ARTICLE_NO',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMM.CANCELLED','CANCELLED',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @DTLOCAL VALUES('PRT','U.USERNAME','USERNAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @DTLOCAL VALUES('PRT','U1.USERNAME','EDT_USERNAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')


--INSERT INTO @dtLocal VALUES('PRT','CASE WHEN LEFT(RTRIM(LTRIM(RMM.RM_NO)),1)=''0'' AND rmm.rm_dt>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),'''') )  THEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END '  +'+RMM.RM_NO','RM_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @DTLOCAL VALUES('PRT','CASE 
              WHEN  isnull(SL.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  RMM.RM_NO
              WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and isnull(RMM.DN_TYPE,0)<>2 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(RMM.EINV_IRN_NO,'''')='''' AND  RMM.RM_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),''''))  
              and ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''DONOT_ENFORCE_EINV_DN''),'''') <>''1'' THEN ''*****''+RIGHT(RMM.RM_NO,5)
ELSE CASE WHEN  LEFT(RTRIM(LTRIM(RMM.RM_NO)),1)=''0'' AND ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND RMM.RM_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),'''')  ) 
              and ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''DONOT_ENFORCE_EINV_DN''),'''') <>''1'' THEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END  ' +'+RMM.RM_NO  END','RM_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT',' CASE 
              WHEN  isnull(SL.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  RMM.RM_DT
              WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and isnull(RMM.DN_TYPE,0)<>2 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(RMM.EINV_IRN_NO,'''')='''' AND  RMM.RM_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),''''))  
              and ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''DONOT_ENFORCE_EINV_DN''),'''') <>''1'' THEN '''' else RMM.RM_DT end ','RM_DT',0,'DEBITNOTE','DEBITNOTE_MASTERS')



--INSERT INTO @dtLocal VALUES('PRT','RMM.RM_DT','RM_DT',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','RMM.ROUND_OFF','ROUND_OFF',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.REMARKS','BILL_LEVEL_REMARKS',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.FREIGHT','FREIGHT_CHARGE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.OTHER_CHARGES','OTHER_CHARGES',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','RMM.ROUND_OFF','ROUND_OFF',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.bill_challan_mode','bill_challan_mode',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT',' CASE   
        WHEN  isnull(SL.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  ''Sale on Approval''
        WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(RMM.EINV_IRN_NO,'''')='''' AND  RMM.RM_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),'''') ) 
        and ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''DONOT_ENFORCE_EINV_DN''),'''') <>''1'' THEN ''SAMPLE INVOICE'' ELSE 
CASE ISNULL(COM.TITLE_DEBIT_NOTE,'''') 
            WHEN '''' THEN (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE XN_TYPE=''PRT'')  
            ELSE COM.TITLE_DEBIT_NOTE   
     END  END  ','INVOICE_TYPE',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','RMM.supply_type_code','supply_type_code',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.other_charges_gst_percentage','OTHER_CHARGES_GST_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.other_charges_hsn_code','OTHER_CHARGES_HSN_CODE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.other_charges_igst_amount','OTHER_CHARGES_IGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.other_charges_cgst_amount','OTHER_CHARGES_CGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.other_charges_sgst_amount','OTHER_CHARGES_SGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.freight_gst_percentage','FREIGHT_GST_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.freight_hsn_code','FREIGHT_HSN_CODE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.freight_igst_amount','FREIGHT_IGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.freight_cgst_amount','FREIGHT_CGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.freight_sgst_amount','FREIGHT_SGST_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','RMM.Mode','Inv_Mode',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.route_form1','route_form1',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.route_form2','route_form2',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.REFNO','REFNO',0,'DEBITNOTE','DEBITNOTE_MASTERS')
  
INSERT INTO @dtLocal VALUES('PRT','RMM.TOTAL_AMOUNT','TOTAL_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')  
INSERT INTO @dtLocal VALUES('PRT','RMM.DISCOUNT_PERCENTAGE','BILL_DISCOUNT_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_MASTERS') 
INSERT INTO @dtLocal VALUES('PRT','RMM.DISCOUNT_AMOUNT','BILL_DISCOUNT_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS') 
INSERT INTO @dtLocal VALUES('PRT','SL.DEPT_ID','SOURCE_LOCATION__ID',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.DEPT_NAME','SOURCE_LOCATION_NAME',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.address1','SOURCE_LOCATION_ADDRESS1',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.address2','SOURCE_LOCATION_ADDRESS2',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.REGISTERED_ADD','SOURCE_LOCATION_REGISTERED_ADDRESS',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.TIN_NO','SOURCE_LOCATION_TIN',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.loc_gst_no','SOURCE_LOCATION_GST_NO',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','ISNULL(LEFT(SL.loc_gst_no,2),'''')','SOURCE_LOCATION_STATE_CODE',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SLA.AREA_NAME','SOURCE_LOCATION_AREA',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SLA.PINCODE','SOURCE_LOCATION_PIN',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SLC.CITY','SOURCE_LOCATION_CITY',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SLS.GST_STATE_NAME','SOURCE_LOCATION_STATE_NAME',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SLR.region_name','SOURCE_LOCATION_COUNTRY_NAME',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.PHONE','SOURCE_LOCATION_PHONE',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.CONTACT_NO','SOURCE_LOCATION_CONTACT_NO',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.PARTY_CODE','SOURCE_LOCATION_PARTY_CODE',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','SL.DEPT_ALIAS','SOURCE_LOCATION_DEPT_ALIAS',0,'DEBITNOTE','SOURCE_LOCATION')

INSERT INTO @dtLocal VALUES('PRT','TL.DEPT_ID','TARGET_LOCATION__ID',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.DEPT_NAME','TARGET_LOCATION_NAME',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.address1','TARGET_LOCATION_ADDRESS1',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.address2','TARGET_LOCATION_ADDRESS2',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.REGISTERED_ADD','TARGET_LOCATION_REGISTERED_ADDRESS',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.TIN_NO','TARGET_LOCATION_TIN',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.loc_gst_no','TARGET_LOCATION_GST_NO',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','ISNULL(LEFT(TL.loc_gst_no,2),'''')','TARGET_LOCATION_STATE_CODE',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TLA.AREA_NAME','TARGET_LOCATION_AREA',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TLC.CITY','TARGET_LOCATION_CITY',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TLS.GST_STATE_NAME','TARGET_LOCATION_STATE_NAME',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TLR.region_name','TARGET_LOCATION_COUNTRY_NAME',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.PHONE','TARGET_LOCATION_PHONE',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.CONTACT_NO','TARGET_LOCATION_CONTACT_NO',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.PARTY_CODE','TARGET_LOCATION_PARTY_CODE',0,'DEBITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','TL.DEPT_ALIAS','TARGET_LOCATION_DEPT_ALIAS',0,'DEBITNOTE','TARGET_LOCATION')

INSERT INTO @dtLocal VALUES('PRT','CMP.COMPANY_NAME','COMPANY_NAME',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.ADDRESS1','COMPANY_ADDRESS1',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.ADDRESS2','COMPANY_ADDRESS2',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.CITY','COMPANY_CITY',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.[STATE]','COMPANY_STATE',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.COUNTRY','COMPANY_COUNTRY',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.GST_NO','COMPANY_GST_NO',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.CIN','COMPANY_CIN',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.PAN_NO','COMPANY_PAN_NO',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.PIN','COMPANY_PIN',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.EMAIL_ID','COMPANY_EMAIL_ID',0,'DEBITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('PRT','CMP.WEB_ADDRESS','COMPANY_WEBSITE',0,'DEBITNOTE','COMPANY')

INSERT INTO @dtLocal VALUES('PRT','TR.DISP_WEIGHT','DISP_WEIGHT',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','TR.DISP_BOX_NO','DISP_BOX_NO',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','TR.TRANSPORTER_NAME','TRANSPORTER_NAME',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','TR.BILTY_NO','BILTY_NO',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','TR.BILTY_DATE','BILTY_DATE',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','TR.VEHICLE_NO','VEHICLE_NO',0,'DEBITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('PRT','sku_names.barcode_img_id','PROD_IMAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')


INSERT INTO @dtLocal VALUES('PRT','PRLM.AC_NAME','PARTY_NAME',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLM.ALIAS','PARTY_ALIAS',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.AC_GST_NO','PARTY_GST_NO',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.ADDRESS0','PARTY_ADDRESS1',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.ADDRESS1','PARTY_ADDRESS2',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.ADDRESS2','PARTY_ADDRESS3',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.E_MAIL','PARTY_E_MAIL',0,'DEBITNOTE','PARTY')

INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.REGISTERED_GST_DEALER','REGISTERED_GST_DEALER',0,'DEBITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.PAN_NO','PARTY_PAN_NO',0,'DEBITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.PARTY_ERP_CODE','PARTY_ERP_CODE',0,'DEBITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.LMP_MSME','LMP_MSME',0,'DEBITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.LMP_MSME_NO','LMP_MSME_NO',0,'DEBITNOTE','PARTY')



INSERT INTO @dtLocal VALUES('PRT','PRA.AREA_NAME','PARTY_AREA',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRC.city','PARTY_CITY',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRS.GST_STATE_NAME','PARTY_STATE_NAME',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRS.GST_STATE_CODE','PARTY_STATE_CODE',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRR.region_name','PARTY_COUNTRY',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','SLS.UT','UT_STATUS',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRA.PINCODE','PARTY_PIN',0,'DEBITNOTE','PARTY')

INSERT INTO @dtLocal VALUES('PRT','PRLMP.MOBILE','PARTY_MOBILE',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.PHONES_O','PARTY_PHONES_O',0,'DEBITNOTE','PARTY')

INSERT INTO @dtLocal VALUES('PRT','PRLMP.TIN_NO','PARTY_TIN_NO',0,'DEBITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('PRT','PRLMP.CST_NO','PARTY_CST_NO',0,'DEBITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('PRT','PRLMP.PRINT_NAME','LEDGER_PRINT_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')


--FOR TAX INVOICE BEFORE GST
INSERT INTO @dtLocal VALUES('PRT','RMD01106.ITEM_TAX_PERCENTAGE','VAT_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.item_tax_amount','VAT_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.purchase_price','purchase_price',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMM.TOTAL_GST_CESS_AMOUNT','TOTAL_GST_CESS_AMOUNT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.GST_Cess_AMount','GST_Cess_AMount',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMD01106.GST_Cess_Percentage','GST_Cess_Percentage',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('PRT','RMD01106.pur_gross_purchase_price','pur_gross_purchase_price',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('PRT','RMD01106.PUR_DISCOUNT_AMOUNT','PUR_DISCOUNT_AMOUNT',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('PRT','RMD01106.pur_taxable_value','pur_taxable_value',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('PRT','RMD01106.PUR_DISCOUNT_PERCENTAGE','PUR_DISCOUNT_PERCENTAGE',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('PRT','RMD01106.CashDiscountAmount','CashDiscountAmount',0,'DEBITNOTE','DEBITNOTE_DETAILS')



INSERT INTO @dtLocal VALUES('PRT','RMM.ACH_NO','ACH_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.ACH_DT','ACH_DT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.IRN_QR_CODE','IRN_QR_CODE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.EINV_IRN_NO','EINV_IRN_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','SKU.FIX_MRP','FIX_MRP',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','RMM.AUTO_EWAYBILL_NO','AUTO_EWAYBILL_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.AUTO_EWAYBILL_DT','AUTO_EWAYBILL_DT',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @DTLOCAL VALUES('PRT','RMM.EWAYDISTANCE','EWAYDISTANCE',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','RMM.RM_TIME','DATE_WITH_TIME',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT','ISNULL(BN.AC_NAME,'''') ','BROKER_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('PRT',' RMD01106.BILL_NO+CASE YEAR(ISNULL(RMD01106.BILL_DT,'''')) WHEN 1900 THEN '''' ELSE ''/''+CONVERT(VARCHAR,RMD01106.BILL_DT,105) END ','BILL_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','OEMLM.AC_NAME','OEM_NAME',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMLM.ALIAS','OEM_ALIAS',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMLMP.ADDRESS0','OEM_ADDRESS1',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMLMP.ADDRESS1','OEM_ADDRESS2',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMLMP.ADDRESS2','OEM_ADDRESS3',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMLMP.MOBILE','OEM_MOBILE',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMA.AREA_NAME','OEM_AREA',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMA.PINCODE','OEM_PIN',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMC.city','OEM_CITY',0,'DEBITNOTE','OEMPARTY')
INSERT INTO @dtLocal VALUES('PRT','OEMS.GST_STATE_NAME','OEM_STATE_NAME',0,'DEBITNOTE','OEMPARTY')



INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.PRINT_NAME  ELSE SHLMP.PRINT_NAME END
					ELSE PRLMP.PRINT_NAME END','SHIPPING_PRINT_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLM.AC_NAME  ELSE SHLM.AC_NAME END
					ELSE PRLM.AC_NAME END','SHIPPING_AC_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')



INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.ADDRESS0  ELSE RMM.SHIPPING_ADDRESS END
					ELSE PRLMP.ADDRESS0 END','SHIPPING_ADDRESS',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.ADDRESS1  ELSE RMM.SHIPPING_ADDRESS2 END
					ELSE PRLMP.ADDRESS1 END','SHIPPING_ADDRESS2',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.ADDRESS2  ELSE RMM.SHIPPING_ADDRESS3 END
					ELSE PRLMP.ADDRESS2 END','SHIPPING_ADDRESS3',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.Ac_gst_no  ELSE SHLMP.Ac_gst_no END
					ELSE PRLMP.Ac_gst_no END','SHIPPING_GST_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.MOBILE  ELSE SHLMP.MOBILE END
					ELSE PRLMP.MOBILE END','SHIPPING_MOBILE',0,'DEBITNOTE','DEBITNOTE_MASTERS')



INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHAR.AREA_CODE  ELSE RMM.SHIPPING_AREA_CODE END
					ELSE PRA.AREA_CODE END','SHIPPING_AREA_CODE',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHAR.AREA_NAME  ELSE RMM.SHIPPING_AREA_NAME END
					ELSE PRA.AREA_NAME END','SHIPPING_AREA_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHCT.CITY   ELSE RMM.SHIPPING_CITY_NAME  END
					ELSE PRC.CITY END','SHIPPING_CITY_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN shCS.gst_state_name   ELSE RMM.SHIPPING_STATE_NAME  END
					ELSE PRS.gst_state_name END','SHIPPING_STATE_NAME',0,'DEBITNOTE','DEBITNOTE_MASTERS')

					
INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN shCS.gst_state_code   ELSE SHST.GST_STATE_CODE  END
					ELSE PRS.gst_state_CODE END','SHIPPING_STATE_CODE',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHAR.pincode   ELSE RMM.shipping_pin  END
					ELSE PRA.pincode END','SHIPPING_PIN',0,'DEBITNOTE','DEBITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.registered_gst_dealer  ELSE SHLMP.registered_gst_dealer END
					ELSE PRLMP.REGISTERED_GST_DEALER END','SHIPPING_REGISTERED_GST_DEALER',0,'DEBITNOTE','DEBITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.pan_no  ELSE SHLMP.pan_no END
					ELSE PRLMP.pan_no END','SHIPPING_pan_no',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.party_erp_code  ELSE SHLMP.party_erp_code END
					ELSE PRLMP.party_erp_code END','SHIPPING_party_erp_code',0,'DEBITNOTE','DEBITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.LMP_MSME  ELSE SHLMP.LMP_MSME END
					ELSE PRLMP.LMP_MSME END','SHIPPING_LMP_MSME',0,'DEBITNOTE','DEBITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('PRT','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =1 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)<>1 THEN SHLMP.LMP_MSME_NO  ELSE SHLMP.LMP_MSME_NO END
					ELSE PRLMP.LMP_MSME_NO END','SHIPPING_LMP_MSME_NO',0,'DEBITNOTE','DEBITNOTE_MASTERS')
																				
					
INSERT INTO @DTLOCAL VALUES('PRT','SL.DEPT_PRINT_NAME','LOCATION_PRINT_NAME',0,'DEBITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_1','TNC_1',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_2','TNC_2',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_3','TNC_3',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_4','TNC_4',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_5','TNC_5',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_6','TNC_6',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_7','TNC_7',0,'DEBITNOTE','DEBITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('PRT','GST_TNC.TNC_8','TNC_8',0,'DEBITNOTE','DEBITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('PRT','SizeQtyString','SizeQtyString',0,'DEBITNOTE','DEBITNOTE_DETAILS')


UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1

DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'DEBITNOTE'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='PRT'
WHERE b.COLUMN_NAME IS NULL

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='PRT'
)

DELETE  FROM CTE WHERE SR>1


