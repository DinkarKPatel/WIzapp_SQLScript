CREATE PROC SP_GENBARCODE 
(@CWHERE VARCHAR(40))
--WITH ENCRYPTION
AS
BEGIN
	SELECT A.PRODUCT_CODE, A.MRP, A.PURCHASE_PRICE, A.WS_PRICE, B.ARTICLE_NO, B.ARTICLE_NAME,A.BARCODE_CODING_SCHEME AS CODING_SCHEME, 
			B.DISCON,D.SECTION_CODE,SECTION_NAME,C.SUB_SECTION_CODE,SUB_SECTION_NAME, E.PARA1_CODE, E.PARA1_NAME, E.PARA1_ORDER, F.PARA2_CODE, 
			F.PARA2_NAME, F.PARA2_ORDER, G.PARA3_CODE, G.PARA3_NAME,  H.PARA4_CODE, H.PARA4_NAME, 
			 I.PARA5_CODE, I.PARA5_NAME,  J.PARA6_CODE, J.PARA6_NAME, 
			B.ARTICLE_DESC,K.AC_NAME,A.INV_NO,A.INV_DT,A.CHALLAN_NO,K.ALIAS, G.INACTIVE AS PARA3_INACTIVE,
			UOM.UOM_CODE,UOM.UOM_NAME,UOM.UOM_TYPE,A.FIX_MRP,A.PRODUCT_NAME,B.STOCK_NA
			,AT1.ATTR1_KEY_NAME,AT2.ATTR2_KEY_NAME,AT3.ATTR3_KEY_NAME,AT4.ATTR4_KEY_NAME,AT5.ATTR5_KEY_NAME,AT6.ATTR6_KEY_NAME,
			AT7.ATTR7_KEY_NAME,AT8.ATTR8_KEY_NAME,AT9.ATTR9_KEY_NAME,AT10.ATTR10_KEY_NAME,AT11.ATTR11_KEY_NAME,AT12.ATTR12_KEY_NAME,
			AT13.ATTR13_KEY_NAME,AT14.ATTR14_KEY_NAME,AT15.ATTR15_KEY_NAME,AT16.ATTR16_KEY_NAME,AT17.ATTR17_KEY_NAME,AT18.ATTR18_KEY_NAME,
			AT19.ATTR19_KEY_NAME,AT20.ATTR20_KEY_NAME,AT21.ATTR21_KEY_NAME,AT22.ATTR22_KEY_NAME,AT23.ATTR23_KEY_NAME,AT24.ATTR24_KEY_NAME,
			AT25.ATTR25_KEY_NAME 

	FROM SKU A 
	JOIN ARTICLE B ON B.ARTICLE_CODE = A.ARTICLE_CODE
	JOIN SECTIOND C ON C.SUB_SECTION_CODE = B.SUB_SECTION_CODE
	JOIN SECTIONM D ON D.SECTION_CODE = C.SECTION_CODE
	LEFT OUTER JOIN ARTICLE_FIX_ATTR ATTR  (NOLOCK) ON A.ARTICLE_CODE = ATTR.ARTICLE_CODE 
LEFT OUTER JOIN ATTR1_MST AT1 (NOLOCK) ON AT1.ATTR1_KEY_CODE=ATTR.ATTR1_KEY_CODE
LEFT OUTER JOIN ATTR2_MST AT2 (NOLOCK) ON AT2.ATTR2_KEY_CODE=ATTR.ATTR2_KEY_CODE
LEFT OUTER JOIN ATTR3_MST AT3 (NOLOCK) ON AT3.ATTR3_KEY_CODE=ATTR.ATTR3_KEY_CODE
LEFT OUTER JOIN ATTR4_MST AT4 (NOLOCK) ON AT4.ATTR4_KEY_CODE=ATTR.ATTR4_KEY_CODE
LEFT OUTER JOIN ATTR5_MST AT5 (NOLOCK) ON AT5.ATTR5_KEY_CODE=ATTR.ATTR5_KEY_CODE
LEFT OUTER JOIN ATTR6_MST AT6 (NOLOCK) ON AT6.ATTR6_KEY_CODE=ATTR.ATTR6_KEY_CODE
LEFT OUTER JOIN ATTR7_MST AT7 (NOLOCK) ON AT7.ATTR7_KEY_CODE=ATTR.ATTR7_KEY_CODE
LEFT OUTER JOIN ATTR8_MST AT8 (NOLOCK) ON AT8.ATTR8_KEY_CODE=ATTR.ATTR8_KEY_CODE
LEFT OUTER JOIN ATTR9_MST AT9 (NOLOCK) ON AT9.ATTR9_KEY_CODE=ATTR.ATTR9_KEY_CODE
LEFT OUTER JOIN ATTR10_MST AT10 (NOLOCK) ON AT10.ATTR10_KEY_CODE=ATTR.ATTR10_KEY_CODE
LEFT OUTER JOIN ATTR11_MST AT11 (NOLOCK) ON AT11.ATTR11_KEY_CODE=ATTR.ATTR11_KEY_CODE
LEFT OUTER JOIN ATTR12_MST AT12 (NOLOCK) ON AT12.ATTR12_KEY_CODE=ATTR.ATTR12_KEY_CODE
LEFT OUTER JOIN ATTR13_MST AT13 (NOLOCK) ON AT13.ATTR13_KEY_CODE=ATTR.ATTR13_KEY_CODE
LEFT OUTER JOIN ATTR14_MST AT14 (NOLOCK) ON AT14.ATTR14_KEY_CODE=ATTR.ATTR14_KEY_CODE
LEFT OUTER JOIN ATTR15_MST AT15 (NOLOCK) ON AT15.ATTR15_KEY_CODE=ATTR.ATTR15_KEY_CODE
LEFT OUTER JOIN ATTR16_MST AT16 (NOLOCK) ON AT16.ATTR16_KEY_CODE=ATTR.ATTR16_KEY_CODE
LEFT OUTER JOIN ATTR17_MST AT17 (NOLOCK) ON AT17.ATTR17_KEY_CODE=ATTR.ATTR17_KEY_CODE
LEFT OUTER JOIN ATTR18_MST AT18 (NOLOCK) ON AT18.ATTR18_KEY_CODE=ATTR.ATTR18_KEY_CODE
LEFT OUTER JOIN ATTR19_MST AT19 (NOLOCK) ON AT19.ATTR19_KEY_CODE=ATTR.ATTR19_KEY_CODE
LEFT OUTER JOIN ATTR20_MST AT20 (NOLOCK) ON AT20.ATTR20_KEY_CODE=ATTR.ATTR20_KEY_CODE
LEFT OUTER JOIN ATTR21_MST AT21 (NOLOCK) ON AT21.ATTR21_KEY_CODE=ATTR.ATTR21_KEY_CODE
LEFT OUTER JOIN ATTR22_MST AT22 (NOLOCK) ON AT22.ATTR22_KEY_CODE=ATTR.ATTR22_KEY_CODE
LEFT OUTER JOIN ATTR23_MST AT23 (NOLOCK) ON AT23.ATTR23_KEY_CODE=ATTR.ATTR23_KEY_CODE
LEFT OUTER JOIN ATTR24_MST AT24 (NOLOCK) ON AT24.ATTR24_KEY_CODE=ATTR.ATTR24_KEY_CODE
LEFT OUTER JOIN ATTR25_MST AT25(NOLOCK) ON AT25.ATTR25_KEY_CODE=ATTR.ATTR25_KEY_CODE
	JOIN PARA1 E ON E.PARA1_CODE = A.PARA1_CODE
	JOIN PARA2 F ON F.PARA2_CODE = A.PARA2_CODE
	JOIN PARA3 G ON G.PARA3_CODE = A.PARA3_CODE
	JOIN PARA4 H ON H.PARA4_CODE = A.PARA4_CODE
	JOIN PARA5 I ON I.PARA5_CODE = A.PARA5_CODE
	JOIN PARA6 J ON J.PARA6_CODE = A.PARA6_CODE
	JOIN LM01106 K ON K.AC_CODE=A.AC_CODE 
	JOIN UOM ON UOM.UOM_CODE=B.UOM_CODE
	JOIN PID01106 PID ON  A.PRODUCT_CODE =PID.PRODUCT_CODE 
	WHERE PID.MRR_ID = @CWHERE
END
