CREATE PROCEDURE SP_JOBWORK_BARCODELIST
(
  @XN_TYPE VARCHAR(10),
  @CMEMO_ID VARCHAR(50),
  @CROW_ID VARCHAR(50)
)
AS
BEGIN
      
	  DECLARE @CTABLENAME VARCHAR(50),@CCOLUMNNAME VARCHAR(20),
	  @DTSQL NVARCHAR(MAX)

	  SET @CTABLENAME=CASE WHEN @XN_TYPE='JWI' THEN 'JOBWORK_ISSUE_DET'
	                       WHEN @XN_TYPE='JWR' THEN 'JOBWORK_RECEIPT_DET' 
						   WHEN @XN_TYPE='Size_NA' THEN 'PPC_FG_BARCODE_NA_DET' 
						   ELSE 'TRANSFER_tO_TRADING_DET' END

						
	  SET @CCOLUMNNAME=CASE WHEN @XN_TYPE='JWI' THEN 'a.ISSUE_ID'
	                       WHEN @XN_TYPE='JWR' THEN 'a.Receipt_id' 
						   ELSE 'a.memo_id' END

     --***---Display In show without barcode  Grid row_id CAST(''LATER''+SKU.ARTICLE_CODE +SKU.PARA1_CODE +SKU.PARA2_CODE AS VARCHAR(40)) apply filter on this--*****
	 if @XN_TYPE='Size_NA'
	 begin
	     
		 	 SET @DTSQL=N' SELECT A.PRODUCT_CODE ,A.QUANTITY,A.ROW_ID
					  FROM '+@CTABLENAME+' A (NOLOCK)
					  JOIN SKU  (NOLOCK) ON A.PRODUCT_CODE =sku.PRODUCT_CODE 
					  join para2 p2 (nolock) on p2.para2_code=sku.para2_code 
					  WHERE '+@CCOLUMNNAME+'='''+@CMEMO_ID+'''
					  AND CAST(SKU.ARTICLE_CODE +SKU.PARA1_CODE +P2.PARA2_SET AS VARCHAR(100))='''+@CROW_ID+''' 
					  ORDER BY A.PRODUCT_CODE'
			 PRINT @DTSQL
			 EXEC SP_EXECUTESQL @DTSQL

	    
	 end
	 else 
	 begin

		 SET @DTSQL=N' SELECT A.PRODUCT_CODE ,A.QUANTITY,A.ROW_ID
					  FROM '+@CTABLENAME+' A (NOLOCK)
					  JOIN SKU  (NOLOCK) ON A.PRODUCT_CODE =sku.PRODUCT_CODE 
					  WHERE '+@CCOLUMNNAME+'='''+@CMEMO_ID+'''
					  AND CAST(''LATER''+SKU.ARTICLE_CODE +SKU.PARA1_CODE +SKU.PARA2_CODE AS VARCHAR(40))='''+@CROW_ID+''' 
					  ORDER BY A.PRODUCT_CODE'
		 PRINT @DTSQL
		 EXEC SP_EXECUTESQL @DTSQL

	 end 
    
	

END