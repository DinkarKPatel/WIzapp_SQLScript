CREATE VIEW VW_WL_PRD_PO

AS      
SELECT       D.PRODUCT_UID,
A.CHECKED_BY AS MST_CHECKED_BY, A.DELIVERY_DT AS MST_DELIVERY_TO_DT,      
A.DISCOUNT_AMOUNT AS MST_DISCOUNT_AMOUNT,      
A.DISCOUNT_PERCENTAGE AS MST_DISCOUNT_PERCENTAGE,      
A.FREIGHT AS MST_FREIGHT,      
A.OTHER_CHARGES AS MST_OTHER_CHARGES,      
A.PO_DT AS MST_XN_DT,      
A.PO_ID,      
A.PO_NO AS MST_PO_NO,      
A.REMARKS AS MST_REMARKS,      
A.ROUND_OFF AS MST_ROUND_OFF,      
A.SUBTOTAL AS MST_SUBTOTAL,      
D.ITEM_TAX_AMOUNT AS MST_TAX_AMOUNT,      
D.ITEM_TAX_PERCENTAGE AS MST_TAX_PERCENTAGE,      
A.TOTAL_AMOUNT AS MST_TOTAL_AMOUNT,      
A.FIN_YEAR AS MST_FIN_YEAR,      
B.PRINT_NAME,  
B.ADDRESS0,  
B.ADDRESS1,  
B.ADDRESS2,  
B.AREA_NAME,  
B.PINCODE,  
B.CITY,  
B.STATE,  
B.CST_NO,  
B.CST_DT,  
B.SST_NO,  
B.SST_DT,  
B.TIN_NO,  
B.TIN_DT,  
B.PHONES_R,  
B.PHONES_O,  
B.PHONES_FAX,  
B.MOBILE,  
B.E_MAIL,  
B.TAX_CODE,  
B.CREDIT_LIMIT,  
B.PAN_NO,  
B.GLN_NO,  
C.USERNAME AS MST_CREATED_USERNAME,      
P1.PARA1_NAME,      
P2.PARA2_NAME,      
P3.PARA3_NAME,      
P4.PARA4_NAME,      
P5.PARA5_NAME,      
P6.PARA6_NAME,      
E.ARTICLE_NO,      
D.AMOUNT,      
D.MP_PERCENTAGE,      
D.MRP,      
  
D.PURCHASE_PRICE,      
D.QUANTITY,      
D.WS_PRICE,      
U.UOM_NAME     
,A.PO_NO  
,A.PO_DT  
,A.AC_CODE  
,A.TOTAL_AMOUNT  
,A.REMARKS  
,A.LAST_UPDATE  
,A.TS  
,A.SUBTOTAL  
,D.ITEM_DISCOUNT_PERCENTAGE AS DISCOUNT_PERCENTAGE  
,D.ITEM_DISCOUNT_AMOUNT AS DISCOUNT_AMOUNT  
,A.OTHER_CHARGES  
,A.CANCELLED  
,A.REF_NO  
,A.COMPANY_CODE  
,A.USER_CODE  
,A.SENT_TO_HO  
,A.FIN_YEAR  
,A.DELIVERY_DT  
,A.DEPT_ID  
,A.CHECKED_BY  
,A.SENT_BY  
,A.SENT  
,A.TAX_PERCENTAGE  
,A.FREIGHT  
,A.ROUND_OFF  
,A.TAX_AMOUNT  
,A.EDT_USER_CODE  
,A.PO_TIME  
,A.APPROVED  
,A.CREDIT_DAYS  
,A.FREIGHT_MODE  
,A.DELIVERY_MODE  
,A.FORM_ID  
,A.MODE  
,A.CANCELLED_ON  
,A.UPLOADED_TO_ACTIVSTREAM  
,B.TDS_CODE  
,B.INACTIVE  
,B.AC_NAME  
,B.ALIAS  
,B.HEAD_CODE  
,B.CLOSING_BALANCE  
,B.CLOSING_BALANCE_CR_DR  
,B.PRINT_LEDGER  
,C.USERNAME  
,C.MAJOR_USER_CODE  
,C.USER_ALIAS  
,C.DISCOUNT_PERCENTAGE_LEVEL  
,C.VIEW_DATA_AFTER_DFM  
,D.ARTICLE_CODE  
,D.PARA1_CODE  
,D.PARA2_CODE  
,D.ROW_ID  
,D.PARA3_CODE  
,D.SRNO  
,D.PRINT_LABEL  
,D.PARA4_CODE  
,D.PARA5_CODE  
,D.PARA6_CODE  
,D.WSP_PERCENTAGE  
,D.ADJ_QUANTITY  
,D.INVOICE_QUANTITY  
,D.SCHEME_QUANTITY  
,P1.PARA1_ORDER  
,P1.PARA1_SET  
,P2.PARA2_ORDER  
,P2.PARA2_SET  
,P3.DT_CREATED  
,E.CODING_SCHEME  
,E.UOM_CODE  
,E.SKU_CODE  
,E.ARTICLE_NAME  
,E.ARTICLE_DESC  
,E.SUB_SECTION_CODE  
,E.DISCON  
,E.WHOLESALE_PRICE  
,E.STOCK_NA  
,E.ARTICLE_TYPE  
,E.CREATED_ON  
,E.ARTICLE_GROUP_CODE  
,E.GENERATE_BARCODES_WITHARTICLE_PREFIX  
,E.ARTICLE_GEN_MODE  
,E.ARTICLE_PRD_MODE  
,E.ARTICLE_SET_CODE  
,E.OH_PERCENTAGE  
,E.OH_AMOUNT  
,U.UOM_TYPE  
,CMP.WORKABLE  
,CMP.PIN  
,CMP.LOGO_PATH  
,CMP.WEB_ADDRESS  
,CMP.SSPL_FIRST_HDSR  
,CMP.POLICY_NO  
,CMP.PAN_NO AS COMPANY_PAN_NO  
,CMP.EMAIL_ID AS COMPANY_EMAIL_ID  
,CMP.COUNTRY AS COMPANY_COUNTRY  
,CMP.MOBILE AS COMPANY_MOBILE  
,CMP.CONTACT_NAME AS COMPANY_CONTACT_NAME  
,CMP.TDS_AC_NO AS COMPANY_TDS_AC_NO  
,CMP.COMPANY_NAME  
,CMP.ALIAS AS COMPANY_ALIAS  
,CMP.ADDRESS1 AS COMPANY_ADDRESS1  
,CMP.ADDRESS2 AS COMPANY_ADDRESS2  
,CMP.PHONES_FAX AS COMPANY_PHONES_FAX  
,CMP.CST_NO AS COMPANY_CST_NO  
,CMP.CST_DT AS COMPANY_CST_DT  
,CMP.SST_NO AS COMPANY_SST_NO  
,CMP.SST_DT AS COMPANY_SST_DT  
,CMP.GRP_CODE AS COMPANY_GRP_CODE  
,CMP.ADDRESS9 AS COMPANY_ADDRESS9  
,CA.AREA_NAME AS COMPANY_AREA  
,CC.CITY AS COMPANY_CITY  
,CS.STATE AS COMPANY_STATE  
,CRG.REGION_NAME AS COMPANY_REGION  
,LCT.DEPT_ID AS LOCATION_DEPT_ID  
,LCT.DEPT_NAME AS LOCATION_DEPT_NAME  
,LCT.MAJOR_DEPT_ID AS LOCATION_MAJOR_DEPT_ID  
,LCT.AREA_CODE AS LOCATION_AREA_CODE  
,LCT.PRIMARY_EMAIL AS LOCATION_PRIMARY_EMAIL  
,LCT.PRIMARY_EMAIL_SMTP AS LOCATION_PRIMARY_EMAIL_SMTP  
,LCT.PRIMARY_EMAIL_PWD AS LOCATION_PRIMARY_EMAIL_PWD  
,LCT.PRIMARY_EMAIL_SSL AS LOCATION_PRIMARY_EMAIL_SSL  
,LCT.SSPL_GRP_CODE AS LOCATION_SSPL_GRP_CODE  
,LCT.PUR_LOC AS LOCATION_PUR_LOC  
,LCT.ADDRESS1 AS LOCATION_ADDRESS1  
,LCT.ADDRESS2 AS LOCATION_ADDRESS2  
,LCT.DEPT_AC_CODE AS LOCATION_DEPT_AC_CODE  
,LCT.CST_NO AS LOCATION_CST_NO  
,LCT.CST_DT AS LOCATION_CST_DT  
,LCT.LST_NO AS LOCATION_LST_NO  
,LCT.LST_DT AS LOCATION_LST_DT  
,LCT.DEPT_ALIAS AS LOCATION_DEPT_ALIAS  
,LCT.PHONE AS LOCATION_PHONE  
,LCT.DATE_OF_OPENING AS LOCATION_DATE_OF_OPENING  
,LCT.REPORT_BLOCKED AS LOCATION_REPORT_BLOCKED  
,LCT.INACTIVE AS LOCATION_INACTIVE  
,LCT.LOC_TYPE AS LOCATION_LOC_TYPE  
,LCT.ACCOUNTS_POSTING_DEPT_ID AS LOCATION_ACCOUNTS_POSTING_DEPT_ID  
,LCT.CONTROL_AC_CODE AS LOCATION_CONTROL_AC_CODE  
,LCT.UPD_PURINFO AS LOCATION_UPD_PURINFO  
,LCT.SSPL_REG_KEY AS LOCATION_SSPL_REG_KEY  
,LCT.WIZCOM_ENABLED AS LOCATION_WIZCOM_ENABLED  
,LCT.EXCISABLE AS LOCATION_EXCISABLE  
,LCT.TIN_NO AS LOCATION_TIN_NO  
,LCT.FR_TYPE AS LOCATION_FR_TYPE  
,LCT.PRIMARY_EMAIL_PORT AS LOCATION_PRIMARY_EMAIL_PORT  
,LA.AREA_NAME AS LOCATION_AREA  
,LC.CITY AS LOCATION_CITY  
,LS.STATE AS LOCATION_STATE  
,LRG.REGION_NAME AS LOCATION_REGION  
,HD.HEAD_NAME  
,HD.MAJOR_HEAD_CODE  
,HD.PHYSICAL  
,HD.PRINT_HEAD  
,HD.CREDITOR_DEBTOR_CODE  
,SD.SECTION_CODE  
,SD.SUB_SECTION_NAME  
,SD.MFG_CATEGORY  
,SM.SECTION_NAME,  
D.GROSS_PURCHASE_PRICE ,  
D.ITEM_DISCOUNT_PERCENTAGE ,D.ITEM_DISCOUNT_AMOUNT   ,
WO.MEMO_NO AS WORK_ORDER_NO, WO.REF_NO AS BUYER_ORDER_REF_NO, WOA.ARTICLE_NO AS SET_NO
,EMP.EMP_FNAME+' '+EMP.EMP_LNAME AS EMP_NAME 
FROM PRD_POM01106 A      
JOIN LMV01106 B (NOLOCK) ON A.AC_CODE = B.AC_CODE      
JOIN USERS C (NOLOCK) ON A.USER_CODE = C.USER_CODE      
JOIN PRD_POD01106 D (NOLOCK) ON A.PO_ID = D.PO_ID      
JOIN PARA1 P1 (NOLOCK) ON D.PARA1_CODE = P1.PARA1_CODE      
JOIN PARA2 P2 (NOLOCK) ON D.PARA2_CODE = P2.PARA2_CODE      
JOIN PARA3 P3 (NOLOCK) ON D.PARA3_CODE = P3.PARA3_CODE      
JOIN PARA4 P4 (NOLOCK) ON D.PARA4_CODE = P4.PARA4_CODE      
JOIN PARA5 P5 (NOLOCK) ON D.PARA5_CODE = P5.PARA5_CODE      
JOIN PARA6 P6 (NOLOCK) ON D.PARA6_CODE = P6.PARA6_CODE      
JOIN ARTICLE E (NOLOCK) ON D.ARTICLE_CODE = E.ARTICLE_CODE      
JOIN UOM U (NOLOCK) ON E.UOM_CODE = U.UOM_CODE    
JOIN PRD_SKU SKU(NOLOCK)  ON SKU.PRODUCT_UID= D.PRODUCT_UID
JOIN COMPANY CMP ON A.COMPANY_CODE=CMP.COMPANY_CODE  
JOIN AREA CA ON CMP.AREA_CODE=CA.AREA_CODE  
JOIN CITY CC ON CA.CITY_CODE=CC.CITY_CODE  
JOIN STATE CS ON CC.CITY_CODE=CS.STATE_CODE  
JOIN REGIONM CRG ON CS.REGION_CODE=CRG.REGION_CODE  
JOIN LOCATION LCT ON A.DEPT_ID=LCT.DEPT_ID  
JOIN AREA LA ON LCT.AREA_CODE=LA.AREA_CODE  
JOIN CITY LC ON LA.CITY_CODE=LC.CITY_CODE  
JOIN STATE LS ON LC.STATE_CODE=LS.STATE_CODE  
JOIN REGIONM LRG ON LS.REGION_CODE=LRG.REGION_CODE  
JOIN HD01106 HD ON B.HEAD_CODE=HD.HEAD_CODE  
JOIN SECTIOND SD ON E.SUB_SECTION_CODE=SD.SUB_SECTION_CODE  
JOIN SECTIONM SM ON SD.SECTION_CODE=SM.SECTION_CODE  
LEFT OUTER JOIN PRD_WO_MST WO ON WO.MEMO_ID=SKU.WORK_ORDER_ID
LEFT OUTER JOIN ARTICLE WOA ON WOA.ARTICLE_CODE=WO.ARTICLE_SET_CODE  
LEFT OUTER JOIN EMP_MST EMP ON EMP.EMP_ID=WO.EMP_CODE
