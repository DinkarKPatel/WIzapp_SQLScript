


---- UNCOMMENT THE FOLLOWING CODE WHEN NEW POSTING METHOD GETS FINALIZED
--IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='INSERT_VOUCHERPOSTINGNEW_REF_ENTRIES' AND VALUE=1)
--BEGIN
--	PRINT 'INSERTING NEW VOUCHER POSTING REFERENCES TABLE'

--	IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='INSERT_VOUCHERPOSTINGNEW_REF_ENTRIES')
--		INSERT CONFIG (CONFIG_OPTION,VALUE,ROW_ID,LAST_UPDATE)
--			   VALUES ('INSERT_VOUCHERPOSTINGNEW_REF_ENTRIES','1','',GETDATE())	
--	ELSE
--		UPDATE CONFIG SET VALUE='1' WHERE CONFIG_OPTION='INSERT_VOUCHERPOSTINGNEW_REF_ENTRIES'

--	INSERT VOUCHER_POSTING_REF	( XN_TYPE, MEMO_ID, VM_ID, LAST_UPDATE ) 
--	SELECT 'PUR' AS XN_TYPE,MRR_ID AS MEMO_ID,A.VM_ID,LAST_UPDATE FROM VM_MRR A
--	JOIN VM01106 B ON A.VM_ID=B.VM_ID
--	WHERE CANCELLED=0
--	UNION 
--	SELECT 'PUR' AS XN_TYPE,MRR_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN PIM01106 B ON A.BILL_NO=B.BILL_NO AND A.BILL_DT=B.INV_DT AND A.BILL_AC_CODE=B.AC_CODE
--	WHERE A.CANCELLED=0	
--	UNION ALL
--	SELECT 'PRT' AS XN_TYPE,RM_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN RMM01106 B ON A.BILL_ID=B.RM_ID
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='PRT'
--	UNION ALL
--	SELECT 'WSL' AS XN_TYPE,INV_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN INM01106 B ON A.BILL_ID=B.INV_ID
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='WSL'
--	UNION ALL
--	SELECT 'WSR' AS XN_TYPE,CN_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN CNM01106 B ON A.BILL_ID=B.CN_ID
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='WSR'
--	UNION ALL
--	SELECT 'SLS' AS XN_TYPE,CM_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN CMM01106 B ON A.VOUCHER_DT=B.CM_DT AND A.DEPT_ID=LEFT(B.CM_NO,2)
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='SLS'
--	UNION ALL
--	SELECT 'ARC' AS XN_TYPE,ADV_REC_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN ARC01106 B ON A.BILL_ID=B.ADV_REC_ID
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='ARC'
--	UNION ALL
--	SELECT 'PTC' AS XN_TYPE,PEM_MEMO_ID AS MEMO_ID,A.VM_ID,A.LAST_UPDATE FROM VM01106 A
--	JOIN PEM01106 B ON A.BILL_ID=B.PEM_MEMO_ID
--	WHERE A.CANCELLED=0 AND A.BILL_TYPE='PTC'

--END	


--**** UPDATE DATE OF CREATION OF IMAGE IN NEW STRING FORMAT IN SKU,ARTICLE,PARA3...
IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE 
			   CONFIG_OPTION='UPDATE_DTCREATED_VARCHAR' AND VALUE=1)
BEGIN
	PRINT 'UPDATE DATE OF CREATION OF IMAGE IN NEW STRING FORMAT IN SKU,ARTICLE,PARA3...'

	IF NOT EXISTS (SELECT CONFIG_OPTION FROM CONFIG WHERE CONFIG_OPTION='UPDATE_DTCREATED_VARCHAR')
		INSERT CONFIG (CONFIG_OPTION,VALUE,ROW_ID,LAST_UPDATE)
			   VALUES ('UPDATE_DTCREATED_VARCHAR',1,'',GETDATE())	
	ELSE
		UPDATE CONFIG SET VALUE=1 WHERE CONFIG_OPTION='UPDATE_DTCREATED_VARCHAR'
	

	UPDATE SKU SET DT_CREATED=CONVERT(VARCHAR,CONVERT(DATETIME,DT_CREATED,112),112) WHERE DT_CREATED<>''
	
	UPDATE ARTICLE SET DT_CREATED=CONVERT(VARCHAR,CONVERT(DATETIME,DT_CREATED,112),112) WHERE DT_CREATED<>''
	
	UPDATE PARA3 SET DT_CREATED=CONVERT(VARCHAR,CONVERT(DATETIME,DT_CREATED,112),112) WHERE DT_CREATED<>''
	
END	
