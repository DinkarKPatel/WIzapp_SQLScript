CREATE VIEW VW_APPROVALRETURNLIST    

AS     
SELECT (ISNULL(CUST.CUSTOMER_TITLE,'')+' ' +ISNULL(CUST.CUSTOMER_FNAME,'')+' '+ISNULL(CUST.CUSTOMER_LNAME,'')) AS CUSTOMER_NAME,
ISNULL(CUST.USER_CUSTOMER_CODE,'') AS CUSTOMER_ID, 
ISNULL(T3.AC_NAME,'') AS SUPPLIER_NAME, 
CASE WHEN T1.MODE=1  THEN 'RETAIL SALE' WHEN T1.MODE=2 THEN 'WHOLE SALE' ELSE '' END AS MEMO_MODE,  
T1.MEMO_DT AS MEMO_DT, T1.MEMO_NO AS MEMO_NO,       
T1.MEMO_NO AS MEMO_ID,  
(CASE WHEN T1.CANCELLED = 1 THEN 'CANCELLED' ELSE '' END) AS CANCELLED  ,  
T1.FIN_YEAR  
FROM APPROVAL_RETURN_MST T1    
LEFT OUTER JOIN CUSTDYM CUST ON CUST.CUSTOMER_CODE = T1.CUSTOMER_CODE  
LEFT OUTER JOIN LMV01106 T3 ON T3.AC_CODE = T1.AC_CODE
