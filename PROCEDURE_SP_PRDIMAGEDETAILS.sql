CREATE PROCEDURE SP_PRDIMAGEDETAILS
@CPRODUCTCODE	VARCHAR(MAX),
@NINVMODE		NUMERIC(1)=1
--WITH ENCRYPTION
AS 
BEGIN
	DECLARE @CCMD NVARCHAR(MAX)
	SET @CCMD=N'SELECT TOP 1 A.PRODUCT_CODE, B.ARTICLE_NO,G.PARA3_NAME, 
	A.DT_CREATED AS [SKU_DT_CREATED],
	B.DT_CREATED AS [ART_DT_CREATED],
	G.DT_CREATED AS [PARA3_DT_CREATED],'+LTRIM(RTRIM(STR(@NINVMODE)))+' AS [IMAGE_MODE]
	FROM PRD_SKU A         
	JOIN ARTICLE B ON  A.ARTICLE_CODE= B.ARTICLE_CODE       
	JOIN PARA3 G ON A.PARA3_CODE= G.PARA3_CODE  
	WHERE '''+@CPRODUCTCODE+'''='+(CASE WHEN @NINVMODE=3 THEN 'G.PARA3_NAME' WHEN @NINVMODE=2 THEN 'B.ARTICLE_NO' ELSE 'A.PRODUCT_CODE' END)

	PRINT @CCMD

	EXEC SP_EXECUTESQL @CCMD
  
END
