CREATE PROCEDURE SP_SEND_MIRROR_MSTDATA
(
	@CXNTYPE VARCHAR(10),
	@CTARGETLOCID VARCHAR(5)='',
	@CLOCMSTLASTUPDATE VARCHAR(50)='',
	@NAPIVERSION INT=1,
	@NMODE NUMERIC(2,0)=0
)
--WITH ENCRYPTION
AS
BEGIN
    DECLARE @DTSQL NVARCHAR(MAX)
    
    IF @NMODE=3 
	BEGIN
		SELECT '' AS ERRMSG
		RETURN
	END

	IF @CXNTYPE='MSTUSR' AND @NAPIVERSION=0
		EXEC SP_SEND_MIRROR_MSTUSR @CTARGETLOCID,@CLOCMSTLASTUPDATE,@NAPIVERSION
	ELSE
	IF @CXNTYPE='MSTUSR' AND @NAPIVERSION=3
		EXEC SP_SEND_MIRROR_MSTUSR_OPTIMIZED @CTARGETLOCID,@CLOCMSTLASTUPDATE
	ELSE
	IF @CXNTYPE='MSTUSR' AND @NAPIVERSION>0
		EXEC SP_SEND_MIRROR_MSTUSR_NEW @CTARGETLOCID,@CLOCMSTLASTUPDATE,@NAPIVERSION,@NMODE
	ELSE
	IF @CXNTYPE='MSTEOSS' AND @NMODE=0
		EXEC SP_SEND_MIRROR_MSTEOSS @CTARGETLOCID,@CLOCMSTLASTUPDATE
	ELSE
	IF @CXNTYPE='MSTEOSS' AND @NMODE>0
		EXEC SP_SEND_MIRROR_MSTEOSS_NEW @CTARGETLOCID,@NMODE
	ELSE
	IF @CXNTYPE='MSTSTKCNT'
		EXEC SP_SEND_MIRROR_MSTSTKCNT @CTARGETLOCID,@NMODE
	ELSE
	IF @CXNTYPE='MSTLST'
		EXEC SP_SEND_MIRROR_LOCSST @CTARGETLOCID
	ELSE
	IF @CXNTYPE='MSTWPAY'
		EXEC SP_SEND_MIRROR_MSTWPAY_NEW @CTARGETLOCID	
	ELSE
	IF @CXNTYPE='MSTLOC' AND @NAPIVERSION=3
		EXEC SP_SEND_MIRROR_MSTLOC_OPT @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTSCH' AND @NAPIVERSION>0
		EXEC SP_SEND_MIRROR_MSTSCH_NEW @CTARGETLOCID


	ELSE 
    IF @CXNTYPE='MSTACT' 
		EXEC SP_SEND_MIRROR_MSTACT_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTANGM' 
		EXEC SP_SEND_MIRROR_MSTANGM_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTBGT' 
		EXEC SP_SEND_MIRROR_MSTBGT_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTBWD' 
		EXEC SP_SEND_MIRROR_MSTBWD_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTCAT' 
		EXEC SP_SEND_MIRROR_MSTCAT_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTDSB' 
		EXEC SP_SEND_MIRROR_MSTDSB_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTDTM' 
		EXEC SP_SEND_MIRROR_MSTDTM_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTEAN' 
		EXEC SP_SEND_MIRROR_MSTEAN_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTEMP' 
		EXEC SP_SEND_MIRROR_MSTEMP_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTGVSCH' 
		EXEC SP_SEND_MIRROR_MSTGVSCH_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTHSN' 
		EXEC SP_SEND_MIRROR_MSTHSN_NEW @CTARGETLOCID
    ELSE
    IF @CXNTYPE='MSTJOBS' 
		EXEC SP_SEND_MIRROR_MSTJOBS_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTLBR' 
		EXEC SP_SEND_MIRROR_MSTLBR_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTLREQ' 
		EXEC SP_SEND_MIRROR_MSTLREQ_NEW @CTARGETLOCID
   ELSE
    IF @CXNTYPE='MSTLSP' 
		EXEC SP_SEND_MIRROR_MSTLSP_NEW @CTARGETLOCID
   ELSE
    IF @CXNTYPE='MSTPATCH' 
		EXEC SP_SEND_MIRROR_MSTPATCH_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTPAYMODE' 
		EXEC SP_SEND_MIRROR_MSTPAYMODE_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTPRM' 
		EXEC SP_SEND_MIRROR_MSTPRM_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTPRNFM' 
		EXEC SP_SEND_MIRROR_MSTPRNFM_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTPTC' 
		EXEC SP_SEND_MIRROR_MSTPTC_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTREGINFO' 
		EXEC SP_SEND_MIRROR_MSTREGINFO_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTSEASON' 
		EXEC SP_SEND_MIRROR_MSTSEASON_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTSTKLVL' 
		EXEC SP_SEND_MIRROR_MSTSTKLVL_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTTGT' 
		EXEC SP_SEND_MIRROR_MSTTGT_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTTILL' 
		EXEC SP_SEND_MIRROR_MSTTILL_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTXNAPP' 
		EXEC SP_SEND_MIRROR_MSTXNAPP_NEW @CTARGETLOCID
	ELSE
    IF @CXNTYPE='MSTCUSATTR' 
		EXEC SP_SEND_MIRROR_MSTCUSATTR @CTARGETLOCID

    ELSE
	BEGIN
	    SET @DTSQL='EXEC SP_SEND_MIRROR_'+@CXNTYPE+' '''+@CTARGETLOCID+''''
		PRINT @DTSQL
		EXEC SP_EXECUTESQL @DTSQL
	END		
END




