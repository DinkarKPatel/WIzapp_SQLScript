CREATE PROCEDURE SP_RETAILSALE_7 -- (LocId 3 digit change by Sanjay:30-10-2024)
(  
	 @CQUERYID			NUMERIC(2),  
	 @CWHERE			VARCHAR(MAX)='',  
	 @CFINYEAR			VARCHAR(5)='',  
	 @CDEPTID			VARCHAR(4)='',  
	 @NNAVMODE			NUMERIC(2)=1,  
	 @CWIZAPPUSERCODE	VARCHAR(10)='',  
	 @CREFMEMOID		VARCHAR(40)='',  
	 @CREFMEMODT		DATETIME='',  
	 @BINCLUDEESTIMATE	BIT=1,  
	 @CFROMDT			DATETIME='',  
	 @CTODT				VARCHAR(50)='',
	 @bCardDiscount		BIT=0,
	 @cCustCode			VARCHAR(15)=''
) 
AS  
BEGIN  
  SELECT A.*,article_no,article_name,B.UOM_NAME,P1.PARA1_NAME,P2.PARA2_NAME,P3.PARA3_NAME,   
        P4.PARA4_NAME,P5.PARA5_NAME,P6.PARA6_NAME,SD.SUB_SECTION_NAME,SM.SECTION_NAME,
        ART.ALIAS AS ARTICLE_ALIAS    
        FROM sku a (NOLOCK) --PMTVIEW A  (NOLOCK)  --- Optimization after removing views
        JOIN PARA1 P1  (NOLOCK) ON P1.PARA1_CODE=A.PARA1_CODE  
        JOIN PARA2 P2  (NOLOCK) ON P2.PARA2_CODE=A.PARA2_CODE  
        JOIN PARA3 P3  (NOLOCK) ON P3.PARA3_CODE=A.PARA3_CODE  
        JOIN PARA4 P4  (NOLOCK) ON P4.PARA4_CODE=A.PARA4_CODE  
        JOIN PARA5 P5  (NOLOCK) ON P5.PARA5_CODE=A.PARA5_CODE  
        JOIN PARA6 P6  (NOLOCK) ON P6.PARA6_CODE=A.PARA6_CODE  
        JOIN ARTICLE ART  (NOLOCK) ON ART.ARTICLE_CODE=A.ARTICLE_CODE  
        JOIN SECTIOND SD  (NOLOCK) ON SD.SUB_SECTION_CODE=ART.SUB_SECTION_CODE  
        JOIN SECTIONM SM  (NOLOCK) ON SM.SECTION_CODE=SD.SECTION_CODE  
        JOIN UOM B  (NOLOCK) ON B.UOM_CODE=ART.UOM_CODE  
        WHERE A.PRODUCT_CODE=@CWHERE  

end
