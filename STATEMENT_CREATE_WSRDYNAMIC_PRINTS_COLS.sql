
DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('WSR','LEFT(SKU.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SKU.PRODUCT_CODE)-1,-1),LEN(SKU.PRODUCT_CODE )))','PRODUCT_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','ARTICLE.ARTICLE_NAME','ARTICLE_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','UOM.UOM_NAME','UOM_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SUB_SECTION_NAME','SUB_SECTION_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SECTION_NAME','SECTION_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.XN_VALUE_WITHOUT_GST','TAXABLE_VALUE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.IGST_AMOUNT','IGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.CGST_AMOUNT','CGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.SGST_AMOUNT','SGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.XN_VALUE_WITH_GST','TOTAL_VALUE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.QUANTITY*CND01106.RATE','AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','(CND01106.QUANTITY*CND01106.RATE)-(CND01106.XN_VALUE_WITHOUT_GST)','LESS_DISCOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')


--INSERT INTO @dtLocal VALUES('WSR','CND01106.GROSS_RATE','GROSS_RATE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('WSR','CND01106.HSN_CODE','HSN_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.RATE','RATE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU.MRP','MRP',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.ATTR1_KEY_NAME','ATTRIBUTE1_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR2_KEY_NAME','ATTRIBUTE2_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR3_KEY_NAME','ATTRIBUTE3_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR4_KEY_NAME','ATTRIBUTE4_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR5_KEY_NAME','ATTRIBUTE5_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR6_KEY_NAME','ATTRIBUTE6_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR7_KEY_NAME','ATTRIBUTE7_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR8_KEY_NAME','ATTRIBUTE8_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR9_KEY_NAME','ATTRIBUTE9_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR10_KEY_NAME','ATTRIBUTE10_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR11_KEY_NAME','ATTRIBUTE11_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR12_KEY_NAME','ATTRIBUTE12_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR13_KEY_NAME','ATTRIBUTE13_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR14_KEY_NAME','ATTRIBUTE14_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR15_KEY_NAME','ATTRIBUTE15_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR16_KEY_NAME','ATTRIBUTE16_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR17_KEY_NAME','ATTRIBUTE17_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR18_KEY_NAME','ATTRIBUTE18_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR19_KEY_NAME','ATTRIBUTE19_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR20_KEY_NAME','ATTRIBUTE20_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR21_KEY_NAME','ATTRIBUTE21_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR22_KEY_NAME','ATTRIBUTE22_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR23_KEY_NAME','ATTRIBUTE23_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR24_KEY_NAME','ATTRIBUTE24_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','sku_names.ATTR25_KEY_NAME','ATTRIBUTE25_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.gst_percentage','GST_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.QUANTITY','QUANTITY',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.DISCOUNT_PERCENTAGE','ITEM_DISCOUNT_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.DISCOUNT_AMOUNT','ITEM_DISCOUNT_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.para2_order','PARA2_ORDER',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.SN_ARTICLE_PACK_SIZE','SN_ARTICLE_PACK_SIZE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')


INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA1_NAME','PARA1_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA2_NAME','PARA2_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA3_NAME','PARA3_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA4_NAME','PARA4_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA5_NAME','PARA5_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA6_NAME','PARA6_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','ARTICLE.ARTICLE_NO','ARTICLE_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CNM.CANCELLED','CANCELLED',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','SKU_NAMES.PARA2_SET','PARA2_SET',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')


INSERT INTO @DTLOCAL VALUES('WSR','CASE WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(CNM.CN_TYPE,0)<>2 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CNM.EINV_IRN_NO,'''')='''' AND  CNM.CN_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),''''))  THEN ''*****''+RIGHT(CNM.CN_NO,5)
ELSE CASE WHEN  LEFT(RTRIM(LTRIM(CNM.CN_NO)),1)=''0'' AND ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND CNM.CN_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),'''')  ) 
THEN  ISNULL((SELECT VALUE FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END  ' +'+CNM.CN_NO END','CN_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR',' CASE WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(CNM.CN_TYPE,0)<>2 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CNM.EINV_IRN_NO,'''')='''' AND  CNM.CN_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),''''))  THEN '''' else CNM.CN_DT end ','CN_DT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.ROUND_OFF','ROUND_OFF',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.REMARKS','BILL_LEVEL_REMARKS',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance','INSURANCE_CHARGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.FREIGHT','FREIGHT_CHARGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.OTHER_CHARGES','OTHER_CHARGES',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.chi_entry_ref_no','chi_entry_ref_no',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.manual_inv_no','manual_inv_no',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('WSR','CASE   WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(CNM.EINV_IRN_NO,'''')='''' AND  CNM.CN_DT>=(ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_START_DATE''),'''') ) THEN ''SAMPLE INVOICE'' ELSE 
         CASE WHEN SL.REGISTERED_GST=1 AND SL.LOC_GST_NO=PRLMP.AC_GST_NO THEN ''DELIVERY CHALLAN'' 
			  ELSE (SELECT TOP 1 CAPTION FROM GST_XN_CAPTION WHERE LTRIM(RTRIM(XN_TYPE))=''WSR'') 
		 END  END','INVOICE_TYPE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('WSR','CNM.supply_type_code','supply_type_code',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.other_charges_gst_percentage','OTHER_CHARGES_GST_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.other_charges_hsn_code','OTHER_CHARGES_HSN_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.other_charges_igst_amount','OTHER_CHARGES_IGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.other_charges_cgst_amount','OTHER_CHARGES_CGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.other_charges_sgst_amount','OTHER_CHARGES_SGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.freight_gst_percentage','FREIGHT_GST_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.freight_hsn_code','FREIGHT_HSN_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.freight_igst_amount','FREIGHT_IGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.freight_cgst_amount','FREIGHT_CGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.freight_sgst_amount','FREIGHT_SGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance_gst_percentage','INSURANCE_GST_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance_hsn_code','INSURANCE_HSN_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance_igst_amount','INSURANCE_IGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance_cgst_amount','INSURANCE_CGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.insurance_sgst_amount','INSURANCE_SGST_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
   
INSERT INTO @dtLocal VALUES('WSR','CNM.TOTAL_AMOUNT','TOTAL_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')  
INSERT INTO @dtLocal VALUES('WSR','CNM.DISCOUNT_PERCENTAGE','BILL_DISCOUNT_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS') 
INSERT INTO @dtLocal VALUES('WSR','CNM.DISCOUNT_AMOUNT','BILL_DISCOUNT_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS') 
INSERT INTO @dtLocal VALUES('WSR','CNM.MANUAL_DN_NO','RM_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.MANUAL_DN_DT','RM_DT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','SL.DEPT_ID','SOURCE_LOCATION__ID',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.DEPT_NAME','SOURCE_LOCATION_NAME',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.address1','SOURCE_LOCATION_ADDRESS1',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.address2','SOURCE_LOCATION_ADDRESS2',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.REGISTERED_ADD','SOURCE_LOCATION_REGISTERED_ADDRESS',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.TIN_NO','SOURCE_LOCATION_TIN',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.loc_gst_no','SOURCE_LOCATION_GST_NO',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','ISNULL(LEFT(SL.loc_gst_no,2),'''')','SOURCE_LOCATION_STATE_CODE',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SLA.AREA_NAME','SOURCE_LOCATION_AREA',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SLA.PINCODE','SOURCE_LOCATION_PIN',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SLC.CITY','SOURCE_LOCATION_CITY',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SLS.GST_STATE_NAME','SOURCE_LOCATION_STATE_NAME',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SLR.region_name','SOURCE_LOCATION_COUNTRY_NAME',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.PHONE','SOURCE_LOCATION_PHONE',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.CONTACT_NO','SOURCE_LOCATION_CONTACT_NO',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.PARTY_CODE','SOURCE_LOCATION_PARTY_CODE',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','SL.DEPT_ALIAS','SOURCE_LOCATION_DEPT_ALIAS',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')

INSERT INTO @dtLocal VALUES('WSR','TL.DEPT_ID','TARGET_LOCATION__ID',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.DEPT_NAME','TARGET_LOCATION_NAME',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.address1','TARGET_LOCATION_ADDRESS1',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.address2','TARGET_LOCATION_ADDRESS2',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.REGISTERED_ADD','TARGET_LOCATION_REGISTERED_ADDRESS',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.TIN_NO','TARGET_LOCATION_TIN',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.loc_gst_no','TARGET_LOCATION_GST_NO',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.PARTY_CODE','TARGET_LOCATION_PARTY_CODE',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.DEPT_ALIAS','TARGET_LOCATION_DEPT_ALIAS',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')

INSERT INTO @dtLocal VALUES('WSR','ISNULL(LEFT(TL.loc_gst_no,2),'''')','TARGET_LOCATION_STATE_CODE',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TLA.AREA_NAME','TARGET_LOCATION_AREA',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TLC.CITY','TARGET_LOCATION_CITY',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TLS.GST_STATE_NAME','TARGET_LOCATION_STATE_NAME',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TLR.region_name','TARGET_LOCATION_COUNTRY_NAME',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.PHONE','TARGET_LOCATION_PHONE',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','TL.CONTACT_NO','TARGET_LOCATION_CONTACT_NO',0,'WHOLESALE_CREDITNOTE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSR','CMP.COMPANY_NAME','COMPANY_NAME',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.ADDRESS1','COMPANY_ADDRESS1',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.ADDRESS2','COMPANY_ADDRESS2',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.CITY','COMPANY_CITY',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.[STATE]','COMPANY_STATE',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.COUNTRY','COMPANY_COUNTRY',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.GST_NO','COMPANY_GST_NO',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.CIN','COMPANY_CIN',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.PAN_NO','COMPANY_PAN_NO',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.PIN','COMPANY_PIN',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.EMAIL_ID','COMPANY_EMAIL_ID',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','CMP.WEB_ADDRESS','COMPANY_WEBSITE',0,'WHOLESALE_CREDITNOTE','COMPANY')
INSERT INTO @dtLocal VALUES('WSR','PRLM.AC_NAME','PARTY_NAME',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.AC_GST_NO','PARTY_GST_NO',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.ADDRESS0','PARTY_ADDRESS1',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.ADDRESS1','PARTY_ADDRESS2',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.ADDRESS2','PARTY_ADDRESS3',0,'WHOLESALE_CREDITNOTE','PARTY')

INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.REGISTERED_GST_DEALER','REGISTERED_GST_DEALER',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.PAN_NO','PARTY_PAN_NO',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.PARTY_ERP_CODE','PARTY_ERP_CODE',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.LMP_MSME','LMP_MSME',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.LMP_MSME_NO','LMP_MSME_NO',0,'WHOLESALE_CREDITNOTE','PARTY')


INSERT INTO @dtLocal VALUES('WSR','PRA.AREA_NAME','PARTY_AREA',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRC.city','PARTY_CITY',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRS.GST_STATE_NAME','PARTY_STATE_NAME',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRS.GST_STATE_CODE','PARTY_STATE_CODE',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRR.region_name','PARTY_COUNTRY',0,'WHOLESALE_CREDITNOTE','PARTY')

INSERT INTO @dtLocal VALUES('WSR','TR.DISP_WEIGHT','DISP_WEIGHT',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','TR.DISP_BOX_NO','DISP_BOX_NO',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','TR.TRANSPORTER_NAME','TRANSPORTER_NAME',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','TR.BILTY_NO','BILTY_NO',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','TR.BILTY_DATE','BILTY_DATE',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','TR.VEHICLE_NO','VEHICLE_NO',0,'WHOLESALE_CREDITNOTE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSR','IMG.PROD_IMAGE','PROD_IMAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','PRA.PINCODE','PARTY_PIN',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.MOBILE','PARTY_MOBILE',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','CND01106.INV_NO','BILL_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.INV_DT','BILL_DT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

--INSERT INTO @dtLocal VALUES('WSR','CND01106.IND_DISCOUNT_PERCENTAGE','IND_DISCOUNT_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
--INSERT INTO @dtLocal VALUES('WSR','CND01106.IND_DISCOUNT_AMOUNT','IND_DISCOUNT_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

--INSERT INTO @dtLocal VALUES('WSR','CND01106.inm_discount_percentage','inm_discount_percentage',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
--INSERT INTO @dtLocal VALUES('WSR','CND01106.inm_discount_amount','inm_discount_amount',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

--FOR TAX INVOICE BEFORE GST
INSERT INTO @dtLocal VALUES('WSR','CND01106.ITEM_TAX_PERCENTAGE','VAT_PERCENTAGE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.item_tax_amount','VAT_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.NET_RATE','NET_RATE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.TIN_NO','PARTY_TIN_NO',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','PRLMP.CST_NO','PARTY_CST_NO',0,'WHOLESALE_CREDITNOTE','PARTY')
INSERT INTO @dtLocal VALUES('WSR','CNM.TOTAL_GST_CESS_AMOUNT','TOTAL_GST_CESS_AMOUNT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.GST_Cess_AMount','GST_Cess_AMount',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CND01106.GST_Cess_Percentage','GST_Cess_Percentage',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','CNM.ACH_NO','ACH_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.ACH_DT','ACH_DT',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.IRN_QR_CODE','IRN_QR_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','CNM.EINV_IRN_NO','EINV_IRN_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
INSERT INTO @dtLocal VALUES('WSR','SKU.FIX_MRP','FIX_MRP',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @DTLOCAL VALUES('WSR','SL.DEPT_PRINT_NAME','LOCATION_PRINT_NAME',0,'WHOLESALE_CREDITNOTE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('WSR','PRLMP.PRINT_NAME','LEDGER_PRINT_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')


INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_1','TNC_1',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_2','TNC_2',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_3','TNC_3',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_4','TNC_4',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_5','TNC_5',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_6','TNC_6',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_7','TNC_7',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')
INSERT INTO @dtLocal VALUES('WSR','GST_TNC.TNC_8','TNC_8',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS0  ELSE CNM.SHIPPING_ADDRESS END
					ELSE PRLMP.ADDRESS0 END','SHIPPING_ADDRESS',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS1  ELSE CNM.SHIPPING_ADDRESS2 END
					ELSE PRLMP.ADDRESS1 END','SHIPPING_ADDRESS2',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS2  ELSE CNM.SHIPPING_ADDRESS3 END
					ELSE PRLMP.ADDRESS2 END','SHIPPING_ADDRESS3',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHAR.AREA_NAME  ELSE CNM.SHIPPING_AREA_NAME END
					ELSE PRA.AREA_NAME END','SHIPPING_AREA_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHCT.CITY   ELSE CNM.SHIPPING_CITY_NAME  END
					ELSE PRC.CITY END','SHIPPING_CITY_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN shCS.gst_state_name   ELSE CNM.SHIPPING_STATE_NAME  END
					ELSE PRS.gst_state_name END','SHIPPING_STATE_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
					
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHAR.pincode   ELSE CNM.shipping_pin  END
					ELSE PRA.pincode END','SHIPPING_PIN',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLM.AC_NAME  ELSE SHLM.AC_NAME END
					ELSE PRLM.AC_NAME END','SHIPPING_AcName',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.PRINT_NAME  ELSE SHLMP.PRINT_NAME END
					ELSE PRLMP.PRINT_NAME END','SHIPPING_PRINT_NAME',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN shCS.gst_state_code   ELSE SHP.GST_STATE_CODE END
					ELSE PRS.gst_state_code END','SHIPPING_STATE_CODE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.AC_GST_NO   ELSE SHLMP.AC_GST_NO END
					ELSE PRLMP.AC_GST_NO END','SHIPPING_GST_NO',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')
				
INSERT INTO @dtLocal VALUES('WSR','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.MOBILE  ELSE SHLMP.MOBILE END
					ELSE PRLMP.MOBILE END','SHIPPING_MOBILE',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_MASTERS')

INSERT INTO @dtLocal VALUES('WSR','SizeQtyString','SizeQtyString',0,'WHOLESALE_CREDITNOTE','CREDITNOTE_DETAILS')

UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1
	 
  

DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'WHOLESALE_CREDITNOTE'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='WSR'
WHERE b.COLUMN_NAME IS NULL

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='WSR'
)

DELETE  FROM CTE WHERE SR>1
