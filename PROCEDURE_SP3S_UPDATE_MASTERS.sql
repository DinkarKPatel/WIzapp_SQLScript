create PROCEDURE SP3S_UPDATE_MASTERS
(
	@NMODE INT
)
AS
BEGIN
	 DECLARE @CSTEP INT,@CERRMSG VARCHAR(MAX)
	 DECLARE @CTABLENAME NVARCHAR(MAX),@CCMD NVARCHAR(MAX),@CCURLOCTIONID VARCHAR(5)
          ,@CCLONAME NVARCHAR(MAX),@CTEMPTABLE VARCHAR(1000),@LOCCTEMPTABLE NVARCHAR(1000)
          ,@CLOCTYPE INT,@UPD_PURINFO BIT,@CODING BIT,@SKUINS VARCHAR(2)
          
BEGIN TRY 
         
          SELECT @CCURLOCTIONID=VALUE FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID'
          SET @CLOCTYPE=''
              SET @UPD_PURINFO=''
              SELECT @CLOCTYPE=ISNULL(LOC_TYPE,0),@UPD_PURINFO=ISNULL(UPD_PURINFO,0) FROM LOCATION WHERE DEPT_ID=@CCURLOCTIONID
                 
                
        IF @NMODE=1
          BEGIN
				EXEC SP3S_UPDATE_MASTERS_SKU @DEPT_ID=@CCURLOCTIONID
				RETURN
			   --SET @CTABLENAME='SKU'
			   --SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'
          END
         IF @NMODE IN (2,9)
          BEGIN
			   SET @CTABLENAME='ARTICLE'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'
			   SET @CCMD=N'SELECT TOP 1 @CODING=CODING,@SKUINS=SKUINS FROM  '+@LOCCTEMPTABLE+''
			   EXEC SP_EXECUTESQL @CCMD, N'@CODING BIT OUTPUT,@SKUINS VARCHAR(2) OUTPUT',@CODING OUTPUT,
			   @SKUINS OUTPUT
			   
			   

          END 

		  
          
          IF @NMODE=3
          BEGIN
			   SET @CTABLENAME='PARA1'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
           IF @NMODE=4
          BEGIN
			   SET @CTABLENAME='PARA2'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
          IF @NMODE=5
          BEGIN
			   SET @CTABLENAME='PARA3'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
          IF @NMODE=6
          BEGIN
			   SET @CTABLENAME='PARA4'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
         IF @NMODE=7
          BEGIN
			   SET @CTABLENAME='PARA5'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
          IF @NMODE=8
          BEGIN
			   SET @CTABLENAME='PARA6'
			   SET @LOCCTEMPTABLE='TEMP_'+@CTABLENAME+'_'+@CCURLOCTIONID+'_DETAIL'

          END 
          
           
      IF @NMODE=1   ---- SKU
      BEGIN
          

        
		   SET @CSTEP=10--UPDATE PARA1
		   SET @CCMD=N' UPDATE A1 SET A1.PARA1_NAME = A2.P1_PARA1_NAME, A1.ALIAS = A2.P1_ALIAS,A1.INACTIVE = A2.P1_INACTIVE
		   FROM PARA1 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA1_CODE = A2.PARA1_CODE'
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	       
	        
		   SET @CSTEP=20 --INSERT PARA1
		   SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
		   SELECT DISTINCT A.PARA1_CODE,A.P1_PARA1_NAME, '' ,ISNULL(A.P1_ALIAS,''''),A.P1_INACTIVE, 0, '''', ''''
		   FROM  '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA1 B(NOLOCK) ON A.PARA1_CODE = B.PARA1_CODE 
		   WHERE B.PARA1_CODE IS NULL'
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	        
			
		   SET @CSTEP=30 --UPDATE PARA2
		   SET @CCMD=N' UPDATE A1 SET A1.PARA2_NAME = A2.P2_PARA2_NAME,A1.ALIAS = A2.P2_ALIAS,A1.INACTIVE = A2.P2_INACTIVE,
		   A1.PARA2_ORDER = A2.P2_PARA2_ORDER FROM PARA2 A1 WITH (ROWLOCK) 
		   JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA2_CODE = A2.PARA2_CODE' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD


		  SET @CSTEP=40 -- INSERT PARA2
		  SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
		  SELECT DISTINCT GETDATE(),ISNULL(A.P2_ALIAS,''''),A.P2_INACTIVE,ISNULL(A.P2_PARA2_ORDER,0),'''',
		  A.PARA2_CODE,A.P2_PARA2_NAME,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.PARA2_CODE = B.PARA2_CODE 
		  WHERE B.PARA2_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		
		  SET @CSTEP=50 --UPDATE PARA3
		  SET @CCMD=N' UPDATE A1 SET A1.PARA3_NAME = A2.P3_PARA3_NAME,A1.ALIAS = A2.P3_ALIAS,A1.INACTIVE = A2.P3_INACTIVE
		  FROM PARA3 A1 WITH (ROWLOCK) 
		  JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA3_CODE = A2.PARA3_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
		  SET @CSTEP=60 -- INSERT PARA3
		  SET @CCMD=N'INSERT PARA3(PARA3_CODE, PARA3_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)
		  SELECT DISTINCT A.PARA3_CODE, A.P3_PARA3_NAME, GETDATE() AS LAST_UPDATE,ISNULL(A.P3_ALIAS,''''),A.P3_INACTIVE, ''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA3 B(NOLOCK) ON A.PARA3_CODE = B.PARA3_CODE WHERE B.PARA3_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		
		  SET @CSTEP=70 --UPDATE PARA4
		  SET @CCMD=N' UPDATE A1 SET A1.PARA4_NAME = A2.P4_PARA4_NAME, A1.ALIAS = A2.P4_ALIAS, 
		  A1.INACTIVE = A2.P4_INACTIVE
		  FROM PARA4 A1 WITH (ROWLOCK)JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA4_CODE = A2.PARA4_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
	    
		  SET @CSTEP=80 -- INSERT PARA4
		  SET @CCMD=N' INSERT PARA4( PARA4_CODE, PARA4_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS) 
		  SELECT DISTINCT A.PARA4_CODE,A.P4_PARA4_NAME, GETDATE(),ISNULL(A.P4_ALIAS,''''), A.P4_INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA4 B(NOLOCK) ON A.PARA4_CODE = B.PARA4_CODE 
		  WHERE B.PARA4_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	      
		  SET @CSTEP=90 --UPDATE PARA5
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA5_NAME = A2.P5_PARA5_NAME,A1.ALIAS = A2.P5_ALIAS,A1.INACTIVE = A2.P5_INACTIVE
		  FROM PARA5 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA5_CODE = A2.PARA5_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
	    
		  SET @CSTEP=100 -- INSERT PARA5
		  SET @CCMD=N' INSERT PARA5( ALIAS, INACTIVE, PARA5_CODE, PARA5_NAME, LAST_UPDATE, REMARKS)
		  SELECT DISTINCT ISNULL(A.P5_ALIAS,''''),A.P5_INACTIVE,A.PARA5_CODE,A.P5_PARA5_NAME, GETDATE() ,''''
   		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA5 B(NOLOCK) ON A.PARA5_CODE = B.PARA5_CODE 
   		  WHERE B.PARA5_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
		  SET @CSTEP=110 --UPDATE PARA6
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA6_NAME = A2.P6_PARA6_NAME,A1.ALIAS = A2.P6_ALIAS,A1.INACTIVE = A2.P6_INACTIVE
		  FROM PARA6 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA6_CODE = A2.PARA6_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
		  SET @CSTEP=120 --- INSERT PARA6
		  SET @CCMD=N'INSERT PARA6( PARA6_CODE, PARA6_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)  
		  SELECT DISTINCT A.PARA6_CODE, A.P6_PARA6_NAME, GETDATE(),ISNULL(A.P6_ALIAS,''''),A.P6_INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA6 B(NOLOCK) ON A.PARA6_CODE = B.PARA6_CODE 
		  WHERE B.PARA6_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		
		
		   SET @CSTEP=130 -- UPDATE HEAD_CODE
		  SET @CCMD=N'INSERT HD01106	( HEAD_CODE, HEAD_NAME, MAJOR_HEAD_CODE, PHYSICAL, ALIAS, PRINT_HEAD,
		  LAST_UPDATE, CREDITOR_DEBTOR_CODE,UPLOADED_TO_ACTIVSTREAM, INACTIVE )  
		  SELECT DISTINCT LM_HEAD_CODE, H_HEAD_NAME, H_MAJOR_HEAD_CODE, H_PHYSICAL, ISNULL(H_ALIAS,''''), H_PRINT_HEAD,
		  GETDATE(),ISNULL(H_CREDITOR_DEBTOR_CODE,''''), 0, H_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN HD01106 B(NOLOCK) ON A.LM_HEAD_CODE = B.HEAD_CODE 
		  WHERE B.HEAD_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD 
		  
		  

		  SET @CSTEP=140 ---  INSERT HEAD_CODE
		  SET @CCMD=N' UPDATE A1 SET HEAD_NAME=A2.H_HEAD_NAME,MAJOR_HEAD_CODE=A2.H_MAJOR_HEAD_CODE,PHYSICAL=A2.H_PHYSICAL,
		  ALIAS=A2.H_ALIAS,PRINT_HEAD=A2.H_PRINT_HEAD,CREDITOR_DEBTOR_CODE=A2.H_CREDITOR_DEBTOR_CODE,
		  INACTIVE=A2.H_INACTIVE
		  FROM HD01106 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK)
		  ON A1.HEAD_CODE = A2.LM_HEAD_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    
		 
		 
		  SET @CSTEP=150 --UPDATE LM01106
		  SET @CCMD=N' UPDATE A1 SET INACTIVE=A2.LM_INACTIVE,AC_NAME=A2.LM_AC_NAME, ALIAS=A2.LM_ALIAS, HEAD_CODE=A2.LM_HEAD_CODE,
		  PRINT_LEDGER=A2.LM_PRINT_LEDGER FROM LM01106 A1 WITH (ROWLOCK) 
		  JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.AC_CODE = A2.AC_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  

		  SET @CSTEP=160 --- INSERT LM01106
		  SET @CCMD=N'INSERT LM01106	(  UPLOADED_TO_ACTIVSTREAM, USER_CODE, EDT_USER_CODE,
		  LAST_UPDATE, OPENING_BALANCE,OPENING_BALANCE_CR_DR, TDS_CODE, INACTIVE, AC_CODE, AC_NAME, ALIAS, 
		  HEAD_CODE, CLOSING_BALANCE, CLOSING_BALANCE_CR_DR, PRINT_LEDGER)  
		  SELECT  DISTINCT 0, 0000000,0000000, GETDATE() ,0, '''',0000000, A.LM_INACTIVE, A.AC_CODE, A.LM_AC_NAME,ISNULL(A.LM_ALIAS,''''),A.LM_HEAD_CODE, 0, 
		  '''', A.LM_PRINT_LEDGER
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN LM01106 B(NOLOCK) ON A.AC_CODE = B.AC_CODE 
		  WHERE B.AC_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		 

		
		 
		 
		   SET @CSTEP=170 --UPDATE HSN(ARTICLE)---HSN_MST
		   SET @CCMD=N' UPDATE A1 SET TAXABLE_ITEM=A2.HD_TAXABLE_ITEM,HSN_TYPE=A2.HD_HSN_TYPE 
		   FROM HSN_MST A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) 
		   ON A1.HSN_CODE = A2.AR_HSN_CODE' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		 
		   SET @CSTEP=180 --INSERT HSN(SECTIOND)---HSN_MST
		   SET @CCMD=N'INSERT HSN_MST	(HSN_CODE,TAXABLE_ITEM, HSN_TYPE ) 
		   SELECT DISTINCT A.AR_HSN_CODE,A.HD_TAXABLE_ITEM, ISNULL(A.HD_HSN_TYPE,0) FROM 
		   '+@LOCCTEMPTABLE+' A(NOLOCK) 
		   LEFT JOIN HSN_MST B (NOLOCK) ON A.AR_HSN_CODE=B.HSN_CODE
		   WHERE B.HSN_CODE IS NULL AND ISNULL(A.AR_HSN_CODE,'''')<>''''' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		    SET @CSTEP=190 --UPDATE HSN(SKU)---HSN_MST
		   SET @CCMD=N' UPDATE A1 SET TAXABLE_ITEM=A2.HM_TAXABLE_ITEM,HSN_TYPE=A2.HM_HSN_TYPE 
		   FROM HSN_MST A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.HSN_CODE = A2.HSN_CODE' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	    
	    
		   SET @CSTEP=200 --INSERT HSN(SKU)---HSN_MST
		   SET @CCMD=N'INSERT HSN_MST	( HSN_CODE, TAXABLE_ITEM, HSN_TYPE ) 
		   SELECT DISTINCT A.HSN_CODE,A.HM_TAXABLE_ITEM, ISNULL(A.HM_HSN_TYPE,0) 
		   FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		   LEFT JOIN HSN_MST B (NOLOCK) ON A.HSN_CODE=B.HSN_CODE
		   WHERE B.HSN_CODE IS NULL AND ISNULL(A.HSN_CODE,'''')<>'''''  
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		   
		   SET @CSTEP=210---DELETE  HSN_DET(SKU)
		   SET @CCMD=N' DELETE A FROM HSN_DET A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		   ON A.HSN_CODE=B.HD1_HSN_CODE ' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD

		   
		 
		   SET @CSTEP=220 --INSERT HSN(SKU)---HSN_DET
		   SET @CCMD=N'INSERT HSN_DET	(HSN_CODE,TAX_PERCENTAGE,RATE_CUTOFF,RATE_CUTOFF_TAX_PERCENTAGE,WEF,ROW_ID ) 
		   SELECT DISTINCT A.HD1_HSN_CODE,ISNULL(A.HD1_TAX_PERCENTAGE,0), ISNULL(A.HD1_RATE_CUTOFF,0), ISNULL(A.HD1_RATE_CUTOFF_TAX_PERCENTAGE,0),
		   A.HD1_WEF, A.HD1_ROW_ID FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		   LEFT JOIN HSN_DET B (NOLOCK) ON A.HD1_HSN_CODE=B.HSN_CODE
		   WHERE B.HSN_CODE IS NULL AND ISNULL(A.HD1_HSN_CODE,'''')<>''''
		     and isnull(A.HD2_WEF,'''')<>''''' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		   
		   SET @CSTEP=230---DELETE  HSN_DET(ARTICLE)
		   SET @CCMD=N' DELETE A FROM HSN_DET A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		   ON A.HSN_CODE=B.HD2_HSN_CODE ' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		   
		   
		 
		   SET @CSTEP=240 --INSERT HSN(SECTIOND)---HSN_DET
		   SET @CCMD=N'INSERT HSN_DET	(HSN_CODE,TAX_PERCENTAGE,RATE_CUTOFF,RATE_CUTOFF_TAX_PERCENTAGE,WEF,ROW_ID ) 
		   SELECT DISTINCT A.HD2_HSN_CODE,ISNULL(A.HD2_TAX_PERCENTAGE,0), ISNULL(A.HD2_RATE_CUTOFF,0), ISNULL(A.HD2_RATE_CUTOFF_TAX_PERCENTAGE,0),
		   A.HD2_WEF, A.HD2_ROW_ID FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		   LEFT JOIN HSN_DET B (NOLOCK) ON A.HD2_HSN_CODE=B.HSN_CODE
		   WHERE B.HSN_CODE IS NULL AND ISNULL(A.HD2_HSN_CODE,'''')<>''''' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	    
		
		 SET @CSTEP=250 -- UPDATE SECTIONM(SECTIOND)
		 SET @CCMD=N' UPDATE A1 SET SECTION_NAME=A2.SECTION_NAME,ALIAS=A2.SM_ALIAS,INACTIVE=A2.SM_INACTIVE
		 FROM SECTIONM A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.SECTION_CODE = A2.SD_SECTION_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		
		 SET @CSTEP=260 --INSERT SECTIONM(SECTIOND)
		 SET @CCMD=N'INSERT SECTIONM	( SECTION_CODE, SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS )  
		 SELECT DISTINCT SD_SECTION_CODE, A.SECTION_NAME, GETDATE() ,ISNULL(SM_ALIAS,''''), SM_INACTIVE, ''''
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK)LEFT JOIN SECTIONM B (NOLOCK) ON A.SD_SECTION_CODE=B.SECTION_CODE
		 WHERE B.SECTION_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
	     
	     
	     
		 SET @CSTEP=270 --UPDATE SECTIOND(ARTICLE)
		 SET @CCMD=N' UPDATE A1 SET SUB_SECTION_NAME=A2.SUB_SECTION_NAME,ALIAS=A2.SD_ALIAS,INACTIVE=A2.SD_INACTIVE,
		 MFG_CATEGORY=A2.SD_MFG_CATEGORY,SECTION_CODE=A2.SD_SECTION_CODE
		 FROM SECTIOND A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) 
		 ON A1.SUB_SECTION_CODE = A2.AR_SUB_SECTION_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		
		 
		
		 SET @CSTEP=280 --INSERT SECTIOND(ARTICLE)
		 SET @CCMD=N'INSERT SECTIOND( SUB_SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, MFG_CATEGORY, SECTION_CODE, 
		 SUB_SECTION_CODE, REMARKS )  
		 SELECT DISTINCT A.SUB_SECTION_NAME, GETDATE(), ISNULL(SD_ALIAS,''''), SD_INACTIVE,ISNULL(SD_MFG_CATEGORY,0),SD_SECTION_CODE,
		  AR_SUB_SECTION_CODE, ''''
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN SECTIOND B (NOLOCK) ON A.AR_SUB_SECTION_CODE=B.SUB_SECTION_CODE
		 WHERE B.SUB_SECTION_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
		
		 SET @CSTEP=290 --UPDATAE UOM(ARTICLE)
		 SET @CCMD=N' UPDATE A1 SET UOM_TYPE=A2.U_UOM_TYPE, INACTIVE=A2.U_INACTIVE,UOM_NAME=A2.U_UOM_NAME
		 FROM UOM A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.UOM_CODE = A2.AR_UOM_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		
		 SET @CSTEP=300---INSERT UOM(ARTICLE)
		 SET @CCMD=N'INSERT UOM	( UOM_TYPE, INACTIVE, UOM_CODE, UOM_NAME, LAST_UPDATE ) 
		 SELECT DISTINCT 	U_UOM_TYPE, U_INACTIVE, AR_UOM_CODE, U_UOM_NAME, GETDATE()FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN UOM B (NOLOCK) ON A.AR_UOM_CODE=B.UOM_CODE
		 WHERE B.UOM_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		 
		 SET @CSTEP=310 ---  UPDATE ARTICLE(SKU)
		 SET @CCMD=N' UPDATE A1 SET	A1.UOM_CODE = A2.AR_UOM_CODE, A1.CODING_SCHEME = A2.AR_CODING_SCHEME,
		 A1.SUB_SECTION_CODE = A2.AR_SUB_SECTION_CODE, A1.ARTICLE_NAME = A2.AR_ARTICLE_NAME, 
		 A1.ARTICLE_NO = A2.AR_ARTICLE_NO,A1.INACTIVE = A2.AR_INACTIVE,A1.ALIAS = A2.AR_ALIAS,
		 A1.DISCON = A2.AR_DISCON,A1.STOCK_NA = A2.AR_STOCK_NA,
		 A1.GENERATE_BARCODES_WITHARTICLE_PREFIX = A2.AR_GENERATE_BARCODES_WITHARTICLE_PREFIX,
		 A1.SKU_CODE = A2.AR_SKU_CODE,A1.ARTICLE_DESC = A2.AR_ARTICLE_DESC,
		 A1.GEN_EAN_CODES=A2.AR_GEN_EAN_CODES,A1.ORDERITEM=A2.AR_ORDERITEM,
		 A1.HSN_CODE=A2.AR_HSN_CODE
		 FROM ARTICLE A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ARTICLE_CODE = A2.ARTICLE_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
		
	     
	     
		 SET @CSTEP=320 --INSERT ARTICLE(SKU)
		 SET @CCMD=N'INSERT ARTICLE	( PARA2_CODE, PARA3_CODE, PARA4_CODE, PARA5_CODE, PARA6_CODE, DISCON, 
		 WHOLESALE_PRICE, WSP_PERCENTAGE, MIN_PRICE, STOCK_NA, ARTICLE_TYPE, CREATED_ON, ARTICLE_GROUP_CODE,
		 COMPANY_CODE, GENERATE_BARCODES_WITHARTICLE_PREFIX, ARTICLE_GEN_MODE, ARTICLE_PRD_MODE, ARTICLE_SET_CODE,
		 OH_PERCENTAGE, OH_AMOUNT, FIX_MRP, ENABLE_FIXWT_ENTRY, FIX_WEIGHT, EXP_AMOUNT, SUPP_SPECIFIC, SUPP_AC_CODE,
		 SUPP_ITEM_CODE, REMARKS, FIX_PRICE_ARTICLE, GROSS_PURCHASE_PRICE, DISCOUNT_PERCENTAGE, DISCOUNT_AMOUNT, 
		 GEN_EAN_CODES, SIZE_CENTER_POINT, SIZE_RATE_DIFF, MANUAL_DISC, MANUAL_WSP, MANUAL_RSP, 
		 AREA_WISE_RATE_APPLICABLE, ORDERITEM,  DO_AMOUNT, DO_PERCENTAGE, EXP_PERCENTAGE,
		 ARTICLE_SET_TYPE, STYLE_NO, COLOR_NAME, COLOR_CODE, SIZE, DEBIT_MATERIAL,
		 CODING_SCHEME, LAST_UPDATE, UOM_CODE, ALIAS, MP_PERCENTAGE, PURCHASE_PRICE, MRP, PARA1_SET,
		 PARA2_SET, INACTIVE, SKU_CODE, DT_CREATED, USER_CODE, EDT_USER_CODE, ARTICLE_CODE, ARTICLE_NO,
		 ARTICLE_NAME, ARTICLE_DESC, SUB_SECTION_CODE, PARA1_CODE,HSN_CODE )  
	    
		 SELECT DISTINCT ''0000000'', ''0000000'', ''0000000'',''0000000'',''0000000'', ISNULL(AR_DISCON,0), 0,0, 0,
		 AR_STOCK_NA, 0, '''','''',''01'',   AR_GENERATE_BARCODES_WITHARTICLE_PREFIX, 0,0,'''',0,0, 0, 0,0, 0, 0,
		 '''', '''', '''', 0, 0, 0, 0, AR_GEN_EAN_CODES, 0, 0,  0, 0, 0, 0, AR_ORDERITEM,
		 0, 0, 0,  0, '''', '''', '''', '''', 0, ISNULL(AR_CODING_SCHEME,0), GETDATE(), AR_UOM_CODE, 
		 ISNULL(AR_ALIAS,''''),0, 0, 0, 0, 0, AR_INACTIVE, ISNULL(AR_SKU_CODE,''''), '''',
		 ''0000000'', ''0000000'', A.ARTICLE_CODE, AR_ARTICLE_NO, AR_ARTICLE_NAME, AR_ARTICLE_DESC,
		 AR_SUB_SECTION_CODE, ''0000000'',ISNULL(AR_HSN_CODE,''0000000000'') FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN ARTICLE B (NOLOCK) ON A.ARTICLE_CODE=B.ARTICLE_CODE
		 WHERE B.ARTICLE_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
	     

		 
		 
		 
		 
		 
		   IF ( @CLOCTYPE=2 OR @UPD_PURINFO=0 )
	       
           BEGIN
             SET @CSTEP=330 -- UPDATE SKU
			 SET @CCMD=N' UPDATE A1 SET PARA2_CODE=A2.PARA2_CODE, LAST_UPDATE=GETDATE(), 
			 PARA3_CODE=A2.PARA3_CODE,
			 PARA4_CODE=A2.PARA4_CODE,PARA5_CODE=A2.PARA5_CODE,
			 PARA6_CODE=A2.PARA6_CODE,FORM_ID=''0000000'',
			 MRP=A2.MRP,DT_CREATED=A2.DT_CREATED,WS_PRICE=A2.WS_PRICE,IMAGE_NAME=A2.IMAGE_NAME,TAX_AMOUNT=A2.TAX_AMOUNT,
			 CHALLAN_NO=A2.CHALLAN_NO,FIX_MRP=A2.FIX_MRP,PRODUCT_NAME=A2.PRODUCT_NAME,ARTICLE_CODE=A2.ARTICLE_CODE,
			 PARA1_CODE=A2.PARA1_CODE,ER_FLAG=A2.ER_FLAG,UPLOADED_TO_ACTIVSTREAM=A2.UPLOADED_TO_ACTIVSTREAM,
			 BARCODE_CODING_SCHEME=A2.BARCODE_CODING_SCHEME,EMP_CODE=A2.EMP_CODE,VENDOR_EAN_NO=A2.VENDOR_EAN_NO,
			 ONLINE_PRODUCT_CODE=A2.ONLINE_PRODUCT_CODE,
			 BASIC_PURCHASE_PRICE=A2.BASIC_PURCHASE_PRICE,HSN_CODE=A2.HSN_CODE
			 FROM SKU A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PRODUCT_CODE = A2.PRODUCT_CODE' 
			 PRINT @CCMD 
			 EXEC SP_EXECUTESQL @CCMD
           END
		 
		 
		 
		 
		 IF ( @CLOCTYPE=1 AND @UPD_PURINFO=1)
           BEGIN
             SET @CSTEP=340 -- UPDATE SKU
			 SET @CCMD=N' UPDATE A1 SET PARA2_CODE=A2.PARA2_CODE, LAST_UPDATE=GETDATE(), 
			 PURCHASE_PRICE=A2.PURCHASE_PRICE,PARA3_CODE=A2.PARA3_CODE,INV_DT=A2.INV_DT,INV_NO=A2.INV_NO,
			 AC_CODE=A2.AC_CODE,RECEIPT_DT=A2.RECEIPT_DT,PARA4_CODE=A2.PARA4_CODE,PARA5_CODE=A2.PARA5_CODE,
			 PARA6_CODE=A2.PARA6_CODE,FORM_ID=''0000000'',
			 MRP=A2.MRP,DT_CREATED=A2.DT_CREATED,WS_PRICE=A2.WS_PRICE,IMAGE_NAME=A2.IMAGE_NAME,TAX_AMOUNT=A2.TAX_AMOUNT,
			 CHALLAN_NO=A2.CHALLAN_NO,FIX_MRP=A2.FIX_MRP,PRODUCT_NAME=A2.PRODUCT_NAME,ARTICLE_CODE=A2.ARTICLE_CODE,
			 PARA1_CODE=A2.PARA1_CODE,ER_FLAG=A2.ER_FLAG,UPLOADED_TO_ACTIVSTREAM=A2.UPLOADED_TO_ACTIVSTREAM,
			 BARCODE_CODING_SCHEME=A2.BARCODE_CODING_SCHEME,EMP_CODE=A2.EMP_CODE,VENDOR_EAN_NO=A2.VENDOR_EAN_NO,
			 ONLINE_PRODUCT_CODE=A2.ONLINE_PRODUCT_CODE,
			 BASIC_PURCHASE_PRICE=A2.BASIC_PURCHASE_PRICE,HSN_CODE=A2.HSN_CODE
			 FROM SKU A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PRODUCT_CODE = A2.PRODUCT_CODE' 
			 PRINT @CCMD 
			 EXEC SP_EXECUTESQL @CCMD
           END
		

     END
     IF @NMODE IN (2,9)   ---- ARTICLE
      BEGIN
      
      
      	   
       IF @CODING=1
       BEGIN
       
       
            SET @CSTEP=10--UPDATE PARA1
		   SET @CCMD=N' UPDATE A1 SET A1.PARA1_NAME = A2.AP1_PARA1_NAME, A1.ALIAS = A2.AP1_ALIAS,A1.INACTIVE = A2.AP1_INACTIVE
		   FROM PARA1 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA1_CODE = A2.AP1_PARA1_CODE'
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		   
		   SET @CSTEP=20--INSERT PARA1(ARTICLE)
		   SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
		   SELECT DISTINCT A.P1_PARA1_CODE,A.P1_PARA1_NAME, GETDATE() ,ISNULL(A.P1_ALIAS,''''),A.P1_INACTIVE, 0, '''', ''''
		   FROM  '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA1 B(NOLOCK) ON A.P1_PARA1_CODE = B.PARA1_CODE 
		   WHERE B.PARA1_CODE IS NULL AND ISNULL( A.P1_PARA1_CODE,'''')<>'''' '
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		  
		   
		   
		   SET @CSTEP=30 --INSERT PARA1(ART_PARA1)
		   SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
		   SELECT DISTINCT A.AB1_PARA1_CODE,A.AB1_PARA1_NAME, GETDATE() ,ISNULL(A.AB1_ALIAS,''''),A.AB1_INACTIVE, 0, '''', ''''
		   FROM  '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA1 B(NOLOCK) ON A.AB1_PARA1_CODE = B.PARA1_CODE 
		   WHERE B.PARA1_CODE IS NULL AND ISNULL(A.AB1_PARA1_CODE,'''')<>'''''
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   
		   SET @CSTEP=40 --INSERT PARA1(ART_BOM)
		   SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
		   SELECT DISTINCT A.AP1_PARA1_CODE,A.AP1_PARA1_NAME, GETDATE() ,ISNULL(A.AP1_ALIAS,''''),A.AP1_INACTIVE, 0, '''', ''''
		   FROM  '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA1 B(NOLOCK) ON A.AP1_PARA1_CODE = B.PARA1_CODE 
		   WHERE B.PARA1_CODE IS NULL AND ISNULL(A.AP1_PARA1_CODE,'''')<>'''''
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	        

           SET @CSTEP=50 --UPDATE PARA2
		   SET @CCMD=N' UPDATE A1 SET A1.PARA2_NAME = A2.ADP2_PARA2_NAME,A1.ALIAS = A2.ADP2_ALIAS,A1.INACTIVE = A2.ADP2_INACTIVE,
		   A1.PARA2_ORDER = A2.ADP2_PARA2_ORDER FROM PARA2 A1 WITH (ROWLOCK) 
		   JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA2_CODE = A2.ADP2_PARA2_CODE' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
		   

		  SET @CSTEP=60 -- INSERT PARA2(ARTICLE)
		  SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
		  SELECT DISTINCT GETDATE(),ISNULL(A.P2_ALIAS,''''),A.P2_INACTIVE,ISNULL(A.P2_PARA2_ORDER,0),'''',
		  A.P2_PARA2_CODE,A.P2_PARA2_NAME,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.P2_PARA2_CODE = B.PARA2_CODE 
		  WHERE B.PARA2_CODE IS NULL AND ISNULL( A.P2_PARA2_CODE,'''')<>'''' '
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  

		  
		  SET @CSTEP=70 -- INSERT PARA2(ART_DET)
		  SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
		  SELECT DISTINCT GETDATE(),ISNULL(A.ADP2_ALIAS,''''),A.ADP2_INACTIVE,ISNULL(A.ADP2_PARA2_ORDER,0),'''',
		  A.ADP2_PARA2_CODE,A.ADP2_PARA2_NAME,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.ADP2_PARA2_CODE = B.PARA2_CODE 
		  WHERE B.PARA2_CODE IS NULL AND ISNULL(A.ADP2_PARA2_CODE,'''')<>'''''  
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		  SET @CSTEP=80 -- INSERT PARA2(ART_BOM)
		  SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
		  SELECT DISTINCT GETDATE(),ISNULL(A.AB2_ALIAS,''''),A.AB2_INACTIVE,ISNULL(A.AB2_PARA2_ORDER,0),'''',
		  A.AB2_PARA2_CODE,A.AB2_PARA2_NAME,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.AB2_PARA2_CODE = B.PARA2_CODE 
		  WHERE B.PARA2_CODE IS NULL AND ISNULL(A.AB2_PARA2_CODE,'''')<>'''''  
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		   SET @CSTEP=90 --UPDATE PARA3
		  SET @CCMD=N' UPDATE A1 SET A1.PARA3_NAME = A2.P3_PARA3_NAME,A1.ALIAS = A2.P3_ALIAS,A1.INACTIVE = A2.P3_INACTIVE
		  FROM PARA3 A1 WITH (ROWLOCK) 
		  JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA3_CODE = A2.P3_PARA3_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		

	    
		  SET @CSTEP=100 -- INSERT PARA3
		  SET @CCMD=N'INSERT PARA3(PARA3_CODE, PARA3_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)
		  SELECT DISTINCT A.P3_PARA3_CODE, A.P3_PARA3_NAME, GETDATE() AS LAST_UPDATE,ISNULL(A.P3_ALIAS,''''),A.P3_INACTIVE, ''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA3 B(NOLOCK) ON A.P3_PARA3_CODE = B.PARA3_CODE WHERE B.PARA3_CODE IS NULL AND ISNULL( A.P3_PARA3_CODE,'''')<>'''' ' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		  SET @CSTEP=110 --UPDATE PARA4
		  SET @CCMD=N' UPDATE A1 SET A1.PARA4_NAME = A2.P4_PARA4_NAME, A1.ALIAS = A2.P4_ALIAS, 
		  A1.INACTIVE = A2.P4_INACTIVE
		  FROM PARA4 A1 WITH (ROWLOCK)JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA4_CODE = A2.P4_PARA4_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  

	    
	    
		  SET @CSTEP=120 -- INSERT PARA4
		  SET @CCMD=N' INSERT PARA4( PARA4_CODE, PARA4_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS) 
		  SELECT DISTINCT A.P4_PARA4_CODE,A.P4_PARA4_NAME, GETDATE(),ISNULL(A.P4_ALIAS,''''), A.P4_INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA4 B(NOLOCK) ON A.P4_PARA4_CODE = B.PARA4_CODE 
		  WHERE B.PARA4_CODE IS NULL AND ISNULL( A.P4_PARA4_CODE,'''')<>'''' '  
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		  SET @CSTEP=130 --UPDATE PARA5
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA5_NAME = A2.P5_PARA5_NAME,A1.ALIAS = A2.P5_ALIAS,A1.INACTIVE = A2.P5_INACTIVE
		  FROM PARA5 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA5_CODE = A2.P5_PARA5_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD

	    
		  SET @CSTEP=140 -- INSERT PARA5
		  SET @CCMD=N' INSERT PARA5( ALIAS, INACTIVE, PARA5_CODE, PARA5_NAME, LAST_UPDATE, REMARKS)
		  SELECT DISTINCT ISNULL(A.P5_ALIAS,''''),A.P5_INACTIVE,A.P5_PARA5_CODE,A.P5_PARA5_NAME, GETDATE() ,''''
   		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA5 B(NOLOCK) ON A.P5_PARA5_CODE = B.PARA5_CODE 
   		  WHERE B.PARA5_CODE IS NULL AND ISNULL( A.P5_PARA5_CODE,'''')<>'''' '  
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		   SET @CSTEP=150 --UPDATE PARA6
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA6_NAME = A2.P6_PARA6_NAME,A1.ALIAS = A2.P6_ALIAS,A1.INACTIVE = A2.P6_INACTIVE
		  FROM PARA6 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA6_CODE = A2.P6_PARA6_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	    

	    
		  SET @CSTEP=160 --- INSERT PARA6
		  SET @CCMD=N'INSERT PARA6( PARA6_CODE, PARA6_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)  
		  SELECT DISTINCT A.P6_PARA6_CODE, A.P6_PARA6_NAME, GETDATE(),ISNULL(A.P6_ALIAS,''''),A.P6_INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA6 B(NOLOCK) ON A.P6_PARA6_CODE = B.PARA6_CODE 
		  WHERE B.PARA6_CODE IS NULL AND ISNULL( A.P6_PARA6_CODE,'''')<>'''' ' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
	
		  


		  SET @CSTEP=170 --INSERT HSN_MST(SECTIOND)
		  SET @CCMD=N'INSERT HSN_MST	(HSN_CODE,TAXABLE_ITEM, HSN_TYPE ) 
		  SELECT DISTINCT A.AR_HSN_CODE,A.HD_TAXABLE_ITEM, ISNULL(A.HD_HSN_TYPE,0) FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		  LEFT JOIN HSN_MST B (NOLOCK) ON A.AR_HSN_CODE=B.HSN_CODE
		  WHERE B.HSN_CODE IS NULL AND ISNULL(A.AR_HSN_CODE,'''')<>''''' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  SET @CSTEP=180 --INSERT HSN_DET(SECTIOND)
		  SET @CCMD=N'INSERT HSN_DET(HSN_CODE,TAX_PERCENTAGE,RATE_CUTOFF,RATE_CUTOFF_TAX_PERCENTAGE,WEF,ROW_ID ) 
		  SELECT DISTINCT A.HD2_HSN_CODE,ISNULL(A.HD2_TAX_PERCENTAGE,0), ISNULL(A.HD2_RATE_CUTOFF,0), 
		  ISNULL(A.HD2_RATE_CUTOFF_TAX_PERCENTAGE,0),
		  A.HD2_WEF, A.HD2_ROW_ID FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		  LEFT JOIN HSN_DET B (NOLOCK) ON A.HD2_HSN_CODE=B.HSN_CODE
		  WHERE B.HSN_CODE IS NULL AND ISNULL(A.AR_HSN_CODE,'''')<>''''
		  and isnull(A.HD2_WEF,'''')<>''''' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       
       END
       
		  
		  
		  
		   SET @CSTEP=190 -- UPDATE SECTIONM(SECTIOND)
		 SET @CCMD=N' UPDATE A1 SET SECTION_NAME=A2.SECTION_NAME,ALIAS=A2.SM_ALIAS,INACTIVE=A2.SM_INACTIVE,
		 ITEM_TYPE=A2.SM_ITEM_TYPE
		 FROM SECTIONM A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.SECTION_CODE = A2.SD_SECTION_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD 
	    
	    

	    
		
		 SET @CSTEP=200 --INSERT SECTIONM(SECTIOND)
		 SET @CCMD=N'INSERT SECTIONM	( SECTION_CODE, SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS,ITEM_TYPE )  
		 SELECT DISTINCT SD_SECTION_CODE, A.SECTION_NAME, GETDATE() ,ISNULL(SM_ALIAS,''''), SM_INACTIVE, '''',SM_ITEM_TYPE
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK)LEFT JOIN SECTIONM B (NOLOCK) ON A.SD_SECTION_CODE=B.SECTION_CODE
		 WHERE B.SECTION_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
	     SET @CSTEP=210 --UPDATE SECTIOND(ARTICLE)
		 SET @CCMD=N' UPDATE A1 SET SUB_SECTION_NAME=A2.SUB_SECTION_NAME,ALIAS=A2.SD_ALIAS,INACTIVE=A2.SD_INACTIVE,
		 MFG_CATEGORY=A2.SD_MFG_CATEGORY,SECTION_CODE=A2.SD_SECTION_CODE
		 FROM SECTIOND A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) 
		 ON A1.SUB_SECTION_CODE = A2.AR_SUB_SECTION_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
	
		 SET @CSTEP=220 --INSERT SECTIOND(ARTICLE)
		 SET @CCMD=N'INSERT SECTIOND( SUB_SECTION_NAME, LAST_UPDATE, ALIAS, INACTIVE, MFG_CATEGORY, SECTION_CODE, 
		 SUB_SECTION_CODE, REMARKS )  
		 SELECT DISTINCT A.SUB_SECTION_NAME, GETDATE(), ISNULL(SD_ALIAS,''''), 
		 SD_INACTIVE,ISNULL(SD_MFG_CATEGORY,0),SD_SECTION_CODE, AR_SUB_SECTION_CODE, '''' 
		 
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN SECTIOND B (NOLOCK) ON A.AR_SUB_SECTION_CODE=B.SUB_SECTION_CODE
		 WHERE B.SUB_SECTION_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 SET @CSTEP=230 --UPDATAE UOM(ARTICLE)
		 SET @CCMD=N' UPDATE A1 SET UOM_TYPE=A2.U_UOM_TYPE, INACTIVE=A2.U_INACTIVE,UOM_NAME=A2.U_UOM_NAME
		 FROM UOM A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.UOM_CODE = A2.AR_UOM_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
		
		 SET @CSTEP=240---INSERT UOM(ARTICLE)
		 SET @CCMD=N'INSERT UOM	( UOM_TYPE, INACTIVE, UOM_CODE, UOM_NAME, LAST_UPDATE ) 
		 SELECT DISTINCT 	U_UOM_TYPE, U_INACTIVE, AR_UOM_CODE, U_UOM_NAME, GETDATE()FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN UOM B (NOLOCK) ON A.AR_UOM_CODE=B.UOM_CODE
		 WHERE B.UOM_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
	IF @CODING=1
       BEGIN
		 
		 SET @CSTEP=250 --UPDATAE JOBS(ART_JOBS)
		 SET @CCMD=N' UPDATE A1 SET JOB_RATE_BASIS=A2.JO_JOB_RATE_BASIS, INACTIVE=A2.JO_INACTIVE,JOB_NAME=A2.JO_JOB_NAME,
		 PER_DAYS=A2.JO_PER_DAYS,JOBRATE=A2.JO_JOBRATE
		 FROM JOBS A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.JOB_CODE = A2.JO_JOB_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		 
		 
		 
		  SET @CSTEP=260---INSERT JOBS(ART_JOBS)
		 SET @CCMD=N'INSERT JOBS	( LAST_UPDATE,JOB_RATE_BASIS, INACTIVE, JOB_CODE, JOB_NAME, COMPANY_CODE,PER_DAYS,JOBRATE ) 
		 SELECT DISTINCT 	GETDATE(), JO_JOB_RATE_BASIS, JO_INACTIVE, JO_JOB_CODE, JO_JOB_NAME, JO_COMPANY_CODE,JO_PER_DAYS,JO_JOBRATE 
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN JOBS B (NOLOCK) ON A.JO_JOB_CODE=B.JOB_CODE
		 WHERE B.JOB_CODE IS NULL AND ISNULL(JO_JOB_NAME,'''')<>''''' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
	END	 
		 
		 
		 SET @CSTEP=270 ---  UPDATE ARTICLE
		 SET @CCMD=N' UPDATE A1 SET	A1.UOM_CODE = A2.AR_UOM_CODE, A1.CODING_SCHEME = A2.AR_CODING_SCHEME,
		 A1.SUB_SECTION_CODE = A2.AR_SUB_SECTION_CODE, A1.ARTICLE_NAME = A2.AR_ARTICLE_NAME, 
		 A1.ARTICLE_NO = A2.AR_ARTICLE_NO,A1.INACTIVE = A2.AR_INACTIVE,A1.ALIAS = A2.AR_ALIAS,
		 A1.DISCON = A2.AR_DISCON,A1.STOCK_NA = A2.AR_STOCK_NA,
		 A1.GENERATE_BARCODES_WITHARTICLE_PREFIX = A2.AR_GENERATE_BARCODES_WITHARTICLE_PREFIX,
		 A1.SKU_CODE = A2.AR_SKU_CODE,A1.ARTICLE_DESC = A2.AR_ARTICLE_DESC,
		 A1.GEN_EAN_CODES=A2.AR_GEN_EAN_CODES,A1.ORDERITEM=A2.AR_ORDERITEM,
		 A1.HSN_CODE=A2.AR_HSN_CODE,A1.PARA1_SET = A2.AR_PARA1_SET, A1.PARA2_SET = A2.AR_PARA2_SET,
		 A1.ARTICLE_PURCHASE_MODE=A2.AR_ARTICLE_PURCHASE_MODE,A1.ARTICLE_TYPE=A2.AR_ARTICLE_TYPE,
		 A1.MRP=A2.AR_MRP
		 FROM ARTICLE A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ARTICLE_CODE = A2.AR_ARTICLE_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
	     
     
		 SET @CSTEP=280 --INSERT ARTICLE(SKU)
		 SET @CCMD=N'INSERT ARTICLE	( PARA2_CODE, PARA3_CODE, PARA4_CODE, PARA5_CODE, PARA6_CODE, DISCON, 
		 WHOLESALE_PRICE, WSP_PERCENTAGE, MIN_PRICE, STOCK_NA, ARTICLE_TYPE, CREATED_ON, ARTICLE_GROUP_CODE,
		 COMPANY_CODE, GENERATE_BARCODES_WITHARTICLE_PREFIX, ARTICLE_GEN_MODE, ARTICLE_PRD_MODE, ARTICLE_SET_CODE,
		 OH_PERCENTAGE, OH_AMOUNT, FIX_MRP, ENABLE_FIXWT_ENTRY, FIX_WEIGHT, EXP_AMOUNT, SUPP_SPECIFIC, SUPP_AC_CODE,
		 SUPP_ITEM_CODE, REMARKS, FIX_PRICE_ARTICLE, GROSS_PURCHASE_PRICE, DISCOUNT_PERCENTAGE, DISCOUNT_AMOUNT, 
		 GEN_EAN_CODES, SIZE_CENTER_POINT, SIZE_RATE_DIFF, MANUAL_DISC, MANUAL_WSP, MANUAL_RSP, 
		 AREA_WISE_RATE_APPLICABLE, ORDERITEM,  DO_AMOUNT, DO_PERCENTAGE, EXP_PERCENTAGE,
		 ARTICLE_SET_TYPE, STYLE_NO, COLOR_NAME, COLOR_CODE, SIZE, DEBIT_MATERIAL,
		 CODING_SCHEME, LAST_UPDATE, UOM_CODE, ALIAS, MP_PERCENTAGE, PURCHASE_PRICE, MRP, PARA1_SET,
		 PARA2_SET, INACTIVE, SKU_CODE, DT_CREATED, USER_CODE, EDT_USER_CODE, ARTICLE_CODE, ARTICLE_NO,
		 ARTICLE_NAME, ARTICLE_DESC, SUB_SECTION_CODE, PARA1_CODE,HSN_CODE,ARTICLE_PURCHASE_MODE )  
	    
		 SELECT DISTINCT ''0000000'', ''0000000'', ''0000000'',''0000000'',''0000000'', ISNULL(AR_DISCON,0), 0,0, 0,
		 AR_STOCK_NA, AR_ARTICLE_TYPE, '''','''',''01'',   AR_GENERATE_BARCODES_WITHARTICLE_PREFIX, 0,0,'''',0,0, 0, 0,0, 0, 0,
		 '''', '''', '''', 0, 0, 0, 0, AR_GEN_EAN_CODES, 0, 0,  0, 0, 0, 0, AR_ORDERITEM,
		 0, 0, 0,  0, '''', '''', '''', '''', 0, ISNULL(AR_CODING_SCHEME,0), GETDATE(), AR_UOM_CODE, 
		 ISNULL(AR_ALIAS,''''),0, 0, AR_MRP, AR_PARA1_SET, AR_PARA2_SET, AR_INACTIVE, ISNULL(AR_SKU_CODE,''''), '''',
		 ''0000000'', ''0000000'', A.AR_ARTICLE_CODE, AR_ARTICLE_NO, AR_ARTICLE_NAME, AR_ARTICLE_DESC,
		 AR_SUB_SECTION_CODE, ''0000000'',AR_HSN_CODE,AR_ARTICLE_PURCHASE_MODE 
		 FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
		 LEFT JOIN ARTICLE B (NOLOCK) ON A.AR_ARTICLE_CODE=B.ARTICLE_CODE
		 WHERE B.ARTICLE_CODE IS NULL' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		SET @CSTEP=282 --INSERT sku(fix)
		IF @CODING=1 AND @SKUINS='Y'
		BEGIN
			SET @CCMD=N' INSERT SKU	( PARA2_CODE, LAST_UPDATE, PURCHASE_PRICE, PARA3_CODE, INV_DT, INV_NO, AC_CODE, 
			RECEIPT_DT, PARA4_CODE, PARA5_CODE, PARA6_CODE, FORM_ID, MRP, DT_CREATED, WS_PRICE, IMAGE_NAME, 
			TAX_AMOUNT, CHALLAN_NO, FIX_MRP, PRODUCT_NAME, PRODUCT_CODE, ARTICLE_CODE, PARA1_CODE, ER_FLAG, 
			UPLOADED_TO_ACTIVSTREAM, BARCODE_CODING_SCHEME, EMP_CODE, VENDOR_EAN_NO, ONLINE_PRODUCT_CODE, 
			LAST_MODIFIED_ON, BASIC_PURCHASE_PRICE, HSN_CODE, GST_PERCENTAGE, BATCH_NO, EXPIRY_DT )  
			
			SELECT 	DISTINCT  Z_PARA2_CODE, Z_LAST_UPDATE, Z_PURCHASE_PRICE, Z_PARA3_CODE, Z_INV_DT, Z_INV_NO, 
			Z_AC_CODE, Z_RECEIPT_DT, Z_PARA4_CODE, Z_PARA5_CODE, Z_PARA6_CODE, Z_FORM_ID, Z_MRP, Z_DT_CREATED,
			Z_WS_PRICE, Z_IMAGE_NAME, Z_TAX_AMOUNT, Z_CHALLAN_NO, Z_FIX_MRP, Z_PRODUCT_NAME, Z_PRODUCT_CODE, 
			Z_ARTICLE_CODE, Z_PARA1_CODE, Z_ER_FLAG, Z_UPLOADED_TO_ACTIVSTREAM, Z_BARCODE_CODING_SCHEME, 
			Z_EMP_CODE, Z_VENDOR_EAN_NO, Z_ONLINE_PRODUCT_CODE, Z_LAST_MODIFIED_ON, Z_BASIC_PURCHASE_PRICE,
			Z_HSN_CODE, Z_GST_PERCENTAGE, Z_BATCH_NO, Z_EXPIRY_DT 
			FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
			LEFT JOIN SKU B (NOLOCK) ON A.Z_PRODUCT_CODE=B.PRODUCT_CODE
			WHERE B.PRODUCT_CODE IS NULL' 
			PRINT @CCMD 
			EXEC SP_EXECUTESQL @CCMD
		 END
		 
		 
		 
		 
		 
	  
		   
		   
		   
		   SET @CSTEP=290 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR1_KEY_NAME=A2.Y1_ATTR1_KEY_NAME,
		              ATTR1_ALIAS   =A2.Y1_ATTR1_ALIAS,
		              ATTR1_INACTIVE=A2.Y1_ATTR1_INACTIVE
		 FROM ATTR1_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR1_KEY_CODE = A2.Y_ATTR1_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=300 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR2_KEY_NAME=A2.Y2_ATTR2_KEY_NAME,
		              ATTR2_ALIAS   =A2.Y2_ATTR2_ALIAS,
		              ATTR2_INACTIVE=A2.Y2_ATTR2_INACTIVE
		 FROM ATTR2_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR2_KEY_CODE = A2.Y_ATTR2_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		 SET @CSTEP=310 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR3_KEY_NAME=A2.Y3_ATTR3_KEY_NAME,
		              ATTR3_ALIAS   =A2.Y3_ATTR3_ALIAS,
		              ATTR3_INACTIVE=A2.Y3_ATTR3_INACTIVE
		 FROM ATTR3_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR3_KEY_CODE = A2.Y_ATTR3_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=320 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR4_KEY_NAME=A2.Y4_ATTR4_KEY_NAME,
		              ATTR4_ALIAS   =A2.Y4_ATTR4_ALIAS,
		              ATTR4_INACTIVE=A2.Y4_ATTR4_INACTIVE
		 FROM ATTR4_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR4_KEY_CODE = A2.Y_ATTR4_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=330 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR5_KEY_NAME=A2.Y5_ATTR5_KEY_NAME,
		              ATTR5_ALIAS   =A2.Y5_ATTR5_ALIAS,
		              ATTR5_INACTIVE=A2.Y5_ATTR5_INACTIVE
		 FROM ATTR5_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR5_KEY_CODE = A2.Y_ATTR5_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=340 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR6_KEY_NAME=A2.Y6_ATTR6_KEY_NAME,
		              ATTR6_ALIAS   =A2.Y6_ATTR6_ALIAS,
		              ATTR6_INACTIVE=A2.Y6_ATTR6_INACTIVE
		 FROM ATTR6_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR6_KEY_CODE = A2.Y_ATTR6_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=350 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR7_KEY_NAME=A2.Y7_ATTR7_KEY_NAME,
		              ATTR7_ALIAS   =A2.Y7_ATTR7_ALIAS,
		              ATTR7_INACTIVE=A2.Y7_ATTR7_INACTIVE
		 FROM ATTR7_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR7_KEY_CODE = A2.Y_ATTR7_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=360 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR8_KEY_NAME=A2.Y8_ATTR8_KEY_NAME,
		              ATTR8_ALIAS   =A2.Y8_ATTR8_ALIAS,
		              ATTR8_INACTIVE=A2.Y8_ATTR8_INACTIVE
		 FROM ATTR8_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR8_KEY_CODE = A2.Y_ATTR8_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=370 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR9_KEY_NAME=A2.Y9_ATTR9_KEY_NAME,
		              ATTR9_ALIAS   =A2.Y9_ATTR9_ALIAS,
		              ATTR9_INACTIVE=A2.Y9_ATTR9_INACTIVE
		 FROM ATTR9_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR9_KEY_CODE = A2.Y_ATTR9_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=380 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR10_KEY_NAME=A2.Y10_ATTR10_KEY_NAME,
		              ATTR10_ALIAS   =A2.Y10_ATTR10_ALIAS,
		              ATTR10_INACTIVE=A2.Y10_ATTR10_INACTIVE
		 FROM ATTR10_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR10_KEY_CODE = A2.Y_ATTR10_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=390 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR11_KEY_NAME=A2.Y11_ATTR11_KEY_NAME,
		              ATTR11_ALIAS   =A2.Y11_ATTR11_ALIAS,
		              ATTR11_INACTIVE=A2.Y11_ATTR11_INACTIVE
		 FROM ATTR11_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR11_KEY_CODE = A2.Y_ATTR11_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=400 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR12_KEY_NAME=A2.Y12_ATTR12_KEY_NAME,
		              ATTR12_ALIAS   =A2.Y12_ATTR12_ALIAS,
		              ATTR12_INACTIVE=A2.Y12_ATTR12_INACTIVE
		 FROM ATTR12_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR12_KEY_CODE = A2.Y_ATTR12_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=410 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR13_KEY_NAME=A2.Y13_ATTR13_KEY_NAME,
		              ATTR13_ALIAS   =A2.Y13_ATTR13_ALIAS,
		              ATTR13_INACTIVE=A2.Y13_ATTR13_INACTIVE
		 FROM ATTR13_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR13_KEY_CODE = A2.Y_ATTR13_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=420 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR14_KEY_NAME=A2.Y14_ATTR14_KEY_NAME,
		              ATTR14_ALIAS   =A2.Y14_ATTR14_ALIAS,
		              ATTR14_INACTIVE=A2.Y14_ATTR14_INACTIVE
		 FROM ATTR14_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR14_KEY_CODE = A2.Y_ATTR14_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=430 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR15_KEY_NAME=A2.Y15_ATTR15_KEY_NAME,
		              ATTR15_ALIAS   =A2.Y15_ATTR15_ALIAS,
		              ATTR15_INACTIVE=A2.Y15_ATTR15_INACTIVE
		 FROM ATTR15_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR15_KEY_CODE = A2.Y_ATTR15_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=440 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR16_KEY_NAME=A2.Y16_ATTR16_KEY_NAME,
		              ATTR16_ALIAS   =A2.Y16_ATTR16_ALIAS,
		              ATTR16_INACTIVE=A2.Y16_ATTR16_INACTIVE
		 FROM ATTR16_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR16_KEY_CODE = A2.Y_ATTR16_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=450 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR17_KEY_NAME=A2.Y17_ATTR17_KEY_NAME,
		              ATTR17_ALIAS   =A2.Y17_ATTR17_ALIAS,
		              ATTR17_INACTIVE=A2.Y17_ATTR17_INACTIVE
		 FROM ATTR17_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR17_KEY_CODE = A2.Y_ATTR17_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=460 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR18_KEY_NAME=A2.Y18_ATTR18_KEY_NAME,
		              ATTR18_ALIAS   =A2.Y18_ATTR18_ALIAS,
		              ATTR18_INACTIVE=A2.Y18_ATTR18_INACTIVE
		 FROM ATTR18_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR18_KEY_CODE = A2.Y_ATTR18_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=470 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR19_KEY_NAME=A2.Y19_ATTR19_KEY_NAME,
		              ATTR19_ALIAS   =A2.Y19_ATTR19_ALIAS,
		              ATTR19_INACTIVE=A2.Y19_ATTR19_INACTIVE
		 FROM ATTR19_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR19_KEY_CODE = A2.Y_ATTR19_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=480 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR20_KEY_NAME=A2.Y20_ATTR20_KEY_NAME,
		              ATTR20_ALIAS   =A2.Y20_ATTR20_ALIAS,
		              ATTR20_INACTIVE=A2.Y20_ATTR20_INACTIVE
		 FROM ATTR20_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR20_KEY_CODE = A2.Y_ATTR20_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=490 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR21_KEY_NAME=A2.Y21_ATTR21_KEY_NAME,
		              ATTR21_ALIAS   =A2.Y21_ATTR21_ALIAS,
		              ATTR21_INACTIVE=A2.Y21_ATTR21_INACTIVE
		 FROM ATTR21_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR21_KEY_CODE = A2.Y_ATTR21_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=500 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR22_KEY_NAME=A2.Y22_ATTR22_KEY_NAME,
		              ATTR22_ALIAS   =A2.Y22_ATTR22_ALIAS,
		              ATTR22_INACTIVE=A2.Y22_ATTR22_INACTIVE
		 FROM ATTR22_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR22_KEY_CODE = A2.Y_ATTR22_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=510 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR23_KEY_NAME=A2.Y23_ATTR23_KEY_NAME,
		              ATTR23_ALIAS   =A2.Y23_ATTR23_ALIAS,
		              ATTR23_INACTIVE=A2.Y23_ATTR23_INACTIVE
		 FROM ATTR23_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR23_KEY_CODE = A2.Y_ATTR23_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=520 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR24_KEY_NAME=A2.Y24_ATTR24_KEY_NAME,
		              ATTR24_ALIAS   =A2.Y24_ATTR24_ALIAS,
		              ATTR24_INACTIVE=A2.Y24_ATTR24_INACTIVE
		 FROM ATTR24_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR24_KEY_CODE = A2.Y_ATTR24_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		   
		   
		   SET @CSTEP=530 
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR25_KEY_NAME=A2.Y25_ATTR25_KEY_NAME,
		              ATTR25_ALIAS   =A2.Y25_ATTR25_ALIAS,
		              ATTR25_INACTIVE=A2.Y25_ATTR25_INACTIVE
		 FROM ATTR25_MST A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.ATTR25_KEY_CODE = A2.Y_ATTR25_KEY_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD





           
		   
		     SET @CSTEP=540 --INSERT ATTR1_MST
		 SET @CCMD=N'INSERT ATTR1_MST	( ATTR1_KEY_CODE, ATTR1_KEY_NAME, ATTR1_ALIAS, ATTR1_INACTIVE )  
		  SELECT 	DISTINCT  Y_ATTR1_KEY_CODE, Y1_ATTR1_KEY_NAME, Y1_ATTR1_ALIAS, Y1_ATTR1_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR1_MST B (NOLOCK) ON A.Y_ATTR1_KEY_CODE=B.ATTR1_KEY_CODE
		 WHERE B.ATTR1_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR1_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=550 --INSERT ATTR2_MST
		 SET @CCMD=N'INSERT ATTR2_MST	( ATTR2_KEY_CODE, ATTR2_KEY_NAME, ATTR2_ALIAS, ATTR2_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR2_KEY_CODE, Y2_ATTR2_KEY_NAME, Y2_ATTR2_ALIAS, Y2_ATTR2_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR2_MST B (NOLOCK) ON A.Y_ATTR2_KEY_CODE=B.ATTR2_KEY_CODE
		 WHERE B.ATTR2_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR2_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=560 --INSERT ATTR3_MST
		 SET @CCMD=N'INSERT ATTR3_MST	( ATTR3_KEY_CODE, ATTR3_KEY_NAME, ATTR3_ALIAS, ATTR3_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR3_KEY_CODE, Y3_ATTR3_KEY_NAME, Y3_ATTR3_ALIAS, Y3_ATTR3_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR3_MST B (NOLOCK) ON A.Y_ATTR3_KEY_CODE=B.ATTR3_KEY_CODE
		 WHERE B.ATTR3_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR3_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=570 --INSERT ATTR4_MST
		 SET @CCMD=N'INSERT ATTR4_MST	( ATTR4_KEY_CODE, ATTR4_KEY_NAME, ATTR4_ALIAS, ATTR4_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR4_KEY_CODE, Y4_ATTR4_KEY_NAME, Y4_ATTR4_ALIAS, Y4_ATTR4_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR4_MST B (NOLOCK) ON A.Y_ATTR4_KEY_CODE=B.ATTR4_KEY_CODE
		 WHERE B.ATTR4_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR4_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=580 --INSERT ATTR5_MST
		 SET @CCMD=N'INSERT ATTR5_MST	( ATTR5_KEY_CODE, ATTR5_KEY_NAME, ATTR5_ALIAS, ATTR5_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR5_KEY_CODE, Y5_ATTR5_KEY_NAME, Y5_ATTR5_ALIAS, Y5_ATTR5_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR5_MST B (NOLOCK) ON A.Y_ATTR5_KEY_CODE=B.ATTR5_KEY_CODE
		 WHERE B.ATTR5_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR5_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=590 --INSERT ATTR6_MST
		 SET @CCMD=N'INSERT ATTR6_MST	( ATTR6_KEY_CODE, ATTR6_KEY_NAME, ATTR6_ALIAS, ATTR6_INACTIVE )  
		  SELECT DISTINCT  Y_ATTR6_KEY_CODE, Y6_ATTR6_KEY_NAME, Y6_ATTR6_ALIAS, Y6_ATTR6_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR6_MST B (NOLOCK) ON A.Y_ATTR6_KEY_CODE=B.ATTR6_KEY_CODE
		 WHERE B.ATTR6_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR6_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=600 --INSERT ATTR7_MST
		 SET @CCMD=N'INSERT ATTR7_MST	( ATTR7_KEY_CODE, ATTR7_KEY_NAME, ATTR7_ALIAS, ATTR7_INACTIVE )  
		  SELECT 	DISTINCT  Y_ATTR7_KEY_CODE, Y7_ATTR7_KEY_NAME, Y7_ATTR7_ALIAS, Y7_ATTR7_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR7_MST B (NOLOCK) ON A.Y_ATTR7_KEY_CODE=B.ATTR7_KEY_CODE
		 WHERE B.ATTR7_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR7_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=610 --INSERT ATTR8_MST
		 SET @CCMD=N'INSERT ATTR8_MST	( ATTR8_KEY_CODE, ATTR8_KEY_NAME, ATTR8_ALIAS, ATTR8_INACTIVE )  
		  SELECT 	DISTINCT  Y_ATTR8_KEY_CODE, Y8_ATTR8_KEY_NAME, Y8_ATTR8_ALIAS, Y8_ATTR8_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR8_MST B (NOLOCK) ON A.Y_ATTR8_KEY_CODE=B.ATTR8_KEY_CODE
		 WHERE B.ATTR8_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR8_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=620 --INSERT ATTR9_MST
		 SET @CCMD=N'INSERT ATTR9_MST	( ATTR9_KEY_CODE, ATTR9_KEY_NAME, ATTR9_ALIAS, ATTR9_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR9_KEY_CODE, Y9_ATTR9_KEY_NAME, Y9_ATTR9_ALIAS, Y9_ATTR9_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR9_MST B (NOLOCK) ON A.Y_ATTR9_KEY_CODE=B.ATTR9_KEY_CODE
		 WHERE B.ATTR9_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR9_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=630 --INSERT ATTR10_MST
		 SET @CCMD=N'INSERT ATTR10_MST	( ATTR10_KEY_CODE, ATTR10_KEY_NAME, ATTR10_ALIAS, ATTR10_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR10_KEY_CODE, Y10_ATTR10_KEY_NAME, Y10_ATTR10_ALIAS, Y10_ATTR10_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR10_MST B (NOLOCK) ON A.Y_ATTR10_KEY_CODE=B.ATTR10_KEY_CODE
		 WHERE B.ATTR10_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR10_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=640 --INSERT ATTR11_MST
		 SET @CCMD=N'INSERT ATTR11_MST	( ATTR11_KEY_CODE, ATTR11_KEY_NAME, ATTR11_ALIAS, ATTR11_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR11_KEY_CODE, Y11_ATTR11_KEY_NAME, Y11_ATTR11_ALIAS, Y11_ATTR11_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR11_MST B (NOLOCK) ON A.Y_ATTR11_KEY_CODE=B.ATTR11_KEY_CODE
		 WHERE B.ATTR11_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR11_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=650 --INSERT ATTR12_MST
		 SET @CCMD=N'INSERT ATTR12_MST	( ATTR12_KEY_CODE, ATTR12_KEY_NAME, ATTR12_ALIAS, ATTR12_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR12_KEY_CODE, Y12_ATTR12_KEY_NAME, Y12_ATTR12_ALIAS, Y12_ATTR12_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR12_MST B (NOLOCK) ON A.Y_ATTR12_KEY_CODE=B.ATTR12_KEY_CODE
		 WHERE B.ATTR12_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR12_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=660 --INSERT ATTR13_MST
		 SET @CCMD=N'INSERT ATTR13_MST	( ATTR13_KEY_CODE, ATTR13_KEY_NAME, ATTR13_ALIAS, ATTR13_INACTIVE )  
		  SELECT 	DISTINCT  Y_ATTR13_KEY_CODE, Y13_ATTR13_KEY_NAME, Y13_ATTR13_ALIAS, Y13_ATTR13_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR13_MST B (NOLOCK) ON A.Y_ATTR13_KEY_CODE=B.ATTR13_KEY_CODE
		 WHERE B.ATTR13_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR13_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=670 --INSERT ATTR14_MST
		 SET @CCMD=N'INSERT ATTR14_MST	( ATTR14_KEY_CODE, ATTR14_KEY_NAME, ATTR14_ALIAS, ATTR14_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR14_KEY_CODE, Y14_ATTR14_KEY_NAME, Y14_ATTR14_ALIAS, Y14_ATTR14_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR14_MST B (NOLOCK) ON A.Y_ATTR14_KEY_CODE=B.ATTR14_KEY_CODE
		 WHERE B.ATTR14_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR14_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=680 --INSERT ATTR15_MST
		 SET @CCMD=N'INSERT ATTR15_MST	( ATTR15_KEY_CODE, ATTR15_KEY_NAME, ATTR15_ALIAS, ATTR15_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR15_KEY_CODE, Y15_ATTR15_KEY_NAME, Y15_ATTR15_ALIAS, Y15_ATTR15_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR15_MST B (NOLOCK) ON A.Y_ATTR15_KEY_CODE=B.ATTR15_KEY_CODE
		 WHERE B.ATTR15_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR15_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=690 --INSERT ATTR16_MST
		 SET @CCMD=N'INSERT ATTR16_MST	( ATTR16_KEY_CODE, ATTR16_KEY_NAME, ATTR16_ALIAS, ATTR16_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR16_KEY_CODE, Y16_ATTR16_KEY_NAME, Y16_ATTR16_ALIAS, Y16_ATTR16_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR16_MST B (NOLOCK) ON A.Y_ATTR16_KEY_CODE=B.ATTR16_KEY_CODE
		 WHERE B.ATTR16_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR16_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=700 --INSERT ATTR17_MST
		 SET @CCMD=N'INSERT ATTR17_MST	( ATTR17_KEY_CODE, ATTR17_KEY_NAME, ATTR17_ALIAS, ATTR17_INACTIVE )  
		  SELECT 	DISTINCT  Y_ATTR17_KEY_CODE, Y17_ATTR17_KEY_NAME, Y17_ATTR17_ALIAS, Y17_ATTR17_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR17_MST B (NOLOCK) ON A.Y_ATTR17_KEY_CODE=B.ATTR17_KEY_CODE
		 WHERE B.ATTR17_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR17_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=710 --INSERT ATTR18_MST
		 SET @CCMD=N'INSERT ATTR18_MST	( ATTR18_KEY_CODE, ATTR18_KEY_NAME, ATTR18_ALIAS, ATTR18_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR18_KEY_CODE, Y18_ATTR18_KEY_NAME, Y18_ATTR18_ALIAS, Y18_ATTR18_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR18_MST B (NOLOCK) ON A.Y_ATTR18_KEY_CODE=B.ATTR18_KEY_CODE
		 WHERE B.ATTR18_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR18_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=720 --INSERT ATTR19_MST
		 SET @CCMD=N'INSERT ATTR19_MST	( ATTR19_KEY_CODE, ATTR19_KEY_NAME, ATTR19_ALIAS, ATTR19_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR19_KEY_CODE, Y19_ATTR19_KEY_NAME, Y19_ATTR19_ALIAS, Y19_ATTR19_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR19_MST B (NOLOCK) ON A.Y_ATTR19_KEY_CODE=B.ATTR19_KEY_CODE
		 WHERE B.ATTR19_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR19_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=730 --INSERT ATTR20_MST
		 SET @CCMD=N'INSERT ATTR20_MST	( ATTR20_KEY_CODE, ATTR20_KEY_NAME, ATTR20_ALIAS, ATTR20_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR20_KEY_CODE, Y20_ATTR20_KEY_NAME, Y20_ATTR20_ALIAS, Y20_ATTR20_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR20_MST B (NOLOCK) ON A.Y_ATTR20_KEY_CODE=B.ATTR20_KEY_CODE
		 WHERE B.ATTR20_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR20_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=740 --INSERT ATTR21_MST
		 SET @CCMD=N'INSERT ATTR21_MST	( ATTR21_KEY_CODE, ATTR21_KEY_NAME, ATTR21_ALIAS, ATTR21_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR21_KEY_CODE, Y21_ATTR21_KEY_NAME, Y21_ATTR21_ALIAS, Y21_ATTR21_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR21_MST B (NOLOCK) ON A.Y_ATTR21_KEY_CODE=B.ATTR21_KEY_CODE
		 WHERE B.ATTR21_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR21_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=750 --INSERT ATTR22_MST
		 SET @CCMD=N'INSERT ATTR22_MST	( ATTR22_KEY_CODE, ATTR22_KEY_NAME, ATTR22_ALIAS, ATTR22_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR22_KEY_CODE, Y22_ATTR22_KEY_NAME, Y22_ATTR22_ALIAS, Y22_ATTR22_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR22_MST B (NOLOCK) ON A.Y_ATTR22_KEY_CODE=B.ATTR22_KEY_CODE
		 WHERE B.ATTR22_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR22_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=760 --INSERT ATTR23_MST
		 SET @CCMD=N'INSERT ATTR23_MST	( ATTR23_KEY_CODE, ATTR23_KEY_NAME, ATTR23_ALIAS, ATTR23_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR23_KEY_CODE, Y23_ATTR23_KEY_NAME, Y23_ATTR23_ALIAS, Y23_ATTR23_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR23_MST B (NOLOCK) ON A.Y_ATTR23_KEY_CODE=B.ATTR23_KEY_CODE
		 WHERE B.ATTR23_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR23_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=770 --INSERT ATTR24_MST
		 SET @CCMD=N'INSERT ATTR24_MST	( ATTR24_KEY_CODE, ATTR24_KEY_NAME, ATTR24_ALIAS, ATTR24_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR24_KEY_CODE, Y24_ATTR24_KEY_NAME, Y24_ATTR24_ALIAS, Y24_ATTR24_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR24_MST B (NOLOCK) ON A.Y_ATTR24_KEY_CODE=B.ATTR24_KEY_CODE
		 WHERE B.ATTR24_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR24_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
 
		   
		     SET @CSTEP=780 --INSERT ATTR25_MST
		 SET @CCMD=N'INSERT ATTR25_MST	( ATTR25_KEY_CODE, ATTR25_KEY_NAME, ATTR25_ALIAS, ATTR25_INACTIVE )  
		  SELECT DISTINCT	  Y_ATTR25_KEY_CODE, Y25_ATTR25_KEY_NAME, Y25_ATTR25_ALIAS, Y25_ATTR25_INACTIVE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ATTR25_MST B (NOLOCK) ON A.Y_ATTR25_KEY_CODE=B.ATTR25_KEY_CODE
		 WHERE B.ATTR25_KEY_CODE IS NULL  AND ISNULL(A.Y_ATTR25_KEY_CODE,'''') NOT IN ('''',''0000000'')' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		  SET @CSTEP=790 
		 SET @CCMD=N' UPDATE A1 SET 
		             ATTR1_MST=A2.SA_ATTR1_MST,
					 ATTR2_MST=A2.SA_ATTR2_MST,
					 ATTR3_MST=A2.SA_ATTR3_MST,
					 ATTR4_MST=A2.SA_ATTR4_MST,
					 ATTR5_MST=A2.SA_ATTR5_MST,
					 ATTR6_MST=A2.SA_ATTR6_MST,
					 ATTR7_MST=A2.SA_ATTR7_MST,
					 ATTR8_MST=A2.SA_ATTR8_MST,
					 ATTR9_MST=A2.SA_ATTR9_MST,
					 ATTR10_MST=A2.SA_ATTR10_MST,
					 ATTR11_MST=A2.SA_ATTR11_MST,
					 ATTR12_MST=A2.SA_ATTR12_MST,
					 ATTR13_MST=A2.SA_ATTR13_MST,
					 ATTR14_MST=A2.SA_ATTR14_MST,
					 ATTR15_MST=A2.SA_ATTR15_MST,
					 ATTR16_MST=A2.SA_ATTR16_MST,
					 ATTR17_MST=A2.SA_ATTR17_MST,
					 ATTR18_MST=A2.SA_ATTR18_MST,
					 ATTR19_MST=A2.SA_ATTR19_MST,
					 ATTR20_MST=A2.SA_ATTR20_MST,
					 ATTR21_MST=A2.SA_ATTR21_MST,
					 ATTR22_MST=A2.SA_ATTR22_MST,
					 ATTR23_MST=A2.SA_ATTR23_MST,
					 ATTR24_MST=A2.SA_ATTR24_MST,
					 ATTR25_MST=A2.SA_ATTR25_MST


		 FROM SD_ATTR_AVATAR A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.SUB_SECTION_CODE = A2.SA_SUB_SECTION_CODE '
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 SET @CSTEP=793 --INSERT SD_ATTR_AVATAR
		 SET @CCMD=N'INSERT SD_ATTR_AVATAR	( SUB_SECTION_CODE, ATTR1_MST, ATTR2_MST, ATTR3_MST, ATTR4_MST, 
		  ATTR5_MST, ATTR6_MST, ATTR7_MST, ATTR8_MST, ATTR9_MST, ATTR10_MST, ATTR11_MST, 
		  ATTR12_MST, ATTR13_MST, ATTR14_MST, ATTR15_MST, ATTR16_MST, ATTR17_MST,
		  ATTR18_MST, ATTR19_MST, ATTR20_MST, ATTR21_MST, ATTR22_MST, ATTR23_MST, 
		  ATTR24_MST, ATTR25_MST ) 
		  
		  SELECT DISTINCT  SA_SUB_SECTION_CODE, SA_ATTR1_MST, SA_ATTR2_MST, SA_ATTR3_MST, SA_ATTR4_MST, SA_ATTR5_MST, 
		  SA_ATTR6_MST,  SA_ATTR7_MST,  SA_ATTR8_MST, SA_ATTR9_MST, SA_ATTR10_MST, SA_ATTR11_MST, 
		  SA_ATTR12_MST, SA_ATTR13_MST, SA_ATTR14_MST, SA_ATTR15_MST, SA_ATTR16_MST, SA_ATTR17_MST, 
		  SA_ATTR18_MST, SA_ATTR19_MST, SA_ATTR20_MST, SA_ATTR21_MST, SA_ATTR22_MST, SA_ATTR23_MST, 
		  SA_ATTR24_MST, SA_ATTR25_MST 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN SD_ATTR_AVATAR B (NOLOCK) ON A.SA_SUB_SECTION_CODE=B.SUB_SECTION_CODE
		 WHERE B.SUB_SECTION_CODE IS NULL  AND ISNULL(A.SA_SUB_SECTION_CODE,'''')<>''''' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 


  
		   SET @CSTEP=796
		 SET @CCMD=N' UPDATE A1 SET 
		              ATTR1_KEY_CODE=A2.Y_ATTR1_KEY_CODE,
		              ATTR2_KEY_CODE=A2.Y_ATTR2_KEY_CODE,
		              ATTR3_KEY_CODE=A2.Y_ATTR3_KEY_CODE,
		              ATTR4_KEY_CODE=A2.Y_ATTR4_KEY_CODE,
		              ATTR5_KEY_CODE=A2.Y_ATTR5_KEY_CODE,
		              ATTR6_KEY_CODE=A2.Y_ATTR6_KEY_CODE,
		              ATTR7_KEY_CODE=A2.Y_ATTR7_KEY_CODE,
		              ATTR8_KEY_CODE=A2.Y_ATTR8_KEY_CODE,
		              ATTR9_KEY_CODE=A2.Y_ATTR9_KEY_CODE,
		              ATTR10_KEY_CODE=A2.Y_ATTR10_KEY_CODE,
		              ATTR11_KEY_CODE=A2.Y_ATTR11_KEY_CODE,
		              ATTR12_KEY_CODE=A2.Y_ATTR12_KEY_CODE,
		              ATTR13_KEY_CODE=A2.Y_ATTR13_KEY_CODE,
		              ATTR14_KEY_CODE=A2.Y_ATTR14_KEY_CODE,
		              ATTR15_KEY_CODE=A2.Y_ATTR15_KEY_CODE,
		              ATTR16_KEY_CODE=A2.Y_ATTR16_KEY_CODE,
		              ATTR17_KEY_CODE=A2.Y_ATTR17_KEY_CODE,
		              ATTR18_KEY_CODE=A2.Y_ATTR18_KEY_CODE,
		              ATTR19_KEY_CODE=A2.Y_ATTR19_KEY_CODE,
		              ATTR20_KEY_CODE=A2.Y_ATTR20_KEY_CODE,
		              ATTR21_KEY_CODE=A2.Y_ATTR21_KEY_CODE,
		              ATTR22_KEY_CODE=A2.Y_ATTR22_KEY_CODE,
		              ATTR23_KEY_CODE=A2.Y_ATTR23_KEY_CODE,
		              ATTR24_KEY_CODE=A2.Y_ATTR24_KEY_CODE,
		              ATTR25_KEY_CODE=A2.Y_ATTR25_KEY_CODE


		 FROM ARTICLE_FIX_ATTR A1 WITH (ROWLOCK) 
		 JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.article_code = A2.AR_article_code 
		 where A2.Y_ATTR1_KEY_CODE is not null'
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 

		  SET @CSTEP=800 --INSERT ARTICLE_FIX_ATTR
		 SET @CCMD=N'INSERT ARTICLE_FIX_ATTR	( ARTICLE_CODE, ATTR1_KEY_CODE, ATTR2_KEY_CODE, ATTR3_KEY_CODE, ATTR4_KEY_CODE, 
		  ATTR5_KEY_CODE, ATTR6_KEY_CODE, ATTR7_KEY_CODE, ATTR8_KEY_CODE, ATTR9_KEY_CODE, ATTR10_KEY_CODE, ATTR11_KEY_CODE, 
		  ATTR12_KEY_CODE, ATTR13_KEY_CODE, ATTR14_KEY_CODE, ATTR15_KEY_CODE, ATTR16_KEY_CODE, ATTR17_KEY_CODE,
		  ATTR18_KEY_CODE, ATTR19_KEY_CODE, ATTR20_KEY_CODE, ATTR21_KEY_CODE, ATTR22_KEY_CODE, ATTR23_KEY_CODE, 
		  ATTR24_KEY_CODE, ATTR25_KEY_CODE ) 
		  
		  SELECT DISTINCT  AR_ARTICLE_CODE, Y_ATTR1_KEY_CODE, Y_ATTR2_KEY_CODE, Y_ATTR3_KEY_CODE, Y_ATTR4_KEY_CODE, Y_ATTR5_KEY_CODE, 
		  Y_ATTR6_KEY_CODE,  Y_ATTR7_KEY_CODE,  Y_ATTR8_KEY_CODE, Y_ATTR9_KEY_CODE, Y_ATTR10_KEY_CODE, Y_ATTR11_KEY_CODE, 
		  Y_ATTR12_KEY_CODE, Y_ATTR13_KEY_CODE, Y_ATTR14_KEY_CODE, Y_ATTR15_KEY_CODE, Y_ATTR16_KEY_CODE, Y_ATTR17_KEY_CODE, 
		  Y_ATTR18_KEY_CODE, Y_ATTR19_KEY_CODE, Y_ATTR20_KEY_CODE, Y_ATTR21_KEY_CODE, Y_ATTR22_KEY_CODE, Y_ATTR23_KEY_CODE, 
		  Y_ATTR24_KEY_CODE, Y_ATTR25_KEY_CODE 
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK)
		  LEFT JOIN ARTICLE_FIX_ATTR B (NOLOCK) ON A.AR_ARTICLE_CODE=B.ARTICLE_CODE
		 WHERE B.ARTICLE_CODE IS NULL  AND ISNULL(A.AR_ARTICLE_CODE,'''')<>'''' and  Y_ATTR1_KEY_CODE is not null' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
 
		 
		 
	IF @CODING=1
       BEGIN
		 
		 
		  SET @CSTEP=890---DELETE  ART_PARA1(ARTICLE)
		 SET @CCMD=N' DELETE A  FROM ART_PARA1 A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		 ON A.ARTICLE_CODE=B.AR_ARTICLE_CODE AND A.ARTICLE_CODE=B.AR_ARTICLE_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		  
		  
		  
		  SET @CSTEP=900 --- INSERT ART_PARA1
		  SET @CCMD=N'INSERT ART_PARA1	( LAST_UPDATE, ARTICLE_CODE, PARA1_CODE, ROW_ID, PARA1_DESC )   
		  SELECT DISTINCT GETDATE(),AR_ARTICLE_CODE,AP1_PARA1_CODE,ARTPARA_ROW_ID,ISNULL(ARTPARA_PARA1_DESC,'''')
		  		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN ART_PARA1 B(NOLOCK) ON A.AR_ARTICLE_CODE = B.ARTICLE_CODE 
		  WHERE B.ARTICLE_CODE IS NULL AND ISNULL(AP1_PARA1_CODE,'''')<>'''''  
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  SET @CSTEP=910---DELETE  ART_DET(ARTICLE)
		 SET @CCMD=N' DELETE A FROM ART_DET A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		 ON A.ARTICLE_CODE=B.AR_ARTICLE_CODE AND A.ARTICLE_CODE=B.AR_ARTICLE_CODE' 
		 PRINT @CCMD 
		 EXEC SP_EXECUTESQL @CCMD
		 
		 
		   SET @CSTEP=920 --- INSERT ART_DET
		  SET @CCMD=N'INSERT ART_DET( ARTICLE_CODE, PARA2_CODE, MRP, ROW_ID, LAST_UPDATE, WS_PRICE, 
		  COMPANY_CODE, MRP_INC_AMT, MRP2, PARA1_CODE, PARA2_RATIO, PURCHASE_PRICE, CENTER_POINT, SIZEGROUP_CODE )  
	      SELECT DISTINCT AR_ARTICLE_CODE, ADP2_PARA2_CODE, ARDET_MRP, ARDET_ROW_ID ,GETDATE(), ISNULL(ARTDET_WS_PRICE,0),
	       ''01'', 
	      ISNULL(ARTDET_MRP_INC_AMT,0), ISNULL(ARTDET_MRP2,0), ''0000000'', 
	      ISNULL(ARTDET_PARA2_RATIO,0), ISNULL(ARTDET_PURCHASE_PRICE,0), 
	      ARTDET_CENTER_POINT, ISNULL(ARTDET_SIZEGROUP_CODE,'''') 
		  		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN ART_DET B(NOLOCK) ON A.AR_ARTICLE_CODE = B.ARTICLE_CODE 
		  WHERE B.ARTICLE_CODE IS NULL AND ISNULL(ADP2_PARA2_CODE ,'''')<>''''' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		   SET @CSTEP=930---DELETE  ART_BOM(ARTICLE)
		   SET @CCMD=N' DELETE A FROM ART_BOM A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		   ON A.ARTICLE_CODE=B.AR_ARTICLE_CODE 
		   WHERE ISNULL(AB_BOM_ARTICLE_CODE,'''')<>'''' ' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		 
		 
		  SET @CSTEP=940 --- INSERT ART_BOM
		  SET @CCMD=N'INSERT ART_BOM( ARTICLE_CODE, BOM_ARTICLE_CODE, AVG_QTY, ROW_ID, LAST_UPDATE, COMPANY_CODE, 
		  RATE, BOM_PARA1_CODE, USES, BOM_PARA2_CODE, ADD_AVG_QTY )  
	      SELECT DISTINCT AR_ARTICLE_CODE, AB_BOM_ARTICLE_CODE,AB_AVG_QTY,AB_ROW_ID,GETDATE(),AB_COMPANY_CODE,
	      AB_RATE,AB1_PARA1_CODE,ISNULL(AB_USES,''''),AB2_PARA2_CODE,AB_ADD_AVG_QTY
          FROM '+@LOCCTEMPTABLE+' A(NOLOCK) 
          LEFT JOIN ART_BOM B(NOLOCK) ON A.AR_ARTICLE_CODE = B.ARTICLE_CODE 
          JOIN ARTICLE C(NOLOCK) ON C.ARTICLE_CODE=AB_BOM_ARTICLE_CODE
		  WHERE B.ARTICLE_CODE IS NULL AND ISNULL(AR_ARTICLE_CODE ,'''')<>'''' AND ISNULL(AB_BOM_ARTICLE_CODE,'''')<>''''' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
		  
		  SET @CSTEP=950---DELETE  ART_JOBS
		   SET @CCMD=N' DELETE A FROM ART_JOBS A JOIN '+@LOCCTEMPTABLE+' B(NOLOCK)
		   ON A.ARTICLE_CODE=B.AR_ARTICLE_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		 
		 
		  SET @CSTEP=960 --- INSERT ART_JOBS
		  SET @CCMD=N'INSERT ART_JOBS( JOB_REMARKS, ROW_ID, LAST_UPDATE, COMPANY_CODE, JOB_CODE, JOB_RATE, 
		  DAYS, HOURS, DEFAULT_BASIS, JOB_RATE_PCS,JOB_RATE_DAYS,JOB_RATE_HOURS ,ARTICLE_CODE,JOB_ORDER)  
	      SELECT DISTINCT AJ_JOB_REMARKS, AJ_ROW_ID,GETDATE(),AJ_COMPANY_CODE,JO_JOB_CODE,AJ_JOB_RATE,
	      AJ_DAYS,AJ_HOURS,AJ_DEFAULT_BASIS,AJ_JOB_RATE_PCS,AJ_JOB_RATE_DAYS,AJ_JOB_RATE_HOURS,
	      AR_ARTICLE_CODE,AJ_JOB_ORDER
          FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN ART_JOBS B(NOLOCK) ON A.AR_ARTICLE_CODE = B.ARTICLE_CODE 
		  WHERE B.ARTICLE_CODE IS NULL AND ISNULL(AR_ARTICLE_CODE ,'''')<>'''' AND ISNULL(JO_JOB_CODE,'''')<>''''' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
	END	  
		  
		   UPDATE  REP_DET  SET COL_EXPR = B.COLUMN_NAME FROM REP_DET A
		JOIN CONFIG_ATTR B ON A.COL_EXPR= B.TABLE_CAPTION 
		WHERE A.TABLE_NAME= 'ATTR_VALUE' 


		UPDATE  REP_FILTER_DET  SET CATTR = B.COLUMN_NAME FROM REP_FILTER_DET A
		JOIN CONFIG_ATTR B ON A.CATTR= B.TABLE_CAPTION 


		UPDATE  REP_FILTER  SET CATTR = B.COLUMN_NAME FROM REP_FILTER_DET A
		JOIN CONFIG_ATTR B ON A.CATTR= B.TABLE_CAPTION 


		UPDATE  REP_DET  SET COL_EXPR = B.COLUMN_NAME FROM REP_DET A
		JOIN CONFIG_ATTR B ON A.COL_HEADER= B.TABLE_CAPTION 
		WHERE A.TABLE_NAME= 'ATTR_VALUE' 
          
		    
		
		  
		  
		  

     END
     IF @NMODE=3 ----- PARA1
       BEGIN
       
              SET @CSTEP=5--UPDATE PARA1
		   SET @CCMD=N' UPDATE A1 SET A1.PARA1_NAME = A2.PARA1_NAME, A1.ALIAS = A2.ALIAS,A1.INACTIVE = A2.INACTIVE
		   FROM PARA1 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA1_CODE = A2.PARA1_CODE'
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
       
       
       
			 SET @CSTEP=10 --INSERT PARA1(ART_PARA1)
		   SET @CCMD=N'INSERT PARA1( PARA1_CODE, PARA1_NAME, LAST_UPDATE, ALIAS, INACTIVE, PARA1_ORDER, PARA1_SET, REMARKS )  
		   SELECT DISTINCT A.PARA1_CODE,A.PARA1_NAME, GETDATE() ,ISNULL(A.ALIAS,''''),A.INACTIVE, 0, '''', ''''
		   FROM  '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA1 B(NOLOCK) ON A.PARA1_CODE = B.PARA1_CODE 
		   WHERE B.PARA1_CODE IS NULL'
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
	   
       END
     IF @NMODE=4  ----- PARA2
       BEGIN
       
           SET @CSTEP=10 --UPDATE PARA2
		   SET @CCMD=N' UPDATE A1 SET A1.PARA2_NAME = A2.PARA2_NAME,A1.ALIAS = A2.ALIAS,A1.INACTIVE = A2.INACTIVE,
		   A1.PARA2_ORDER = A2.PARA2_ORDER FROM PARA2 A1 WITH (ROWLOCK) 
		   JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA2_CODE = A2.PARA2_CODE' 
		   PRINT @CCMD 
		   EXEC SP_EXECUTESQL @CCMD
       
       
        SET @CSTEP=20 -- INSERT PARA2
		  SET @CCMD=N'INSERT PARA2 WITH (ROWLOCK) ( LAST_UPDATE,ALIAS,INACTIVE,PARA2_ORDER,PARA2_SET,PARA2_CODE,PARA2_NAME,REMARKS )  
		  SELECT DISTINCT GETDATE(),ISNULL(A.ALIAS,''''),A.INACTIVE,ISNULL(A.PARA2_ORDER,0),'''',
		  A.PARA2_CODE,A.PARA2_NAME,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA2 B(NOLOCK) ON A.PARA2_CODE = B.PARA2_CODE 
		  WHERE B.PARA2_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       END
     IF @NMODE=5  ----- PARA3
       BEGIN
       
          SET @CSTEP=30 --UPDATE PARA3
		  SET @CCMD=N' UPDATE A1 SET A1.PARA3_NAME = A2.PARA3_NAME,A1.ALIAS = A2.ALIAS,A1.INACTIVE = A2.INACTIVE
		  FROM PARA3 A1 WITH (ROWLOCK) 
		  JOIN '+@LOCCTEMPTABLE+' A2(NOLOCK) ON A1.PARA3_CODE = A2.PARA3_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       
		  SET @CSTEP=40 -- INSERT PARA3
		  SET @CCMD=N'INSERT PARA3(PARA3_CODE, PARA3_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)
		  SELECT DISTINCT A.PARA3_CODE, A.PARA3_NAME, GETDATE() AS LAST_UPDATE,ISNULL(A.ALIAS,''''),A.INACTIVE, ''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA3 B(NOLOCK) ON A.PARA3_CODE = B.PARA3_CODE WHERE B.PARA3_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       END
     IF @NMODE=6 ----- PARA4
       BEGIN
       
        SET @CSTEP=50 --UPDATE PARA4
		  SET @CCMD=N' UPDATE A1 SET A1.PARA4_NAME = A2.PARA4_NAME, A1.ALIAS = A2.ALIAS, 
		  A1.INACTIVE = A2.INACTIVE
		  FROM PARA4 A1 WITH (ROWLOCK)JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA4_CODE = A2.PARA4_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
       
        SET @CSTEP=60 -- INSERT PARA4
		  SET @CCMD=N' INSERT PARA4( PARA4_CODE, PARA4_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS) 
		  SELECT DISTINCT A.PARA4_CODE,A.PARA4_NAME, GETDATE(),ISNULL(A.ALIAS,''''), A.INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA4 B(NOLOCK) ON A.PARA4_CODE = B.PARA4_CODE 
		  WHERE B.PARA4_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD

       END
     IF @NMODE=7 ----- PARA5
       BEGIN
       
         SET @CSTEP=70 --UPDATE PARA5
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA5_NAME = A2.PARA5_NAME,A1.ALIAS = A2.ALIAS,A1.INACTIVE = A2.INACTIVE
		  FROM PARA5 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA5_CODE = A2.PARA5_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
		  
       
           SET @CSTEP=80 -- INSERT PARA5
		  SET @CCMD=N' INSERT PARA5( ALIAS, INACTIVE, PARA5_CODE, PARA5_NAME, LAST_UPDATE, REMARKS)
		  SELECT DISTINCT ISNULL(A.ALIAS,''''),A.INACTIVE,A.PARA5_CODE,A.PARA5_NAME, GETDATE() ,''''
   		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA5 B(NOLOCK) ON A.PARA5_CODE = B.PARA5_CODE 
   		  WHERE B.PARA5_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       END
     IF @NMODE=8 ----- PARA6
       BEGIN
       
          SET @CSTEP=90 --UPDATE PARA6
		  SET @CCMD=N' UPDATE A1
		  SET A1.PARA6_NAME = A2.PARA6_NAME,A1.ALIAS = A2.ALIAS,A1.INACTIVE = A2.INACTIVE
		  FROM PARA6 A1 WITH (ROWLOCK) JOIN '+@LOCCTEMPTABLE+' A2 (NOLOCK) ON A1.PARA6_CODE = A2.PARA6_CODE' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
       
           
		  SET @CSTEP=100 --- INSERT PARA6
		  SET @CCMD=N'INSERT PARA6( PARA6_CODE, PARA6_NAME, LAST_UPDATE, ALIAS, INACTIVE, REMARKS)  
		  SELECT DISTINCT A.PARA6_CODE, A.PARA6_NAME, GETDATE(),ISNULL(A.ALIAS,''''),A.INACTIVE,''''
		  FROM '+@LOCCTEMPTABLE+' A(NOLOCK) LEFT JOIN PARA6 B(NOLOCK) ON A.PARA6_CODE = B.PARA6_CODE 
		  WHERE B.PARA6_CODE IS NULL' 
		  PRINT @CCMD 
		  EXEC SP_EXECUTESQL @CCMD
	
       END
          
          
   
END TRY  
	BEGIN CATCH  
		SET @CERRMSG='P: SP3S_UPDATE_MASTERS, STEP: '+CAST(@CSTEP AS VARCHAR(5))+', MESSAGE: ' + ERROR_MESSAGE()
		GOTO END_PROC  
	END CATCH   

END_PROC:  
	IF  ISNULL(@CERRMSG,'')<>'' 
		SELECT ISNULL(@CERRMSG,'') AS ERRMSG
	ELSE 
	   BEGIN
	         IF @NMODE=1
	         BEGIN
				 SET @CCMD=N'INSERT INTO MASTERDATA 
				 SELECT DISTINCT PRODUCT_CODE FROM '+@LOCCTEMPTABLE+' A 
				 LEFT JOIN MASTERDATA B ON A.PRODUCT_CODE=B.CODE
				 WHERE B.CODE IS NULL'
				 PRINT @CCMD
				 EXEC SP_EXECUTESQL @CCMD
	         END
	         
	         IF @NMODE=9
	         BEGIN
				 SET @CCMD=N'INSERT INTO ARTICLEMASTERDATA 
				 SELECT DISTINCT AR_ARTICLE_CODE FROM '+@LOCCTEMPTABLE+' A 
				 LEFT JOIN ARTICLEMASTERDATA B ON A.AR_ARTICLE_CODE=B.CODE
				 WHERE B.CODE IS NULL'
				 PRINT @CCMD
				 EXEC SP_EXECUTESQL @CCMD
	         END
	         
           	SELECT '' AS ERRMSG

	   END
END

---END OF PROCEDURE - SP3S_PREPARE_FINAL_UPDATE

