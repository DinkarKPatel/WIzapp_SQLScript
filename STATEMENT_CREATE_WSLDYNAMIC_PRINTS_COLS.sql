DECLARE  @dtLocal TABLE(XN_TYPE	varchar(10),COLUMN_NAME	nvarchar(MAX),DISPLAY_COLUMN_NAME	nvarchar(200),SELECTED	bit	,MODULE_NAME	varchar(100),GROUP_NAME VARCHAR(50))

INSERT INTO @dtLocal VALUES('WSL','LEFT(SN.PRODUCT_CODE, ISNULL(NULLIF(CHARINDEX (''@'',SN.PRODUCT_CODE)-1,-1),LEN(SN.PRODUCT_CODE )))','PRODUCT_CODE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ARTICLE_NAME','ARTICLE_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','sn.uom','UOM_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SUB_SECTION_NAME','SUB_SECTION_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SECTION_NAME','SECTION_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.XN_VALUE_WITHOUT_GST','TAXABLE_VALUE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.IGST_AMOUNT','IGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.CGST_AMOUNT','CGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.SGST_AMOUNT','SGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.XN_VALUE_WITH_GST','TOTAL_VALUE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.QUANTITY*IND01106.RATE','AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','CAST((IND01106.DISCOUNT_AMOUNT+ CASE WHEN inm.SUBTOTAL>0 THEN ((inm.DISCOUNT_AMOUNT/inm.SUBTOTAL)*IND01106.NET_RATE*IND01106.INVOICE_QUANTITY) ELSE 0 END )   AS NUMERIC(12,2))','DISCOUNT_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','case when (CAST((IND01106.QUANTITY*IND01106.RATE) AS NUMERIC(12,2)))=0 then 0 
  else Cast( ROUND((CAST((IND01106.DISCOUNT_AMOUNT+ CASE WHEN inm.SUBTOTAL>0 THEN ((inm.DISCOUNT_AMOUNT/inm.SUBTOTAL)*IND01106.NET_RATE*IND01106.INVOICE_QUANTITY) ELSE 0 END )   AS NUMERIC(12,2)))/(CAST((IND01106.QUANTITY*IND01106.RATE) AS NUMERIC(12,2)))*100.0,2)  As numeric(18,2)) end '
,'Less_discount',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')


INSERT INTO @dtLocal VALUES('WSL','IND01106.RATE','RATE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BN.AC_NAME','BROKER_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.REMARKS','ITEM_LEVEL_REMARKS',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.HSN_CODE','HSN_CODE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.RATE','RATE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.MRP','MRP',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','SN.ATTR1_KEY_NAME','ATTRIBUTE1_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR2_KEY_NAME','ATTRIBUTE2_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR3_KEY_NAME','ATTRIBUTE3_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR4_KEY_NAME','ATTRIBUTE4_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR5_KEY_NAME','ATTRIBUTE5_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR6_KEY_NAME','ATTRIBUTE6_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR7_KEY_NAME','ATTRIBUTE7_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR8_KEY_NAME','ATTRIBUTE8_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR9_KEY_NAME','ATTRIBUTE9_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR10_KEY_NAME','ATTRIBUTE10_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR11_KEY_NAME','ATTRIBUTE11_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR12_KEY_NAME','ATTRIBUTE12_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR13_KEY_NAME','ATTRIBUTE13_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR14_KEY_NAME','ATTRIBUTE14_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR15_KEY_NAME','ATTRIBUTE15_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR16_KEY_NAME','ATTRIBUTE16_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR17_KEY_NAME','ATTRIBUTE17_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR18_KEY_NAME','ATTRIBUTE18_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR19_KEY_NAME','ATTRIBUTE19_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR20_KEY_NAME','ATTRIBUTE20_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR21_KEY_NAME','ATTRIBUTE21_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR22_KEY_NAME','ATTRIBUTE22_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR23_KEY_NAME','ATTRIBUTE23_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR24_KEY_NAME','ATTRIBUTE24_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ATTR25_KEY_NAME','ATTRIBUTE25_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.gst_percentage','GST_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','IND01106.QUANTITY','QUANTITY',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.DISCOUNT_PERCENTAGE','ITEM_DISCOUNT_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.DISCOUNT_AMOUNT','ITEM_DISCOUNT_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.para2_order','PARA2_ORDER',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','sn.para2_set','PARA2_SET',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.BOX_NO','BOX_NO',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA1_NAME','PARA1_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA2_NAME','PARA2_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA3_NAME','PARA3_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA4_NAME','PARA4_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA5_NAME','PARA5_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.PARA6_NAME','PARA6_NAME',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.ARTICLE_NO','ARTICLE_NO',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.SN_ARTICLE_PACK_SIZE','SN_ARTICLE_PACK_SIZE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','SN.WS_price','WS_price',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','INM.CANCELLED','CANCELLED',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.inv_time','inv_time',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.CREDIT_DAYS','CREDIT_DAYS',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.broker_comm_percentage','broker_comm_percentage',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.broker_comm_amount','broker_comm_amount',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')


INSERT INTO @DTLOCAL VALUES('WSL','CASE 
WHEN  isnull(Tl.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  INM.INV_NO
WHEN isnull(INM.XN_ITEM_TYPE,0)<>5 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(inm.EINV_IRN_NO,'''')='''' AND  inm.inv_dt>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,''''))  THEN ''*****''+RIGHT(inm.inv_no,5)
ELSE CASE WHEN  LEFT(RTRIM(LTRIM(INM.INV_NO)),1)=''0'' AND ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND inm.inv_dt>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''')  ) 
THEN  ISNULL((SELECT VALUE  FROM CONFIG WHERE CONFIG_OPTION =''EINVOICE_PREFIX''),'''') ELSE '''' END  ' +'+inm.inv_no  END'  ,'INVOICE_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL',' CASE WHEN  isnull(Tl.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  INM.INV_DT
WHEN  isnull(INM.XN_ITEM_TYPE,0)<>5 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' and  ISNULL(SL.ENABLE_EINVOICE,0)=1 AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(inm.EINV_IRN_NO,'''')='''' AND  inm.inv_dt>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,''''))  THEN '''' else INM.INV_DT end ','INVOICE_DATE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')


INSERT INTO @dtLocal VALUES('WSL','INM.TOTAL_BOX_NO','TOTAL_BOX_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.TOTAL_PACKSLIP_NO','TOTAL_PACKSLIP_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.ROUND_OFF','ROUND_OFF',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @DTLOCAL VALUES('WSL','INM.INV_MODE','INV_MODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','HLDS.MEMO_NO','MEMO_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','HLDS.MEMO_DT','MEMO_DT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','HLDS.DELIVERY_DT','DELIVERY_DT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @DTLOCAL VALUES('WSL','USERS.USERNAME','USERNAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS0  ELSE INM.SHIPPING_ADDRESS END
					ELSE PRLMP.ADDRESS0 END','SHIPPING_ADDRESS',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
					
					
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS1  ELSE INM.SHIPPING_ADDRESS2 END
					ELSE PRLMP.ADDRESS1 END','SHIPPING_ADDRESS2',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.ADDRESS2  ELSE INM.SHIPPING_ADDRESS3 END
					ELSE PRLMP.ADDRESS2 END','SHIPPING_ADDRESS3',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHAR.AREA_NAME  ELSE INM.SHIPPING_AREA_NAME END
					ELSE PRA.AREA_NAME END','SHIPPING_AREA_NAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHCT.CITY   ELSE INM.SHIPPING_CITY_NAME  END
					ELSE PRC.CITY END','SHIPPING_CITY_NAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN shCS.gst_state_name   ELSE INM.SHIPPING_STATE_NAME  END
					ELSE PRS.gst_state_name END','SHIPPING_STATE_NAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHAR.pincode   ELSE INM.shipping_pin  END
					ELSE PRA.pincode END','SHIPPING_PIN',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
					

INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.registered_gst_dealer  ELSE SHLMP.registered_gst_dealer  END
					ELSE PRLMP.registered_gst_dealer END','SHIPPING_registered_gst_dealer',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.pan_no  ELSE SHLMP.pan_no END
					ELSE PRLMP.pan_no END','SHIPPING_PAN_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.party_erp_code  ELSE SHLMP.party_erp_code END
					ELSE PRLMP.party_erp_code END','SHIPPING_PARTY_ERP_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
																	
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.LMP_MSME  ELSE SHLMP.LMP_MSME END
					ELSE PRLMP.LMP_MSME END','SHIPPING_LMP_MSME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')	
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.LMP_MSME_NO  ELSE SHLMP.LMP_MSME_NO END
					ELSE PRLMP.LMP_MSME_NO END','SHIPPING_LMP_MSME_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')	

INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.E_MAIL  ELSE SHLMP.E_MAIL END
					ELSE PRLMP.E_MAIL END','SHIPPING_EMAIL',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')	
					
INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.E_MAIL_CC  ELSE SHLMP.E_MAIL_CC END
					ELSE PRLMP.E_MAIL_CC END','SHIPPING_EMAIL_CC',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')	


INSERT INTO @dtLocal VALUES('WSL','INM.REMARKS','BILL_LEVEL_REMARKS',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.MANUAL_INV_NO','MANNUAL_REF_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance','INSURANCE_CHARGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.FREIGHT','FREIGHT_CHARGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.PACKING','PACKING_CHARGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.OTHER_CHARGES','OTHER_CHARGES',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','CASE  
        WHEN  isnull(INM.XN_ITEM_TYPE,0)=5 THEN ''REPAIR CHALLAN''
        WHEN  isnull(Tl.SOR_LOC,0)=1 and  isnull((SELECT TOP 1 VALUE FROM CONFIG WHERE CONFIG_OPTION =''DONOT_CALCULATE_GST_FOR_SOR_LOCATION''),'''')=''1'' THEN  ''Sale on Approval''
		WHEN  isnull(INM.party_state_code,0)=''96'' THEN ''EXPORT INVOICE''
        WHEN  ISNULL(SL.ENABLE_EINVOICE,0)=1 and isnull(tmp.GSTINVOICE_WITHOUT_STARS,'''')<>''1'' AND ISNULL(PRLMP.Ac_gst_no,'''')<>'''' AND ISNULL(PRLMP.Ac_gst_no,'''')<> ISNULL(SL.LOC_GST_NO,'''') AND ISNULL(inm.EINV_IRN_NO,'''')='''' AND  inm.inv_dt>=(ISNULL(SL.EINVOICE_CUTOFF_DATE,'''') ) THEN ''SAMPLE INVOICE''
        WHEN ISNULL(SL.REGISTERED_GST,0)=0 THEN ''BILL OF SUPPLY''                          
        WHEN SL.REGISTERED_GST=2 THEN ''BILL OF SUPPLY''
        WHEN SL.REGISTERED_GST=1 AND SL.LOC_GST_NO=TMP.LMV1AC_GST_NO   THEN ''DELIVERY CHALLAN''                       
        WHEN SL.REGISTERED_GST=1 AND SL.LOC_GST_NO!=TMP.LMV1AC_GST_NO   THEN ''TAX INVOICE''         
        WHEN SL.loc_type=2  OR (SL.LOC_GST_NO!=PRLMP.AC_GST_NO AND ISNULL(TMP.LMV1AC_GST_NO,'''')=ISNULL(TMP.LMV1AC_GST_NO,''''))  THEN ''TAX INVOICE'' 
        WHEN INM.INV_MODE=2 AND SL.LOC_GST_NO=PRLMP.AC_GST_NO THEN ''DELIVERY CHALLAN'' ELSE '''' END','INVOICE_TYPE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.other_charges_gst_percentage','OTHER_CHARGES_GST_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.other_charges_hsn_code','OTHER_CHARGES_HSN_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.other_charges_igst_amount','OTHER_CHARGES_IGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.other_charges_cgst_amount','OTHER_CHARGES_CGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.other_charges_sgst_amount','OTHER_CHARGES_SGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.freight_gst_percentage','FREIGHT_GST_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.freight_hsn_code','FREIGHT_HSN_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.freight_igst_amount','FREIGHT_IGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.freight_cgst_amount','FREIGHT_CGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.freight_sgst_amount','FREIGHT_SGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance_gst_percentage','INSURANCE_GST_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance_hsn_code','INSURANCE_HSN_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance_igst_amount','INSURANCE_IGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance_cgst_amount','INSURANCE_CGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.insurance_sgst_amount','INSURANCE_SGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.packing_gst_percentage','PACKING_GST_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.packing_hsn_code','PACKING_HSN_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.packing_igst_amount','PACKING_IGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.packing_cgst_amount','PACKING_CGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.packing_sgst_amount','PACKING_SGST_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.BUYER_ORDER_NO','BUYER_ORDER_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')     
INSERT INTO @dtLocal VALUES('WSL','INM.NET_AMOUNT','NET_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')  
INSERT INTO @dtLocal VALUES('WSL','INM.DISCOUNT_PERCENTAGE','BILL_DISCOUNT_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS') 
INSERT INTO @dtLocal VALUES('WSL','INM.DISCOUNT_AMOUNT','BILL_DISCOUNT_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS') 
INSERT INTO @dtLocal VALUES('WSL','INM.route_form1','ROUTE_FORM1',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.route_form2','ROUTE_FORM2',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.octroi_percentage','OCTROI_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.DISCOUNT_PERCENTAGE_1','DISCOUNT_PERCENTAGE_1',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.DISCOUNT_PERCENTAGE_2','DISCOUNT_PERCENTAGE_2',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','SL.DEPT_ID','SOURCE_LOCATION__ID',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.DEPT_NAME','SOURCE_LOCATION_NAME',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.address1','SOURCE_LOCATION_ADDRESS1',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.address2','SOURCE_LOCATION_ADDRESS2',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.REGISTERED_ADD','SOURCE_LOCATION_REGISTERED_ADDRESS',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.TIN_NO','SOURCE_LOCATION_TIN',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.loc_gst_no','SOURCE_LOCATION_GST_NO',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','ISNULL(LEFT(SL.loc_gst_no,2),'''')','SOURCE_LOCATION_STATE_CODE',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.PARTY_CODE','SOURCE_LOCATION_PARTY_CODE',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.DEPT_ALIAS','SOURCE_LOCATION_DEPT_ALIAS',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')

INSERT INTO @dtLocal VALUES('WSL','SLA.AREA_NAME','SOURCE_LOCATION_AREA',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SLA.PINCODE','SOURCE_LOCATION_PIN',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SLC.CITY','SOURCE_LOCATION_CITY',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SLS.GST_STATE_NAME','SOURCE_LOCATION_STATE_NAME',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SLR.region_name','SOURCE_LOCATION_COUNTRY_NAME',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.PHONE','SOURCE_LOCATION_PHONE',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','SL.CONTACT_NO','SOURCE_LOCATION_CONTACT_NO',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.DEPT_ID','TARGET_LOCATION__ID',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.DEPT_NAME','TARGET_LOCATION_NAME',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.address1','TARGET_LOCATION_ADDRESS1',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.address2','TARGET_LOCATION_ADDRESS2',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.REGISTERED_ADD','TARGET_LOCATION_REGISTERED_ADDRESS',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.TIN_NO','TARGET_LOCATION_TIN',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.loc_gst_no','TARGET_LOCATION_GST_NO',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.PARTY_CODE','TARGET_LOCATION_PARTY_CODE',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.DEPT_ALIAS','TARGET_LOCATION_DEPT_ALIAS',0,'WHOLESALE_INVOICE','TARGET_LOCATION')

INSERT INTO @dtLocal VALUES('WSL','ISNULL(LEFT(TL.loc_gst_no,2),'''')','TARGET_LOCATION_STATE_CODE',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TLA.AREA_NAME','TARGET_LOCATION_AREA',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TLC.CITY','TARGET_LOCATION_CITY',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TLS.GST_STATE_NAME','TARGET_LOCATION_STATE_NAME',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TLR.region_name','TARGET_LOCATION_COUNTRY_NAME',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.PHONE','TARGET_LOCATION_PHONE',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','TL.CONTACT_NO','TARGET_LOCATION_CONTACT_NO',0,'WHOLESALE_INVOICE','TARGET_LOCATION')
INSERT INTO @dtLocal VALUES('WSL','CMP.COMPANY_NAME','COMPANY_NAME',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.ADDRESS1','COMPANY_ADDRESS1',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.ADDRESS2','COMPANY_ADDRESS2',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.CITY','COMPANY_CITY',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.[STATE]','COMPANY_STATE',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.COUNTRY','COMPANY_COUNTRY',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.GST_NO','COMPANY_GST_NO',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.CIN','COMPANY_CIN',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.PAN_NO','COMPANY_PAN_NO',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.PIN','COMPANY_PIN',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.EMAIL_ID','COMPANY_EMAIL_ID',0,'WHOLESALE_INVOICE','COMPANY')
INSERT INTO @dtLocal VALUES('WSL','CMP.WEB_ADDRESS','COMPANY_WEBSITE',0,'WHOLESALE_INVOICE','COMPANY')

INSERT INTO @dtLocal VALUES('WSL','PRLM.AC_NAME','PARTY_NAME',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLM.ALIAS','PARTY_ALIAS',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLM.LM_REMARKS','LM_REMARKS',0,'WHOLESALE_INVOICE','PARTY')



INSERT INTO @dtLocal VALUES('WSL','PRLMP.AC_GST_NO','PARTY_GST_NO',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.ADDRESS0','PARTY_ADDRESS1',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.ADDRESS1','PARTY_ADDRESS2',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.ADDRESS2','PARTY_ADDRESS3',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.TIN_NO','PARTY_TIN_NO',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.CST_NO','PARTY_CST_NO',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.CST_NO','PARTY_CST_NO',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','(CASE WHEN PRLMP.FREIGHTPAIDBY =2 THEN '' PAIDBY PARTY'' ELSE ''PAIDBY COMPANY'' END)','freightPaidBy',0,'WHOLESALE_INVOICE','PARTY')


INSERT INTO @dtLocal VALUES('WSL','PRLMP.registered_gst_dealer','registered_gst_dealer',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.pan_no','Party_pan_no',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.party_erp_code','party_erp_code',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.LMP_MSME','LMP_MSME',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.LMP_MSME_NO','LMP_MSME_NO',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.E_MAIL','Party_Email',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.E_MAIL_CC','Party_Email_CC',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.EXPORT_GST_PERCENTAGE_APPLICABLE','EXPORT_GST_PERCENTAGE_APPLICABLE',0,'WHOLESALE_INVOICE','PARTY')


INSERT INTO @dtLocal VALUES('WSL','PRA.AREA_NAME','PARTY_AREA',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRC.city','PARTY_CITY',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRS.GST_STATE_NAME','PARTY_STATE_NAME',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRS.GST_STATE_CODE','PARTY_STATE_CODE',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRR.region_name','PARTY_COUNTRY',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','SHP.UT','UT_STATUS',0,'WHOLESALE_INVOICE','PARTY')

INSERT INTO @dtLocal VALUES('WSL','TR.DISP_WEIGHT','DISP_WEIGHT',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.DISP_BOX_NO','DISP_BOX_NO',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.TRANSPORTER_NAME','TRANSPORTER_NAME',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.BILTY_NO','BILTY_NO',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.BILTY_DATE','BILTY_DATE',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.VEHICLE_NO','VEHICLE_NO',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.Driver_name','Driver_name',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.cash_receipt_no','Prcl_Receipt_no',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.gate_entry_no','Prcl_ref_no',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.Transporter_Email','Transporter_Email',0,'WHOLESALE_INVOICE','TRANSPORT')

INSERT INTO @dtLocal VALUES('WSL','TR.Transporter_Mobile','Transporter_Mobile',0,'WHOLESALE_INVOICE','TRANSPORT')
INSERT INTO @dtLocal VALUES('WSL','TR.Transporter_GstNo','Transporter_GstNo',0,'WHOLESALE_INVOICE','TRANSPORT')


INSERT INTO @dtLocal VALUES('WSL','SN.barcode_img_id','PROD_IMAGE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')


INSERT INTO @dtLocal VALUES('WSL','PRA.PINCODE','PARTY_PIN',0,'WHOLESALE_INVOICE','PARTY')
INSERT INTO @dtLocal VALUES('WSL','PRLMP.MOBILE','PARTY_MOBILE',0,'WHOLESALE_INVOICE','PARTY')


INSERT INTO @dtLocal VALUES('WSL','EMPLOYEE.EMP_NAME','SALEPERSON1',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','EMPLOYEE1.EMP_NAME','SALEPERSON2',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','EMPLOYEE2.EMP_NAME','SALEPERSON3',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')


--FOR TAX INVOICE BEFORE GST
INSERT INTO @dtLocal VALUES('WSL','ind01106.ITEM_TAX_PERCENTAGE','VAT_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','ind01106.item_tax_amount','VAT_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','ind01106.NET_RATE','NET_RATE',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','INM.TOTAL_GST_CESS_AMOUNT','TOTAL_GST_CESS_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','IND01106.GST_Cess_AMount','GST_Cess_AMount',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','IND01106.GST_Cess_Percentage','GST_Cess_Percentage',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','inm.Tcs_Amount','Tcs_Amount',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','inm.Tcs_Percentage','Tcs_Percentage',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','inm.INV_NO','BOX_INVOICE_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','inm.INV_DT','BOX_INVOICE_DATE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','inm.SUPPLY_TYPE_CODE','SUPPLY_TYPE_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')



INSERT INTO @dtLocal VALUES('WSL','INM.ACH_NO','ACH_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.ACH_DT','ACH_DT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.IRN_QR_CODE','IRN_QR_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.EINV_IRN_NO','EINV_IRN_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLM.AC_NAME  ELSE SHLM.AC_NAME END
					ELSE PRLM.AC_NAME END','SHIPPING_AcName',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')


INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.PRINT_NAME  ELSE SHLMP.PRINT_NAME END
					ELSE PRLMP.PRINT_NAME END','SHIPPING_PRINT_NAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')



INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN shCS.gst_state_code   ELSE SHP.GST_STATE_CODE END
					ELSE PRS.gst_state_code END','SHIPPING_STATE_CODE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','CASE WHEN ISNULL(SHIPPING_SAME_AS_BILLING_ADD,0) =0 
		            THEN CASE WHEN ISNULL(SHIPPING_MODE,0)=0 THEN SHLMP.AC_GST_NO   ELSE SHLMP.AC_GST_NO END
					ELSE PRLMP.AC_GST_NO END','SHIPPING_GST_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','SN.FIX_MRP','FIX_MRP',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','INM.AUTO_EWAYBILL_NO','AUTO_EWAYBILL_NO',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.AUTO_EWAYBILL_DT','AUTO_EWAYBILL_DT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.BROKER_COMM_PERCENTAGE','BROKER_COMM_PERCENTAGE',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')
INSERT INTO @dtLocal VALUES('WSL','INM.BROKER_COMM_AMOUNT','BROKER_COMM_AMOUNT',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_1','TNC_1',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_2','TNC_2',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_3','TNC_3',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_4','TNC_4',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_5','TNC_5',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_6','TNC_6',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_7','TNC_7',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','GST_TNC.TNC_8','TNC_8',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @dtLocal VALUES('WSL','SizeQtyString','SizeQtyString',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','TMPBOX.boxDetails','boxDetails',0,'WHOLESALE_INVOICE','INVOICE_DETAILS')

INSERT INTO @DTLOCAL VALUES('WSL','SL.DEPT_PRINT_NAME','LOCATION_PRINT_NAME',0,'WHOLESALE_INVOICE','SOURCE_LOCATION')
INSERT INTO @DTLOCAL VALUES('WSL','PRLMP.PRINT_NAME','LEDGER_PRINT_NAME',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')

INSERT INTO @DTLOCAL VALUES('WSL',' isnull(inm.SUPPLY_TYPE_CODE,''B2B'') ','Transaction_type',0,'WHOLESALE_INVOICE','INVOICE_MASTERS')


INSERT INTO @dtLocal VALUES('WSL','ISNULL(BOD.FROM_UOM_NAME,'''')+''-''+ISNULL(BOD.TO_UOM_NAME,'''') ','AREA_UOM_NAME',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BOD.area_length','area_length',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BOD.area_width','area_width',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BOD.area_sqare','area_sqare',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BOD.area_rate_pp','area_rate_pp',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')
INSERT INTO @dtLocal VALUES('WSL','BOD.RATE_AREA_SQUARE','RATE_AREA_SQUARE',0,'WHOLESALE_INVOICE','WSLORDER_DETAILS')




UPDATE B SET SELECTED=A.SELECTED FROM   DYNAMIC_PRINT_COLS A
JOIN @DTLOCAL B ON A.DISPLAY_COLUMN_NAME=B.DISPLAY_COLUMN_NAME and a.MODULE_NAME =b.MODULE_NAME 
WHERE  A.SELECTED<>B.SELECTED
AND A.SELECTED=1

DELETE a
FROM DYNAMIC_PRINT_COLS a
LEFT OUTER JOIN @dtLocal b ON b.COLUMN_NAME=a.COLUMN_NAME AND A.DISPLAY_COLUMN_NAME =B.DISPLAY_COLUMN_NAME 
WHERE b.COLUMN_NAME IS NULL AND a.MODULE_NAME= 'WHOLESALE_INVOICE'

INSERT INTO DYNAMIC_PRINT_COLS(XN_TYPE,COLUMN_NAME,DISPLAY_COLUMN_NAME,SELECTED,MODULE_NAME,GROUP_NAME)
SELECT a.XN_TYPE,a.COLUMN_NAME,a.DISPLAY_COLUMN_NAME,a.SELECTED,a.MODULE_NAME,A.GROUP_NAME 
FROM @dtLocal a
LEFT OUTER JOIN DYNAMIC_PRINT_COLS b (NOLOCK) ON b.COLUMN_NAME=a.COLUMN_NAME AND b.XN_TYPE ='WSL'
WHERE b.COLUMN_NAME IS NULL

--REMOVE DUPLICATE RECORDS
;WITH CTE AS
(
SELECT * ,SR=ROW_NUMBER () OVER (PARTITION BY XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME
ORDER BY  XN_TYPE,COLUMN_NAME ,DISPLAY_COLUMN_NAME,SELECTED)
FROM  DYNAMIC_PRINT_COLS	
 WHERE LTRIM(RTRIM(XN_TYPE))='WSL'
)

DELETE  FROM CTE WHERE SR>1



