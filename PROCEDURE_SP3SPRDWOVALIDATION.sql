CREATE PROCEDURE [DBO].[SP3SPRDWOVALIDATION]
@ARTICLECODE VARCHAR(100),
@REFWOID VARCHAR(100)

AS
BEGIN

SELECT DISTINCT VALIDATIONS FROM
(

SELECT COUNT(*) AS VALIDATIONS FROM PRD_STK_TRANSFER_DET 

AS PSTD INNER JOIN PRD_SKU AS PS 
ON PSTD.PRODUCT_UID=PS.PRODUCT_UID 
WHERE PS.ARTICLE_CODE=@ARTICLECODE  
AND REF_WO_ID=@REFWOID

UNION ALL 

SELECT COUNT(*) AS VALIDATIONS FROM PRD_STK_TRANSFER_DET_PENDING AS PSTD INNER JOIN PRD_SKU AS PS 
ON PSTD.PRODUCT_UID=PS.PRODUCT_UID 
WHERE PS.ARTICLE_CODE=@ARTICLECODE
AND REF_WO_ID=@REFWOID
) AS SUB WHERE VALIDATIONS >0

END
