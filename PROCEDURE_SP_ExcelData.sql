CREATE PROCEDURE SP_EXCELDATA  
(
	@XNTYPE VARCHAR(50),
	@CSPID VARCHAR(40)=''
)
--WITH ENCRYPTION
AS  
BEGIN  

	IF(@XNTYPE IN ('IMPORT_ACT_RECEIPT'))
    BEGIN 
		DECLARE @i INT
		SET @i=(CASE WHEN ISNULL(@CSPID,'')='' THEN  1 ELSE CAST(@CSPID AS INT)  END)
		EXEC SP_VOUCHERIMPORTDATA	@nShowAll=@i
		RETURN
	END
	
	IF(@XNTYPE IN ('SLS_INC'))
    BEGIN 
		EXEC SP3S_EXCELIMPORT_SLSINC @nMode=1
		RETURN
	END

	DECLARE @CPARA1 VARCHAR(50)  
		DECLARE @CPARA2 VARCHAR(50)  
		DECLARE @CPARA3 VARCHAR(50)  
		DECLARE @CPARA4 VARCHAR(50)  
		DECLARE @CPARA5 VARCHAR(50)  
		DECLARE @CPARA6 VARCHAR(50),@CCMD NVARCHAR(MAX)  
		DECLARE @BMBOSLS BIT /*VARIABLE TO IDENTIFY IF THE IMPORTED SALE IS FOR MBO MARKED BIN OR LOCATION*/

		SELECT @CPARA1=ISNULL(VALUE,'PARA1')   
		FROM  CONFIG  
		WHERE CONFIG_OPTION='PARA1_CAPTION'
		  
		SELECT @CPARA2=ISNULL(VALUE,'PARA2')   
		FROM CONFIG  
		WHERE  CONFIG_OPTION='PARA2_CAPTION'
		  
		SELECT @CPARA3=ISNULL(VALUE,'PARA3')   
		FROM CONFIG  
		WHERE  CONFIG_OPTION='PARA3_CAPTION'
		  
		SELECT @CPARA4=ISNULL(VALUE,'PARA4')   
		FROM CONFIG  
		WHERE  CONFIG_OPTION='PARA4_CAPTION'
		  
		SELECT @CPARA5=ISNULL(VALUE,'PARA5')   
		FROM CONFIG  
		WHERE  CONFIG_OPTION='PARA5_CAPTION'
		  
		SELECT @CPARA6=ISNULL(VALUE,'PARA6')   
		FROM CONFIG  
		WHERE  CONFIG_OPTION='PARA6_CAPTION'

	
	SET @BMBOSLS=0
	---
	IF EXISTS(SELECT TOP 1 'U' FROM BIN WHERE MBO_COUNTER=1)
		SET @BMBOSLS=1

	IF(ISNULL(@XNTYPE,'')='')	
	BEGIN 
		SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		Union  All
		SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		Union  All
		SELECT 'BIN' AS MASTER_COL,'BIN_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL	
	END

	ELSE IF(ISNULL(@XNTYPE,'')='SCC')	
	BEGIN 
		SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		Union  All
		SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		Union  All
		SELECT 'BIN' AS MASTER_COL,'BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL	
	END

	ELSE IF(ISNULL(@XNTYPE,'')='MPRCL')	
	BEGIN 
		SELECT 'BILTY NO' AS MASTER_COL,'BILTY_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		Union  All
		SELECT 'FREIGHT AMOUNT' AS MASTER_COL,'Total_amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		
	END


	ELSE IF(@XNTYPE IN ('PUR'))
    BEGIN  	  
		  DECLARE @cEnableFcXns VARCHAR(2)
		  	
		  SELECT TOP 1 @cEnableFcXns=value FROM config WHERE config_option='ENABLE_MULTI_CURRENCY'
		    
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1 SET APPLICABLE' ELSE @CPARA1+' SET APPLICABLE ' END) AS MASTER_COL,'PARA1_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA2 SET APPLICABLE' ELSE @CPARA2+' SET APPLICABLE ' END) AS MASTER_COL,'PARA2_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
	      SELECT 'PURCHASE PRICE' AS MASTER_COL,'PURCHASE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'WHOLESALE PRICE' AS MASTER_COL,'WHOLESALE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'CODING SCHEME' AS MASTER_COL,'CODING_SCHEME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'UOM' AS MASTER_COL,'UOM_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'INVOICE QUANTITY' AS MASTER_COL,'INVOICE_QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'FOC QUANTITY' AS MASTER_COL,'SCHEME_QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'TAX TYPE' AS MASTER_COL,'FORM_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE DESC ' AS MASTER_COL,'ARTICLE_DESC' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL      
		  SELECT 'FIX MRP' AS MASTER_COL,'FIX_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL           
		  UNION ALL      
		  SELECT 'GENERATE EAN' AS MASTER_COL,'GEN_EAN_CODES' AS MASTER_COL_EXPR,'' AS MAPPED_COL       
		   UNION ALL      
		  SELECT 'EAN PREFIX' AS MASTER_COL,'EAN_PREFIX' AS MASTER_COL_EXPR,'' AS MAPPED_COL     
		    UNION ALL      
		  SELECT 'REPLACEABLE COLOR' AS MASTER_COL,'REPLACEABLE_COLOR' AS MASTER_COL_EXPR,'' AS MAPPED_COL       
		  UNION ALL      
		  SELECT 'ARTICLE NAME' AS MASTER_COL,'ARTICLE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'ARTICLE ALIAS' AS MASTER_COL,'ARTICLE_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'VENDOR EAN' AS MASTER_COL,'VENDOR_EAN_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL                 
		  UNION ALL      
		  SELECT 'DISC PERCENTAGE' AS MASTER_COL,'DISCOUNT_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL                 
		  UNION ALL      
		  SELECT 'PO ROW ID' AS MASTER_COL,'PO_ROW_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL                 
		  UNION ALL      
		  SELECT 'HSN CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL      
		  SELECT 'INVOICE NO' AS MASTER_COL,'INV_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  UNION ALL      
		  SELECT 'INVOICE DT' AS MASTER_COL,'INV_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL
		  SELECT 'PO REF NO' AS MASTER_COL,'REF_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL	
		  SELECT 'PO DELIVERY DT' AS MASTER_COL,'DELIVERY_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL	
		  SELECT 'SECTION ALIAS' AS MASTER_COL,'SECTION_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'SUB SECTION ALIAS' AS MASTER_COL,'SUB_SECTION_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'PO ID ' AS MASTER_COL,'PO_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1 SET NAME' ELSE @CPARA1+' SET NAME ' END) AS MASTER_COL,'P1_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA2 SET NAME' ELSE @CPARA2+' SET NAME ' END) AS MASTER_COL,'P2_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		   UNION ALL
		  SELECT 'BATCH NO' AS MASTER_COL,'BATCH_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL	
		  SELECT 'EXPIRY DATE' AS MASTER_COL,'EXPIRY_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL 
		  SELECT 'PERISHABLE' AS MASTER_COL,'PERISHABLE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
          UNION ALL    
		  SELECT TABLE_CAPTION  AS MASTER_COL,column_name AS MASTER_COL_EXPR, '' AS MAPPED_COL FROM  CONFIG_ATTR  where TABLE_CAPTION <> '' 		  
		  UNION ALL
		  SELECT fc_name  AS MASTER_COL,'FC_'+fc_code+'_mrp' AS MASTER_COL_EXPR, '' AS MAPPED_COL FROM  FC  
		  where fc_name<>'' AND ISNULL(@cEnableFcXns,'')='1' AND fc_code<>'0000000'

		  union all
		  SELECT 'FOREX PURCHASE PRICE' AS MASTER_COL,'FOREX_PURCHASE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		   union all
		  SELECT 'Forex gross purchase price' AS MASTER_COL,'Forex_gross_purchase_price' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  union all
		  SELECT 'Forex Accessiblevalue' AS MASTER_COL,'Forex_Accessiblevalue' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		    union all
		  SELECT 'Forex CustomdutyAmt' AS MASTER_COL,'Forex_CustomdutyAmt' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  
		   UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1_Alias' ELSE @CPARA1+'_Alias' END) AS MASTER_COL,'PARA1_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2_Alias' ELSE @CPARA2+'_Alias' END) AS MASTER_COL,'PARA2_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL      
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3_Alias' ELSE @CPARA3+'_Alias' END) AS MASTER_COL,'PARA3_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4_Alias' ELSE @CPARA4+'_Alias' END) AS MASTER_COL,'PARA4_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5_Alias' ELSE @CPARA5+'_Alias' END) AS MASTER_COL,'PARA5_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6_Alias' ELSE @CPARA6+'_Alias' END) AS MASTER_COL,'PARA6_Alias' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
              		  
	END  
	ELSE IF(@XNTYPE IN ('PUR_RATE'))
    BEGIN  	  
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'GROSS PURCHASE PRICE' AS MASTER_COL,'GROSS_PURCHASE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL      
		  SELECT 'DISC PERCENTAGE' AS MASTER_COL,'DISCOUNT_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL      
		  SELECT 'DISC AMOUNT' AS MASTER_COL,'DISCOUNT_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL    
		  SELECT 'FIX MRP' AS MASTER_COL,'FIX_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL     
		  UNION ALL    
		  SELECT 'WHOLESALE PRICE' AS MASTER_COL,'WHOLESALE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END
	ELSE IF @XNTYPE='ERPCHO'
	BEGIN
		DECLARE @CMASTERCOL VARCHAR(500),@CMASTERCOLEXPR VARCHAR(500),@CMASTERCOLNAME VARCHAR(500) 

	    IF CURSOR_STATUS('GLOBAL','MAPPEDCOLCUR') IN (0,1)  
		BEGIN  
		   CLOSE MAPPEDCOLCUR  
		   DEALLOCATE MAPPEDCOLCUR  
		END
		
		DECLARE MAPPEDCOLCUR CURSOR FOR SELECT MASTER_COL,MASTER_COL_EXPR,MAPPED_COL FROM ERP_CHALLAN_MAPPEDCOLS
		OPEN MAPPEDCOLCUR
		
		SET @CCMD=N''
		FETCH NEXT FROM MAPPEDCOLCUR INTO @CMASTERCOL,@CMASTERCOLEXPR,@CMASTERCOLNAME
		WHILE @@FETCH_STATUS=0
		BEGIN
			
			SET @CCMD=@CCMD+(CASE WHEN @CCMD<>'' THEN ' UNION ' ELSE '' END)+N'SELECT '''+@CMASTERCOL+''' AS MASTER_COL'+
			','''+@CMASTERCOLEXPR+''' AS MASTER_COL_EXPR,'+
			(CASE WHEN @CMASTERCOLNAME<>'' THEN @CMASTERCOLNAME ELSE '''''' END)+' AS MAPPED_COL'
			
			FETCH NEXT FROM MAPPEDCOLCUR INTO @CMASTERCOL,@CMASTERCOLEXPR,@CMASTERCOLNAME
		END
		
		CLOSE MAPPEDCOLCUR
		DEALLOCATE MAPPEDCOLCUR
		
		PRINT @CCMD
		EXEC SP_EXECUTESQL @CCMD
	END
	
	ELSE IF(@XNTYPE='OPS')
	BEGIN
		    
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1 SET APPLICABLE' ELSE @CPARA1+' SET APPLICABLE ' END) AS MASTER_COL,'PARA1_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA2 SET APPLICABLE' ELSE @CPARA2+' SET APPLICABLE ' END) AS MASTER_COL,'PARA2_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'PURCHASE PRICE' AS MASTER_COL,'PURCHASE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'WHOLESALE PRICE' AS MASTER_COL,'WHOLESALE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'CODING SCHEME' AS MASTER_COL,'CODING_SCHEME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'UOM' AS MASTER_COL,'UOM_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'INVOICE QUANTITY' AS MASTER_COL,'INVOICE_QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'FOC QUANTITY' AS MASTER_COL,'SCHEME_QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'TAX TYPE' AS MASTER_COL,'FORM_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'PRODUCT NAME' AS MASTER_COL,'PRODUCT_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL      
		  SELECT 'FIX MRP' AS MASTER_COL,'FIX_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL      
		  SELECT 'SUPPLIER' AS MASTER_COL,'AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
		  UNION ALL      
		  SELECT 'GENERATE EAN' AS MASTER_COL,'GEN_EAN_CODES' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		    UNION ALL      
		  SELECT 'EAN PREFIX' AS MASTER_COL,'EAN_PREFIX' AS MASTER_COL_EXPR,'' AS MAPPED_COL     
		    UNION ALL      
		  SELECT 'REPLACEABLE COLOR' AS MASTER_COL,'REPLACEABLE_COLOR' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  
		  UNION ALL      
		  SELECT 'ARTICLE NAME' AS MASTER_COL,'ARTICLE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  UNION ALL      
		  SELECT 'ARTICLE ALIAS' AS MASTER_COL,'ARTICLE_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'ARTICLE DESC' AS MASTER_COL,'ARTICLE_DESC' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		   UNION ALL 
		  SELECT 'ARTICLE TYPE' AS MASTER_COL,'ARTICLE_TYPE' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL 
		  SELECT 'SECTION ALIAS' AS MASTER_COL,'SECTION_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'SUB SECTION ALIAS' AS MASTER_COL,'SUB_SECTION_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'VENDOR EAN' AS MASTER_COL,'VENDOR_EAN_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL      
		  SELECT 'DISC PERCENTAGE' AS MASTER_COL,'DISCOUNT_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'IMAGE NAME' AS MASTER_COL,'IMAGE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL      
		  SELECT 'HSN CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1 SET NAME' ELSE @CPARA1+' SET NAME ' END) AS MASTER_COL,'P1_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA2 SET NAME' ELSE @CPARA2+' SET NAME ' END) AS MASTER_COL,'P2_SET' AS MASTER_COL_EXPR,'' AS MAPPED_COL   		  
          UNION ALL    
          SELECT 'DEPT ID' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL  
		  SELECT TABLE_CAPTION  AS MASTER_COL,column_name AS MASTER_COL_EXPR, '' AS MAPPED_COL FROM  CONFIG_ATTR  where TABLE_CAPTION <> '' 
		  UNION ALL
		  SELECT 'BATCH NO' AS MASTER_COL,'BATCH_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL	
		  SELECT 'EXPIRY DATE' AS MASTER_COL,'EXPIRY_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL 
		  SELECT 'PERISHABLE' AS MASTER_COL,'PERISHABLE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 		
		   UNION ALL 
		  SELECT 'SEASON NAME' AS MASTER_COL,'SEASON_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
		   UNION ALL 
		  SELECT 'PUR BILL NO' AS MASTER_COL,'PUR_BILL_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
		   UNION ALL 
		  SELECT 'PUR BILL DATE' AS MASTER_COL,'PUR_BILL_DATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
		  UNION ALL 
		  SELECT 'XN DT' AS MASTER_COL,'XN_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL 
		  SELECT 'MRP_RESTRICTION' AS MASTER_COL,'MRP_RESTRICTION' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL 
		  SELECT 'MRP_RESTRICTION_FROM' AS MASTER_COL,'MRP_RESTRICTION_FROM' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		  UNION ALL 
		  SELECT 'MRP_RESTRICTION_TO' AS MASTER_COL,'MRP_RESTRICTION_TO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		                                 
	END  
	ELSE IF(@XNTYPE='GV')
	BEGIN
			  SELECT 'GV SERIAL NO' AS MASTER_COL,'GV_SRNO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'SCRATCH NO' AS MASTER_COL,'GV_SCRATCH_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'DENOMINATION' AS MASTER_COL,'DENOMINATION' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'DISCOUNT' AS MASTER_COL,'DISCOUNT_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END  
	

	ELSE IF(@XNTYPE='EOSSSLAB')
	BEGIN
			  SELECT 'Buy From' AS MASTER_COL,'buyFromRange' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Buy To' AS MASTER_COL,'buyToRange' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Get Type' AS MASTER_COL,'schemegetTypeName' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Get Value' AS MASTER_COL,'getQty' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Disc %' AS MASTER_COL,'discountPercentage' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Disc Amount' AS MASTER_COL,'discountAmount' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'Net Price' AS MASTER_COL,'netPrice' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END  
	
	
	ELSE IF(@XNTYPE='BIN')
	BEGIN
			  SELECT 'BIN NAME' AS MASTER_COL,'BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'MAJOR BIN NAME' AS MASTER_COL,'MAJOR_BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'BIN ALIAS' AS MASTER_COL,'BIN_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'BIN AREA' AS MASTER_COL,'AREA_COVERED' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL      
			  SELECT 'MBO COUNTER' AS MASTER_COL,'MBO_COUNTER' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  
			  --SELECT 'INACTIVE' AS MASTER_COL,'INACTIVE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			
			  --UNION ALL    
			  --SELECT 'MBO LEDGER AC NAME' AS MASTER_COL,'MBO_LEDGER_AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'BILL PREFIX' AS MASTER_COL,'BILL_PREFIX' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'ADDRESS1' AS MASTER_COL,'ADDRESS1' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'ADDRESS2' AS MASTER_COL,'ADDRESS2' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'AREA' AS MASTER_COL,'AREA_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'TIN NO' AS MASTER_COL,'TIN_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'TAN NO' AS MASTER_COL,'TAN_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			  --UNION ALL    
			  --SELECT 'PAN NO' AS MASTER_COL,'PAN_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL    
			  --SELECT 'PHONE NO' AS MASTER_COL,'PHONE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  --UNION ALL    
			  --SELECT 'ONLINE COUNTER' AS MASTER_COL,'ONLINE_COUNTER' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
  
	END  

	ELSE IF(@XNTYPE='MBOSLS')
	BEGIN
			  SELECT 'BILL NO' AS MASTER_COL,'BILL_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'BILL DATE' AS MASTER_COL,'CM_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT (CASE WHEN @BMBOSLS=1 THEN 'BIN ID' ELSE 'LOCATION ID' END) AS MASTER_COL
					,'BIN_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'AMOUNT' AS MASTER_COL,'AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL    
			  SELECT 'CANCELLED' AS MASTER_COL,'CANCELLED' AS MASTER_COL_EXPR,'' AS MAPPED_COL     
	END  
	
 ELSE IF(@XNTYPE='SORPYMT')      
 BEGIN      
     SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL          
     SELECT 'CM NO' AS MASTER_COL,'CM_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL          
         
     SELECT 'CM DT' AS MASTER_COL,'CM_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL          
     SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL         
              
     SELECT 'NET PAYABLE' AS MASTER_COL,'NET_PAYABLE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
  
           
 END 


 ELSE IF(@XNTYPE='EOSSDEBIT')      
 BEGIN      
     SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL          
     SELECT 'CM NO' AS MASTER_COL,'CM_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL     
         
     SELECT 'CM DT' AS MASTER_COL,'CM_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL          
     SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL             
     SELECT 'DISCOUNT SHARING AMOUNT' AS MASTER_COL,'DISCOUNT_SHARING_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
 
           
 END 
	
ELSE IF(@XNTYPE='IBT')
	BEGIN
			 
			  
			  SELECT 'TARGET BIN NAME' AS MASTER_COL,'ITEM_TARGET_BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL  			  
			  SELECT 'SOURCE BIN NAME' AS MASTER_COL,'SOURCE_BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    			   
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			   
	END 


	ELSE IF(@XNTYPE='DNPF')
	BEGIN
			 
			  
			  SELECT 'SOURCE DEPT ID' AS MASTER_COL,'Source_DeptId' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL  			  
			  SELECT 'TARGET DEPT ID' AS MASTER_COL,'Target_DeptId' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    			   
			  SELECT 'VALID DATE' AS MASTER_COL,'Valid_Date' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'REMARKS' AS MASTER_COL,'remarks' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL    
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'Product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			   
			   
	END 
	

	ELSE IF(@XNTYPE='SDP')
	BEGIN
			 			  
			  SELECT 'Location Id' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL  			  
			  SELECT 'Product Code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    			   
			  SELECT 'Depreciation Value' AS MASTER_COL,'depcn_value' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			 
			   
	END  

	

	ELSE IF(@XNTYPE='SCS')
	BEGIN
			 
			  
			  SELECT 'LOCATION ID' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL  			  
			  SELECT 'STOCK COUNT TITLE' AS MASTER_COL,'STK_COUNT_SETUP_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    			   
			  SELECT 'WEEK DAY' AS MASTER_COL,'WEEK_DAY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			 
			   
	END  
	
 ELSE IF(@XNTYPE='LOCLEDGERS')    
 BEGIN    
        
     SELECT 'XN TYPE' AS MASTER_COL,'XN_TYPE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
     UNION ALL  
     SELECT 'SOURCE LOCATION' AS MASTER_COL,'SOURCE_LOCATION' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL           
     SELECT 'TARGET LOCATION' AS MASTER_COL,'TARGET_LOCATION' AS MASTER_COL_EXPR,'' AS MAPPED_COL          
     UNION ALL              
     SELECT 'LEDGER' AS MASTER_COL,'LEDGER' AS MASTER_COL_EXPR,'' AS MAPPED_COL        
        
          
 END  
		ELSE IF(@XNTYPE='GRNPS')
	BEGIN			 
			  
			  SELECT 'BOX NO' AS MASTER_COL,'BOX_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL			  			   
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			   
	END  
	
	ELSE IF(@XNTYPE='WSL')
	BEGIN
			 		  
			 			  
			  SELECT 'SOURCE BIN NAME' AS MASTER_COL,'BIN_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    			   
			  --SELECT 'SOURCE BIN ID' AS MASTER_COL,'BIN_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  --UNION ALL    			   
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL    
			  SELECT 'RATE' AS MASTER_COL,'RATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  UNION ALL    
			  SELECT 'NET RATE' AS MASTER_COL,'NET_RATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL
			  SELECT 'ITEM REMARKS' AS MASTER_COL,'REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			   UNION ALL
			  SELECT 'Discount%' AS MASTER_COL,'DISCOUNT_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			   UNION ALL
			  SELECT 'Discount Amount' AS MASTER_COL,'DISCOUNT_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			    UNION ALL
			  SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			   
	END  
	
	

	ELSE IF(@XNTYPE='WSLM')
	BEGIN
			 	  
			 			  
			  SELECT 'AC NAME' AS MASTER_COL,'AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'MANUAL INV NO' AS MASTER_COL,'MANUAL_INV_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL 			  
			  UNION ALL
			  SELECT 'ONLINE BILL REF NO' AS MASTER_COL,'ONLINE_BILL_REF_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'FREIGHT' AS MASTER_COL,'FREIGHT' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'OTHER_CHARGES' AS MASTER_COL,'OTHER_CHARGES' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'MEMO PREFIX' AS MASTER_COL,'MEMO_PREFIX' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL
			  SELECT 'REMARKS' AS MASTER_COL,'REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL
			  SELECT 'BILL LEVEL TAX METHOD' AS MASTER_COL,'BILL_LEVEL_TAX_METHOD' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  
			  UNION ALL
			  SELECT 'ITEM REMARKS' AS MASTER_COL,'ITEM_REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL
			  SELECT 'HSN CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL
			  SELECT 'RATE' AS MASTER_COL,'RATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL			  
			  SELECT 'DISCOUNT PERCENTAGE' AS MASTER_COL,'DISCOUNT_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'DISCOUNT AMOUNT' AS MASTER_COL,'DISCOUNT_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  UNION ALL
			  SELECT 'INV REF' AS MASTER_COL,'INV_REF' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			   UNION ALL
			  SELECT 'SERVICE PERIOD FROM' AS MASTER_COL,'SERVICEPERIODFROMDATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			   UNION ALL
			  SELECT 'SERVICE PERIOD TO' AS MASTER_COL,'SERVICEPERIODTODATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			   UNION ALL
			  SELECT 'MANUAL BILL DT' AS MASTER_COL,'MANUAL_BILL_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL 			  
			 
	END  
	
	ELSE IF(@XNTYPE='WSR')
	BEGIN
			 	  
			 			  
			  SELECT 'AC NAME' AS MASTER_COL,'AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'MANUAL INV NO' AS MASTER_COL,'MANUAL_INV_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL 			  
			  --UNION ALL
			  --SELECT 'ONLINE BILL REF NO' AS MASTER_COL,'ONLINE_BILL_REF_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'FREIGHT' AS MASTER_COL,'FREIGHT' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'OTHER_CHARGES' AS MASTER_COL,'OTHER_CHARGES' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'MEMO PREFIX' AS MASTER_COL,'MEMO_PREFIX' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL
			  SELECT 'REMARKS' AS MASTER_COL,'REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  --UNION ALL
			  --SELECT 'BILL LEVEL TAX METHOD' AS MASTER_COL,'BILL_LEVEL_TAX_METHOD' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  
			  --UNION ALL
			  --SELECT 'ITEM REMARKS' AS MASTER_COL,'ITEM_REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL
			  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  --UNION ALL
			  --SELECT 'HSN CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL      
			  UNION ALL    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL
			  SELECT 'INV NO' AS MASTER_COL,'INV_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL			  
			  SELECT 'INV DT' AS MASTER_COL,'INV_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL    
			  SELECT 'RATE' AS MASTER_COL,'RATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  --UNION ALL
			  --SELECT 'DISCOUNT AMOUNT' AS MASTER_COL,'DISCOUNT_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  --UNION ALL
			  --SELECT 'INV REF' AS MASTER_COL,'INV_REF' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  -- UNION ALL
			  --SELECT 'SERVICE PERIOD FROM' AS MASTER_COL,'SERVICEPERIODFROMDATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			  -- UNION ALL
			  --SELECT 'SERVICE PERIOD TO' AS MASTER_COL,'SERVICEPERIODTODATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
			   
	END  
	



	ELSE IF(@XNTYPE='MST')
	BEGIN
			  SELECT 'OLD VALUE' AS MASTER_COL,'OLD_VALE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'NEW VALUE' AS MASTER_COL,'NEW_VALUE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END  
	ELSE IF(@XNTYPE='ATTRKEY')
	BEGIN
			  SELECT 'KEY VALUE' AS MASTER_COL,'KEY_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
			  UNION ALL    
			  SELECT 'ALIAS' AS MASTER_COL,'KEY_ALIAS' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END 
	ELSE IF(@XNTYPE='WOD')
	BEGIN
	
			   
			  SELECT 'CUSTOMER PO NO.' AS MASTER_COL,'REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL
			  SELECT CASE WHEN COLUMN_CAPTION='PARA1_NAME' AND ISNULL(@CPARA1,'')<>'' THEN @CPARA1
			              WHEN COLUMN_CAPTION='PARA2_NAME' AND ISNULL(@CPARA2,'')<>'' THEN @CPARA2
						  WHEN COLUMN_CAPTION='PARA3_NAME' AND ISNULL(@CPARA3,'')<>'' THEN @CPARA3
						  WHEN COLUMN_CAPTION='PARA4_NAME' AND ISNULL(@CPARA4,'')<>'' THEN @CPARA4
						  WHEN COLUMN_CAPTION='PARA5_NAME' AND ISNULL(@CPARA5,'')<>'' THEN @CPARA5
						  WHEN COLUMN_CAPTION='PARA6_NAME' AND ISNULL(@CPARA6,'')<>'' THEN @CPARA6
						  when isnull(attr.table_caption,'')<>'' then attr.table_caption
			     ELSE   COLUMN_CAPTION END  AS MASTER_COL,

			  a.COLUMN_NAME AS MASTER_COL_EXPR,'' AS MAPPED_COL
			  FROM CONFIG_BUYERORDER (NOLOCK) a
			  left join config_attr attr on attr.column_name=a.COLUMN_NAME
			  WHERE ISNULL(a.OPEN_KEY ,0)=1 or ( a. COLUMN_NAME  in ('ARTICLE_NO','PARA1_NAME','PARA2_NAME','PARA3_NAME'))
			  and a.COLUMN_NAME<>'MRP_FROM_TO'

			  union all
			  SELECT   'FROM_MRP' AS MASTER_COL,
			  'FROM_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			  FROM CONFIG_BUYERORDER (NOLOCK)  WHERE ISNULL(OPEN_KEY ,0)=1
			  and COLUMN_NAME='MRP_FROM_TO'
			   union all
			  SELECT   'TO_MRP' AS MASTER_COL,
			  'TO_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			  FROM CONFIG_BUYERORDER (NOLOCK)  WHERE ISNULL(OPEN_KEY ,0)=1
			  and COLUMN_NAME='MRP_FROM_TO'

			   
			  UNION ALL			    
			  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
			  UNION ALL			    
			  SELECT 'RATE' AS MASTER_COL,'GROSS_WSP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
			  --new add 
			  UNION ALL			    
			  SELECT 'SETTLEMENT' AS MASTER_COL,'MEMO_TYPE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'Memo Type' AS MASTER_COL,'Inv_Mode' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'RECEIVER NAME' AS MASTER_COL,'AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'REF NO' AS MASTER_COL,'REF_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'SENDER LOCATION' AS MASTER_COL,'WBO_FOR_DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_Address' AS MASTER_COL,'shipping_Address' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_address2' AS MASTER_COL,'shipping_address2' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_address3' AS MASTER_COL,'shipping_address3' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_area_name' AS MASTER_COL,'shipping_area_name' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_city_name' AS MASTER_COL,'shipping_city_name' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_pin' AS MASTER_COL,'shipping_pin' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'shipping_state_name' AS MASTER_COL,'shipping_state_name' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'Item Code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
			  UNION ALL			    
			  SELECT 'Item Delivery Date' AS MASTER_COL,'item_delivery_dt' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
			   UNION ALL			    
			  SELECT 'Delivery Date' AS MASTER_COL,'delivery_dt' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
			  UNION ALL			    
			  SELECT 'Transporter Name' AS MASTER_COL,'Angadia_name' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
			  UNION ALL			    
			  SELECT 'Foreign Currency' AS MASTER_COL,'fc_name' AS MASTER_COL_EXPR,'' AS MAPPED_COL 	
			   UNION ALL			    
			  SELECT 'Season' AS MASTER_COL,'Season_Name' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	END  	
	ELSE IF(@XNTYPE='BUYPL')
	BEGIN
	
	
	
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'REMARKS' AS MASTER_COL,'REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL   			 
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL  	  
		  SELECT 'QUANTITY' AS MASTER_COL,'QUANTITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL  	  
		  SELECT 'PURCHASE PRICE' AS MASTER_COL,'PURCHASE_PRICE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL  	      
		  SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  
		  UNION ALL  	      
		  SELECT 'BUY PLAN ROW ID' AS MASTER_COL,'ROW_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
		  UNION ALL  	      
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
	END  
	ELSE IF(@XNTYPE='JOBRATE')
	BEGIN
	
	
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL  	  
		  SELECT 'JOB RATE' AS MASTER_COL,'RATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  
		  UNION ALL  	      
		  SELECT 'JOB WORKER' AS MASTER_COL,'AGENCY_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL 
	END 

	ELSE IF(@XNTYPE='ARSPLAN')
	BEGIN
	    SELECT STK_LEVEL_PARA_desc AS MASTER_COL,STK_LEVEL_PARA_name AS MASTER_COL_EXPR,'' AS MAPPED_COL
	    FROM ARS_ARS_STOCK_LEVEL_MST_UPLOAD (NOLOCK) WHERE SP_ID=@CSPID
		UNION ALL    
		----LOCATION
		SELECT 'LOC' AS MASTER_COL,'LOC_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL    
		SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL
		SELECT 'Target Daily Sale' as  master_col,'Target_Daily_Sale' as master_col_expr, '' AS MAPPED_COL
		UNION ALL    
		SELECT 'Minimum Days' as  master_col,'Minimum_Days' as master_col_expr, '' AS MAPPED_COL 
		UNION ALL
		SELECT 'Target Days' as  master_col,'Target_Days' as master_col_expr, '' AS MAPPED_COL
		UNION ALL
		SELECT 'Maximum Days' as  master_col,'Maximum_Days' as master_col_expr, '' AS MAPPED_COL 
		UNION ALL
		SELECT 'Safety Level' as  master_col,'Safety_Level' as master_col_expr, '' AS MAPPED_COL

	END 
	 	
    ELSE IF(@XNTYPE='SLSTRG')
	BEGIN
	    SELECT SLSTARGET_PARA_DESC AS MASTER_COL,SLSTARGET_PARA_NAME AS MASTER_COL_EXPR,'' AS MAPPED_COL
	    FROM SLSTRG_SLSTARGET_SETUP_UPLOAD (NOLOCK) WHERE SP_ID=@CSPID
		UNION ALL    
		----LOCATION
		SELECT 'DEPT_ID' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL    
		SELECT 'TARGET_DT' AS MASTER_COL,'TARGET_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL
		SELECT 'TARGET_QTY' as  master_col,'TARGET_QTY' as master_col_expr, '' AS MAPPED_COL
		UNION ALL    
		SELECT 'TARGET_value' as  master_col,'TARGET_value' as master_col_expr, '' AS MAPPED_COL 
  		  
	END  
	
	
	
	ELSE IF(@XNTYPE='HSN')
	BEGIN
	    SELECT 'DEPT_ID' AS MASTER_COL,'DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL  
		SELECT 'HSN_CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL    
		SELECT 'TAX_PERCENTAGE' AS MASTER_COL,'TAX_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		UNION ALL
		SELECT 'RATE_CUTOFF' AS  MASTER_COL,'RATE_CUTOFF' AS MASTER_COL_EXPR, '' AS MAPPED_COL
		UNION ALL    
		SELECT 'RATE_CUTOFF_TAX_PERCENTAGE' AS  MASTER_COL,'RATE_CUTOFF_TAX_PERCENTAGE' AS MASTER_COL_EXPR, '' AS MAPPED_COL 
		UNION ALL    
		SELECT 'WEF' AS  MASTER_COL,'WEF' AS MASTER_COL_EXPR, '' AS MAPPED_COL 
		UNION ALL    
		SELECT 'GST_CAL_BASIS' AS  MASTER_COL,'GST_CAL_BASIS' AS MASTER_COL_EXPR, '' AS MAPPED_COL 
		UNION ALL    
		SELECT 'TAXABLE_ITEM' AS  MASTER_COL,'TAXABLE_ITEM' AS MASTER_COL_EXPR, '' AS MAPPED_COL 
  		UNION ALL    
		SELECT 'HSN_TYPE' AS  MASTER_COL,'HSN_TYPE' AS MASTER_COL_EXPR, '' AS MAPPED_COL 
		UNION ALL    
		SELECT 'GST_VARIATION' AS  MASTER_COL,'GST_VARIATION' AS MASTER_COL_EXPR, '' AS MAPPED_COL   
		UNION ALL    
		SELECT 'DESCRIPTIONS' AS  MASTER_COL,'DESCRIPTIONS' AS MASTER_COL_EXPR, '' AS MAPPED_COL   
		
	END  	

	ELSE IF(@XNTYPE='INDENT')
	BEGIN
		SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL UNION ALL    
		SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL UNION ALL    
		SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL UNION ALL    
		SELECT VALUE MASTER_COL,UPPER(CONFIG_OPTION)+'_NAME'MASTER_COL_EXPR,'' FROM CONFIG WHERE CONFIG_OPTION LIKE 'PARA[1-6]' UNION ALL    
		SELECT TABLE_CAPTION MASTER_COL,REPLACE(UPPER(TABLE_NAME),'_MST','_KEY_NAME')MASTER_COL_EXPR,'' FROM CONFIG_ATTR WHERE TABLE_CAPTION<>''
	END  	
	
	ELSE IF(@XNTYPE='ALT')
	BEGIN
		SELECT 'Location ID'MASTER_COL,'DEPT_ID'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 'Location Name'MASTER_COL,'DEPT_NAME'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 'Job Name','JOB_NAME',''  UNION
		SELECT 'Section','SECTION_NAME',''  UNION
		SELECT 'Sub Section','SUB_SECTION_NAME',''  UNION
		SELECT 'Base NRV','BASE_NRV','' UNION
		SELECT 'Job Rate on Less than NRV','JOBRATE_LESSTHAN_NRV','' UNION
		SELECT 'Job Rate on More than NRV','JOBRATE_MORETHAN_NRV','' UNION
		SELECT 'Vendor Job Rate','VENDOR_RATE','' 
	END	
	ELSE IF(@XNTYPE='RACK')
	BEGIN
		SELECT 'Location ID'MASTER_COL,'DEPT_ID'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 'Location Name'MASTER_COL,'DEPT_NAME'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 'Rack No','RACK_NO',''  
	END	
	ELSE IF(@XNTYPE='MONTHLY_BUDGET')
	BEGIN
	SELECT MASTER_COL,MASTER_COL_EXPR,MAPPED_COL FROM
	(
		SELECT 1 AS SRNO,'Location ID'MASTER_COL,'DEPT_ID'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 2 AS SRNO,'Location Name'MASTER_COL,'DEPT_NAME'MASTER_COL_EXPR,CAST('' AS VARCHAR(100)) MAPPED_COL UNION
		SELECT 3 AS SRNO,'Expense Head','AC_NAME',''  UNION
		SELECT 4 AS SRNO,'April','MONTH1',''  UNION	
		SELECT 5 AS SRNO,'May','MONTH2',''  UNION
		SELECT 6 AS SRNO,'June','MONTH3',''  UNION
		SELECT 7 AS SRNO,'July','MONTH4',''  UNION
		SELECT 8 AS SRNO,'August','MONTH5',''  UNION
		SELECT 9 AS SRNO,'September','MONTH6',''  UNION
		SELECT 10 AS SRNO,'October','MONTH7',''  UNION
		SELECT 11 AS SRNO,'November','MONTH8',''  UNION
		SELECT 12 AS SRNO,'December','MONTH9',''  UNION
		SELECT 13 AS SRNO,'January','MONTH10',''  UNION
		SELECT 14 AS SRNO,'February','MONTH11',''  UNION
		SELECT 15 AS SRNO,'March','MONTH12',''  
	)X
	ORDER BY SRNO
	END	
	ELSE IF(@XNTYPE='SLSBC')
	BEGIN	 		 
			   			   
	  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
	  UNION ALL    
	  SELECT 'DISCOUNT VALUE' AS MASTER_COL,'DISCOUNT_FIGURE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	  UNION ALL    
	  SELECT 'Location Id' AS MASTER_COL,'ITEM_DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	  
	END  
	ELSE IF(@XNTYPE='SCHPARAS')	
	BEGIN    
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'DISCOUNT/NET PRICE' AS MASTER_COL,'DISCOUNT_figure' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'DISCOUNT TYPE' AS MASTER_COL,'DISC_TYPE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END

	ELSE IF(@XNTYPE='EOSSOPT')	
	BEGIN    
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		   UNION ALL    
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'Disc%' AS MASTER_COL,'discountPercentage' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'Disc Amout' AS MASTER_COL,'discountAmount' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'Net Amout' AS MASTER_COL,'netPrice' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END
	
	
	
	ELSE IF(@XNTYPE='LSL')	
	BEGIN 
	
	      SELECT 'TITLE NAME' AS MASTER_COL,'TITLE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL 
		  SELECT 'TARGET LOC ID' AS MASTER_COL,'TARGET_DEPT_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'APPLICABLE FROM DT' AS MASTER_COL,'APPLICABLE_FROM_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL 
		  SELECT 'APPLICABLE TO DT' AS MASTER_COL,'APPLICABLE_TO_DT' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL 
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  UNION ALL
		  SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL
		   UNION ALL
		  SELECT 'MRP FROM' AS MASTER_COL,'MRP_FROM' AS MASTER_COL_EXPR,'' AS MAPPED_COL                    
		  UNION ALL
		  SELECT 'MRP TO' AS MASTER_COL,'MRP_TO' AS MASTER_COL_EXPR,'' AS MAPPED_COL  		  
		  UNION ALL
		  SELECT 'Planned Qty' AS MASTER_COL,'STOCK_LEVEL_QTY' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL
		  SELECT 'Planned %' AS MASTER_COL,'STOCK_LEVEL_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		   UNION ALL
		  SELECT 'Item Remarks' AS MASTER_COL,'ITEM_REMARKS' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
	END
	ELSE IF(@XNTYPE IN ('SLSIMP_STOCK'))	
	BEGIN 
	SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'Store Code' AS MASTER_COL,'STORE_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	END
	ELSE IF(@XNTYPE IN ('SLSIMP','SORIMP'))	
	BEGIN 

	SELECT  'Ref No' AS MASTER_COL,'memo_no' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Memo Dt' AS MASTER_COL,'memo_dt' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'MRP VALUE' AS MASTER_COL,'MRPVALUE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Item Net' AS MASTER_COL,'net' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'*' AS MANDATORY
	Union  All
	SELECT 'Bill Amount' AS MASTER_COL,'NET_AMOUNT' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATOR
	Union  All
	SELECT 'Item Discount %' AS MASTER_COL,'CMD_Discount_Percentage' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Item Discount Amt' AS MASTER_COL,'CMD_Discount_Amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	--Union  All
	--SELECT 'Bill Discount Amt' AS MASTER_COL,'CMM_Discount_Amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Other Charges' AS MASTER_COL,'CMM_OTHER_CHARGES' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Round Off' AS MASTER_COL,'CMM_ROUND_OFF' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'HSN Code' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'GST%' AS MASTER_COL,'gst_percentage' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'IGST Amount' AS MASTER_COL,'igst_amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'CGST Amount' AS MASTER_COL,'cgst_amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'SGST Amount' AS MASTER_COL,'sgst_amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Taxable Amount' AS MASTER_COL,'xn_value_without_gst' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Cancelled' AS MASTER_COL,'CANCELLED' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Sales Person' AS MASTER_COL,'emp_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Mobile' AS MASTER_COL,'USER_CUSTOMER_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Fname' AS MASTER_COL,'customer_fname' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Lname' AS MASTER_COL,'customer_lname' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Address1' AS MASTER_COL,'address0' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Address2' AS MASTER_COL,'address1' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Address3' AS MASTER_COL,'address2' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Customer Address4' AS MASTER_COL,'address9' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Area' AS MASTER_COL,'AREA' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'City' AS MASTER_COL,'CITY' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'State' AS MASTER_COL,'STATE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'GST No' AS MASTER_COL,'CUS_GST_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'GST State' AS MASTER_COL,'cus_gst_state' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Email' AS MASTER_COL,'EMAIL' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Remarks' AS MASTER_COL,'remarks' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Store Code' AS MASTER_COL,'STORE_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Payment Mode Name' AS MASTER_COL,'PAYMODE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Ledger Name' AS MASTER_COL,'AC_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	/*Union  All
	SELECT 'Weighted Disc Per' AS MASTER_COL,'weighted_avg_disc_pct' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	Union  All
	SELECT 'Weighted Disc Amt' AS MASTER_COL,'weighted_avg_disc_amt' AS MASTER_COL_EXPR,'' AS MAPPED_COL,'' AS MANDATORY
	
	weighted_avg_disc_pct
weighted_avg_disc_amt
	*/
	END
	
	ELSE IF(@XNTYPE='SISIMP' )	
	BEGIN 

	SELECT 'Dept id' AS MASTER_COL,'dept_id' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	union All
	SELECT 'xn type ' AS MASTER_COL,'xn_type' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Memo No' AS MASTER_COL,'memo_no' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Memo Dt' AS MASTER_COL,'memo_dt' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Net' AS MASTER_COL,'net' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Cancelled' AS MASTER_COL,'Cancelled' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Cash' AS MASTER_COL,'Cash' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Credit Card Amount' AS MASTER_COL,'CC_Amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'MRP' AS MASTER_COL,'MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Discount Amt' AS MASTER_COL,'Discount_Amount' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'BIN' AS MASTER_COL,'BIN_ID' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'MOBILE' AS MASTER_COL,'USER_CUSTOMER_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Sales Person' AS MASTER_COL,'emp_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Remarks' AS MASTER_COL,'remarks' AS MASTER_COL_EXPR,'' AS MAPPED_COL


	END
	ELSE IF(@XNTYPE='SORSISIMP')	
	BEGIN 

	SELECT 'Dept id' AS MASTER_COL,'dept_id' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Ref No' AS MASTER_COL,'memo_no' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Ref Dt' AS MASTER_COL,'memo_dt' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Product code' AS MASTER_COL,'product_code' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Quantity' AS MASTER_COL,'Quantity' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Net' AS MASTER_COL,'net' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'MOBILE' AS MASTER_COL,'USER_CUSTOMER_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Customer Name' AS MASTER_COL,'CUSTOMER_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL
	Union  All
	SELECT 'Remarks' AS MASTER_COL,'remarks' AS MASTER_COL_EXPR,'' AS MAPPED_COL


	END
	ELSE IF(@XNTYPE IN ('STKCNT'))
    BEGIN  	  
  		--  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT 'PRODUCT CODE' AS MASTER_COL,'PRODUCT_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    
		  --UNION ALL    
		  --SELECT TABLE_CAPTION  AS MASTER_COL,column_name AS MASTER_COL_EXPR, '' AS MAPPED_COL FROM  CONFIG_ATTR  where TABLE_CAPTION <> '' 		  
		  --UNION ALL    
		  --SELECT 'Physical Stock'  AS MASTER_COL,'physical_stock' AS MASTER_COL_EXPR, '' AS MAPPED_COL

			SELECT col_header AS MASTER_COL,col_value AS MASTER_COL_EXPR, '' AS MAPPED_COL FROM  STOCK_COUNT_SETUP_COL_LIST where STK_COUNT_SETUP_ID = @CSPID 
			UNION ALL    
			SELECT 'Physical Stock'  AS MASTER_COL,'physical_stock' AS MASTER_COL_EXPR, '' AS MAPPED_COL

	END	
	ELSE IF (@XNTYPE IN ('PARTYRATE'))
	BEGIN
		
		  SELECT 'SECTION NAME' AS MASTER_COL,'SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL    WHERE @CSPID LIKE '%SEC%'
		  UNION ALL    
		  SELECT 'SUB SECTION NAME' AS MASTER_COL,'SUB_SECTION_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      WHERE @CSPID LIKE '%SUB%'
		  UNION ALL    
		  SELECT 'ARTICLE NO' AS MASTER_COL,'ARTICLE_NO' AS MASTER_COL_EXPR,'' AS MAPPED_COL     WHERE @CSPID LIKE '%ART%'
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA1,'')='' THEN 'PARA1' ELSE @CPARA1 END) AS MASTER_COL,'PARA1_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL     WHERE @CSPID LIKE '%P1%'
		  UNION ALL
		  SELECT (CASE WHEN ISNULL(@CPARA2,'')='' THEN 'PARA2' ELSE @CPARA2 END) AS MASTER_COL,'PARA2_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL      WHERE @CSPID LIKE '%P2%'
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA3,'')='' THEN 'PARA3' ELSE @CPARA3 END) AS MASTER_COL,'PARA3_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   WHERE @CSPID LIKE '%P3%' 
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA4,'')='' THEN 'PARA4' ELSE @CPARA4 END) AS MASTER_COL,'PARA4_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL  WHERE @CSPID LIKE '%P4%'  
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA5,'')='' THEN 'PARA5' ELSE @CPARA5 END) AS MASTER_COL,'PARA5_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL     WHERE @CSPID LIKE '%P5%'
		  UNION ALL    
		  SELECT (CASE WHEN ISNULL(@CPARA6,'')='' THEN 'PARA6' ELSE @CPARA6 END) AS MASTER_COL,'PARA6_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL  WHERE @CSPID LIKE '%P6%'
		  UNION ALL      
		  SELECT 'HSN CODE' AS MASTER_COL,'HSN_CODE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  WHERE @CSPID LIKE '%HSN%'
		  UNION ALL      
		  SELECT 'GST%' AS MASTER_COL,'GST_PERCENTAGE' AS MASTER_COL_EXPR,'' AS MAPPED_COL  WHERE @CSPID LIKE '%GST%'
		  UNION ALL    
		  SELECT 'FROM MRP' AS MASTER_COL,'FROM_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL   WHERE @CSPID LIKE '%MRP%'
		  UNION ALL    
		  SELECT 'TO MRP' AS MASTER_COL,'TO_MRP' AS MASTER_COL_EXPR,'' AS MAPPED_COL   WHERE @CSPID LIKE '%MRP%'
		  UNION ALL      
		  SELECT 'Base Price Name' AS MASTER_COL,'BASE_PRICE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL  
		  UNION ALL    
		  SELECT 'Disc Cal Mode' AS MASTER_COL,'CAL_MODE_NAME' AS MASTER_COL_EXPR,'' AS MAPPED_COL   
		  UNION ALL    
		  SELECT 'Value' AS MASTER_COL,'Value' AS MASTER_COL_EXPR,'' AS MAPPED_COL 

	END
END
--END OF PROCEDURE - SP_EXCELDATA

