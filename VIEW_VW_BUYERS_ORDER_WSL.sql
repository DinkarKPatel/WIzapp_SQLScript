CREATE VIEW VW_BUYERS_ORDER_WSL  
  
AS  
SELECT T1.ORDER_DT,T1.ORDER_NO,T2.AC_NAME,  
     (T3.QUANTITY * T3.WS_PRICE) AS AMOUNT,  
     T1.TOTAL_AMOUNT,T1.MEMO_TYPE ,         
     T1.OTHER_CHARGES AS OTHER_CHARGES,T1.DISCOUNT_AMOUNT AS MST_DISCOUNT_AMOUNT,
     T1.DISCOUNT_PERCENTAGE AS MST_DISC_PRCT,   
     T1.SUBTOTAL AS AMOUNT_WO_TAX,PARA1.PARA1_NAME,PARA2.PARA2_NAME,PARA2.PARA2_ORDER,   
     T3.ORDER_ID,  
	 T3.PARA1_CODE,  
	 T3.PARA2_CODE,  
	 T3.QUANTITY,  
	 T3.ROW_ID,  
	 T3.LAST_UPDATE,  
	 T3.WS_PRICE,  
	 T3.RFNET,  
	 T3.ARTICLE_CODE,  
	 T3.GROSS_WSP,  
	 T3.DISCOUNT_PERCENTAGE,  
	 T3.DISCOUNT_AMOUNT,  
	 T3.REMARKS,  
	 T3.PRODUCT_CODE,  
	 T3.MANUAL_DISCOUNT,  
	 T3.PARA3_CODE,  
     T3.ONLINE_PRODUCT_CODE,  
     T1.PAYMENT_DETAILS,SECTIOND.SUB_SECTION_NAME,SECTIONM.SECTION_NAME,ARTICLE.ARTICLE_NO, ARTICLE.ARTICLE_NAME,   
     T3.QUANTITY AS QTY  ,COM.COMPANY_CODE ,COM.COMPANY_NAME,COM.LOGO_PATH ,
     COM.GST_NO,COM.ADDRESS1 AS COMP_ADDRESS1,COM.ADDRESS2 AS COMP_ADDRESS2,
     COM.CITY AS COM_CITY, 
     T1.TRAIL_DT,T1.DELIVERY_DT  ,T2.ADDRESS0,T2.ADDRESS1,T2.ADDRESS2,T2.AREA_NAME,T2.CITY,T2.STATE,T2.PINCODE,
     T2.TIN_NO AS PARTY_TIN_NO,T2.PHONES_O AS PARTY_PHONE_O, T2.MOBILE AS PARTY_MOBILE ,
     T1.WAY_BILL,T1.BOOKED_BY,T1.CREDIT_DAYS ,       
  T1.REF_NO,T1.PAY_TYPE,
  T1.REMARKS AS MST_REMARKS,  
  EMP.EMP_NAME AS MERCHANT_NAME,   
  t1.shipping_Address AS SHIPPING_ADDRESS1,  
  t1.shipping_ADDRESS2 AS SHIPPING_ADDRESS2,  
  t1.shipping_ADDRESS3 AS SHIPPING_ADDRESS3,  
  t1.shipping_AREA_NAME AS SHIPPING_AREA_NAME,  
  t1.shipping_PIN AS SHIPPING_PIN ,  
  t1.shipping_city_name AS SHIPPING_CITY,  
  t1.shipping_state_name  AS SHIPPING_STATE,
  BRD.AC_NAME AS BROCKER_NAME ,
  ANG.ANGADIA_NAME AS TRANSPORT_NAME ,ANG.INSURANCE_PERCENTAGE AS TSPRT_INS_PERCENT,T1.ANGADIA_CODE ,
  (T3.IGST_AMOUNT + T3.SGST_AMOUNT + T3.CGST_AMOUNT) AS GST_AMOUNT  ,
  T2.AC_GST_NO  
  
  FROM BUYER_ORDER_MST T1        
  JOIN LMV01106 T2 ON T1.AC_CODE = T2.AC_CODE
  LEFT OUTER JOIN LMV01106 BRD ON T1.BROKER_AC_CODE = BRD.AC_CODE
  --LEFT OUTER JOIN LM_SHIPPING_DETAILS LMS ON T2.AC_CODE =LMS.AC_CODE    
  --LEFT OUTER JOIN AREA  ON AREA.AREA_CODE =LMS.AREA_CODE   
  --LEFT OUTER JOIN CITY  ON AREA.CITY_CODE=CITY.CITY_CODE   
  --LEFT OUTER JOIN STATE ON STATE.STATE_CODE =CITY.STATE_CODE
  LEFT OUTER JOIN ANGM ANG ON T1.ANGADIA_CODE =ANG.ANGADIA_CODE
  --LEFT OUTER JOIN ANGM_RATE ANGR ON ANG.ANGADIA_CODE=ANGR.ANGADIA_CODE       
  JOIN BUYER_ORDER_DET T3 ON T3.ORDER_ID = T1.ORDER_ID  
  LEFT OUTER JOIN EMPLOYEE EMP ON  T3.ITEM_MERCHANT_CODE=EMP.EMP_CODE        
  JOIN ARTICLE ON ARTICLE.ARTICLE_CODE = T3.ARTICLE_CODE        
  JOIN SECTIOND ON SECTIOND.SUB_SECTION_CODE= ARTICLE.SUB_SECTION_CODE        
  JOIN SECTIONM ON SECTIOND.SECTION_CODE = SECTIONM.SECTION_CODE        
  JOIN PARA1 ON PARA1.PARA1_CODE = T3.PARA1_CODE        
  JOIN PARA2 ON PARA2.PARA2_CODE = T3.PARA2_CODE          
  LEFT OUTER JOIN COMPANY COM ON 1=1 AND COM.COMPANY_CODE='01'     
  WHERE T1.CANCELLED = 0
