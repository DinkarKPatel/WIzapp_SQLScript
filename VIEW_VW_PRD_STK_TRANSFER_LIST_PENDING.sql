CREATE VIEW VW_PRD_STK_TRANSFER_LIST_PENDING      
      
AS       
 SELECT T1.MEMO_NO ,WO.MEMO_NO AS WORK_ORDER_NO,WO.REF_NO      
  , ART.ARTICLE_NO      
 ,T1.MEMO_DT AS MEMO_DATE         
 ,T3.DEPARTMENT_NAME AS TARGET_DEPARTMENT_NAME        
 ,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END AS CANCELLED        
 ,T4.DEPARTMENT_NAME AS SOURCE_DEPARTMENT_NAME,T1.SOURCE_DEPARTMENT_ID         
 ,T1.MEMO_ID ,T1.FIN_YEAR       
 FROM PRD_STK_TRANSFER_MST_PENDING  T1        
 JOIN PRD_DEPARTMENT_MST T3 ON T3.DEPARTMENT_ID = T1.TARGET_DEPARTMENT_ID        
 JOIN PRD_DEPARTMENT_MST T4 ON T4.DEPARTMENT_ID = T1.SOURCE_DEPARTMENT_ID        
 JOIN PRD_STK_TRANSFER_DET_PENDING DET ON DET.MEMO_ID=T1.MEMO_ID        
 JOIN PRD_WO_MST WO ON WO.MEMO_ID=DET.REF_WO_ID      
 JOIN ARTICLE ART ON ART.ARTICLE_CODE=WO.ARTICLE_SET_CODE      
 GROUP BY T1.MEMO_NO ,WO.MEMO_NO ,WO.REF_NO      
  ,ART.ARTICLE_NO      
 ,T1.MEMO_DT         
 ,T3.DEPARTMENT_NAME         
 ,CASE WHEN T1.CANCELLED =0 THEN '' ELSE 'CANCELLED' END       
 ,T4.DEPARTMENT_NAME ,T1.SOURCE_DEPARTMENT_ID        
 ,T1.MEMO_ID ,T1.FIN_YEAR
