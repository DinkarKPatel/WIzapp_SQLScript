CREATE FUNCTION GETDISCCAT   
(  
 @CDEPTID CHAR(5),  
 @NDISCPCT NUMERIC(5,2)  
)  
RETURNS VARCHAR(50)  
AS   
BEGIN  
 DECLARE @CDISCCAT VARCHAR(50)  
  
 SELECT @CDISCCAT = DISC_CATEGORY   
 FROM LOC_COMM_DETAIL   
 WHERE DEPT_ID = @CDEPTID AND @NDISCPCT BETWEEN FLOOR_DISC_PCT AND CEIL_DISC_PCT  
  
 RETURN ISNULL(@CDISCCAT,'')  
END
