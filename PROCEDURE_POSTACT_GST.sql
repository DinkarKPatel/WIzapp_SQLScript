create PROCEDURE POSTACT_GST
(
	@CXNTYPE VARCHAR(40),
	@DFROMDT DATETIME,
	@DTODT DATETIME,
	@CACCODE VARCHAR(10) = '',
	@CLOCATIONID CHAR(4)='',
	@NLOOP NUMERIC(1,0)=0
)
AS 
BEGIN

	DECLARE @CPOSTINGXNTYPE VARCHAR(5),@NXNITEMTYPE NUMERIC(1,0)
	
	SELECT TOP 1 @CPOSTINGXNTYPE=POSTING_XN_TYPE FROM GST_ACCOUNTS_CONFIG_MST WHERE XN_TYPE=@CXNTYPE

	DECLARE @CCURLOCID CHAR(2),@CHOLOCID CHAR(2),@BLOC BIT	
	SELECT TOP 1 @CCURLOCID=value FROM CONFIG WHERE CONFIG_OPTION='LOCATION_ID'
	SELECT TOP 1 @CHOLOCID=VALUE FROM CONFIG WHERE CONFIG_OPTION='HO_LOCATION_ID'
	
	IF @CHOLOCID<>@CCURLOCID
		SET @BLOC=1
	ELSE 
		SET @BLOC=0
			
	SET @NXNITEMTYPE=1
	
	IF RIGHT(@CXNTYPE,4) IN ('_AST','_CON','_SRV')
		SET @NXNITEMTYPE=(CASE WHEN RIGHT(@CXNTYPE,4)='_AST' THEN 3 WHEN RIGHT(@CXNTYPE,4)='_CON' THEN 2 ELSE 4 END)
	
	IF @CPOSTINGXNTYPE='XFR'
	BEGIN
		EXEC POSTACT_GST_XFR @DTODT,@CLOCATIONID,@CXNTYPE,@nXnItemType,@NLOOP
		RETURN
	END
	ELSE 		
	IF LEFT(@CXNTYPE,3)='PUR'
	BEGIN
		EXEC POSTACT_GST_PUR @DTODT,@CLOCATIONID,@CACCODE,@CXNTYPE,@NXNITEMTYPE,@NLOOP,@BLOC
		RETURN
	END	
	IF LEFT(@CXNTYPE,3)='PRT'
	BEGIN
		EXEC POSTACT_GST_PRT @DTODT,@CLOCATIONID,@CACCODE,@CXNTYPE,@NXNITEMTYPE,@NLOOP,@BLOC
		RETURN
	END
	ELSE IF LEFT(@CXNTYPE,3)='WSL'
	BEGIN
		EXEC POSTACT_GST_WSL @DTODT,@CLOCATIONID,@CACCODE,@CXNTYPE,@NXNITEMTYPE,@NLOOP,@BLOC
		RETURN
	END
	ELSE IF LEFT(@CXNTYPE,3)='WSR'
	BEGIN
		EXEC POSTACT_GST_WSR @DTODT,@CLOCATIONID,@CACCODE,@CXNTYPE,@NXNITEMTYPE,@NLOOP,@BLOC
		RETURN
	END 
	ELSE IF @CXNTYPE='ARC'
	BEGIN
		EXEC POSTACT_GST_ARC @DTODT,@CLOCATIONID,@NLOOP,@BLOC
		RETURN
	END
	ELSE IF @CXNTYPE='SLS'
	BEGIN
		EXEC POSTACT_GST_SLS @DTODT,@CLOCATIONID,0,@NLOOP,@BLOC
		RETURN
	END
	ELSE IF @CXNTYPE='PTC'
	BEGIN
		EXEC POSTACT_GST_PTC @DTODT,@CLOCATIONID,@NLOOP,@BLOC
		RETURN
	END

	ELSE IF @CXNTYPE='IWS'
	BEGIN
		EXEC POSTACT_GST_EXPENSE @DTODT,@CLOCATIONID
		RETURN
	END

	ELSE IF @CXNTYPE='SOR_REC'
	BEGIN
		EXEC POSTACT_GST_SOR_RECEIPTS @DTODT,@CLOCATIONID,@CACCODE,@NLOOP
		RETURN
	END
		
	ELSE IF @CXNTYPE='JWR'
	BEGIN
		EXEC POSTACT_GST_JWR @DTODT,@CLOCATIONID,@CACCODE,@NLOOP
		RETURN
	END
	ELSE IF @CXNTYPE='BTF'
	BEGIN
		EXEC POSTACT_GST_BTF @DTODT,@CLOCATIONID,@NLOOP
		RETURN
	END
	ELSE IF @CXNTYPE='TLF'
	BEGIN
		EXEC POSTACT_GST_TTL @DTODT,@CLOCATIONID,@NLOOP
		RETURN
	END
	ELSE IF @CXNTYPE='PTF'
	BEGIN
		EXEC POSTACT_GST_PTF @DTODT,@CLOCATIONID,@NLOOP
		RETURN
	END	
	ELSE IF @CXNTYPE='RCM'
	BEGIN
		EXEC POSTACT_GST_RCM @DTODT,@CLOCATIONID,@NLOOP
		RETURN
	END		
END
