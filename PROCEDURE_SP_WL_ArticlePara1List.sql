

-- GET ALL SIZE LIST RELATED TO A ARTICLE
CREATE PROCEDURE SP_WL_ARTICLEPARA1LIST 
(
@ARTICLE_CODE VARCHAR(9)
)
--WITH ENCRYPTION
AS

		DECLARE @CMD NVARCHAR(MAX)
		DECLARE @PARA NUMERIC(10,2)
	 
		SELECT @PARA  = COUNT(A.PARA1_CODE )  
		FROM PARA1 A  
		JOIN ART_PARA1 (NOLOCK) B ON A.PARA1_CODE = B.PARA1_CODE  
		WHERE B.ARTICLE_CODE = @ARTICLE_CODE 
		IF @PARA > 0
		BEGIN
			SET @CMD = N'SELECT A.PARA1_CODE, A.PARA1_NAME  
			FROM PARA1 A  
			JOIN ART_PARA1 (NOLOCK) B ON A.PARA1_CODE = B.PARA1_CODE  
			WHERE B.ARTICLE_CODE = '''+@ARTICLE_CODE+''' ORDER BY A.PARA1_NAME'
		END
		ELSE
		BEGIN
			SET @CMD = N'SELECT A.PARA1_CODE, A.PARA1_NAME  FROM PARA1 A  
			WHERE A.PARA1_CODE = ''0000000'''
		END
		PRINT @CMD
		EXEC SP_EXECUTESQL @CMD    
--************************* END OF PROCEDURE SP_WL_ARTICLEPARA1LIST
