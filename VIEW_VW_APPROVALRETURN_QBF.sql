CREATE VIEW VW_APPROVALRETURN_QBF   

AS     
SELECT B.MEMO_NO ,B.MEMO_NO AS MST_MEMO_NO,ISNULL(CUST.USER_CUSTOMER_CODE,'') AS MST_USER_CUSTOMER_CODE,
ISNULL(LMV.AC_NAME,'') AS MST_AC_NAME,B.MEMO_DT AS MST_MEMO_DT,B.MODE AS MST_MODE,
B.FIN_YEAR AS MST_FIN_YEAR,B.REMARKS AS MST_REMARKS,
A.*,C.PRODUCT_CODE,C.MRP as apd_mrp,C.NET,    
APM.MEMO_NO AS APM_MEMO_NO, APM.MEMO_DT AS APM_MEMO_DT,
D.DT_CREATED AS SKU_DT_CREATED, E.DT_CREATED AS ART_DT_CREATED,E.ARTICLE_NO,         
F.PARA1_CODE,F.PARA1_NAME , G.PARA2_CODE , G.PARA2_NAME,H.SUB_SECTION_NAME, I.SECTION_NAME,    
J.DT_CREATED AS PARA3_DT_CREATED,J.PARA3_NAME,K.PARA4_NAME,L.PARA5_NAME,M.PARA6_NAME,    
UOM.UOM_TYPE, UOM.UOM_CODE,UOM.UOM_NAME       
,EMP.EMP_NAME ,US.USERNAME AS MST_USER_NAME    
FROM APPROVAL_RETURN_DET A  
JOIN APPROVAL_RETURN_MST B ON A.MEMO_ID = B.MEMO_ID    
JOIN APD01106 C ON C.ROW_ID = A.APD_ROW_ID  
JOIN APM01106 APM ON APM.MEMO_ID = C.MEMO_ID     
JOIN SKU D ON C.PRODUCT_CODE = D.PRODUCT_CODE    
JOIN ARTICLE E ON D.ARTICLE_CODE = E.ARTICLE_CODE         
JOIN PARA1 F ON D.PARA1_CODE = F.PARA1_CODE         
JOIN PARA2 G ON D.PARA2_CODE = G.PARA2_CODE         
JOIN SECTIOND H ON E.SUB_SECTION_CODE = H.SUB_SECTION_CODE         
JOIN SECTIONM I ON H.SECTION_CODE = I.SECTION_CODE       
JOIN PARA3 J ON D.PARA3_CODE = J.PARA3_CODE     
JOIN PARA4 K ON D.PARA4_CODE = K.PARA4_CODE    
JOIN PARA5 L ON D.PARA5_CODE = L.PARA5_CODE    
JOIN PARA6 M ON D.PARA6_CODE = M.PARA6_CODE    
JOIN UOM ON E.UOM_CODE = UOM.UOM_CODE 
LEFT OUTER JOIN USERS US ON US.USER_CODE = B.USER_CODE    
LEFT OUTER JOIN EMPLOYEE EMP  (NOLOCK) ON A.EMP_CODE = EMP.EMP_CODE 
LEFT OUTER JOIN CUSTDYM CUST ON CUST.CUSTOMER_CODE = B.CUSTOMER_CODE   
LEFT OUTER JOIN LMV01106 LMV ON LMV.AC_CODE = B.AC_CODE
